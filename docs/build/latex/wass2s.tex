%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,10pt,english]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax
\ifdefined\pdfimageresolution
    \pdfimageresolution= \numexpr \dimexpr1in\relax/\sphinxpxdimen\relax
\fi
%% let collapsible pdf bookmarks panel have high depth per default
\PassOptionsToPackage{bookmarksdepth=5}{hyperref}

\PassOptionsToPackage{booktabs}{sphinx}
\PassOptionsToPackage{colorrows}{sphinx}

\PassOptionsToPackage{warn}{textcomp}
\usepackage[utf8]{inputenc}
\ifdefined\DeclareUnicodeCharacter
% support both utf8 and utf8x syntaxes
  \ifdefined\DeclareUnicodeCharacterAsOptional
    \def\sphinxDUC#1{\DeclareUnicodeCharacter{"#1}}
  \else
    \let\sphinxDUC\DeclareUnicodeCharacter
  \fi
  \sphinxDUC{00A0}{\nobreakspace}
  \sphinxDUC{2500}{\sphinxunichar{2500}}
  \sphinxDUC{2502}{\sphinxunichar{2502}}
  \sphinxDUC{2514}{\sphinxunichar{2514}}
  \sphinxDUC{251C}{\sphinxunichar{251C}}
  \sphinxDUC{2572}{\textbackslash}
\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage{babel}



\usepackage{tgtermes}
\usepackage{tgheros}
\renewcommand{\ttdefault}{txtt}



\usepackage[Bjarne]{fncychap}
\usepackage{sphinx}

\fvset{fontsize=auto}
\usepackage{geometry}


% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}

\addto\captionsenglish{\renewcommand{\contentsname}{Contents:}}

\usepackage{sphinxmessages}
\setcounter{tocdepth}{1}


    \usepackage{enumitem}
    \setlistdepth{8}
    

\title{wass2s}
\date{May 19, 2025}
\release{0.1.0}
\author{Mandela C.\@{} M.\@{} HOUNGNIBO}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{Release}
\makeindex
\begin{document}

\ifdefined\shorthandoff
  \ifnum\catcode`\=\string=\active\shorthandoff{=}\fi
  \ifnum\catcode`\"=\active\shorthandoff{"}\fi
\fi

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{index::doc}}


\sphinxAtStartPar
A python\sphinxhyphen{}based tool for seasonal climate forecast in West Africa and the Sahel.

\sphinxAtStartPar
The wass2s tool is designed to facilitate implementation of the new generation of seasonal forecasts in West Africa and the Sahel using various statistical and machine learning methods. New generation of seasonal forecasts aligns with the World Meteorological Organization’s (WMO) guidelines for objective, operational, and scientifically rigorous seasonal forecasting methods. wass2s helps forecaster to download GCM, reanalysis, and satellite/observation data, build statistical or machine learning models, verify the models using cross\sphinxhyphen{}validation, and forecast.
A user\sphinxhyphen{}friendly \sphinxhref{https://github.com/hmandela/WASS2S\_notebooks}{jupyter\sphinxhyphen{}lab notebook}  streamlines the forecasting process .


\chapter{Features}
\label{\detokenize{index:features}}\begin{itemize}
\item {} 
\sphinxAtStartPar
Automated Forecasting

\item {} 
\sphinxAtStartPar
Reproducibility

\item {} 
\sphinxAtStartPar
Modularity

\item {} 
\sphinxAtStartPar
Exploration of Machine Learning Models.

\end{itemize}

\sphinxstepscope


\section{Installation}
\label{\detokenize{Installation:installation}}\label{\detokenize{Installation::doc}}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
Create an environment and activate it

\end{enumerate}
\begin{itemize}
\item {} 
\sphinxAtStartPar
For Windows: download yaml \sphinxhref{https://github.com/hmandela/WASS2S/blob/main/WAS\_S2S\_windows.yml}{here} and run

\end{itemize}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
conda\PYG{+w}{ }env\PYG{+w}{ }create\PYG{+w}{ }\PYGZhy{}f\PYG{+w}{ }WAS\PYGZus{}S2S\PYGZus{}windows.yml
conda\PYG{+w}{ }activate\PYG{+w}{ }WASS2S
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
\sphinxAtStartPar
For Linux: download yaml \sphinxhref{https://github.com/hmandela/WASS2S/blob/main/WAS\_S2S\_linux.yml}{here} and run

\end{itemize}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
conda\PYG{+w}{ }env\PYG{+w}{ }create\PYG{+w}{ }\PYGZhy{}f\PYG{+w}{ }WAS\PYGZus{}S2S\PYGZus{}linux.yml
conda\PYG{+w}{ }activate\PYG{+w}{ }WASS2S
\end{sphinxVerbatim}
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\setcounter{enumi}{1}
\item {} 
\sphinxAtStartPar
Install the wass2s package

\end{enumerate}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
pip\PYG{+w}{ }install\PYG{+w}{ }wass2s
\end{sphinxVerbatim}
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\setcounter{enumi}{2}
\item {} 
\sphinxAtStartPar
Upgrade the wass2s package

\end{enumerate}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
pip\PYG{+w}{ }install\PYG{+w}{ }\PYGZhy{}\PYGZhy{}upgrade\PYG{+w}{ }wass2s
\end{sphinxVerbatim}

\sphinxstepscope


\section{Usage}
\label{\detokenize{Usage:usage}}\label{\detokenize{Usage::doc}}
\sphinxAtStartPar
Comprehensive usage guidelines, including data download, processing, models description, configuration and execution, cross\sphinxhyphen{}validation, and verification, are available in the \sphinxhref{https://hmandela.github.io/WAS\_S2S\_Training/}{Training Documentation}.
But for a quick start, use the \sphinxhref{https://github.com/hmandela/WASS2S\_notebooks}{example notebooks}.

\sphinxAtStartPar
Download example notebooks:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
git\PYG{+w}{ }clone\PYG{+w}{ }https://github.com/hmandela/WASS2S\PYGZus{}notebooks.git
\end{sphinxVerbatim}

\sphinxAtStartPar
or download the zip file:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
wget\PYG{+w}{ }https://github.com/hmandela/WASS2S\PYGZus{}notebooks/archive/refs/heads/main.zip\PYG{+w}{ }\PYGZhy{}O\PYG{+w}{ }WASS2S\PYGZus{}notebooks.zip
\end{sphinxVerbatim}

\sphinxstepscope


\subsection{Download module}
\label{\detokenize{Download:download-module}}\label{\detokenize{Download::doc}}
\sphinxAtStartPar
Three types of data can be downloaded with wass2s:
\begin{itemize}
\item {} 
\sphinxAtStartPar
GCM data on seasonal time scales

\item {} 
\sphinxAtStartPar
Reanalysis data

\item {} 
\sphinxAtStartPar
Observational data (satellite data, products combining satellite and observational data)

\end{itemize}

\sphinxAtStartPar
For some data, for instance \sphinxhref{https://cds.climate.copernicus.eu/}{C3S}, it requires creating an account, accepting the terms of use, and configuring an API key ({\color{red}\bfseries{}\textasciigrave{}CDS API key\textless{}https://hmandela.github.io/WAS\_S2S\_Training/s2s\_data.html\textgreater{}\textasciigrave{}\_}).
Please refer also to the \sphinxhref{https://cds.climate.copernicus.eu/api-how-to}{CDS documentation} for more instructions on how to set up the API key.
For more information on C3S seasonal data, browse the \sphinxhref{https://confluence.ecmwf.int/display/CKB/Description+of+the+C3S+seasonal+multi-system}{MetaData}.


\subsubsection{Download GCM data}
\label{\detokenize{Download:download-gcm-data}}
\sphinxAtStartPar
The \sphinxcode{\sphinxupquote{WAS\_Download\_Models}} method allows downloading seasonal forecast model data from various centers for specified variables, initialization months, lead times, and years.

\sphinxAtStartPar
\sphinxstylestrong{Parameters:}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{dir\_to\_save}} (str): Directory to save the downloaded files.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{center\_variable}} (list): List of center\sphinxhyphen{}variable identifiers, e.g., {[}“ECMWF\_51.PRCP”, “UKMO\_604.TEMP”{]}.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{month\_of\_initialization}} (int): Initialization month as an integer (1\sphinxhyphen{}12).

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{lead\_time}} (list): List of lead times in months.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{year\_start\_hindcast}} (int): Start year for hindcast data.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{year\_end\_hindcast}} (int): End year for hindcast data.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{area}} (list): Bounding box as {[}North, West, South, East{]} for clipping.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{year\_forecast}} (int, optional): Forecast year if downloading forecast data. Defaults to None.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{ensemble\_mean}} (str, optional): Can be “median”, “mean”, or None. Defaults to None.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{force\_download}} (bool): If True, forces download even if file exists.

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Available centers and variables:}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Centers:} BOM\_2, ECMWF\_51, UKMO\_604, UKMO\_603, METEOFRANCE\_8, METEOFRANCE\_9, DWD\_21, DWD\_22, CMCC\_35, NCEP\_2, JMA\_3, ECCC\_4, ECCC\_5, CFSV2\_1, CMC1\_1, CMC2\_1, GFDL\_1, NASA\_1, NCAR\_CCSM4\_1, NMME\_1

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Variables:} PRCP, TEMP, TMAX, TMIN, UGRD10, VGRD10, SST, SLP, DSWR, DLWR, HUSS\_1000, HUSS\_925, HUSS\_850, UGRD\_1000, UGRD\_925, UGRD\_850, VGRD\_1000, VGRD\_925, VGRD\_850

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Note:} Some models are part of the NMME (North American Multi\sphinxhyphen{}Model Ensemble) project. For more information, see the \sphinxhref{https://www.cpc.ncep.noaa.gov/products/NMME/}{NMME documentation}.
If \sphinxcode{\sphinxupquote{year\_forecast}} is not specified, hindcast data is downloaded; otherwise, forecast data for the specified year is retrieved.

\sphinxAtStartPar
\sphinxstylestrong{Example:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{wass2s} \PYG{k+kn}{import} \PYG{o}{*}

\PYG{n}{downloader} \PYG{o}{=} \PYG{n}{WAS\PYGZus{}Download}\PYG{p}{(}\PYG{p}{)}

\PYG{n}{downloader}\PYG{o}{.}\PYG{n}{WAS\PYGZus{}Download\PYGZus{}Models}\PYG{p}{(}
    \PYG{n}{dir\PYGZus{}to\PYGZus{}save}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{/path/to/save}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
    \PYG{n}{center\PYGZus{}variable}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ECMWF\PYGZus{}51.PRCP}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{month\PYGZus{}of\PYGZus{}initialization}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{03}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
    \PYG{n}{lead\PYGZus{}time}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{01}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{02}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{03}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{year\PYGZus{}start\PYGZus{}hindcast}\PYG{o}{=}\PYG{l+m+mi}{1993}\PYG{p}{,}
    \PYG{n}{year\PYGZus{}end\PYGZus{}hindcast}\PYG{o}{=}\PYG{l+m+mi}{2016}\PYG{p}{,}
    \PYG{n}{area}\PYG{o}{=}\PYG{p}{[}\PYG{l+m+mi}{60}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{180}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{60}\PYG{p}{,} \PYG{l+m+mi}{180}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{force\PYGZus{}download}\PYG{o}{=}\PYG{k+kc}{False}
\PYG{p}{)}
\end{sphinxVerbatim}


\subsubsection{Download daily GCM data}
\label{\detokenize{Download:download-daily-gcm-data}}
\sphinxAtStartPar
The \sphinxcode{\sphinxupquote{WAS\_Download\_Models\_Daily}} method allows downloading daily or sub\sphinxhyphen{}daily seasonal forecast model data from various centers for specified variables, initialization dates, lead times, and years.

\sphinxAtStartPar
\sphinxstylestrong{Parameters:}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{dir\_to\_save}} (str): Directory to save the downloaded files.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{center\_variable}} (list): List of center\sphinxhyphen{}variable identifiers, e.g., {[}“ECMWF\_51.PRCP”, “UKMO\_604.TEMP”{]}.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{month\_of\_initialization}} (int): Initialization month as an integer (1\sphinxhyphen{}12).

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{day\_of\_initialization}} (int): Initialization day as an integer (1\sphinxhyphen{}31).

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{leadtime\_hour}} (list): List of lead times in hours, e.g., {[}“24”, “48”, …, “5160”{]}.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{year\_start\_hindcast}} (int): Start year for hindcast data.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{year\_end\_hindcast}} (int): End year for hindcast data.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{area}} (list): Bounding box as {[}North, West, South, East{]} for clipping.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{year\_forecast}} (int, optional): Forecast year if downloading forecast data. Defaults to None.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{ensemble\_mean}} (str, optional): Can be “mean”, “median”, or None. Defaults to None.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{force\_download}} (bool): If True, forces download even if file exists.

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Available centers and variables:}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Centers:} ECMWF\_51, UKMO\_604, UKMO\_603, METEOFRANCE\_8, DWD\_21, DWD\_22, CMCC\_35, NCEP\_2, JMA\_3, ECCC\_4, ECCC\_5

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Variables:} PRCP, TEMP, TMAX, TMIN, UGRD10, VGRD10, SST, SLP, DSWR, DLWR, HUSS\_1000, HUSS\_925, HUSS\_850, UGRD\_1000, UGRD\_925, UGRD\_850, VGRD\_1000, VGRD\_925, VGRD\_850

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Example:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{wass2s} \PYG{k+kn}{import} \PYG{o}{*}

\PYG{n}{downloader} \PYG{o}{=} \PYG{n}{WAS\PYGZus{}Download}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{downloader}\PYG{o}{.}\PYG{n}{WAS\PYGZus{}Download\PYGZus{}Models\PYGZus{}Daily}\PYG{p}{(}
    \PYG{n}{dir\PYGZus{}to\PYGZus{}save}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{/path/to/save}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
    \PYG{n}{center\PYGZus{}variable}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ECMWF\PYGZus{}51.PRCP}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{month\PYGZus{}of\PYGZus{}initialization}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{01}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
    \PYG{n}{day\PYGZus{}of\PYGZus{}initialization}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{01}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
    \PYG{n}{leadtime\PYGZus{}hour}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{24}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{48}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{72}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{year\PYGZus{}start\PYGZus{}hindcast}\PYG{o}{=}\PYG{l+m+mi}{1993}\PYG{p}{,}
    \PYG{n}{year\PYGZus{}end\PYGZus{}hindcast}\PYG{o}{=}\PYG{l+m+mi}{2016}\PYG{p}{,}
    \PYG{n}{area}\PYG{o}{=}\PYG{p}{[}\PYG{l+m+mi}{60}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{180}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{60}\PYG{p}{,} \PYG{l+m+mi}{180}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{force\PYGZus{}download}\PYG{o}{=}\PYG{k+kc}{False}
\PYG{p}{)}
\end{sphinxVerbatim}


\subsubsection{Download reanalysis data}
\label{\detokenize{Download:download-reanalysis-data}}
\sphinxAtStartPar
The \sphinxcode{\sphinxupquote{WAS\_Download\_Reanalysis}} method downloads reanalysis data for specified center\sphinxhyphen{}variable combinations, years, and months, handling cross\sphinxhyphen{}year seasons.

\sphinxAtStartPar
\sphinxstylestrong{Parameters:}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{dir\_to\_save}} (str): Directory to save the downloaded files.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{center\_variable}} (list): List of center\sphinxhyphen{}variable identifiers, e.g., {[}“ERA5.PRCP”, “MERRA2.TEMP”{]}.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{year\_start}} (int): Start year for the data to download.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{year\_end}} (int): End year for the data to download.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{area}} (list): Bounding box as {[}North, West, South, East{]} for clipping.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{seas}} (list): List of month strings representing the season, e.g., {[}“11”, “12”, “01”{]} for NDJ.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{force\_download}} (bool): If True, forces download even if file exists.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{run\_avg}} (int): Number of months for running average (default=3).

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Available centers and variables:}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Centers:} ERA5, MERRA2, NOAA (for SST)

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Variables:} PRCP, TEMP, TMAX, TMIN, UGRD10, VGRD10, SST, SLP, DSWR, DLWR, HUSS\_1000, HUSS\_925, HUSS\_850, UGRD\_1000, UGRD\_925, UGRD\_850, VGRD\_1000, VGRD\_925, VGRD\_850

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Example:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{wass2s} \PYG{k+kn}{import} \PYG{o}{*}

\PYG{n}{downloader} \PYG{o}{=} \PYG{n}{WAS\PYGZus{}Download}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{downloader}\PYG{o}{.}\PYG{n}{WAS\PYGZus{}Download\PYGZus{}Reanalysis}\PYG{p}{(}
    \PYG{n}{dir\PYGZus{}to\PYGZus{}save}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{/path/to/save}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
    \PYG{n}{center\PYGZus{}variable}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ERA5.PRCP}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{year\PYGZus{}start}\PYG{o}{=}\PYG{l+m+mi}{1993}\PYG{p}{,}
    \PYG{n}{year\PYGZus{}end}\PYG{o}{=}\PYG{l+m+mi}{2016}\PYG{p}{,}
    \PYG{n}{area}\PYG{o}{=}\PYG{p}{[}\PYG{l+m+mi}{60}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{180}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{60}\PYG{p}{,} \PYG{l+m+mi}{180}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{seas}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{11}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{12}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{01}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{force\PYGZus{}download}\PYG{o}{=}\PYG{k+kc}{False}
\PYG{p}{)}
\end{sphinxVerbatim}


\subsubsection{Download observational data}
\label{\detokenize{Download:download-observational-data}}
\sphinxAtStartPar
Observational data includes agro\sphinxhyphen{}meteorological indicators and satellite\sphinxhyphen{}based precipitation data like CHIRPS.


\paragraph{Agro\sphinxhyphen{}meteorological indicators}
\label{\detokenize{Download:agro-meteorological-indicators}}
\sphinxAtStartPar
The \sphinxcode{\sphinxupquote{WAS\_Download\_AgroIndicators}} method downloads agro\sphinxhyphen{}meteorological indicators for specified variables, years, and months, handling cross\sphinxhyphen{}year seasons.

\sphinxAtStartPar
\sphinxstylestrong{Parameters:}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{dir\_to\_save}} (str): Directory to save the downloaded files.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{variables}} (list): List of shorthand variables, e.g., {[}“AGRO.PRCP”, “AGRO.TMAX”{]}.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{year\_start}} (int): Start year for the data to download.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{year\_end}} (int): End year for the data to download.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{area}} (list): Bounding box as {[}North, West, South, East{]} for clipping.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{seas}} (list): List of month strings representing the season, e.g., {[}“11”, “12”, “01”{]} for NDJ.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{force\_download}} (bool): If True, forces download even if file exists.

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Available variables:}
\begin{itemize}
\item {} 
\sphinxAtStartPar
AGRO.PRCP: precipitation\_flux

\item {} 
\sphinxAtStartPar
AGRO.TMAX: 2m\_temperature (24\_hour\_maximum)

\item {} 
\sphinxAtStartPar
AGRO.TEMP: 2m\_temperature (24\_hour\_mean)

\item {} 
\sphinxAtStartPar
AGRO.TMIN: 2m\_temperature (24\_hour\_minimum)

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Example:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{wass2s} \PYG{k+kn}{import} \PYG{o}{*}

\PYG{n}{downloader} \PYG{o}{=} \PYG{n}{WAS\PYGZus{}Download}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{downloader}\PYG{o}{.}\PYG{n}{WAS\PYGZus{}Download\PYGZus{}AgroIndicators}\PYG{p}{(}
    \PYG{n}{dir\PYGZus{}to\PYGZus{}save}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{/path/to/save}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
    \PYG{n}{variables}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{AGRO.PRCP}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{year\PYGZus{}start}\PYG{o}{=}\PYG{l+m+mi}{1993}\PYG{p}{,}
    \PYG{n}{year\PYGZus{}end}\PYG{o}{=}\PYG{l+m+mi}{2016}\PYG{p}{,}
    \PYG{n}{area}\PYG{o}{=}\PYG{p}{[}\PYG{l+m+mi}{60}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{180}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{60}\PYG{p}{,} \PYG{l+m+mi}{180}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{seas}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{11}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{12}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{01}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{force\PYGZus{}download}\PYG{o}{=}\PYG{k+kc}{False}
\PYG{p}{)}
\end{sphinxVerbatim}


\paragraph{Download daily agro\sphinxhyphen{}meteorological indicators}
\label{\detokenize{Download:download-daily-agro-meteorological-indicators}}
\sphinxAtStartPar
The \sphinxcode{\sphinxupquote{WAS\_Download\_AgroIndicators\_daily}} method downloads daily agro\sphinxhyphen{}meteorological indicators for specified variables and years.

\sphinxAtStartPar
\sphinxstylestrong{Parameters:}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{dir\_to\_save}} (str): Directory to save the downloaded files.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{variables}} (list): List of shorthand variables, e.g., {[}“AGRO.PRCP”, “AGRO.TMAX”{]}.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{year\_start}} (int): Start year for the data to download.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{year\_end}} (int): End year for the data to download.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{area}} (list): Bounding box as {[}North, West, South, East{]} for clipping.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{force\_download}} (bool): If True, forces download even if file exists.

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Available variables:}
\begin{itemize}
\item {} 
\sphinxAtStartPar
AGRO.PRCP: precipitation\_flux

\item {} 
\sphinxAtStartPar
AGRO.TMAX: 2m\_temperature (24\_hour\_maximum)

\item {} 
\sphinxAtStartPar
AGRO.TEMP: 2m\_temperature (24\_hour\_mean)

\item {} 
\sphinxAtStartPar
AGRO.TMIN: 2m\_temperature (24\_hour\_minimum)

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Example:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{wass2s} \PYG{k+kn}{import} \PYG{o}{*}

\PYG{n}{downloader} \PYG{o}{=} \PYG{n}{WAS\PYGZus{}Download}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{downloader}\PYG{o}{.}\PYG{n}{WAS\PYGZus{}Download\PYGZus{}AgroIndicators\PYGZus{}daily}\PYG{p}{(}
    \PYG{n}{dir\PYGZus{}to\PYGZus{}save}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{/path/to/save}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
    \PYG{n}{variables}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{AGRO.PRCP}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{year\PYGZus{}start}\PYG{o}{=}\PYG{l+m+mi}{1993}\PYG{p}{,}
    \PYG{n}{year\PYGZus{}end}\PYG{o}{=}\PYG{l+m+mi}{2016}\PYG{p}{,}
    \PYG{n}{area}\PYG{o}{=}\PYG{p}{[}\PYG{l+m+mi}{60}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{180}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{60}\PYG{p}{,} \PYG{l+m+mi}{180}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{force\PYGZus{}download}\PYG{o}{=}\PYG{k+kc}{False}
\PYG{p}{)}
\end{sphinxVerbatim}


\paragraph{CHIRPS precipitation data}
\label{\detokenize{Download:chirps-precipitation-data}}
\sphinxAtStartPar
The \sphinxcode{\sphinxupquote{WAS\_Download\_CHIRPSv3}} method downloads CHIRPS v3.0 monthly precipitation data for a specified cross\sphinxhyphen{}year season.

\sphinxAtStartPar
\sphinxstylestrong{Parameters:}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{dir\_to\_save}} (str): Directory to save the downloaded files.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{variables}} (list): List of variables, typically {[}“PRCP”{]}.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{year\_start}} (int): Start year for the data to download.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{year\_end}} (int): End year for the data to download.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{area}} (list, optional): Bounding box as {[}North, West, South, East{]} for clipping.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{season\_months}} (list): List of month strings representing the season, e.g., {[}“03”, “04”, “05”{]} for MAM.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{force\_download}} (bool): If True, forces download even if file exists.

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Note:} CHIRPS data is available for land areas between 50°S and 50°N.

\sphinxAtStartPar
\sphinxstylestrong{Example:}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{wass2s} \PYG{k+kn}{import} \PYG{o}{*}

\PYG{n}{downloader} \PYG{o}{=} \PYG{n}{WAS\PYGZus{}Download}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{downloader}\PYG{o}{.}\PYG{n}{WAS\PYGZus{}Download\PYGZus{}CHIRPSv3}\PYG{p}{(}
    \PYG{n}{dir\PYGZus{}to\PYGZus{}save}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{/path/to/save}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
    \PYG{n}{variables}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{PRCP}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{year\PYGZus{}start}\PYG{o}{=}\PYG{l+m+mi}{1993}\PYG{p}{,}
    \PYG{n}{year\PYGZus{}end}\PYG{o}{=}\PYG{l+m+mi}{2016}\PYG{p}{,}
    \PYG{n}{area}\PYG{o}{=}\PYG{p}{[}\PYG{l+m+mi}{15}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{20}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{5}\PYG{p}{,} \PYG{l+m+mi}{20}\PYG{p}{]}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} Example for Africa}
    \PYG{n}{season\PYGZus{}months}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{03}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{04}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{05}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{force\PYGZus{}download}\PYG{o}{=}\PYG{k+kc}{False}
\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxstepscope


\subsection{Processing Modules}
\label{\detokenize{Processing:processing-modules}}\label{\detokenize{Processing::doc}}
\sphinxAtStartPar
The Processing modules provide tools for computing various climate indices or predictands from daily data, such as onset and cessation of the rainy season, dry and wet spells, number of rainy days, extreme precipitation indices, and heat wave indices. Additionally, it offers methods for merging or adjusting gridded data with station observations to correct biases.

\sphinxAtStartPar
These modules are divided into two main parts:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Computing Predictands}: Classes for calculating different climate indices from daily data.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Merging and Adjusting Data}: Classes for combining gridded data with station observations to improve accuracy.

\end{enumerate}

\sphinxAtStartPar
\sphinxstylestrong{Prerequisites}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Dask}: Required for parallel processing in gridded data computations.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Data Formats}: Gridded data should be in xarray DataArray format with coordinates (T, Y, X). Station data should be in CDT format for daily data or CPT format for seasonal aggregation before merging.

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Climate Data Tools (CDT)}: Format for daily data.


\begin{savenotes}\sphinxattablestart
\sphinxthistablewithglobalstyle
\centering
\begin{tabulary}{\linewidth}[t]{TTT}
\sphinxtoprule
\sphinxstyletheadfamily 
\sphinxAtStartPar
ID
&\sphinxstyletheadfamily 
\sphinxAtStartPar
ALLADA
&\sphinxstyletheadfamily 
\sphinxAtStartPar
APLAHOUE
\\
\sphinxmidrule
\sphinxtableatstartofbodyhook
\sphinxAtStartPar
LON
&
\sphinxAtStartPar
2.133333
&
\sphinxAtStartPar
1.666667
\\
\sphinxhline
\sphinxAtStartPar
LAT
&
\sphinxAtStartPar
6.65
&
\sphinxAtStartPar
6.916667
\\
\sphinxhline
\sphinxAtStartPar
DAILY/ELEV
&
\sphinxAtStartPar
92.0
&
\sphinxAtStartPar
153.0
\\
\sphinxhline
\sphinxAtStartPar
19810101
&
\sphinxAtStartPar
0.0
&
\sphinxAtStartPar
0.0
\\
\sphinxhline
\sphinxAtStartPar
19810102
&
\sphinxAtStartPar
0.0
&
\sphinxAtStartPar
0.0
\\
\sphinxhline
\sphinxAtStartPar
19810103
&
\sphinxAtStartPar
0.0
&
\sphinxAtStartPar
0.0
\\
\sphinxhline
\sphinxAtStartPar
19810104
&
\sphinxAtStartPar
0.0
&
\sphinxAtStartPar
0.0
\\
\sphinxhline
\sphinxAtStartPar
19810105
&
\sphinxAtStartPar
0.0
&
\sphinxAtStartPar
0.0
\\
\sphinxhline
\sphinxAtStartPar
19810106
&
\sphinxAtStartPar
0.0
&
\sphinxAtStartPar
0.0
\\
\sphinxhline
\sphinxAtStartPar
19810107
&
\sphinxAtStartPar
0.0
&
\sphinxAtStartPar
0.0
\\
\sphinxhline
\sphinxAtStartPar
19810108
&
\sphinxAtStartPar
0.0
&
\sphinxAtStartPar
0.0
\\
\sphinxhline
\sphinxAtStartPar
19810109
&
\sphinxAtStartPar
0.0
&
\sphinxAtStartPar
0.0
\\
\sphinxhline
\sphinxAtStartPar
19810110
&
\sphinxAtStartPar
0.0
&
\sphinxAtStartPar
0.0
\\
\sphinxhline
\sphinxAtStartPar
…
&&\\
\sphinxbottomrule
\end{tabulary}
\sphinxtableafterendhook\par
\sphinxattableend\end{savenotes}

\sphinxAtStartPar
\sphinxstylestrong{Climate Prediction Tools (CPT)}: Format for seasonal aggregation (used in climate prediction tools) before merging.


\begin{savenotes}\sphinxattablestart
\sphinxthistablewithglobalstyle
\centering
\begin{tabulary}{\linewidth}[t]{TTTT}
\sphinxtoprule
\sphinxstyletheadfamily 
\sphinxAtStartPar
STATION
&\sphinxstyletheadfamily 
\sphinxAtStartPar
ABEO
&\sphinxstyletheadfamily 
\sphinxAtStartPar
ABUJ
&\sphinxstyletheadfamily 
\sphinxAtStartPar
ADEK
\\
\sphinxmidrule
\sphinxtableatstartofbodyhook
\sphinxAtStartPar
LAT
&
\sphinxAtStartPar
7.2
&
\sphinxAtStartPar
7.6
&
\sphinxAtStartPar
9.0
\\
\sphinxhline
\sphinxAtStartPar
LON
&
\sphinxAtStartPar
3.3
&
\sphinxAtStartPar
5.2
&
\sphinxAtStartPar
7.2
\\
\sphinxhline
\sphinxAtStartPar
1991
&
\sphinxAtStartPar
514.9
&
\sphinxAtStartPar
715.1
&
\sphinxAtStartPar
934.3
\\
\sphinxhline
\sphinxAtStartPar
1992
&
\sphinxAtStartPar
503.6
&
\sphinxAtStartPar
736.4
&
\sphinxAtStartPar
714.6
\\
\sphinxhline
\sphinxAtStartPar
1993
&
\sphinxAtStartPar
414.6
&
\sphinxAtStartPar
891.0
&
\sphinxAtStartPar
709.6
\\
\sphinxhline
\sphinxAtStartPar
1994
&
\sphinxAtStartPar
345.6
&
\sphinxAtStartPar
1034.7
&
\sphinxAtStartPar
491.7
\\
\sphinxhline
\sphinxAtStartPar
1995
&
\sphinxAtStartPar
492.2
&
\sphinxAtStartPar
837.6
&
\sphinxAtStartPar
938.8
\\
\sphinxhline
\sphinxAtStartPar
…
&&&\\
\sphinxbottomrule
\end{tabulary}
\sphinxtableafterendhook\par
\sphinxattableend\end{savenotes}


\subsubsection{Computing Predictands}
\label{\detokenize{Processing:computing-predictands}}
\sphinxAtStartPar
This section includes classes for computing various climate indices:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{WAS\_compute\_onset}}: Computes the onset of the rainy season.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{WAS\_compute\_cessation}}: Computes the cessation of the rainy season.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{WAS\_compute\_onset\_dry\_spell}}: Computes the longest dry spell after the onset.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{WAS\_compute\_cessation\_dry\_spell}}: Computes the longest dry spell in flourishing period.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{WAS\_count\_wet\_spells}}: Computes the number of wet spells between onset and cessation.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{WAS\_count\_dry\_spells}}: Computes the number of dry spells between onset and cessation.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{WAS\_count\_rainy\_days}}: Computes the number of rainy days between onset and cessation.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{WAS\_r95\_99p}}: Computes extreme precipitation indices R95p and R99p.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{WAS\_compute\_HWSDI}}: Computes the Heat Wave Severity Duration Index.

\end{itemize}

\sphinxAtStartPar
Each class has methods for computing the index from gridded data (\sphinxcode{\sphinxupquote{compute}}) and, where applicable, from station data in CDT format (\sphinxcode{\sphinxupquote{compute\_insitu}}).

\sphinxAtStartPar
\sphinxstylestrong{Onset Computation}

\sphinxAtStartPar
The \sphinxcode{\sphinxupquote{WAS\_compute\_onset}} class computes the onset of the rainy season based on user\sphinxhyphen{}defined or default criteria for different zones.

\sphinxAtStartPar
\sphinxstylestrong{Initialization}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{\_\_init\_\_(self, user\_criteria=None)}}: Initializes the class with user\sphinxhyphen{}defined criteria. If not provided, default criteria are used.

\item {} 
\sphinxAtStartPar
Dictionaries \sphinxcode{\sphinxupquote{onset\_criteria}},  \sphinxcode{\sphinxupquote{cessation\_criteria}}, \sphinxcode{\sphinxupquote{onset\_dryspell\_criteria}}, \sphinxcode{\sphinxupquote{cessation\_dryspell\_criteria}} show how to define the criteria for onset, cessation, onset dry spell and cessation dry spell computations.

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Methods}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{compute(self, daily\_data, nb\_cores)}}: Computes onset dates for gridded daily rainfall data.
* \sphinxcode{\sphinxupquote{daily\_data}}: xarray DataArray with daily rainfall data (coords: T, Y, X).
* \sphinxcode{\sphinxupquote{nb\_cores}}: Number of CPU cores for parallel processing.
* Returns: xarray DataArray with onset dates.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{compute\_insitu(self, daily\_df)}}: Computes onset dates for station data in CDT format.
* \sphinxcode{\sphinxupquote{daily\_df}}: pandas DataFrame in CDT format.
* Returns: pandas DataFrame in CPT format with onset dates.

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Criteria Dictionary}

\sphinxAtStartPar
The criteria dictionary defines parameters for onset computation:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{p}{\PYGZob{}}
    \PYG{l+m+mi}{0}\PYG{p}{:} \PYG{p}{\PYGZob{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{zone\PYGZus{}name}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Sahel100\PYGZus{}0mm}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{start\PYGZus{}search}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{06\PYGZhy{}01}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{cumulative}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+m+mi}{10}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{number\PYGZus{}dry\PYGZus{}days}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+m+mi}{25}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{thrd\PYGZus{}rain\PYGZus{}day}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+m+mf}{0.85}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{end\PYGZus{}search}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{08\PYGZhy{}30}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{,}
    \PYG{l+m+mi}{1}\PYG{p}{:} \PYG{p}{\PYGZob{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{zone\PYGZus{}name}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Sahel200\PYGZus{}100mm}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{start\PYGZus{}search}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{05\PYGZhy{}15}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{cumulative}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+m+mi}{15}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{number\PYGZus{}dry\PYGZus{}days}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+m+mi}{25}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{thrd\PYGZus{}rain\PYGZus{}day}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+m+mf}{0.85}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{end\PYGZus{}search}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{08\PYGZhy{}15}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{,}
    \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}
\PYG{p}{\PYGZcb{}}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{zone\_name}}: Name of the zone.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{start\_search}}: Start date for searching the onset (e.g., “06\sphinxhyphen{}01”).

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{cumulative}}: Cumulative rainfall threshold (mm).

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{number\_dry\_days}}: Maximum number of dry days allowed after onset.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{thrd\_rain\_day}}: Rainfall threshold to consider a day as rainy (mm).

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{end\_search}}: End date for searching the onset.

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Example}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{wass2s} \PYG{k+kn}{import} \PYG{o}{*}
\PYG{c+c1}{\PYGZsh{} Download daily rainfall data}
\PYG{n}{downloader} \PYG{o}{=} \PYG{n}{WAS\PYGZus{}Download}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{downloader}\PYG{o}{.}\PYG{n}{WAS\PYGZus{}Download\PYGZus{}AgroIndicators\PYGZus{}daily}\PYG{p}{(}
    \PYG{n}{dir\PYGZus{}to\PYGZus{}save}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{/path/to/save}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
    \PYG{n}{variables}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{AGRO.PRCP}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{year\PYGZus{}start}\PYG{o}{=}\PYG{l+m+mi}{1993}\PYG{p}{,}
    \PYG{n}{year\PYGZus{}end}\PYG{o}{=}\PYG{l+m+mi}{2016}\PYG{p}{,}
    \PYG{n}{area}\PYG{o}{=}\PYG{p}{[}\PYG{l+m+mi}{60}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{180}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{60}\PYG{p}{,} \PYG{l+m+mi}{180}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{force\PYGZus{}download}\PYG{o}{=}\PYG{k+kc}{False}
\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Load daily rainfall data}
\PYG{n}{rainfall} \PYG{o}{=} \PYG{n}{prepare\PYGZus{}predictand}\PYG{p}{(}\PYG{n}{dir\PYGZus{}to\PYGZus{}save}\PYG{p}{,} \PYG{n}{variables}\PYG{p}{,} \PYG{n}{year\PYGZus{}start}\PYG{p}{,} \PYG{n}{year\PYGZus{}end}\PYG{p}{,} \PYG{n}{daily}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{ds}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}\PYGZsh{} NB: prepare\PYGZus{}predictand is a utility function that loads the data and prepares it for the computation of the predictand.}
\PYG{c+c1}{\PYGZsh{}\PYGZsh{} ds is set to False because the data will be loaded as dataarray.}

\PYG{c+c1}{\PYGZsh{} Print predefined  onset criteria}
\PYG{n}{onset\PYGZus{}criteria}
\PYG{c+c1}{\PYGZsh{} Define user criteria}
\PYG{n}{user\PYGZus{}criteria} \PYG{o}{=} \PYG{n}{onset\PYGZus{}criteria}
\PYG{c+c1}{\PYGZsh{} adjust user criteria}
\PYG{n}{user\PYGZus{}criteria}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{start\PYGZus{}search}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{06\PYGZhy{}15}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{n}{user\PYGZus{}criteria}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{end\PYGZus{}search}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{09\PYGZhy{}01}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{c+c1}{\PYGZsh{} Compute onset}
\PYG{n}{was\PYGZus{}onset} \PYG{o}{=} \PYG{n}{WAS\PYGZus{}compute\PYGZus{}onset}\PYG{p}{(}\PYG{n}{user\PYGZus{}criteria}\PYG{p}{)}
\PYG{n}{onset} \PYG{o}{=} \PYG{n}{was\PYGZus{}onset}\PYG{o}{.}\PYG{n}{compute}\PYG{p}{(}\PYG{n}{daily\PYGZus{}data}\PYG{o}{=}\PYG{n}{rainfall}\PYG{p}{,} \PYG{n}{nb\PYGZus{}cores}\PYG{o}{=}\PYG{l+m+mi}{4}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} Plot the mean onset date to check the results}
\PYG{n}{plot\PYGZus{}date}\PYG{p}{(}\PYG{n}{onset}\PYG{o}{.}\PYG{n}{mean}\PYG{p}{(}\PYG{n}{dim}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{T}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Cessation Computation}

\sphinxAtStartPar
The \sphinxcode{\sphinxupquote{WAS\_compute\_cessation}} class computes the cessation of the rainy season based on soil moisture balance criteria.
\begin{itemize}
\item {} 
\sphinxAtStartPar
Similar initialization and methods as \sphinxcode{\sphinxupquote{WAS\_compute\_onset}} with criteria including:
* \sphinxcode{\sphinxupquote{date\_dry\_soil}}: Date when soil is assumed dry (e.g., “01\sphinxhyphen{}01”).
* \sphinxcode{\sphinxupquote{ETP}}: Evapotranspiration rate (mm/day).
* \sphinxcode{\sphinxupquote{Cap\_ret\_maxi}}: Maximum soil water retention capacity (mm).

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Dry Spell Computation}

\sphinxAtStartPar
The \sphinxcode{\sphinxupquote{WAS\_compute\_onset\_dry\_spell}} class computes the longest dry spell after the onset.
\begin{itemize}
\item {} 
\sphinxAtStartPar
Includes an additional \sphinxcode{\sphinxupquote{nbjour}} parameter in the criteria for the number of days to check after onset.

\end{itemize}

\sphinxAtStartPar
The \sphinxcode{\sphinxupquote{WAS\_compute\_cessation\_dry\_spell}} class computes the longest dry spell in flourishing period.
\begin{itemize}
\item {} 
\sphinxAtStartPar
Includes an additional \sphinxcode{\sphinxupquote{nbjour}} parameter in the criteria for the number of days to check after cessation.

\end{itemize}

\sphinxAtStartPar
The \sphinxcode{\sphinxupquote{WAS\_count\_dry\_spells}} class computes the number of dry spells between onset and cessation. Requires onset and cessation dates as inputs.

\sphinxAtStartPar
\sphinxstylestrong{Wet Spell Computation}

\sphinxAtStartPar
The \sphinxcode{\sphinxupquote{WAS\_count\_wet\_spells}} class computes the number of wet spells between onset and cessation. Requires onset and cessation dates as inputs.

\sphinxAtStartPar
\sphinxstylestrong{Rainy Days Computation}

\sphinxAtStartPar
The \sphinxcode{\sphinxupquote{WAS\_count\_rainy\_days}} class computes the number of rainy days between onset and cessation. Requires onset and cessation dates as inputs.

\sphinxAtStartPar
\sphinxstylestrong{Extreme Precipitation Indices}

\sphinxAtStartPar
The \sphinxcode{\sphinxupquote{WAS\_r95\_99p}} class computes R95p and R99p indices. Initialization with a base period (e.g., \sphinxcode{\sphinxupquote{slice("1991\sphinxhyphen{}01\sphinxhyphen{}01", "2020\sphinxhyphen{}12\sphinxhyphen{}31")}}) and optional season (list of months).
\begin{itemize}
\item {} 
\sphinxAtStartPar
Methods:
* \sphinxcode{\sphinxupquote{compute\_r95p}} and \sphinxcode{\sphinxupquote{compute\_r99p}} for gridded data.
* \sphinxcode{\sphinxupquote{compute\_insitu\_r95p}} and \sphinxcode{\sphinxupquote{compute\_insitu\_r99p}} for station data.

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Heat Wave Indices}

\sphinxAtStartPar
The \sphinxcode{\sphinxupquote{WAS\_compute\_HWSDI}} class computes the Heat Wave Severity Duration Index. Computes TXin90 (90th percentile of daily max temperature) and counts heatwave days with at least 6 consecutive hot days.


\subsubsection{Merging and Adjusting Data}
\label{\detokenize{Processing:merging-and-adjusting-data}}
\sphinxAtStartPar
The \sphinxcode{\sphinxupquote{WAS\_Merging}} class provides methods for merging gridded data with station observations to adjust for biases.

\sphinxAtStartPar
\sphinxstylestrong{Initialization}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{\_\_init\_\_(self, df, da, date\_month\_day="08\sphinxhyphen{}01")}}: Initializes with station data DataFrame (CPT format), gridded data DataArray, and a date string.

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Methods}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{simple\_bias\_adjustment(self, missing\_value=\sphinxhyphen{}999.0, do\_cross\_validation=False)}}: Adjusts gridded data using kriging of residuals.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{regression\_kriging(self, missing\_value=\sphinxhyphen{}999.0, do\_cross\_validation=False)}}: Uses linear regression followed by kriging of residuals.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{neural\_network\_kriging(self, missing\_value=\sphinxhyphen{}999.0, do\_cross\_validation=False)}}: Uses a neural network followed by kriging of residuals.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{multiplicative\_bias(self, missing\_value=\sphinxhyphen{}999.0, do\_cross\_validation=False)}}: Applies a multiplicative bias correction.

\end{itemize}

\sphinxAtStartPar
Each method returns the adjusted gridded data as an xarray DataArray and optionally cross\sphinxhyphen{}validation results as a DataFrame.
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{plot\_merging\_comparaison(self, df\_Obs, da\_estimated, da\_corrected, missing\_value=\sphinxhyphen{}999.0)}}: Visualizes the comparison between observations, original estimates, and corrected data.

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Example: Merging Onset with Station Observations}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Load station onset data in CPT format}
\PYG{n}{cpt\PYGZus{}input\PYGZus{}file\PYGZus{}path} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{./path/to/cpt\PYGZus{}file.csv}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{n}{df} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{read\PYGZus{}csv}\PYG{p}{(}\PYG{n}{cpt\PYGZus{}input\PYGZus{}file\PYGZus{}path}\PYG{p}{,} \PYG{n}{na\PYGZus{}values}\PYG{o}{=}\PYG{o}{\PYGZhy{}}\PYG{l+m+mf}{999.0}\PYG{p}{,} \PYG{n}{encoding}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{latin1}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Filter for relevant years and stations}
\PYG{n}{year\PYGZus{}start}\PYG{p}{,} \PYG{n}{year\PYGZus{}end} \PYG{o}{=} \PYG{l+m+mi}{1981}\PYG{p}{,} \PYG{l+m+mi}{2020}  \PYG{c+c1}{\PYGZsh{} Example years}
\PYG{n}{onset\PYGZus{}df} \PYG{o}{=} \PYG{n}{df}\PYG{p}{[}\PYG{p}{(}\PYG{n}{df}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{STATION}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{==} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{LAT}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{o}{|} \PYG{p}{(}\PYG{n}{df}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{STATION}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]} \PYG{o}{==} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{LON}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)} \PYG{o}{|}
              \PYG{p}{(}\PYG{n}{pd}\PYG{o}{.}\PYG{n}{to\PYGZus{}numeric}\PYG{p}{(}\PYG{n}{df}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{STATION}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{,} \PYG{n}{errors}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{coerce}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{o}{.}\PYG{n}{between}\PYG{p}{(}\PYG{n}{year\PYGZus{}start}\PYG{p}{,} \PYG{n}{year\PYGZus{}end}\PYG{p}{)}\PYG{p}{)}\PYG{p}{]}

\PYG{c+c1}{\PYGZsh{} Verify station network}
\PYG{n}{verify\PYGZus{}station\PYGZus{}network}\PYG{p}{(}\PYG{n}{onset\PYGZus{}df}\PYG{p}{,} \PYG{n}{area}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}\PYGZsh{} NB: verify\PYGZus{}station\PYGZus{}network is a utility function that verifies the station network. area is the extent of the gridded onset domain.}

\PYG{c+c1}{\PYGZsh{} Instantiate WAS\PYGZus{}Merging}
\PYG{n}{data\PYGZus{}merger} \PYG{o}{=} \PYG{n}{WAS\PYGZus{}Merging}\PYG{p}{(}\PYG{n}{onset\PYGZus{}df}\PYG{p}{,} \PYG{n}{onset}\PYG{p}{,} \PYG{n}{date\PYGZus{}month\PYGZus{}day}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{02\PYGZhy{}01}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}\PYGZsh{} NB: date\PYGZus{}month\PYGZus{}day is set to \PYGZsq{}02\PYGZhy{}01\PYGZsq{} because the onset start\PYGZus{}search criteria is set to the month of February.}
\PYG{c+c1}{\PYGZsh{}\PYGZsh{} Important to verify the T dimension in the gridded onset computed. the month and day must match the date\PYGZus{}month\PYGZus{}day.}

\PYG{c+c1}{\PYGZsh{} Perform simple bias adjustment}
\PYG{n}{onset\PYGZus{}adjusted}\PYG{p}{,} \PYG{n}{\PYGZus{}} \PYG{o}{=} \PYG{n}{data\PYGZus{}merger}\PYG{o}{.}\PYG{n}{simple\PYGZus{}bias\PYGZus{}adjustment}\PYG{p}{(}\PYG{n}{do\PYGZus{}cross\PYGZus{}validation}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Plot comparison}
\PYG{n}{data\PYGZus{}merger}\PYG{o}{.}\PYG{n}{plot\PYGZus{}merging\PYGZus{}comparaison}\PYG{p}{(}\PYG{n}{onset\PYGZus{}df}\PYG{p}{,} \PYG{n}{onset}\PYG{p}{,} \PYG{n}{onset\PYGZus{}adjusted}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}\PYGZsh{} NB: plot\PYGZus{}merging\PYGZus{}comparaison is a utility function that plots the comparison between the station onset, the gridded onset and the adjusted onset.}
\end{sphinxVerbatim}

\sphinxstepscope


\subsection{Quantifying uncertainty via cross\sphinxhyphen{}validation}
\label{\detokenize{cv:quantifying-uncertainty-via-cross-validation}}\label{\detokenize{cv::doc}}
\sphinxAtStartPar
Cross\sphinxhyphen{}validation schemes are used to assess model performance and to quantify uncertainty. \sphinxtitleref{wass2s} uses a cross\sphinxhyphen{}validation scheme that splits the data into training, omit, and test periods. The scheme is a variation of the \sphinxtitleref{K\sphinxhyphen{}Fold} cross\sphinxhyphen{}validation scheme, but it is tailored for time series data throughout \sphinxtitleref{CustomTimeSeriesSplit} and \sphinxtitleref{WAS\_Cross\_Validator} class. The scheme is illustrated in the figure below (Figure 1).

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[scale=0.7]{{cvv}.png}
\caption{Figure 1: Cross\sphinxhyphen{}validation scheme used in wass2s}\label{\detokenize{cv:id1}}\end{figure}

\sphinxAtStartPar
The figure shows how we split our data (1981\textendash{}2010) to validate the model. Each row is a “fold” or a test run.
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Pink (Training)}: Years we use to train the model. For example, in the first row, we train on 1986\textendash{}2010.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Yellow (Omit)}: A buffer years we skip to avoid cheating. Climate data has patterns over time, so we don’t want to train on a years right after/before the one we’re predicting, which would make the model look better than it really is. In this case we’ve omitted four years (in the first row, we skip 1982\sphinxhyphen{}1985).

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{White (Predict)}: The year we predict. In the first row, we predict 1981.

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{CustomTimeSeriesSplit}

\sphinxAtStartPar
A custom splitter for time series data that accounts for temporal dependencies.

\sphinxAtStartPar
\sphinxstylestrong{Initialization}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxtitleref{n\_splits}: Number of splits for cross\sphinxhyphen{}validation.

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Methods}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxtitleref{split}: Generates indices for training and test sets, omitting a specified number of samples after the test index.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{get\_n\_splits}: Returns the number of splits.

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{WAS\_Cross\_Validator}

\sphinxAtStartPar
A wrapper class that uses the custom splitter to perform cross\sphinxhyphen{}validation with various models.

\sphinxAtStartPar
\sphinxstylestrong{Initialization}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxtitleref{n\_splits}: Number of splits for cross\sphinxhyphen{}validation.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{nb\_omit}: Number of samples to omit from training after the test index.

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Methods}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxtitleref{get\_model\_params}: Retrieves parameters for the model’s \sphinxtitleref{compute\_model} method.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{cross\_validate}: Performs cross\sphinxhyphen{}validation and computes deterministic hindcast and tercile probabilities.

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Example Usage}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{wass2s}\PYG{n+nn}{.}\PYG{n+nn}{was\PYGZus{}cross\PYGZus{}validate} \PYG{k+kn}{import} \PYG{n}{WAS\PYGZus{}Cross\PYGZus{}Validator}

\PYG{c+c1}{\PYGZsh{} Initialize the cross\PYGZhy{}validator}
\PYG{n}{cv} \PYG{o}{=} \PYG{n}{WAS\PYGZus{}Cross\PYGZus{}Validator}\PYG{p}{(}\PYG{n}{n\PYGZus{}splits}\PYG{o}{=}\PYG{l+m+mi}{30}\PYG{p}{,} \PYG{n}{nb\PYGZus{}omit}\PYG{o}{=}\PYG{l+m+mi}{4}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
A better example will be provided in the next sections.


\subsubsection{Estimating Prediction Uncertainty}
\label{\detokenize{cv:estimating-prediction-uncertainty}}
\sphinxAtStartPar
The cross\sphinxhyphen{}validation makes out\sphinxhyphen{}of\sphinxhyphen{}sample predictions for each fold’s prediction period, and errors are calculated by comparing predictions to actual values. These errors are collected across all folds.
Running the statistical models—e.g. multiple linear regression—yields the most likely value of the predictand (best\sphinxhyphen{}guess) for the coming season.
Because seasonal outlooks are inherently probabilistic, we must go beyond this single best\sphinxhyphen{}guess and quantify the likelihood of other possible outcomes.
wass2s does so by analysing the cross\sphinxhyphen{}validation errors described earlier. The method explicitly takes the statistical distribution of the predictand into account.
If, for instance, the predictand is approximately Gaussian, we assume the predicted values follow a normal distribution whose mean is the single best\sphinxhyphen{}guess and whose variance equals the cross\sphinxhyphen{}validated error variance.
Comparing that forecast probability\sphinxhyphen{}density function with the climatological density (see the example in Figure 2) lets us integrate the areas that fall below\sphinxhyphen{}normal (values below the 1st tercile), near\sphinxhyphen{}normal (values between the 1st and 3rd terciles), and above\sphinxhyphen{}normal (values above the 3rd tercile).
These integrals are the tercile probabilities ultimately delivered to users.

\begin{figure}[htbp]
\centering
\capstart

\noindent\sphinxincludegraphics[scale=0.7]{{generation_proba}.png}
\caption{Figure 2: Generation of probabilistic forecasts}\label{\detokenize{cv:id2}}\end{figure}

\sphinxstepscope


\subsection{Models Modules}
\label{\detokenize{Models:models-modules}}\label{\detokenize{Models::doc}}
\sphinxAtStartPar
The Models modules provide a comprehensive suite of statistical and machine learning models for climate prediction, including linear models, EOF\sphinxhyphen{}based models, canonical correlation analysis (CCA), analog methods, and multi\sphinxhyphen{}model ensemble (MME) techniques.
These models are designed to handle both deterministic and probabilistic forecasts, with support for hyperparameter tuning.
Models are evaluated using cross\sphinxhyphen{}validation schemes.

\sphinxAtStartPar
The models modules are organized into several classes, each implementing a specific type of model:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Machine Learning Models}: This includes linear models such as multiple linear regression, logistic regression and regularized models like ridge, lasso, elastic\sphinxhyphen{}net. Additionally, more advanced models are available, including support vector regression, random forests, XGBoost, and neural networks.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{EOF and PCR Models}: For dimensionality reduction and regression using principal components.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{CCA Models}: For identifying relationships between two multivariate datasets.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Analog Methods}: For finding historical analogs to current conditions.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Multi\sphinxhyphen{}Model Ensemble (MME) Techniques}: For combining predictions from multiple models.

\end{enumerate}


\subsubsection{Machine Learning Models}
\label{\detokenize{Models:machine-learning-models}}
\sphinxAtStartPar
The available models are:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxtitleref{WAS\_LinearRegression\_Model}: Standard Multiple Linear Regression.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{WAS\_Ridge\_Model}: Ridge regression with L2 regularization.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{WAS\_Lasso\_Model}: Lasso regression with L1 regularization.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{WAS\_LassoLars\_Model}: Lasso regression using the LARS algorithm.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{WAS\_ElasticNet\_Model}: Elastic net regression combining L1 and L2 regularization.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{WAS\_LogisticRegression\_Model}: Logistic regression for classification.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{WAS\_SVR}: Support vector regression.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{WAS\_PolynomialRegression}: Polynomial regression.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{WAS\_PoissonRegression}: Poisson regression.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{WAS\_RandomForest\_XGBoost\_ML\_Stacking}: Random forest and XGBoost regression with stacking.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{WAS\_MLP}: Multi\sphinxhyphen{}Layer Perceptron regression.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{WAS\_RandomForest\_XGBoost\_Stacking\_MLP}: Random forest, XGBoost, and MLP regression with stacking.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{WAS\_Stacking\_Ridge}: Random forest, XGBoost, MLP, and Ridge regression with stacking.

\end{itemize}

\sphinxAtStartPar
Except for \sphinxtitleref{WAS\_LogisticRegression\_Model}, each model class includes methods for:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxtitleref{compute\_model}: Training the model and making predictions.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{compute\_prob}: Computing tercile probabilities for the predictions.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{forecast}: Making forecasts for new data.

\end{itemize}


\subsubsection{EOF and PCR Models}
\label{\detokenize{Models:eof-and-pcr-models}}
\sphinxAtStartPar
The \sphinxtitleref{was\_eof.py} and \sphinxtitleref{was\_pcr.py} modules provide classes for EOF analysis and Principal Component Regression (PCR), with support for multiple EOF zones:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxtitleref{WAS\_EOF}: Performs EOF analysis with options for cosine latitude weighting, standardization, and L2 normalization.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{WAS\_PCR}: Combines EOF analysis with a regression model for prediction, supporting multiple EOF zones.

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{WAS\_EOF}

\sphinxAtStartPar
\sphinxstylestrong{Initialization}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxtitleref{n\_modes}: Number of EOF modes to retain.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{use\_coslat}: Apply cosine latitude weighting (default: True).

\item {} 
\sphinxAtStartPar
\sphinxtitleref{standardize}: Standardize the input data (default: False).

\item {} 
\sphinxAtStartPar
\sphinxtitleref{opti\_explained\_variance}: Target cumulative explained variance to determine modes.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{L2norm}: Normalize components and scores to have L2 norm (default: True).

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Methods}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxtitleref{fit}: Fits the EOF model to the data, supporting multiple zones by applying EOF analysis to the entire dataset.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{transform}: Projects new data onto the EOF modes.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{inverse\_transform}: Reconstructs data from principal components (PCs).

\item {} 
\sphinxAtStartPar
\sphinxtitleref{plot\_EOF}: Plots the EOF spatial patterns with explained variance.

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{WAS\_PCR}

\sphinxAtStartPar
\sphinxstylestrong{Initialization}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxtitleref{regression\_model}: The regression model (e.g., \sphinxtitleref{WAS\_Ridge\_Model}) to use with PCs.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{n\_modes}: Number of EOF modes to retain.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{use\_coslat}: Apply cosine latitude weighting (default: True).

\item {} 
\sphinxAtStartPar
\sphinxtitleref{standardize}: Standardize the input data (default: False).

\item {} 
\sphinxAtStartPar
\sphinxtitleref{opti\_explained\_variance}: Target cumulative explained variance.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{L2norm}: Normalize EOF components and scores (default: True).

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Methods}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxtitleref{compute\_model}: Fits the EOF model, transforms data to PCs, and applies the regression model.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{compute\_prob}: Computes tercile probabilities using the regression model.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{forecast}: Makes forecasts using EOF\sphinxhyphen{}transformed data.

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Example Usage: Seasonal Forecasting Based on Observational Data}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{wass2s} \PYG{k+kn}{import} \PYG{o}{*}
\PYG{c+c1}{\PYGZsh{}\PYGZsh{} Define the directory to save the data}
\PYG{n}{dir\PYGZus{}to\PYGZus{}save\PYGZus{}reanalysis} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{/path/to/save\PYGZus{}reanalysis}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{n}{dir\PYGZus{}to\PYGZus{}save\PYGZus{}agroindicators} \PYG{o}{=} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{/path/to/save\PYGZus{}agroindicators}\PYG{l+s+s2}{\PYGZdq{}}

\PYG{c+c1}{\PYGZsh{}\PYGZsh{} Define the climatology  year range and the season}
\PYG{n}{clim\PYGZus{}year\PYGZus{}start} \PYG{o}{=} \PYG{l+m+mi}{1991}
\PYG{n}{clim\PYGZus{}year\PYGZus{}end} \PYG{o}{=} \PYG{l+m+mi}{2020}
\PYG{n}{seas\PYGZus{}reanalysis} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{01}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{02}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{03}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}
\PYG{n}{seas\PYGZus{}agroindicators} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{05}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{06}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{07}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}

\PYG{c+c1}{\PYGZsh{}\PYGZsh{} Define the variables to download}
\PYG{n}{variables} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{AGRO.PRCP}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}

\PYG{c+c1}{\PYGZsh{}\PYGZsh{} Define the center and the predictor variables}
\PYG{n}{center\PYGZus{}variable} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ERA5.SST}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{:}

\PYG{c+c1}{\PYGZsh{}\PYGZsh{} Define the extent for reanalysis}
\PYG{n}{extent} \PYG{o}{=} \PYG{p}{[}\PYG{l+m+mi}{45}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{180}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{45}\PYG{p}{,} \PYG{l+m+mi}{180}\PYG{p}{]} \PYG{c+c1}{\PYGZsh{} [North, West, South, East]}

\PYG{c+c1}{\PYGZsh{}\PYGZsh{} Define the extent for Observation}
\PYG{n}{extent\PYGZus{}obs} \PYG{o}{=} \PYG{p}{[}\PYG{l+m+mi}{30}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{25}\PYG{p}{,} \PYG{l+m+mi}{0}\PYG{p}{,} \PYG{l+m+mi}{30}\PYG{p}{]} \PYG{c+c1}{\PYGZsh{} [North, West, South, East]}

\PYG{c+c1}{\PYGZsh{}\PYGZsh{} Download the predictors and the predictand}
\PYG{n}{downloader} \PYG{o}{=} \PYG{n}{WAS\PYGZus{}Download}\PYG{p}{(}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}\PYGZsh{} Download the predictors}
\PYG{n}{downloader}\PYG{o}{.}\PYG{n}{WAS\PYGZus{}Download\PYGZus{}Reanalysis}\PYG{p}{(}
    \PYG{n}{dir\PYGZus{}to\PYGZus{}save}\PYG{o}{=}\PYG{n}{dir\PYGZus{}to\PYGZus{}save\PYGZus{}reanalysis}\PYG{p}{,}
    \PYG{n}{center\PYGZus{}variable}\PYG{o}{=}\PYG{n}{center\PYGZus{}variable}\PYG{p}{,}
    \PYG{n}{year\PYGZus{}start}\PYG{o}{=}\PYG{l+m+mi}{1991}\PYG{p}{,}
    \PYG{n}{year\PYGZus{}end}\PYG{o}{=}\PYG{l+m+mi}{2025}\PYG{p}{,}
    \PYG{n}{area}\PYG{o}{=}\PYG{n}{extent}\PYG{p}{,}
    \PYG{n}{seas}\PYG{o}{=}\PYG{n}{seas\PYGZus{}reanalysis}\PYG{p}{,}
    \PYG{n}{force\PYGZus{}download}\PYG{o}{=}\PYG{k+kc}{False}
\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}\PYGZsh{} Download the predictand}
\PYG{n}{downloader}\PYG{o}{.}\PYG{n}{WAS\PYGZus{}Download\PYGZus{}AgroIndicators}\PYG{p}{(}
    \PYG{n}{dir\PYGZus{}to\PYGZus{}save}\PYG{o}{=}\PYG{n}{dir\PYGZus{}to\PYGZus{}save\PYGZus{}agroindicators}\PYG{p}{,}
    \PYG{n}{variables}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{AGRO.PRCP}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{year\PYGZus{}start}\PYG{o}{=}\PYG{l+m+mi}{1991}\PYG{p}{,}
    \PYG{n}{year\PYGZus{}end}\PYG{o}{=}\PYG{l+m+mi}{2024}\PYG{p}{,}
    \PYG{n}{area}\PYG{o}{=}\PYG{n}{extent\PYGZus{}obs}\PYG{p}{,}
    \PYG{n}{seas}\PYG{o}{=}\PYG{n}{seas\PYGZus{}agroindicators}\PYG{p}{,}
    \PYG{n}{force\PYGZus{}download}\PYG{o}{=}\PYG{k+kc}{False}
\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Case 1: Used SST index as a predictor}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Prepare predictand and predictors}
\PYG{n}{predictand} \PYG{o}{=} \PYG{n}{prepare\PYGZus{}predictand}\PYG{p}{(}\PYG{n}{dir\PYGZus{}to\PYGZus{}save\PYGZus{}agroindicators}\PYG{p}{,} \PYG{n}{variables}\PYG{p}{,} \PYG{n}{year\PYGZus{}start}\PYG{p}{,} \PYG{n}{year\PYGZus{}end}\PYG{p}{,} \PYG{n}{seas\PYGZus{}agroindicators}\PYG{p}{,} \PYG{n}{ds}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{,} \PYG{n}{daily}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Prepare predictors}
\PYG{c+c1}{\PYGZsh{}\PYGZsh{} Print available SST indices}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n+nb}{list}\PYG{p}{(}\PYG{n}{sst\PYGZus{}indices\PYGZus{}name}\PYG{o}{.}\PYG{n}{keys}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}\PYGZsh{} Choose yours}
\PYG{n}{sst\PYGZus{}index\PYGZus{}name} \PYG{o}{=} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{NINO34}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{TNA}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{TSA}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{DMI}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}

\PYG{c+c1}{\PYGZsh{}\PYGZsh{} Plot the SST index zone}
\PYG{n}{plot\PYGZus{}map}\PYG{p}{(}\PYG{p}{[}\PYG{n}{extent}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,}\PYG{n}{extent}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{p}{]}\PYG{p}{,}\PYG{n}{extent}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{,}\PYG{n}{extent}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{]}\PYG{p}{,} \PYG{n}{sst\PYGZus{}indices} \PYG{o}{=} \PYG{n}{sst\PYGZus{}index\PYGZus{}name}\PYG{p}{,} \PYG{n}{title}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Index Zone}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{fig\PYGZus{}size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{7}\PYG{p}{,}\PYG{l+m+mi}{4}\PYG{p}{)}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}\PYGZsh{} Compute the SST indices}
\PYG{n}{predictors} \PYG{o}{=} \PYG{n}{compute\PYGZus{}sst\PYGZus{}indices}\PYG{p}{(}\PYG{n}{dir\PYGZus{}to\PYGZus{}save\PYGZus{}reanalysis}\PYG{p}{,} \PYG{n}{sst\PYGZus{}index\PYGZus{}name}\PYG{p}{,} \PYG{n}{center\PYGZus{}variable}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{year\PYGZus{}start}\PYG{p}{,} \PYG{n}{year\PYGZus{}end}\PYG{p}{,} \PYG{n}{seas\PYGZus{}reanalysis}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}\PYGZsh{} Compute variance inflation factor to see multicolinearity between predictors}

\PYG{n}{vif\PYGZus{}data} \PYG{o}{=} \PYG{n}{pd}\PYG{o}{.}\PYG{n}{DataFrame}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{vif\PYGZus{}data}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{feature}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{n}{predictors}\PYG{o}{.}\PYG{n}{to\PYGZus{}dataframe}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{columns}
\PYG{n}{vif\PYGZus{}data}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{VIF}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{=} \PYG{p}{[}\PYG{n}{VIF}\PYG{p}{(}\PYG{n}{predictors}\PYG{o}{.}\PYG{n}{to\PYGZus{}dataframe}\PYG{p}{(}\PYG{p}{)}\PYG{p}{,} \PYG{n}{i}\PYG{p}{)} \PYG{k}{for} \PYG{n}{i} \PYG{o+ow}{in} \PYG{n+nb}{range}\PYG{p}{(}\PYG{n}{predictors}\PYG{o}{.}\PYG{n}{to\PYGZus{}dataframe}\PYG{p}{(}\PYG{p}{)}\PYG{o}{.}\PYG{n}{shape}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}\PYG{p}{]}
\PYG{c+c1}{\PYGZsh{}\PYGZsh{} Print VIF values}
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{vif\PYGZus{}data}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}\PYGZsh{} Set a threshold for VIF}
\PYG{n}{vif\PYGZus{}threshold} \PYG{o}{=} \PYG{l+m+mi}{5}
\PYG{c+c1}{\PYGZsh{} Remove features with VIF greater than the threshold}
\PYG{n}{low\PYGZus{}vif\PYGZus{}predictors} \PYG{o}{=} \PYG{n}{vif\PYGZus{}data}\PYG{p}{[}\PYG{n}{vif\PYGZus{}data}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{VIF}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]} \PYG{o}{\PYGZlt{}} \PYG{n}{vif\PYGZus{}threshold}\PYG{p}{]}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{feature}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{o}{.}\PYG{n}{tolist}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{filtered\PYGZus{}predictors} \PYG{o}{=} \PYG{n}{predictors}\PYG{p}{[}\PYG{n}{low\PYGZus{}vif\PYGZus{}predictors}\PYG{p}{]}\PYG{o}{.}\PYG{n}{to\PYGZus{}array}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{filtered\PYGZus{}predictors} \PYG{o}{=} \PYG{n}{filtered\PYGZus{}predictors}\PYG{o}{.}\PYG{n}{rename}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{variable}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{features}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{)}\PYG{o}{.}\PYG{n}{transpose}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{T}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{features}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Initialize the model class}
\PYG{n}{model} \PYG{o}{=} \PYG{n}{WAS\PYGZus{}LinearRegression\PYGZus{}Model}\PYG{p}{(}\PYG{n}{nb\PYGZus{}cores}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{dist\PYGZus{}method}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{lognormal}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} Assuming predictand follows a lognormal distribution. otherwise, normal, student\PYGZhy{}t or gamma are available. used dist\PYGZus{}method=\PYGZdq{}normal\PYGZdq{} or dist\PYGZus{}method=\PYGZdq{}t\PYGZdq{} or dist\PYGZus{}method=\PYGZdq{}gamma\PYGZdq{}.}

\PYG{c+c1}{\PYGZsh{} Perform cross\PYGZhy{}validation}
\PYG{n}{was\PYGZus{}cv} \PYG{o}{=} \PYG{n}{WAS\PYGZus{}Cross\PYGZus{}Validator}\PYG{p}{(}\PYG{n}{n\PYGZus{}splits}\PYG{o}{=}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{predictand}\PYG{o}{.}\PYG{n}{get\PYGZus{}index}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{T}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{n}{nb\PYGZus{}omit}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{)}
\PYG{n}{hindcast\PYGZus{}det}\PYG{p}{,} \PYG{n}{hindcast\PYGZus{}prob} \PYG{o}{=} \PYG{n}{was\PYGZus{}cv}\PYG{o}{.}\PYG{n}{cross\PYGZus{}validate}\PYG{p}{(}\PYG{n}{model}\PYG{p}{,} \PYG{n}{predictand}\PYG{p}{,} \PYG{n}{filtered\PYGZus{}predictorsisel}\PYG{p}{(}\PYG{n}{T}\PYG{o}{=}\PYG{n+nb}{slice}\PYG{p}{(}\PYG{k+kc}{None}\PYG{p}{,}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{n}{clim\PYGZus{}year\PYGZus{}start}\PYG{p}{,} \PYG{n}{clim\PYGZus{}year\PYGZus{}end}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{} clim\PYGZus{}year\PYGZus{}start and clim\PYGZus{}year\PYGZus{}end are the years used to compute the climatology.}

\PYG{c+c1}{\PYGZsh{} Initialize the model class}
\PYG{n}{model} \PYG{o}{=} \PYG{n}{WAS\PYGZus{}Ridge\PYGZus{}Model}\PYG{p}{(}\PYG{n}{n\PYGZus{}clusters}\PYG{o}{=}\PYG{l+m+mi}{6}\PYG{p}{,} \PYG{n}{alpha\PYGZus{}range}\PYG{o}{=}\PYG{n}{np}\PYG{o}{.}\PYG{n}{logspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mf}{0.1}\PYG{p}{,} \PYG{l+m+mi}{20}\PYG{p}{)}\PYG{p}{,} \PYG{n}{nb\PYGZus{}cores} \PYG{o}{=} \PYG{l+m+mi}{2}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Compute alpha parameters}
\PYG{n}{alpha}\PYG{p}{,} \PYG{n}{clusters} \PYG{o}{=} \PYG{n}{model}\PYG{o}{.}\PYG{n}{compute\PYGZus{}hyperparameters}\PYG{p}{(}\PYG{n}{predictand}\PYG{p}{,} \PYG{n}{filtered\PYGZus{}predictors}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Perform cross\PYGZhy{}validation}
\PYG{n}{was\PYGZus{}cv} \PYG{o}{=} \PYG{n}{WAS\PYGZus{}Cross\PYGZus{}Validator}\PYG{p}{(}\PYG{n}{n\PYGZus{}splits}\PYG{o}{=}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{predictand}\PYG{o}{.}\PYG{n}{get\PYGZus{}index}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{T}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{n}{nb\PYGZus{}omit}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{)}
\PYG{n}{hindcast\PYGZus{}det\PYGZus{}Ridge}\PYG{p}{,} \PYG{n}{hindcast\PYGZus{}prob\PYGZus{}Ridge} \PYG{o}{=} \PYG{n}{was\PYGZus{}cv}\PYG{o}{.}\PYG{n}{cross\PYGZus{}validate}\PYG{p}{(}\PYG{n}{model}\PYG{p}{,} \PYG{n}{predictand}\PYG{p}{,} \PYG{n}{filtered\PYGZus{}predictors}\PYG{o}{.}\PYG{n}{isel}\PYG{p}{(}\PYG{n}{T}\PYG{o}{=}\PYG{n+nb}{slice}\PYG{p}{(}\PYG{k+kc}{None}\PYG{p}{,}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{n}{clim\PYGZus{}year\PYGZus{}start}\PYG{p}{,} \PYG{n}{clim\PYGZus{}year\PYGZus{}end}\PYG{p}{,} \PYG{n}{alpha}\PYG{o}{=}\PYG{n}{alpha}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Make a forecast}
\PYG{n}{forecast\PYGZus{}det\PYGZus{}Ridge}\PYG{p}{,} \PYG{n}{forecast\PYGZus{}prob\PYGZus{}Ridge} \PYG{o}{=} \PYG{n}{model}\PYG{o}{.}\PYG{n}{forecast}\PYG{p}{(}\PYG{n}{predictand}\PYG{p}{,} \PYG{n}{clim\PYGZus{}year\PYGZus{}start}\PYG{p}{,} \PYG{n}{clim\PYGZus{}year\PYGZus{}end}\PYG{p}{,} \PYG{n}{filtered\PYGZus{}predictors}\PYG{o}{.}\PYG{n}{isel}\PYG{p}{(}\PYG{n}{T}\PYG{o}{=}\PYG{n+nb}{slice}\PYG{p}{(}\PYG{k+kc}{None}\PYG{p}{,}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{n}{hindcast\PYGZus{}det\PYGZus{}Ridge}\PYG{p}{,} \PYG{n}{filtered\PYGZus{}predictors}\PYG{o}{.}\PYG{n}{isel}\PYG{p}{(}\PYG{n}{T}\PYG{o}{=}\PYG{p}{[}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{)}\PYG{p}{,} \PYG{n}{alpha}\PYG{o}{=}\PYG{n}{alpha}\PYG{p}{,} \PYG{n}{l1\PYGZus{}ratio}\PYG{o}{=}\PYG{n}{l1\PYGZus{}ratio}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Case 2: Used PCRs as a predictor}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Set your own zones ( zones not available in built\PYGZhy{}in)}
\PYG{c+c1}{\PYGZsh{} define zone as dict : \PYGZob{}\PYGZsq{}zone\PYGZus{}name\PYGZus{}key\PYGZsq{}: (\PYGZsq{}Explicit\PYGZus{}Zone\PYGZus{}name\PYGZsq{}, lon\PYGZus{}min, lon\PYGZus{}max, lat\PYGZus{}min, lat\PYGZus{}max)\PYGZcb{}}
\PYG{n}{zones\PYGZus{}for\PYGZus{}PCR} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{A}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{150}\PYG{p}{,} \PYG{l+m+mi}{150}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{45}\PYG{p}{,} \PYG{l+m+mi}{45}\PYG{p}{)}\PYG{p}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Set number of modes}
\PYG{n}{n\PYGZus{}modes} \PYG{o}{=} \PYG{l+m+mi}{6}

\PYG{c+c1}{\PYGZsh{} ElasticNet hyperparameters range}
\PYG{n}{alpha\PYGZus{}range} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{logspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mf}{0.1}\PYG{p}{,} \PYG{l+m+mi}{20}\PYG{p}{)}
\PYG{n}{l1\PYGZus{}ratio\PYGZus{}range} \PYG{o}{=} \PYG{p}{[}\PYG{l+m+mf}{0.5}\PYG{p}{,} \PYG{l+m+mf}{0.9999}\PYG{p}{]}

\PYG{c+c1}{\PYGZsh{} Initialize the model class}
\PYG{n}{model} \PYG{o}{=} \PYG{n}{WAS\PYGZus{}PCR\PYGZus{}Model}\PYG{p}{(}\PYG{n}{n\PYGZus{}clusters}\PYG{o}{=}\PYG{l+m+mi}{6}\PYG{p}{,} \PYG{n}{alpha\PYGZus{}range}\PYG{o}{=}\PYG{n}{np}\PYG{o}{.}\PYG{n}{logspace}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{4}\PYG{p}{,} \PYG{l+m+mf}{0.1}\PYG{p}{,} \PYG{l+m+mi}{20}\PYG{p}{)}\PYG{p}{,} \PYG{n}{nb\PYGZus{}cores} \PYG{o}{=} \PYG{l+m+mi}{2}\PYG{p}{)}
\PYG{n}{plot\PYGZus{}map}\PYG{p}{(}\PYG{p}{[}\PYG{n}{extent}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,}\PYG{n}{extent}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{p}{]}\PYG{p}{,}\PYG{n}{extent}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{,}\PYG{n}{extent}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{]}\PYG{p}{,} \PYG{n}{sst\PYGZus{}indices} \PYG{o}{=} \PYG{n}{zones\PYGZus{}for\PYGZus{}PCR}\PYG{p}{,} \PYG{n}{title}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Predictors Area}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}\PYG{n}{fig\PYGZus{}size}\PYG{o}{=}\PYG{p}{(}\PYG{l+m+mi}{8}\PYG{p}{,}\PYG{l+m+mi}{6}\PYG{p}{)}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Retrieve predictor data for the defined zone}
\PYG{n}{predictor} \PYG{o}{=} \PYG{n}{retrieve\PYGZus{}single\PYGZus{}zone\PYGZus{}for\PYGZus{}PCR}\PYG{p}{(}\PYG{n}{dir\PYGZus{}to\PYGZus{}save\PYGZus{}Reanalysis}\PYG{p}{,} \PYG{n}{zones\PYGZus{}for\PYGZus{}PCR}\PYG{p}{,} \PYG{n}{variables\PYGZus{}reanalysis}\PYG{p}{[}\PYG{l+m+mi}{0}\PYG{p}{]}\PYG{p}{,} \PYG{n}{year\PYGZus{}start}\PYG{p}{,} \PYG{n}{year\PYGZus{}end}\PYG{p}{,} \PYG{n}{season}\PYG{p}{,} \PYG{n}{clim\PYGZus{}year\PYGZus{}start}\PYG{p}{,} \PYG{n}{clim\PYGZus{}year\PYGZus{}end}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Load WAS\PYGZus{}EOF Class}
\PYG{n}{eof\PYGZus{}model} \PYG{o}{=} \PYG{n}{WAS\PYGZus{}EOF}\PYG{p}{(}\PYG{n}{n\PYGZus{}modes}\PYG{o}{=}\PYG{n}{n\PYGZus{}modes}\PYG{p}{,} \PYG{n}{use\PYGZus{}coslat}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{standardize}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Load predictor, compute EOFs and retrieve component, scores and explained variances}
\PYG{n}{s\PYGZus{}eofs}\PYG{p}{,} \PYG{n}{s\PYGZus{}pcs}\PYG{p}{,} \PYG{n}{s\PYGZus{}expvar}\PYG{p}{,} \PYG{n}{\PYGZus{}} \PYG{o}{=} \PYG{n}{eof\PYGZus{}model}\PYG{o}{.}\PYG{n}{fit}\PYG{p}{(}\PYG{n}{predictor}\PYG{p}{,} \PYG{n}{dim}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{T}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}  \PYG{n}{clim\PYGZus{}year\PYGZus{}start}\PYG{o}{=}\PYG{n}{clim\PYGZus{}year\PYGZus{}start}\PYG{p}{,} \PYG{n}{clim\PYGZus{}year\PYGZus{}end}\PYG{o}{=}\PYG{n}{clim\PYGZus{}year\PYGZus{}end}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Plot EOFs and explained variances}
\PYG{n}{eof\PYGZus{}model}\PYG{o}{.}\PYG{n}{plot\PYGZus{}EOF}\PYG{p}{(}\PYG{n}{s\PYGZus{}eofs}\PYG{p}{,} \PYG{n}{s\PYGZus{}expvar}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Perform Cross\PYGZhy{}validation with elastic\PYGZhy{}net}

\PYG{c+c1}{\PYGZsh{}\PYGZsh{} Load class for model}
\PYG{n}{regression\PYGZus{}model} \PYG{o}{=} \PYG{n}{WAS\PYGZus{}ElasticNet\PYGZus{}Model}\PYG{p}{(}\PYG{n}{alpha\PYGZus{}range} \PYG{o}{=} \PYG{n}{alpha\PYGZus{}range}\PYG{p}{,} \PYG{n}{l1\PYGZus{}ratio\PYGZus{}range} \PYG{o}{=} \PYG{n}{l1\PYGZus{}ratio\PYGZus{}range}\PYG{p}{,} \PYG{n}{nb\PYGZus{}cores} \PYG{o}{=} \PYG{l+m+mi}{2}\PYG{p}{,} \PYG{n}{dist\PYGZus{}method}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{lognormal}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\PYG{n}{pcr\PYGZus{}model} \PYG{o}{=} \PYG{n}{WAS\PYGZus{}PCR}\PYG{p}{(}\PYG{n}{regression\PYGZus{}model}\PYG{o}{=}\PYG{n}{regression\PYGZus{}model}\PYG{p}{,} \PYG{n}{n\PYGZus{}modes}\PYG{o}{=}\PYG{n}{n\PYGZus{}modes}\PYG{p}{,} \PYG{n}{standardize}\PYG{o}{=}\PYG{k+kc}{False}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{}\PYGZsh{} Compute alpha parameters}
\PYG{n}{alpha}\PYG{p}{,} \PYG{n}{l1\PYGZus{}ratio}\PYG{p}{,} \PYG{n}{clusters} \PYG{o}{=} \PYG{n}{regression\PYGZus{}model}\PYG{o}{.}\PYG{n}{compute\PYGZus{}hyperparameters}\PYG{p}{(}\PYG{n}{predictand}\PYG{p}{,} \PYG{n}{s\PYGZus{}pcs}\PYG{o}{.}\PYG{n}{isel}\PYG{p}{(}\PYG{n}{T}\PYG{o}{=}\PYG{n+nb}{slice}\PYG{p}{(}\PYG{k+kc}{None}\PYG{p}{,}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{rename}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{mode}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{features}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{)}\PYG{o}{.}\PYG{n}{transpose}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{T}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{features}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{)}
\PYG{c+c1}{\PYGZsh{}\PYGZsh{} Perform cross\PYGZhy{}validation}
\PYG{n}{was\PYGZus{}cv} \PYG{o}{=} \PYG{n}{WAS\PYGZus{}Cross\PYGZus{}Validator}\PYG{p}{(}\PYG{n}{n\PYGZus{}splits}\PYG{o}{=}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{predictand}\PYG{o}{.}\PYG{n}{get\PYGZus{}index}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{T}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{n}{nb\PYGZus{}omit}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{)}
\PYG{n}{hindcast\PYGZus{}det}\PYG{p}{,} \PYG{n}{hindcast\PYGZus{}prob} \PYG{o}{=} \PYG{n}{was\PYGZus{}cv}\PYG{o}{.}\PYG{n}{cross\PYGZus{}validate}\PYG{p}{(}\PYG{n}{pcr\PYGZus{}model}\PYG{p}{,} \PYG{n}{predictand}\PYG{p}{,} \PYG{n}{s\PYGZus{}pcs}\PYG{o}{.}\PYG{n}{isel}\PYG{p}{(}\PYG{n}{T}\PYG{o}{=}\PYG{n+nb}{slice}\PYG{p}{(}\PYG{k+kc}{None}\PYG{p}{,}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{1}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{rename}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{mode}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{features}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{)}\PYG{o}{.}\PYG{n}{transpose}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{T}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{features}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}\PYG{p}{,} \PYG{n}{clim\PYGZus{}year\PYGZus{}start}\PYG{p}{,} \PYG{n}{clim\PYGZus{}year\PYGZus{}end}\PYG{p}{,} \PYG{n}{alpha}\PYG{o}{=}\PYG{n}{alpha}\PYG{p}{,} \PYG{n}{l1\PYGZus{}ratio}\PYG{o}{=}\PYG{n}{l1\PYGZus{}ratio}\PYG{p}{)}
\end{sphinxVerbatim}


\subsubsection{CCA Models}
\label{\detokenize{Models:cca-models}}
\sphinxAtStartPar
The \sphinxtitleref{was\_cca.py} module provides classes for Canonical Correlation Analysis (CCA):
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxtitleref{WAS\_CCA}: Performs CCA to identify relationships between two multivariate datasets.

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Initialization}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxtitleref{n\_modes}: Number of CCA modes to retain.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{n\_pca\_modes}: Number of PCA modes to use for dimensionality reduction.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{dist\_method}: distribution method for probability computations.

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Methods}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxtitleref{compute\_model}: Fits the CCA model and makes predictions.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{compute\_prob}: Computes tercile probabilities for the predictions.

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Example Usage: Recalibrating Seasonal Forecast Outputs from Global Climate Models (GCMs)}


\subsubsection{Analog Forecasting Methods}
\label{\detokenize{Models:analog-forecasting-methods}}
\sphinxAtStartPar
The \sphinxtitleref{was\_analog.py} module provides the \sphinxtitleref{WAS\_Analog} class for analog\sphinxhyphen{}based forecasting using various techniques to identify historical analogs to current conditions for prediction, particularly for seasonal rainfall forecasts using sea surface temperature (SST) data.

\sphinxAtStartPar
\sphinxstylestrong{Initialization Parameters}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{dir\_to\_save}} (str): Directory path to save downloaded and processed data files.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{year\_start}} (int): Starting year for historical data.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{year\_forecast}} (int): Target forecast year.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{reanalysis\_name}} (str): Reanalysis dataset name (e.g., “ERA5.SST” or “NOAA.SST”).

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{model\_name}} (str): Forecast model name (e.g., “ECMWF\_51.SST”).

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{method\_analog}} (str, default=”som”): Analog method to use (“som”, “cor\_based”, “pca\_based”).

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{best\_prcp\_models}} (list, optional): List of best precipitation models. Default is None.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{month\_of\_initialization}} (int, optional): Forecast initialization month. Default is None (uses current month).

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{lead\_time}} (list, optional): Lead times in months. Default is None (uses {[}1, 2, 3, 4, 5{]}).

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{ensemble\_mean}} (str, default=”mean”): Ensemble mean method (“mean” or “median”).

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{clim\_year\_start}} (int, optional): Start year for climatology period.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{clim\_year\_end}} (int, optional): End year for climatology period.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{define\_extent}} (tuple, optional): Bounding box as (lon\_min, lon\_max, lat\_min, lat\_max) for regional analysis.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{index\_compute}} (list, optional): Climate indices to compute (e.g., {[}“NINO34”, “DMI”{]}).

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{some\_grid\_size}} (tuple, default=(None, None)): SOM grid dimensions (rows, cols); None uses automatic sizing.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{some\_learning\_rate}} (float, default=0.5): Learning rate for SOM training.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{some\_neighborhood\_function}} (str, default=”gaussian”): Neighborhood function for SOM (“gaussian”, etc.).

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{some\_sigma}} (float, default=1.0): Initial neighborhood radius for SOM.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{dist\_method}} (str, default=”gamma”): Probability method (“gamma”, “t”, “normal”, “lognormal”, “nonparam”).

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Key Methods}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{download\_sst\_reanalysis()}}: Downloads and processes SST reanalysis data from the specified center for the given years and area.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{download\_models()}}: Downloads seasonal forecast model data for the specified model, initialization month, and lead times.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{standardize\_timeseries()}}: Standardizes time series data over a specified climatology period.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{calc\_index()}}: Computes specified climate indices (e.g., NINO34, DMI) from SST data.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{compute\_model()}}: Identifies historical analogs using the specified method and computes deterministic forecasts.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{compute\_prob()}}: Calculates tercile probabilities (Below Normal, Near Normal, Above Normal) using the specified distribution method.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{forecast()}}: Generates deterministic and probabilistic forecasts for the target year, returning processed SST data, similar years, deterministic forecast, and probabilistic forecast.

\item {} 
\sphinxAtStartPar
\sphinxcode{\sphinxupquote{composite\_plot()}}: Creates composite plots of forecast results, optionally including the predictor (SST) visualization.

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Example Usage}

\sphinxAtStartPar
Basic analog forecast setup:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{wass2s}\PYG{n+nn}{.}\PYG{n+nn}{was\PYGZus{}analog} \PYG{k+kn}{import} \PYG{n}{WAS\PYGZus{}Analog}

\PYG{c+c1}{\PYGZsh{} Initialize analog model}
\PYG{n}{analog\PYGZus{}model} \PYG{o}{=} \PYG{n}{WAS\PYGZus{}Analog}\PYG{p}{(}
    \PYG{n}{dir\PYGZus{}to\PYGZus{}save}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{./s2s\PYGZus{}data/analog}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
    \PYG{n}{year\PYGZus{}start}\PYG{o}{=}\PYG{l+m+mi}{1990}\PYG{p}{,}
    \PYG{n}{year\PYGZus{}forecast}\PYG{o}{=}\PYG{l+m+mi}{2025}\PYG{p}{,}
    \PYG{n}{reanalysis\PYGZus{}name}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{NOAA.SST}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
    \PYG{n}{model\PYGZus{}name}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{ECMWF\PYGZus{}51.SST}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
    \PYG{n}{method\PYGZus{}analog}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{som}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
    \PYG{n}{month\PYGZus{}of\PYGZus{}initialization}\PYG{o}{=}\PYG{l+m+mi}{3}\PYG{p}{,}
    \PYG{n}{clim\PYGZus{}year\PYGZus{}start}\PYG{o}{=}\PYG{l+m+mi}{1991}\PYG{p}{,}
    \PYG{n}{clim\PYGZus{}year\PYGZus{}end}\PYG{o}{=}\PYG{l+m+mi}{2020}\PYG{p}{,}
    \PYG{n}{define\PYGZus{}extent}\PYG{o}{=}\PYG{p}{(}\PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{180}\PYG{p}{,} \PYG{l+m+mi}{180}\PYG{p}{,} \PYG{o}{\PYGZhy{}}\PYG{l+m+mi}{45}\PYG{p}{,} \PYG{l+m+mi}{45}\PYG{p}{)}\PYG{p}{,}
    \PYG{n}{index\PYGZus{}compute}\PYG{o}{=}\PYG{p}{[}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{NINO34}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{DMI}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{]}\PYG{p}{,}
    \PYG{n}{dist\PYGZus{}method}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{gamma}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Download and process data}
\PYG{n}{sst\PYGZus{}hist}\PYG{p}{,} \PYG{n}{sst\PYGZus{}for} \PYG{o}{=} \PYG{n}{analog\PYGZus{}model}\PYG{o}{.}\PYG{n}{download\PYGZus{}and\PYGZus{}process}\PYG{p}{(}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Generate forecast}
\PYG{n}{ddd}\PYG{p}{,} \PYG{n}{similar\PYGZus{}years}\PYG{p}{,} \PYG{n}{forecast\PYGZus{}det}\PYG{p}{,} \PYG{n}{forecast\PYGZus{}prob} \PYG{o}{=} \PYG{n}{analog\PYGZus{}model}\PYG{o}{.}\PYG{n}{forecast}\PYG{p}{(}
    \PYG{n}{predictant}\PYG{o}{=}\PYG{n}{rainfall\PYGZus{}data}\PYG{p}{,}
    \PYG{n}{clim\PYGZus{}year\PYGZus{}start}\PYG{o}{=}\PYG{l+m+mi}{1991}\PYG{p}{,}
    \PYG{n}{clim\PYGZus{}year\PYGZus{}end}\PYG{o}{=}\PYG{l+m+mi}{2020}\PYG{p}{,}
    \PYG{n}{hindcast\PYGZus{}det}\PYG{o}{=}\PYG{n}{hindcast\PYGZus{}data}\PYG{p}{,}
    \PYG{n}{forecast\PYGZus{}year}\PYG{o}{=}\PYG{l+m+mi}{2025}
\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Create composite plot}
\PYG{n}{similar\PYGZus{}years} \PYG{o}{=} \PYG{n}{analog\PYGZus{}model}\PYG{o}{.}\PYG{n}{composite\PYGZus{}plot}\PYG{p}{(}
    \PYG{n}{predictant}\PYG{o}{=}\PYG{n}{rainfall\PYGZus{}data}\PYG{p}{,}
    \PYG{n}{clim\PYGZus{}year\PYGZus{}start}\PYG{o}{=}\PYG{l+m+mi}{1991}\PYG{p}{,}
    \PYG{n}{clim\PYGZus{}year\PYGZus{}end}\PYG{o}{=}\PYG{l+m+mi}{2020}\PYG{p}{,}
    \PYG{n}{hindcast\PYGZus{}det}\PYG{o}{=}\PYG{n}{hindcast\PYGZus{}data}\PYG{p}{,}
    \PYG{n}{plot\PYGZus{}predictor}\PYG{o}{=}\PYG{k+kc}{True}
\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Cross\sphinxhyphen{}Validation Example}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{wass2s}\PYG{n+nn}{.}\PYG{n+nn}{was\PYGZus{}analog} \PYG{k+kn}{import} \PYG{n}{WAS\PYGZus{}Cross\PYGZus{}Validator}

\PYG{c+c1}{\PYGZsh{} Perform cross\PYGZhy{}validation}
\PYG{n}{was\PYGZus{}analog\PYGZus{}cv} \PYG{o}{=} \PYG{n}{WAS\PYGZus{}Cross\PYGZus{}Validator}\PYG{p}{(}\PYG{n}{n\PYGZus{}splits}\PYG{o}{=}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{rainfall}\PYG{o}{.}\PYG{n}{get\PYGZus{}index}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{T}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,} \PYG{n}{nb\PYGZus{}omit}\PYG{o}{=}\PYG{l+m+mi}{2}\PYG{p}{)}
\PYG{n}{hindcast\PYGZus{}analog\PYGZus{}det}\PYG{p}{,} \PYG{n}{hindcast\PYGZus{}analog\PYGZus{}prob} \PYG{o}{=} \PYG{n}{was\PYGZus{}analog\PYGZus{}cv}\PYG{o}{.}\PYG{n}{cross\PYGZus{}validate}\PYG{p}{(}
    \PYG{n}{analog\PYGZus{}model}\PYG{p}{,}
    \PYG{n}{rainfall}\PYG{p}{,}
    \PYG{n}{clim\PYGZus{}year\PYGZus{}start}\PYG{o}{=}\PYG{l+m+mi}{1991}\PYG{p}{,}
    \PYG{n}{clim\PYGZus{}year\PYGZus{}end}\PYG{o}{=}\PYG{l+m+mi}{2020}
\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Generate forecast using cross\PYGZhy{}validated hindcast}
\PYG{n}{ddd}\PYG{p}{,} \PYG{n}{similar\PYGZus{}years}\PYG{p}{,} \PYG{n}{forecast\PYGZus{}det}\PYG{p}{,} \PYG{n}{forecast\PYGZus{}prob} \PYG{o}{=} \PYG{n}{analog\PYGZus{}model}\PYG{o}{.}\PYG{n}{forecast}\PYG{p}{(}
    \PYG{n}{predictant}\PYG{o}{=}\PYG{n}{rainfall}\PYG{p}{,}
    \PYG{n}{clim\PYGZus{}year\PYGZus{}start}\PYG{o}{=}\PYG{l+m+mi}{1991}\PYG{p}{,}
    \PYG{n}{clim\PYGZus{}year\PYGZus{}end}\PYG{o}{=}\PYG{l+m+mi}{2020}\PYG{p}{,}
    \PYG{n}{hindcast\PYGZus{}det}\PYG{o}{=}\PYG{n}{hindcast\PYGZus{}analog\PYGZus{}det}\PYG{p}{,}
    \PYG{n}{forecast\PYGZus{}year}\PYG{o}{=}\PYG{l+m+mi}{2025}
\PYG{p}{)}
\end{sphinxVerbatim}

\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
Ensure \sphinxtitleref{WAS\_Cross\_Validator} is correctly imported from the \sphinxtitleref{wass2s.was\_analog} module and that the \sphinxtitleref{rainfall} variable is an xarray DataArray with appropriate dimensions (T, Y, X).
\end{sphinxadmonition}

\sphinxstepscope


\subsection{Verification Module}
\label{\detokenize{Verification:verification-module}}\label{\detokenize{Verification::doc}}
\sphinxAtStartPar
The Verification module provides tools for evaluating the performance of climate forecasts using a variety of deterministic, probabilistic, and ensemble\sphinxhyphen{}based metrics. It is implemented in the \sphinxtitleref{was\_verification.py} module and leverages the \sphinxtitleref{WAS\_Verification} class to compute metrics such as Kling\sphinxhyphen{}Gupta Efficiency (KGE), Pearson Correlation, Ranked Probability Skill Score (RPSS), and Continuous Ranked Probability Score (CRPS). The module also includes visualization utilities for plotting scores, reliability diagrams, and ROC curves.

\sphinxAtStartPar
This module is designed to work with gridded climate data, typically stored in \sphinxtitleref{xarray} DataArrays, and supports parallel computation using \sphinxtitleref{dask} for efficiency with large datasets.

\sphinxAtStartPar
The \sphinxtitleref{WAS\_Verification} class is the core of the Verification module, providing methods to compute and visualize various performance metrics for climate forecasts.

\sphinxAtStartPar
\sphinxstylestrong{Initialization}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{wass2s}\PYG{n+nn}{.}\PYG{n+nn}{was\PYGZus{}verification} \PYG{k+kn}{import} \PYG{n}{WAS\PYGZus{}Verification}

\PYG{c+c1}{\PYGZsh{} Initialize with a distribution method for probabilistic forecasts}
\PYG{n}{verifier} \PYG{o}{=} \PYG{n}{WAS\PYGZus{}Verification}\PYG{p}{(}\PYG{n}{dist\PYGZus{}method}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{gamma}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Parameters}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxtitleref{dist\_method}: Specifies the distribution method for computing tercile probabilities. Options include:
\sphinxhyphen{} \sphinxtitleref{“t”}: Student’s t\sphinxhyphen{}based method.
\sphinxhyphen{} \sphinxtitleref{“gamma”}: Gamma distribution\sphinxhyphen{}based method (default).
\sphinxhyphen{} \sphinxtitleref{“normal”}: Normal distribution\sphinxhyphen{}based method.
\sphinxhyphen{} \sphinxtitleref{“lognormal”}: Lognormal distribution\sphinxhyphen{}based method.
\sphinxhyphen{} \sphinxtitleref{“weibull\_min”}: Weibull minimum distribution\sphinxhyphen{}based method.
\sphinxhyphen{} \sphinxtitleref{“nonparam”}: Non\sphinxhyphen{}parametric method using historical errors.

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Available Metrics}

\sphinxAtStartPar
The class defines a dictionary of scoring metrics with metadata, including:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Deterministic Metrics}:
\sphinxhyphen{} \sphinxtitleref{KGE}: Kling\sphinxhyphen{}Gupta Efficiency (\sphinxhyphen{}1 to 1).
\sphinxhyphen{} \sphinxtitleref{Pearson}: Pearson Correlation Coefficient (\sphinxhyphen{}1 to 1).
\sphinxhyphen{} \sphinxtitleref{IOA}: Index of Agreement (0 to 1).
\sphinxhyphen{} \sphinxtitleref{MAE}: Mean Absolute Error (0 to 100).
\sphinxhyphen{} \sphinxtitleref{RMSE}: Root Mean Square Error (0 to 100).
\sphinxhyphen{} \sphinxtitleref{NSE}: Nash\sphinxhyphen{}Sutcliffe Efficiency (None to 1).
\sphinxhyphen{} \sphinxtitleref{TAYLOR\_DIAGRAM}: Taylor Diagram (visualization).

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Probabilistic Metrics}:
\sphinxhyphen{} \sphinxtitleref{GROC}: Generalized Receiver Operating Characteristic (0 to 1).
\sphinxhyphen{} \sphinxtitleref{RPSS}: Ranked Probability Skill Score (\sphinxhyphen{}1 to 1).
\sphinxhyphen{} \sphinxtitleref{IGS}: Ignorance Score (0 to None).
\sphinxhyphen{} \sphinxtitleref{RES}: Resolution Score (0 to None).
\sphinxhyphen{} \sphinxtitleref{REL}: Reliability Score (None to None).
\sphinxhyphen{} \sphinxtitleref{RELIABILITY\_DIAGRAM}: Reliability Diagram (visualization).
\sphinxhyphen{} \sphinxtitleref{ROC\_CURVE}: Receiver Operating Characteristic Curve (visualization).

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Ensemble Metrics}:
\sphinxhyphen{} \sphinxtitleref{CRPS}: Continuous Ranked Probability Score (0 to 100).

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Metadata Access}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{metadata} \PYG{o}{=} \PYG{n}{verifier}\PYG{o}{.}\PYG{n}{get\PYGZus{}scores\PYGZus{}metadata}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
This returns a dictionary containing the name, range, type, colormap, and computation function for each metric.


\subsubsection{Deterministic Metrics}
\label{\detokenize{Verification:deterministic-metrics}}
\sphinxAtStartPar
Deterministic metrics evaluate the performance of point forecasts against observations. They are computed using the \sphinxtitleref{compute\_deterministic\_score} method, which applies a scoring function over \sphinxtitleref{xarray} DataArrays.

\sphinxAtStartPar
\sphinxstylestrong{Example Usage}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Compute Pearson Correlation}
\PYG{n}{pearson\PYGZus{}score} \PYG{o}{=} \PYG{n}{verifier}\PYG{o}{.}\PYG{n}{compute\PYGZus{}deterministic\PYGZus{}score}\PYG{p}{(}
    \PYG{n}{verifier}\PYG{o}{.}\PYG{n}{pearson\PYGZus{}corr}\PYG{p}{,} \PYG{n}{obs\PYGZus{}data}\PYG{p}{,} \PYG{n}{model\PYGZus{}data}
\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Plot the score}
\PYG{n}{verifier}\PYG{o}{.}\PYG{n}{plot\PYGZus{}model\PYGZus{}score}\PYG{p}{(}\PYG{n}{pearson\PYGZus{}score}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Pearson}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{dir\PYGZus{}save\PYGZus{}score}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{./scores}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{figure\PYGZus{}name}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Pearson\PYGZus{}Score}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Key Methods}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxtitleref{kling\_gupta\_efficiency}: Computes KGE, balancing correlation, bias, and variability.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{pearson\_corr}: Computes Pearson Correlation Coefficient.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{index\_of\_agreement}: Computes IOA, measuring agreement between predictions and observations.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{mean\_absolute\_error}: Computes MAE, the average absolute difference.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{root\_mean\_square\_error}: Computes RMSE, the square root of mean squared differences.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{nash\_sutcliffe\_efficiency}: Computes NSE, comparing prediction errors to the mean of observations.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{taylor\_diagram}: Placeholder for Taylor Diagram visualization (to be implemented).

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Plotting}

\sphinxAtStartPar
The \sphinxtitleref{plot\_model\_score} method visualizes deterministic scores on a map using \sphinxtitleref{cartopy}.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{verifier}\PYG{o}{.}\PYG{n}{plot\PYGZus{}model\PYGZus{}score}\PYG{p}{(}\PYG{n}{score\PYGZus{}result}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{KGE}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{dir\PYGZus{}save\PYGZus{}score}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{./scores}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{figure\PYGZus{}name}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{KGE\PYGZus{}Model}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
The \sphinxtitleref{plot\_models\_score} method plots multiple model scores in a grid.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{model\PYGZus{}metrics} \PYG{o}{=} \PYG{p}{\PYGZob{}}
    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{model1}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{n}{score\PYGZus{}result1}\PYG{p}{,}
    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{model2}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{n}{score\PYGZus{}result2}
\PYG{p}{\PYGZcb{}}
\PYG{n}{verifier}\PYG{o}{.}\PYG{n}{plot\PYGZus{}models\PYGZus{}score}\PYG{p}{(}\PYG{n}{model\PYGZus{}metrics}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Pearson}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{dir\PYGZus{}save\PYGZus{}score}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{./scores}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}


\subsubsection{Probabilistic Metrics}
\label{\detokenize{Verification:probabilistic-metrics}}
\sphinxAtStartPar
Probabilistic metrics evaluate the performance of forecasts that provide probabilities for tercile categories (below\sphinxhyphen{}normal, near\sphinxhyphen{}normal, above\sphinxhyphen{}normal). These are computed using the \sphinxtitleref{compute\_probabilistic\_score} method.

\sphinxAtStartPar
\sphinxstylestrong{Example Usage}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Compute tercile probabilities}
\PYG{n}{proba\PYGZus{}forecast} \PYG{o}{=} \PYG{n}{verifier}\PYG{o}{.}\PYG{n}{gcm\PYGZus{}compute\PYGZus{}prob}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data}\PYG{p}{,} \PYG{n}{clim\PYGZus{}year\PYGZus{}start}\PYG{o}{=}\PYG{l+m+mi}{1981}\PYG{p}{,} \PYG{n}{clim\PYGZus{}year\PYGZus{}end}\PYG{o}{=}\PYG{l+m+mi}{2010}\PYG{p}{,} \PYG{n}{hindcast\PYGZus{}det}\PYG{o}{=}\PYG{n}{model\PYGZus{}data}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Compute RPSS}
\PYG{n}{rpss\PYGZus{}score} \PYG{o}{=} \PYG{n}{verifier}\PYG{o}{.}\PYG{n}{compute\PYGZus{}probabilistic\PYGZus{}score}\PYG{p}{(}
    \PYG{n}{verifier}\PYG{o}{.}\PYG{n}{calculate\PYGZus{}rpss}\PYG{p}{,} \PYG{n}{obs\PYGZus{}data}\PYG{p}{,} \PYG{n}{proba\PYGZus{}forecast}\PYG{p}{,} \PYG{n}{clim\PYGZus{}year\PYGZus{}start}\PYG{o}{=}\PYG{l+m+mi}{1981}\PYG{p}{,} \PYG{n}{clim\PYGZus{}year\PYGZus{}end}\PYG{o}{=}\PYG{l+m+mi}{2010}
\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Key Methods}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxtitleref{classify}: Classifies data into terciles based on climatology.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{compute\_class}: Computes tercile class labels for observations.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{calculate\_groc}: Computes GROC, averaging AUC across tercile categories.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{calculate\_rpss}: Computes RPSS, comparing forecast probabilities to climatology.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{ignorance\_score}: Computes Ignorance Score per Weijs (2010).

\item {} 
\sphinxAtStartPar
\sphinxtitleref{resolution\_score\_grid}: Computes Resolution Score, measuring how forecasts differ from climatology.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{reliability\_score\_grid}: Computes Reliability Score, assessing forecast calibration.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{reliability\_diagram}: Plots Reliability Diagrams for each tercile category.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{plot\_roc\_curves}: Plots ROC Curves with confidence intervals for each tercile.

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Visualization}

\sphinxAtStartPar
Reliability Diagrams and ROC Curves are generated for probabilistic forecasts.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Plot Reliability Diagram}
\PYG{n}{verifier}\PYG{o}{.}\PYG{n}{reliability\PYGZus{}diagram}\PYG{p}{(}
    \PYG{n}{modelname}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Model1}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{dir\PYGZus{}to\PYGZus{}save\PYGZus{}score}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{./scores}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{y\PYGZus{}true}\PYG{o}{=}\PYG{n}{obs\PYGZus{}data}\PYG{p}{,} \PYG{n}{y\PYGZus{}probs}\PYG{o}{=}\PYG{n}{proba\PYGZus{}forecast}\PYG{p}{,}
    \PYG{n}{clim\PYGZus{}year\PYGZus{}start}\PYG{o}{=}\PYG{l+m+mi}{1981}\PYG{p}{,} \PYG{n}{clim\PYGZus{}year\PYGZus{}end}\PYG{o}{=}\PYG{l+m+mi}{2010}
\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Plot ROC Curves with 95\PYGZpc{} confidence intervals}
\PYG{n}{verifier}\PYG{o}{.}\PYG{n}{plot\PYGZus{}roc\PYGZus{}curves}\PYG{p}{(}
    \PYG{n}{modelname}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Model1}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{dir\PYGZus{}to\PYGZus{}save\PYGZus{}score}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{./scores}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{y\PYGZus{}true}\PYG{o}{=}\PYG{n}{obs\PYGZus{}data}\PYG{p}{,} \PYG{n}{y\PYGZus{}probs}\PYG{o}{=}\PYG{n}{proba\PYGZus{}forecast}\PYG{p}{,}
    \PYG{n}{clim\PYGZus{}year\PYGZus{}start}\PYG{o}{=}\PYG{l+m+mi}{1981}\PYG{p}{,} \PYG{n}{clim\PYGZus{}year\PYGZus{}end}\PYG{o}{=}\PYG{l+m+mi}{2010}\PYG{p}{,} \PYG{n}{n\PYGZus{}bootstraps}\PYG{o}{=}\PYG{l+m+mi}{1000}\PYG{p}{,} \PYG{n}{ci}\PYG{o}{=}\PYG{l+m+mf}{0.95}
\PYG{p}{)}
\end{sphinxVerbatim}


\subsubsection{Ensemble Metrics}
\label{\detokenize{Verification:ensemble-metrics}}
\sphinxAtStartPar
Ensemble metrics evaluate forecasts with multiple members, such as those from GCMs. The primary metric is CRPS, computed using \sphinxtitleref{xskillscore}.

\sphinxAtStartPar
\sphinxstylestrong{Example Usage}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Compute CRPS for ensemble forecast}
\PYG{n}{crps\PYGZus{}score} \PYG{o}{=} \PYG{n}{verifier}\PYG{o}{.}\PYG{n}{compute\PYGZus{}crps}\PYG{p}{(}\PYG{n}{obs\PYGZus{}data}\PYG{p}{,} \PYG{n}{model\PYGZus{}data}\PYG{p}{,} \PYG{n}{member\PYGZus{}dim}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{number}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{dim}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{T}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxstylestrong{Key Methods}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxtitleref{compute\_crps}: Computes CRPS for ensemble forecasts, measuring the difference between predicted and observed distributions.

\end{itemize}


\subsubsection{Tercile Probability Computation}
\label{\detokenize{Verification:tercile-probability-computation}}
\sphinxAtStartPar
The module provides multiple methods to compute tercile probabilities for probabilistic forecasts, based on different distributional assumptions.

\sphinxAtStartPar
\sphinxstylestrong{Key Methods}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxtitleref{calculate\_tercile\_probabilities}: Uses Student’s t\sphinxhyphen{}distribution.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{calculate\_tercile\_probabilities\_gamma}: Uses Gamma distribution.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{calculate\_tercile\_probabilities\_normal}: Uses Normal distribution.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{calculate\_tercile\_probabilities\_lognormal}: Uses Lognormal distribution.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{calculate\_tercile\_probabilities\_weibull\_min}: Uses Weibull minimum distribution.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{calculate\_tercile\_probabilities\_nonparametric}: Uses historical errors for a non\sphinxhyphen{}parametric approach.

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Example Usage}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Compute probabilities using Gamma distribution}
\PYG{n}{hindcast\PYGZus{}prob} \PYG{o}{=} \PYG{n}{verifier}\PYG{o}{.}\PYG{n}{gcm\PYGZus{}compute\PYGZus{}prob}\PYG{p}{(}
    \PYG{n}{Predictant}\PYG{o}{=}\PYG{n}{obs\PYGZus{}data}\PYG{p}{,} \PYG{n}{clim\PYGZus{}year\PYGZus{}start}\PYG{o}{=}\PYG{l+m+mi}{1981}\PYG{p}{,} \PYG{n}{clim\PYGZus{}year\PYGZus{}end}\PYG{o}{=}\PYG{l+m+mi}{2010}\PYG{p}{,} \PYG{n}{hindcast\PYGZus{}det}\PYG{o}{=}\PYG{n}{model\PYGZus{}data}
\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
The \sphinxtitleref{gcm\_compute\_prob} method selects the appropriate distribution based on the \sphinxtitleref{dist\_method} parameter.


\subsubsection{GCM Validation}
\label{\detokenize{Verification:gcm-validation}}
\sphinxAtStartPar
The module includes methods to validate General Circulation Model (GCM) forecasts against observations, supporting both deterministic and probabilistic metrics.

\sphinxAtStartPar
\sphinxstylestrong{Key Methods}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxtitleref{gcm\_validation\_compute}: Validates GCM forecasts for multiple models, computing specified metrics.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{weighted\_gcm\_forecasts}: Combines forecasts from multiple models using weights based on a performance metric (e.g., GROC).

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Example Usage}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Validate GCM forecasts}
\PYG{n}{models\PYGZus{}files\PYGZus{}path} \PYG{o}{=} \PYG{p}{\PYGZob{}}
    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{model1}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{path/to/model1.nc}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
    \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{model2}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{path/to/model2.nc}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{p}{\PYGZcb{}}
\PYG{n}{x\PYGZus{}metric} \PYG{o}{=} \PYG{n}{verifier}\PYG{o}{.}\PYG{n}{gcm\PYGZus{}validation\PYGZus{}compute}\PYG{p}{(}
    \PYG{n}{models\PYGZus{}files\PYGZus{}path}\PYG{o}{=}\PYG{n}{models\PYGZus{}files\PYGZus{}path}\PYG{p}{,} \PYG{n}{Obs}\PYG{o}{=}\PYG{n}{obs\PYGZus{}data}\PYG{p}{,} \PYG{n}{score}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Pearson}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
    \PYG{n}{month\PYGZus{}of\PYGZus{}initialization}\PYG{o}{=}\PYG{l+m+mi}{3}\PYG{p}{,} \PYG{n}{clim\PYGZus{}year\PYGZus{}start}\PYG{o}{=}\PYG{l+m+mi}{1981}\PYG{p}{,} \PYG{n}{clim\PYGZus{}year\PYGZus{}end}\PYG{o}{=}\PYG{l+m+mi}{2010}\PYG{p}{,}
    \PYG{n}{dir\PYGZus{}to\PYGZus{}save\PYGZus{}roc\PYGZus{}reliability}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{./scores}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{lead\PYGZus{}time}\PYG{o}{=}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}
\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Compute weighted GCM forecasts}
\PYG{n}{hindcast\PYGZus{}det}\PYG{p}{,} \PYG{n}{hindcast\PYGZus{}prob}\PYG{p}{,} \PYG{n}{forecast\PYGZus{}prob} \PYG{o}{=} \PYG{n}{verifier}\PYG{o}{.}\PYG{n}{weighted\PYGZus{}gcm\PYGZus{}forecasts}\PYG{p}{(}
    \PYG{n}{Obs}\PYG{o}{=}\PYG{n}{obs\PYGZus{}data}\PYG{p}{,} \PYG{n}{best\PYGZus{}models}\PYG{o}{=}\PYG{p}{\PYGZob{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{model1\PYGZus{}MarIc\PYGZus{}JFM\PYGZus{}1}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{n}{score1}\PYG{p}{\PYGZcb{}}\PYG{p}{,} \PYG{n}{scores}\PYG{o}{=}\PYG{p}{\PYGZob{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{GROC}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:} \PYG{n}{x\PYGZus{}metric}\PYG{p}{\PYGZcb{}}\PYG{p}{,}
    \PYG{n}{lead\PYGZus{}time}\PYG{o}{=}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{,} \PYG{n}{model\PYGZus{}dir}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{./models}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{n}{clim\PYGZus{}year\PYGZus{}start}\PYG{o}{=}\PYG{l+m+mi}{1981}\PYG{p}{,} \PYG{n}{clim\PYGZus{}year\PYGZus{}end}\PYG{o}{=}\PYG{l+m+mi}{2010}\PYG{p}{,} \PYG{n}{variable}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{PRCP}\PYG{l+s+s2}{\PYGZdq{}}
\PYG{p}{)}
\end{sphinxVerbatim}


\subsubsection{Annual Year Validation}
\label{\detokenize{Verification:annual-year-validation}}
\sphinxAtStartPar
The module provides utilities to validate forecasts for a specific year, including ratio\sphinxhyphen{}to\sphinxhyphen{}average classification and RPSS computation.

\sphinxAtStartPar
\sphinxstylestrong{Key Methods}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxtitleref{ratio\_to\_average}: Classifies forecast data relative to the climatological mean into categories (e.g., Well Above Average, Near Average).

\item {} 
\sphinxAtStartPar
\sphinxtitleref{compute\_one\_year\_rpss}: Computes RPSS for a specific year and visualizes it on a map.

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Example Usage}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} Classify ratio to average for a specific year}
\PYG{n}{verifier}\PYG{o}{.}\PYG{n}{ratio\PYGZus{}to\PYGZus{}average}\PYG{p}{(}\PYG{n}{predictant}\PYG{o}{=}\PYG{n}{obs\PYGZus{}data}\PYG{p}{,} \PYG{n}{clim\PYGZus{}year\PYGZus{}start}\PYG{o}{=}\PYG{l+m+mi}{1981}\PYG{p}{,} \PYG{n}{clim\PYGZus{}year\PYGZus{}end}\PYG{o}{=}\PYG{l+m+mi}{2010}\PYG{p}{,} \PYG{n}{year}\PYG{o}{=}\PYG{l+m+mi}{2020}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Compute RPSS for a specific year}
\PYG{n}{verifier}\PYG{o}{.}\PYG{n}{compute\PYGZus{}one\PYGZus{}year\PYGZus{}rpss}\PYG{p}{(}
    \PYG{n}{obs}\PYG{o}{=}\PYG{n}{obs\PYGZus{}data}\PYG{p}{,} \PYG{n}{prob\PYGZus{}pred}\PYG{o}{=}\PYG{n}{proba\PYGZus{}forecast}\PYG{p}{,} \PYG{n}{clim\PYGZus{}year\PYGZus{}start}\PYG{o}{=}\PYG{l+m+mi}{1981}\PYG{p}{,} \PYG{n}{clim\PYGZus{}year\PYGZus{}end}\PYG{o}{=}\PYG{l+m+mi}{2010}\PYG{p}{,} \PYG{n}{year}\PYG{o}{=}\PYG{l+m+mi}{2020}
\PYG{p}{)}
\end{sphinxVerbatim}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Placeholder Functions}: Some methods (e.g., \sphinxtitleref{taylor\_diagram}) are placeholders and require implementation based on specific needs.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Gridded Data}: The module currently supports only gridded data validation. Non\sphinxhyphen{}gridded validation is not implemented.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Performance}: The use of \sphinxtitleref{dask} ensures efficient computation for large datasets, but users should ensure proper chunking of \sphinxtitleref{xarray} DataArrays.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Visualization}: Plots are saved to the specified directory and displayed using \sphinxtitleref{matplotlib}. Ensure the output directory exists.

\end{itemize}

\sphinxAtStartPar
This documentation provides an overview of the Verification module’s capabilities, along with example usage for key methods. For detailed information on each method, refer to the source code and docstrings in \sphinxtitleref{was\_verification.py}.

\sphinxstepscope


\subsection{Multi\sphinxhyphen{}Model Ensemble (MME) Techniques}
\label{\detokenize{mme:multi-model-ensemble-mme-techniques}}\label{\detokenize{mme::doc}}
\sphinxAtStartPar
The \sphinxtitleref{was\_mme.py} module provides classes for combining predictions from multiple models, including:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxtitleref{WAS\_mme\_ELM}: Extreme Learning Machine for MME.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{WAS\_mme\_EPOELM}: Enhanced Parallel Online Extreme Learning Machine.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{WAS\_mme\_MLP}: Multi\sphinxhyphen{}Layer Perceptron for MME.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{WAS\_mme\_GradientBoosting}: Gradient Boosting for MME.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{WAS\_mme\_XGBoosting}: XGBoost for MME.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{WAS\_mme\_AdaBoost}: AdaBoost for MME.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{WAS\_mme\_LGBM\_Boosting}: LightGBM Boosting for MME.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{WAS\_mme\_Stack\_MLP\_RF}: Stacking model with MLP and Random Forest.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{WAS\_mme\_Stack\_Lasso\_RF\_MLP}: Stacking model with Lasso, Random Forest, and MLP.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{WAS\_mme\_Stack\_MLP\_Ada\_Ridge}: Stacking model with MLP, AdaBoost, and Ridge.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{WAS\_mme\_Stack\_RF\_GB\_Ridge}: Stacking model with Random Forest, Gradient Boosting, and Ridge.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{WAS\_mme\_Stack\_KNN\_Tree\_SVR}: Stacking model with KNN, Decision Tree, and SVR.

\item {} 
\sphinxAtStartPar
\sphinxtitleref{WAS\_mme\_GA}: Genetic Algorithm for MME.

\end{itemize}

\sphinxAtStartPar
Each MME class includes methods for computing the ensemble model and, where applicable, computing probabilities.

\sphinxAtStartPar
\sphinxstylestrong{Example Usage with WAS\_mme\_ELM}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{wass2s}\PYG{n+nn}{.}\PYG{n+nn}{was\PYGZus{}mme} \PYG{k+kn}{import} \PYG{n}{WAS\PYGZus{}mme\PYGZus{}ELM}

\PYG{c+c1}{\PYGZsh{} Define ELM parameters}
\PYG{n}{elm\PYGZus{}kwargs} \PYG{o}{=} \PYG{p}{\PYGZob{}}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{regularization}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mi}{10}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{hidden\PYGZus{}layer\PYGZus{}size}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mi}{4}\PYG{p}{,}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{activation}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{lin}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} Options: \PYGZsq{}sigm\PYGZsq{}, \PYGZsq{}tanh\PYGZsq{}, \PYGZsq{}lin\PYGZsq{}, \PYGZsq{}relu\PYGZsq{}}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{preprocessing}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{none}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}  \PYG{c+c1}{\PYGZsh{} Options: \PYGZsq{}minmax\PYGZsq{}, \PYGZsq{}std\PYGZsq{}, \PYGZsq{}none\PYGZsq{}}
    \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{n\PYGZus{}estimators}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{:} \PYG{l+m+mi}{10}\PYG{p}{,}
\PYG{p}{\PYGZcb{}}

\PYG{c+c1}{\PYGZsh{} Initialize the MME ELM model}
\PYG{n}{model} \PYG{o}{=} \PYG{n}{WAS\PYGZus{}mme\PYGZus{}ELM}\PYG{p}{(}\PYG{n}{elm\PYGZus{}kwargs}\PYG{o}{=}\PYG{n}{elm\PYGZus{}kwargs}\PYG{p}{,} \PYG{n}{dist\PYGZus{}method}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{euclidean}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Process datasets for MME (user\PYGZhy{}defined function)}
\PYG{n}{all\PYGZus{}model\PYGZus{}hdcst}\PYG{p}{,} \PYG{n}{all\PYGZus{}model\PYGZus{}fcst}\PYG{p}{,} \PYG{n}{obs}\PYG{p}{,} \PYG{n}{best\PYGZus{}score} \PYG{o}{=} \PYG{n}{process\PYGZus{}datasets\PYGZus{}for\PYGZus{}mme}\PYG{p}{(}
    \PYG{n}{rainfall}\PYG{o}{.}\PYG{n}{sel}\PYG{p}{(}\PYG{n}{T}\PYG{o}{=}\PYG{n+nb}{slice}\PYG{p}{(}\PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{year\PYGZus{}start}\PYG{p}{)}\PYG{p}{,} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{year\PYGZus{}end}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}
    \PYG{n}{gcm}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{ELM\PYGZus{}ELR}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{dir\PYGZus{}to\PYGZus{}save\PYGZus{}model}\PYG{o}{=}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{./models}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,}
    \PYG{n}{best\PYGZus{}models}\PYG{o}{=}\PYG{p}{[}\PYG{p}{]}\PYG{p}{,} \PYG{n}{scores}\PYG{o}{=}\PYG{p}{[}\PYG{p}{]}\PYG{p}{,} \PYG{n}{year\PYGZus{}start}\PYG{o}{=}\PYG{l+m+mi}{1990}\PYG{p}{,} \PYG{n}{year\PYGZus{}end}\PYG{o}{=}\PYG{l+m+mi}{2020}\PYG{p}{,}
    \PYG{n}{model}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{,} \PYG{n}{month\PYGZus{}of\PYGZus{}initialization}\PYG{o}{=}\PYG{l+m+mi}{3}\PYG{p}{,} \PYG{n}{lead\PYGZus{}time}\PYG{o}{=}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{year\PYGZus{}forecast}\PYG{o}{=}\PYG{l+m+mi}{2021}
\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Initialize cross\PYGZhy{}validator}
\PYG{n}{was\PYGZus{}mme\PYGZus{}gcm} \PYG{o}{=} \PYG{n}{WAS\PYGZus{}Cross\PYGZus{}Validator}\PYG{p}{(}
    \PYG{n}{n\PYGZus{}splits}\PYG{o}{=}\PYG{n+nb}{len}\PYG{p}{(}\PYG{n}{rainfall}\PYG{o}{.}\PYG{n}{sel}\PYG{p}{(}\PYG{n}{T}\PYG{o}{=}\PYG{n+nb}{slice}\PYG{p}{(}\PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{year\PYGZus{}start}\PYG{p}{)}\PYG{p}{,} \PYG{n+nb}{str}\PYG{p}{(}\PYG{n}{year\PYGZus{}end}\PYG{p}{)}\PYG{p}{)}\PYG{p}{)}\PYG{o}{.}\PYG{n}{get\PYGZus{}index}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{T}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{)}\PYG{p}{,}
    \PYG{n}{nb\PYGZus{}omit}\PYG{o}{=}\PYG{l+m+mi}{2}
\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} Perform cross\PYGZhy{}validation}
\PYG{n}{hindcast\PYGZus{}det\PYGZus{}gcm}\PYG{p}{,} \PYG{n}{hindcast\PYGZus{}prob\PYGZus{}gcm} \PYG{o}{=} \PYG{n}{was\PYGZus{}mme\PYGZus{}gcm}\PYG{o}{.}\PYG{n}{cross\PYGZus{}validate}\PYG{p}{(}
    \PYG{n}{model}\PYG{p}{,} \PYG{n}{obs}\PYG{p}{,} \PYG{n}{all\PYGZus{}model\PYGZus{}hdcst}\PYG{p}{,} \PYG{n}{clim\PYGZus{}year\PYGZus{}start}\PYG{p}{,} \PYG{n}{clim\PYGZus{}year\PYGZus{}end}
\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxstepscope


\section{wass2s submodules}
\label{\detokenize{api:wass2s-submodules}}\label{\detokenize{api::doc}}

\subsection{wass2s.was\_download module}
\label{\detokenize{api:wass2s-was-download-module}}\index{module@\spxentry{module}!wass2s.was\_download@\spxentry{wass2s.was\_download}}\index{wass2s.was\_download@\spxentry{wass2s.was\_download}!module@\spxentry{module}}\index{WAS\_Download (class in wass2s.was\_download)@\spxentry{WAS\_Download}\spxextra{class in wass2s.was\_download}}\phantomsection\label{\detokenize{api:module-wass2s.was_download}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_download.WAS_Download}}
\pysigstartsignatures
\pysigline
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_download.}}\sphinxbfcode{\sphinxupquote{WAS\_Download}}}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}
\index{AgroObsName() (wass2s.was\_download.WAS\_Download method)@\spxentry{AgroObsName()}\spxextra{wass2s.was\_download.WAS\_Download method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_download.WAS_Download.AgroObsName}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{AgroObsName}}}
{\sphinxparam{\DUrole{n}{variables}\DUrole{o}{=}\DUrole{default_value}{\{\textquotesingle{}AGRO.PRCP\textquotesingle{}: (\textquotesingle{}precipitation\_flux\textquotesingle{}, None), \textquotesingle{}AGRO.TEMP\textquotesingle{}: (\textquotesingle{}2m\_temperature\textquotesingle{}, \textquotesingle{}24\_hour\_mean\textquotesingle{}), \textquotesingle{}AGRO.TMAX\textquotesingle{}: (\textquotesingle{}2m\_temperature\textquotesingle{}, \textquotesingle{}24\_hour\_maximum\textquotesingle{}), \textquotesingle{}AGRO.TMIN\textquotesingle{}: (\textquotesingle{}2m\_temperature\textquotesingle{}, \textquotesingle{}24\_hour\_minimum\textquotesingle{})\}}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Generate a dictionary for agro\sphinxhyphen{}meteorological observation variables.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{variables}} (\sphinxstyleliteralemphasis{\sphinxupquote{dict}}) \textendash{} Mapping of agro variable short names to full names.

\sphinxlineitem{Returns}
\sphinxAtStartPar
A dictionary mapping agro variables to their corresponding full names.

\sphinxlineitem{Return type}
\sphinxAtStartPar
dict

\end{description}\end{quote}

\end{fulllineitems}

\index{ModelsName() (wass2s.was\_download.WAS\_Download method)@\spxentry{ModelsName()}\spxextra{wass2s.was\_download.WAS\_Download method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_download.WAS_Download.ModelsName}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{ModelsName}}}
{\sphinxparam{\DUrole{n}{centre}\DUrole{o}{=}\DUrole{default_value}{\{\textquotesingle{}BOM\_2\textquotesingle{}: \textquotesingle{}bom\textquotesingle{}, \textquotesingle{}CFSV2\_1\textquotesingle{}: \textquotesingle{}cfsv2\textquotesingle{}, \textquotesingle{}CMC1\_1\textquotesingle{}: \textquotesingle{}cmc1\textquotesingle{}, \textquotesingle{}CMC2\_1\textquotesingle{}: \textquotesingle{}cmc2\textquotesingle{}, \textquotesingle{}CMCC\_35\textquotesingle{}: \textquotesingle{}cmcc\textquotesingle{}, \textquotesingle{}DWD\_21\textquotesingle{}: \textquotesingle{}dwd\textquotesingle{}, \textquotesingle{}DWD\_22\textquotesingle{}: \textquotesingle{}dwd\textquotesingle{}, \textquotesingle{}ECCC\_4\textquotesingle{}: \textquotesingle{}eccc\textquotesingle{}, \textquotesingle{}ECCC\_5\textquotesingle{}: \textquotesingle{}eccc\textquotesingle{}, \textquotesingle{}ECMWF\_51\textquotesingle{}: \textquotesingle{}ecmwf\textquotesingle{}, \textquotesingle{}GFDL\_1\textquotesingle{}: \textquotesingle{}gfdl\textquotesingle{}, \textquotesingle{}JMA\_3\textquotesingle{}: \textquotesingle{}jma\textquotesingle{}, \textquotesingle{}METEOFRANCE\_8\textquotesingle{}: \textquotesingle{}meteo\_france\textquotesingle{}, \textquotesingle{}METEOFRANCE\_9\textquotesingle{}: \textquotesingle{}meteo\_france\textquotesingle{}, \textquotesingle{}NASA\_1\textquotesingle{}: \textquotesingle{}nasa\textquotesingle{}, \textquotesingle{}NCAR\_CCSM4\_1\textquotesingle{}: \textquotesingle{}ncar\_ccsm4\textquotesingle{}, \textquotesingle{}NCEP\_2\textquotesingle{}: \textquotesingle{}ncep\textquotesingle{}, \textquotesingle{}NMME\_1\textquotesingle{}: \textquotesingle{}nmme\textquotesingle{}, \textquotesingle{}UKMO\_603\textquotesingle{}: \textquotesingle{}ukmo\textquotesingle{}, \textquotesingle{}UKMO\_604\textquotesingle{}: \textquotesingle{}ukmo\textquotesingle{}\}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{variables\_1}\DUrole{o}{=}\DUrole{default_value}{\{\textquotesingle{}DLWR\textquotesingle{}: \textquotesingle{}surface\_thermal\_radiation\_downwards\textquotesingle{}, \textquotesingle{}DSWR\textquotesingle{}: \textquotesingle{}surface\_solar\_radiation\_downwards\textquotesingle{}, \textquotesingle{}PRCP\textquotesingle{}: \textquotesingle{}total\_precipitation\textquotesingle{}, \textquotesingle{}SLP\textquotesingle{}: \textquotesingle{}mean\_sea\_level\_pressure\textquotesingle{}, \textquotesingle{}SST\textquotesingle{}: \textquotesingle{}sea\_surface\_temperature\textquotesingle{}, \textquotesingle{}TEMP\textquotesingle{}: \textquotesingle{}2m\_temperature\textquotesingle{}, \textquotesingle{}UGRD10\textquotesingle{}: \textquotesingle{}10m\_u\_component\_of\_wind\textquotesingle{}, \textquotesingle{}VGRD10\textquotesingle{}: \textquotesingle{}10m\_v\_component\_of\_wind\textquotesingle{}\}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{variables\_2}\DUrole{o}{=}\DUrole{default_value}{\{\textquotesingle{}HUSS\_1000\textquotesingle{}: \textquotesingle{}specific\_humidity\textquotesingle{}, \textquotesingle{}HUSS\_850\textquotesingle{}: \textquotesingle{}specific\_humidity\textquotesingle{}, \textquotesingle{}HUSS\_925\textquotesingle{}: \textquotesingle{}specific\_humidity\textquotesingle{}, \textquotesingle{}UGRD\_1000\textquotesingle{}: \textquotesingle{}u\_component\_of\_wind\textquotesingle{}, \textquotesingle{}UGRD\_850\textquotesingle{}: \textquotesingle{}u\_component\_of\_wind\textquotesingle{}, \textquotesingle{}UGRD\_925\textquotesingle{}: \textquotesingle{}u\_component\_of\_wind\textquotesingle{}, \textquotesingle{}VGRD\_1000\textquotesingle{}: \textquotesingle{}v\_component\_of\_wind\textquotesingle{}, \textquotesingle{}VGRD\_850\textquotesingle{}: \textquotesingle{}v\_component\_of\_wind\textquotesingle{}, \textquotesingle{}VGRD\_925\textquotesingle{}: \textquotesingle{}v\_component\_of\_wind\textquotesingle{}\}}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Generate a combined dictionary of model names and variables.
For more information on C3S, browse the \sphinxhref{https://confluence.ecmwf.int/display/CKB/Description+of+the+C3S+seasonal+multi-system}{MetaData}.
For more information on NMME, browse the \sphinxhref{https://confluence.ecmwf.int/display/CKB/Description+of+the+C3S+seasonal+multi-system}{MetaData}.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{centre}} (\sphinxstyleliteralemphasis{\sphinxupquote{dict}}) \textendash{} Mapping of model identifiers to model names.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{variables\_1}} (\sphinxstyleliteralemphasis{\sphinxupquote{dict}}) \textendash{} Mapping of variable short names to full names for category 1.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{variables\_2}} (\sphinxstyleliteralemphasis{\sphinxupquote{dict}}) \textendash{} Mapping of variable short names to full names for category 2.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
A combined dictionary with keys as model.variable combinations and values as tuples (model name, variable name).

\sphinxlineitem{Return type}
\sphinxAtStartPar
dict

\end{description}\end{quote}

\end{fulllineitems}

\index{ReanalysisName() (wass2s.was\_download.WAS\_Download method)@\spxentry{ReanalysisName()}\spxextra{wass2s.was\_download.WAS\_Download method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_download.WAS_Download.ReanalysisName}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{ReanalysisName}}}
{\sphinxparam{\DUrole{n}{centre}\DUrole{o}{=}\DUrole{default_value}{\{\textquotesingle{}ERA5\textquotesingle{}: \textquotesingle{}reanalysis ERA5\textquotesingle{}, \textquotesingle{}NOAA\textquotesingle{}: \textquotesingle{}NOAA ERSST\textquotesingle{}\}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{variables\_1}\DUrole{o}{=}\DUrole{default_value}{\{\textquotesingle{}DLWR\textquotesingle{}: \textquotesingle{}surface\_thermal\_radiation\_downwards\textquotesingle{}, \textquotesingle{}DSWR\textquotesingle{}: \textquotesingle{}surface\_solar\_radiation\_downwards\textquotesingle{}, \textquotesingle{}PRCP\textquotesingle{}: \textquotesingle{}total\_precipitation\textquotesingle{}, \textquotesingle{}SLP\textquotesingle{}: \textquotesingle{}mean\_sea\_level\_pressure\textquotesingle{}, \textquotesingle{}SST\textquotesingle{}: \textquotesingle{}sea\_surface\_temperature\textquotesingle{}, \textquotesingle{}TEMP\textquotesingle{}: \textquotesingle{}2m\_temperature\textquotesingle{}, \textquotesingle{}UGRD10\textquotesingle{}: \textquotesingle{}10m\_u\_component\_of\_wind\textquotesingle{}, \textquotesingle{}VGRD10\textquotesingle{}: \textquotesingle{}10m\_v\_component\_of\_wind\textquotesingle{}\}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{variables\_2}\DUrole{o}{=}\DUrole{default_value}{\{\textquotesingle{}HUSS\_1000\textquotesingle{}: \textquotesingle{}specific\_humidity\textquotesingle{}, \textquotesingle{}HUSS\_850\textquotesingle{}: \textquotesingle{}specific\_humidity\textquotesingle{}, \textquotesingle{}HUSS\_925\textquotesingle{}: \textquotesingle{}specific\_humidity\textquotesingle{}, \textquotesingle{}UGRD\_1000\textquotesingle{}: \textquotesingle{}u\_component\_of\_wind\textquotesingle{}, \textquotesingle{}UGRD\_850\textquotesingle{}: \textquotesingle{}u\_component\_of\_wind\textquotesingle{}, \textquotesingle{}UGRD\_925\textquotesingle{}: \textquotesingle{}u\_component\_of\_wind\textquotesingle{}, \textquotesingle{}VGRD\_1000\textquotesingle{}: \textquotesingle{}v\_component\_of\_wind\textquotesingle{}, \textquotesingle{}VGRD\_850\textquotesingle{}: \textquotesingle{}v\_component\_of\_wind\textquotesingle{}, \textquotesingle{}VGRD\_925\textquotesingle{}: \textquotesingle{}v\_component\_of\_wind\textquotesingle{}\}}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Generate a combined dictionary of reanalysis names and variables.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{centre}} (\sphinxstyleliteralemphasis{\sphinxupquote{dict}}) \textendash{} Mapping of reanalysis identifiers to reanalysis names.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{variables\_1}} (\sphinxstyleliteralemphasis{\sphinxupquote{dict}}) \textendash{} Mapping of variable short names to full names for category 1.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{variables\_2}} (\sphinxstyleliteralemphasis{\sphinxupquote{dict}}) \textendash{} Mapping of variable short names to full names for category 2.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
A combined dictionary with keys as reanalysis.variable combinations and values as tuples (reanalysis name, variable name).

\sphinxlineitem{Return type}
\sphinxAtStartPar
dict

\end{description}\end{quote}

\end{fulllineitems}

\index{WAS\_Download\_AgroIndicators() (wass2s.was\_download.WAS\_Download method)@\spxentry{WAS\_Download\_AgroIndicators()}\spxextra{wass2s.was\_download.WAS\_Download method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_download.WAS_Download.WAS_Download_AgroIndicators}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{WAS\_Download\_AgroIndicators}}}
{\sphinxparam{\DUrole{n}{dir\_to\_save}}\sphinxparamcomma \sphinxparam{\DUrole{n}{variables}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{area}}\sphinxparamcomma \sphinxparam{\DUrole{n}{seas}\DUrole{o}{=}\DUrole{default_value}{{[}\textquotesingle{}01\textquotesingle{}, \textquotesingle{}02\textquotesingle{}, \textquotesingle{}03\textquotesingle{}{]}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{force\_download}\DUrole{o}{=}\DUrole{default_value}{False}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Download agro\sphinxhyphen{}meteorological indicators for specified variables, years, and months,
handling cross\sphinxhyphen{}year seasons (e.g., NDJ).

\end{fulllineitems}

\index{WAS\_Download\_AgroIndicators\_() (wass2s.was\_download.WAS\_Download method)@\spxentry{WAS\_Download\_AgroIndicators\_()}\spxextra{wass2s.was\_download.WAS\_Download method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_download.WAS_Download.WAS_Download_AgroIndicators_}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{WAS\_Download\_AgroIndicators\_}}}
{\sphinxparam{\DUrole{n}{dir\_to\_save}}\sphinxparamcomma \sphinxparam{\DUrole{n}{variables}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{area}}\sphinxparamcomma \sphinxparam{\DUrole{n}{seas}\DUrole{o}{=}\DUrole{default_value}{{[}\textquotesingle{}01\textquotesingle{}, \textquotesingle{}02\textquotesingle{}, \textquotesingle{}03\textquotesingle{}{]}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{force\_download}\DUrole{o}{=}\DUrole{default_value}{False}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Download agro\sphinxhyphen{}meteorological indicators for specified variables, years, and months.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dir\_to\_save}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} Directory to save the downloaded files.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{variables}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}) \textendash{} List of shorthand variables to download (e.g., {[}“AGRO.PRCP”, “AGRO.TMAX”{]}).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Start year for the data to download.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} End year for the data to download.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{area}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}) \textendash{} Bounding box as {[}North, West, South, East{]} for clipping.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{seas}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}) \textendash{} List of month strings representing the season (e.g., {[}“01”, “02”, “03”{]}\sphinxhyphen{} for JanFebMar).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{force\_download}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}) \textendash{} If True, forces download even if file exists.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{WAS\_Download\_AgroIndicators\_daily() (wass2s.was\_download.WAS\_Download method)@\spxentry{WAS\_Download\_AgroIndicators\_daily()}\spxextra{wass2s.was\_download.WAS\_Download method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_download.WAS_Download.WAS_Download_AgroIndicators_daily}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{WAS\_Download\_AgroIndicators\_daily}}}
{\sphinxparam{\DUrole{n}{dir\_to\_save}}\sphinxparamcomma \sphinxparam{\DUrole{n}{variables}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{area}}\sphinxparamcomma \sphinxparam{\DUrole{n}{force\_download}\DUrole{o}{=}\DUrole{default_value}{False}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Download daily agro\sphinxhyphen{}meteorological indicators for specified variables and years.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dir\_to\_save}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} Directory to save the downloaded files.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{variables}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}) \textendash{} List of shorthand variables to download (e.g., {[}“AGRO.PRCP”, “AGRO.TMAX”{]}).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Start year for the data to download.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} End year for the data to download.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{area}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}) \textendash{} Bounding box as {[}North, West, South, East{]} for clipping.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{force\_download}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}) \textendash{} If True, forces download even if file exists.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{WAS\_Download\_CHIRPSv3() (wass2s.was\_download.WAS\_Download method)@\spxentry{WAS\_Download\_CHIRPSv3()}\spxextra{wass2s.was\_download.WAS\_Download method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_download.WAS_Download.WAS_Download_CHIRPSv3}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{WAS\_Download\_CHIRPSv3}}}
{\sphinxparam{\DUrole{n}{dir\_to\_save}}\sphinxparamcomma \sphinxparam{\DUrole{n}{variables}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{area}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{season\_months}\DUrole{o}{=}\DUrole{default_value}{{[}\textquotesingle{}03\textquotesingle{}, \textquotesingle{}04\textquotesingle{}, \textquotesingle{}05\textquotesingle{}{]}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{force\_download}\DUrole{o}{=}\DUrole{default_value}{False}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Download CHIRPS v3.0 monthly precipitation for a specified cross\sphinxhyphen{}year season
from year\_start to year\_end, optionally clipped to ‘area’,
and aggregate them into a single NetCDF file.

\end{fulllineitems}

\index{WAS\_Download\_Models() (wass2s.was\_download.WAS\_Download method)@\spxentry{WAS\_Download\_Models()}\spxextra{wass2s.was\_download.WAS\_Download method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_download.WAS_Download.WAS_Download_Models}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{WAS\_Download\_Models}}}
{\sphinxparam{\DUrole{n}{dir\_to\_save}}\sphinxparamcomma \sphinxparam{\DUrole{n}{center\_variable}}\sphinxparamcomma \sphinxparam{\DUrole{n}{month\_of\_initialization}}\sphinxparamcomma \sphinxparam{\DUrole{n}{lead\_time}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year\_start\_hindcast}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year\_end\_hindcast}}\sphinxparamcomma \sphinxparam{\DUrole{n}{area}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year\_forecast}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{ensemble\_mean}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{force\_download}\DUrole{o}{=}\DUrole{default_value}{False}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Download seasonal forecast model data for specified center\sphinxhyphen{}variable combinations, initialization month, lead times, and years.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dir\_to\_save}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} Directory to save the downloaded files.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{center\_variable}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}) \textendash{} List of center\sphinxhyphen{}variable identifiers (e.g., {[}“ECMWF\_51.PRCP”, “UKMO\_602.TEMP”{]}).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{month\_of\_initialization}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Initialization month as an integer (1\sphinxhyphen{}12).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{lead\_time}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}) \textendash{} List of lead times in months.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{year\_start\_hindcast}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Start year for hindcast data.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{year\_end\_hindcast}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} End year for hindcast data.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{area}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}) \textendash{} Bounding box as {[}North, West, South, East{]} for clipping.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{year\_forecast}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Forecast year if downloading forecast data. Defaults to None.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mean}} (\sphinxstyleliteralemphasis{\sphinxupquote{ensemble}}) \textendash{} it’s can be median, mean or None. Defaults to None.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{force\_download}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}) \textendash{} If True, forces download even if file exists.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{WAS\_Download\_Models\_Daily() (wass2s.was\_download.WAS\_Download method)@\spxentry{WAS\_Download\_Models\_Daily()}\spxextra{wass2s.was\_download.WAS\_Download method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_download.WAS_Download.WAS_Download_Models_Daily}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{WAS\_Download\_Models\_Daily}}}
{\sphinxparam{\DUrole{n}{dir\_to\_save}}\sphinxparamcomma \sphinxparam{\DUrole{n}{center\_variable}}\sphinxparamcomma \sphinxparam{\DUrole{n}{month\_of\_initialization}}\sphinxparamcomma \sphinxparam{\DUrole{n}{day\_of\_initialization}}\sphinxparamcomma \sphinxparam{\DUrole{n}{leadtime\_hour}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year\_start\_hindcast}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year\_end\_hindcast}}\sphinxparamcomma \sphinxparam{\DUrole{n}{area}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year\_forecast}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{ensemble\_mean}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{force\_download}\DUrole{o}{=}\DUrole{default_value}{False}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Download daily/sub\sphinxhyphen{}daily seasonal forecast model data (original)
using ‘seasonal\sphinxhyphen{}original\sphinxhyphen{}single\sphinxhyphen{}levels’ from the CDS.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dir\_to\_save}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{Path}}) \textendash{} Directory to save the downloaded files.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{center\_variable}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}) \textendash{} Each element e.g. “ECMWF\_51.PRCP”
\sphinxhyphen{} left side of ‘.’ is model (ECMWF\_51),
\sphinxhyphen{} right side is variable short code (PRCP).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{month\_of\_initialization}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Initialization month (1\sphinxhyphen{}12).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{day\_of\_initialization}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Initialization day (1\sphinxhyphen{}31).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{leadtime\_hour}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}\sphinxstyleliteralemphasis{\sphinxupquote{ of }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} e.g. {[}“24”, “48”, …, “5160”{]}.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{year\_start\_hindcast}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Start year for hindcast data.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{year\_end\_hindcast}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} End year for hindcast data.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{area}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}) \textendash{} Bounding box as {[}North, West, South, East{]}.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{year\_forecast}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} If provided, downloads that single
forecast year. Otherwise downloads hindcast for the specified range.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{ensemble\_mean}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} e.g. “mean”, “median”, or None.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{force\_download}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}) \textendash{} Force download if True, even if file exists.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{WAS\_Download\_Reanalysis() (wass2s.was\_download.WAS\_Download method)@\spxentry{WAS\_Download\_Reanalysis()}\spxextra{wass2s.was\_download.WAS\_Download method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_download.WAS_Download.WAS_Download_Reanalysis}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{WAS\_Download\_Reanalysis}}}
{\sphinxparam{\DUrole{n}{dir\_to\_save}}\sphinxparamcomma \sphinxparam{\DUrole{n}{center\_variable}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{area}}\sphinxparamcomma \sphinxparam{\DUrole{n}{seas}\DUrole{o}{=}\DUrole{default_value}{{[}\textquotesingle{}01\textquotesingle{}, \textquotesingle{}02\textquotesingle{}, \textquotesingle{}03\textquotesingle{}{]}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{force\_download}\DUrole{o}{=}\DUrole{default_value}{False}}\sphinxparamcomma \sphinxparam{\DUrole{n}{run\_avg}\DUrole{o}{=}\DUrole{default_value}{3}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Download reanalysis data for specified center\sphinxhyphen{}variable combinations, years, and months,
handling cross\sphinxhyphen{}year seasons (e.g., NDJ).

\end{fulllineitems}

\index{WAS\_Download\_Reanalysis\_() (wass2s.was\_download.WAS\_Download method)@\spxentry{WAS\_Download\_Reanalysis\_()}\spxextra{wass2s.was\_download.WAS\_Download method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_download.WAS_Download.WAS_Download_Reanalysis_}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{WAS\_Download\_Reanalysis\_}}}
{\sphinxparam{\DUrole{n}{dir\_to\_save}}\sphinxparamcomma \sphinxparam{\DUrole{n}{center\_variable}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{area}}\sphinxparamcomma \sphinxparam{\DUrole{n}{seas}\DUrole{o}{=}\DUrole{default_value}{{[}\textquotesingle{}01\textquotesingle{}, \textquotesingle{}02\textquotesingle{}, \textquotesingle{}03\textquotesingle{}{]}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{force\_download}\DUrole{o}{=}\DUrole{default_value}{False}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Download reanalysis data for specified center\sphinxhyphen{}variable combinations, years, and months.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dir\_to\_save}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} Directory to save the downloaded files.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{center\_variable}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}) \textendash{} List of center\sphinxhyphen{}variable identifiers (e.g., {[}“ERA5.PRCP”, “MERRA2.TEMP”{]}).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Start year for the data to download.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} End year for the data to download.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{area}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}) \textendash{} Bounding box as {[}North, West, South, East{]} for clipping.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{seas}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}) \textendash{} List of month strings representing the season (e.g., {[}“01”, “02”, “03”{]} for JanFebMar).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{force\_download}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}) \textendash{} If True, forces download even if file exists.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{days\_in\_month() (wass2s.was\_download.WAS\_Download method)@\spxentry{days\_in\_month()}\spxextra{wass2s.was\_download.WAS\_Download method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_download.WAS_Download.days_in_month}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{days\_in\_month}}}
{\sphinxparam{\DUrole{n}{year}}\sphinxparamcomma \sphinxparam{\DUrole{n}{month}}}
{}
\pysigstopsignatures
\end{fulllineitems}

\index{download\_nmme\_txt\_with\_progress() (wass2s.was\_download.WAS\_Download method)@\spxentry{download\_nmme\_txt\_with\_progress()}\spxextra{wass2s.was\_download.WAS\_Download method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_download.WAS_Download.download_nmme_txt_with_progress}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{download\_nmme\_txt\_with\_progress}}}
{\sphinxparam{\DUrole{n}{url}}\sphinxparamcomma \sphinxparam{\DUrole{n}{file\_path}}\sphinxparamcomma \sphinxparam{\DUrole{n}{chunk\_size}\DUrole{o}{=}\DUrole{default_value}{1024}}}
{}
\pysigstopsignatures
\end{fulllineitems}

\index{parse\_cpt\_data\_optimized() (wass2s.was\_download.WAS\_Download method)@\spxentry{parse\_cpt\_data\_optimized()}\spxextra{wass2s.was\_download.WAS\_Download method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_download.WAS_Download.parse_cpt_data_optimized}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{parse\_cpt\_data\_optimized}}}
{\sphinxparam{\DUrole{n}{file\_path}}}
{}
\pysigstopsignatures
\end{fulllineitems}


\end{fulllineitems}

\index{plot\_map() (in module wass2s.was\_download)@\spxentry{plot\_map()}\spxextra{in module wass2s.was\_download}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_download.plot_map}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{wass2s.was\_download.}}\sphinxbfcode{\sphinxupquote{plot\_map}}}
{\sphinxparam{\DUrole{n}{extent}}\sphinxparamcomma \sphinxparam{\DUrole{n}{title}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}Map\textquotesingle{}}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Plots a map with specified geographic extent.

\sphinxAtStartPar
Parameters:
\sphinxhyphen{} extent: list of float, specifying {[}west, east, south, north{]}
\sphinxhyphen{} title: str, title of the map

\end{fulllineitems}



\subsection{wass2s.was\_compute\_predictand module}
\label{\detokenize{api:module-wass2s.was_compute_predictand}}\label{\detokenize{api:wass2s-was-compute-predictand-module}}\index{module@\spxentry{module}!wass2s.was\_compute\_predictand@\spxentry{wass2s.was\_compute\_predictand}}\index{wass2s.was\_compute\_predictand@\spxentry{wass2s.was\_compute\_predictand}!module@\spxentry{module}}\index{WAS\_compute\_HWSDI (class in wass2s.was\_compute\_predictand)@\spxentry{WAS\_compute\_HWSDI}\spxextra{class in wass2s.was\_compute\_predictand}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_compute_HWSDI}}
\pysigstartsignatures
\pysigline
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_compute\_predictand.}}\sphinxbfcode{\sphinxupquote{WAS\_compute\_HWSDI}}}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
A class to compute the Heat Wave Severity Duration Index (HWSDI),
including calculating TXin90 (90th percentile of daily max temperature)
and annual counts of heatwave days with at least 6 consecutive hot days.
\index{calculate\_TXin90() (wass2s.was\_compute\_predictand.WAS\_compute\_HWSDI static method)@\spxentry{calculate\_TXin90()}\spxextra{wass2s.was\_compute\_predictand.WAS\_compute\_HWSDI static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_compute_HWSDI.calculate_TXin90}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_TXin90}}}
{\sphinxparam{\DUrole{n}{temperature\_data}}\sphinxparamcomma \sphinxparam{\DUrole{n}{base\_period\_start}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}1961\textquotesingle{}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{base\_period\_end}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}1990\textquotesingle{}}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Calculate the daily 90th percentile temperature (TXin90) centered on a 5\sphinxhyphen{}day window
for each calendar day based on the base period.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{temperature\_data}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Daily maximum temperature with time dimension.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{base\_period\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Start year of the base period (default is ‘1961’).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{base\_period\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} End year of the base period (default is ‘1990’).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
TXin90 for each day of the year.

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{compute() (wass2s.was\_compute\_predictand.WAS\_compute\_HWSDI method)@\spxentry{compute()}\spxextra{wass2s.was\_compute\_predictand.WAS\_compute\_HWSDI method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_compute_HWSDI.compute}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute}}}
{\sphinxparam{\DUrole{n}{temperature\_data}}\sphinxparamcomma \sphinxparam{\DUrole{n}{base\_period\_start}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}1961\textquotesingle{}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{base\_period\_end}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}1990\textquotesingle{}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{nb\_cores}\DUrole{o}{=}\DUrole{default_value}{4}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute the Heat Wave Severity Duration Index (HWSDI) for each pixel
in a given daily temperature DataArray.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{temperature\_data}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Daily maximum temperature data, coords = (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{base\_period\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Start year of the base period for TXin90 calculation (default is ‘1961’).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{base\_period\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} End year of the base period for TXin90 calculation (default is ‘1990’).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{nb\_cores}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Number of parallel processes to use (default is 4).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
HWSDI computed for each pixel.

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{count\_hot\_days() (wass2s.was\_compute\_predictand.WAS\_compute\_HWSDI method)@\spxentry{count\_hot\_days()}\spxextra{wass2s.was\_compute\_predictand.WAS\_compute\_HWSDI method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_compute_HWSDI.count_hot_days}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{count\_hot\_days}}}
{\sphinxparam{\DUrole{n}{temperature\_data}}\sphinxparamcomma \sphinxparam{\DUrole{n}{TXin90}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Count the number of days per year with at least 6 consecutive days
where daily maximum temperature is above the 90th percentile.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{temperature\_data}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Daily maximum temperature with time dimension.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{TXin90}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} 90th percentile temperature for each day of the year.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
Annual count of hot days.

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{WAS\_compute\_HWSDI\_Seasonal (class in wass2s.was\_compute\_predictand)@\spxentry{WAS\_compute\_HWSDI\_Seasonal}\spxextra{class in wass2s.was\_compute\_predictand}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_compute_HWSDI_Seasonal}}
\pysigstartsignatures
\pysigline
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_compute\_predictand.}}\sphinxbfcode{\sphinxupquote{WAS\_compute\_HWSDI\_Seasonal}}}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
A class to compute the Heat Wave Severity Duration Index (HWSDI) for a given season.
\index{calculate\_TXin90() (wass2s.was\_compute\_predictand.WAS\_compute\_HWSDI\_Seasonal static method)@\spxentry{calculate\_TXin90()}\spxextra{wass2s.was\_compute\_predictand.WAS\_compute\_HWSDI\_Seasonal static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_compute_HWSDI_Seasonal.calculate_TXin90}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_TXin90}}}
{\sphinxparam{\DUrole{n}{temperature\_data}}\sphinxparamcomma \sphinxparam{\DUrole{n}{base\_period\_start}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}1961\textquotesingle{}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{base\_period\_end}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}1990\textquotesingle{}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{season}\DUrole{o}{=}\DUrole{default_value}{{[}6, 7, 8{]}}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Calculate the daily 90th percentile temperature (TXin90) for each calendar day
based on the base period, but only considering the specified season.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{temperature\_data}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Daily maximum temperature with time dimension.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{base\_period\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Start year of the base period (default is ‘1961’).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{base\_period\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} End year of the base period (default is ‘1990’).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{season}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} List of months to include in the calculation (default is {[}6, 7, 8{]} for JJA).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
TXin90 for each day of the selected season.

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{compute() (wass2s.was\_compute\_predictand.WAS\_compute\_HWSDI\_Seasonal method)@\spxentry{compute()}\spxextra{wass2s.was\_compute\_predictand.WAS\_compute\_HWSDI\_Seasonal method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_compute_HWSDI_Seasonal.compute}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute}}}
{\sphinxparam{\DUrole{n}{temperature\_data}}\sphinxparamcomma \sphinxparam{\DUrole{n}{base\_period\_start}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}1961\textquotesingle{}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{base\_period\_end}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}1990\textquotesingle{}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{nb\_cores}\DUrole{o}{=}\DUrole{default_value}{4}}\sphinxparamcomma \sphinxparam{\DUrole{n}{season}\DUrole{o}{=}\DUrole{default_value}{{[}6, 7, 8{]}}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute the HWSDI for each pixel in a given daily temperature DataArray for a specific season.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{temperature\_data}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Daily maximum temperature data, coords = (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{base\_period\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Start year of the base period for TXin90 calculation (default is ‘1961’).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{base\_period\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} End year of the base period for TXin90 calculation (default is ‘1990’).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{nb\_cores}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Number of parallel processes to use (default is 4).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{season}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} List of months to include in the calculation (default is {[}6, 7, 8{]} for JJA).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
HWSDI computed for each pixel for the given season.

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{count\_hot\_days() (wass2s.was\_compute\_predictand.WAS\_compute\_HWSDI\_Seasonal method)@\spxentry{count\_hot\_days()}\spxextra{wass2s.was\_compute\_predictand.WAS\_compute\_HWSDI\_Seasonal method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_compute_HWSDI_Seasonal.count_hot_days}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{count\_hot\_days}}}
{\sphinxparam{\DUrole{n}{temperature\_data}}\sphinxparamcomma \sphinxparam{\DUrole{n}{TXin90}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Count the number of days per season with at least 6 consecutive days
where daily maximum temperature is above the 90th percentile.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{temperature\_data}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Daily maximum temperature with time dimension.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{TXin90}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} 90th percentile temperature for each day of the year.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
Seasonal count of hot days.

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{WAS\_compute\_HWSDI\_monthly (class in wass2s.was\_compute\_predictand)@\spxentry{WAS\_compute\_HWSDI\_monthly}\spxextra{class in wass2s.was\_compute\_predictand}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_compute_HWSDI_monthly}}
\pysigstartsignatures
\pysigline
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_compute\_predictand.}}\sphinxbfcode{\sphinxupquote{WAS\_compute\_HWSDI\_monthly}}}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
A class to compute the Heat Wave Severity Duration Index (HWSDI) \sphinxstylestrong{monthly},
calculating TXin90 (90th percentile of daily max temperature) and counting heatwave days
for each month with at least 6 consecutive hot days.
\index{calculate\_TXin90() (wass2s.was\_compute\_predictand.WAS\_compute\_HWSDI\_monthly static method)@\spxentry{calculate\_TXin90()}\spxextra{wass2s.was\_compute\_predictand.WAS\_compute\_HWSDI\_monthly static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_compute_HWSDI_monthly.calculate_TXin90}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_TXin90}}}
{\sphinxparam{\DUrole{n}{temperature\_data}}\sphinxparamcomma \sphinxparam{\DUrole{n}{base\_period\_start}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}1961\textquotesingle{}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{base\_period\_end}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}1990\textquotesingle{}}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Calculate the monthly 90th percentile temperature (TXin90) centered on a 5\sphinxhyphen{}day window
for each calendar day based on the base period.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{temperature\_data}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Daily maximum temperature with time dimension.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{base\_period\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Start year of the base period (default is ‘1961’).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{base\_period\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} End year of the base period (default is ‘1990’).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
TXin90 for each month of the year.

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{compute() (wass2s.was\_compute\_predictand.WAS\_compute\_HWSDI\_monthly method)@\spxentry{compute()}\spxextra{wass2s.was\_compute\_predictand.WAS\_compute\_HWSDI\_monthly method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_compute_HWSDI_monthly.compute}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute}}}
{\sphinxparam{\DUrole{n}{temperature\_data}}\sphinxparamcomma \sphinxparam{\DUrole{n}{base\_period\_start}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}1961\textquotesingle{}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{base\_period\_end}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}1990\textquotesingle{}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{nb\_cores}\DUrole{o}{=}\DUrole{default_value}{4}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute the Monthly Heat Wave Severity Duration Index (HWSDI)
for each pixel in a given daily temperature DataArray.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{temperature\_data}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Daily maximum temperature data, coords = (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{base\_period\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Start year of the base period for TXin90 calculation (default is ‘1961’).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{base\_period\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} End year of the base period for TXin90 calculation (default is ‘1990’).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{nb\_cores}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Number of parallel processes to use (default is 4).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
HWSDI computed for each pixel per month.

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{count\_hot\_days() (wass2s.was\_compute\_predictand.WAS\_compute\_HWSDI\_monthly method)@\spxentry{count\_hot\_days()}\spxextra{wass2s.was\_compute\_predictand.WAS\_compute\_HWSDI\_monthly method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_compute_HWSDI_monthly.count_hot_days}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{count\_hot\_days}}}
{\sphinxparam{\DUrole{n}{temperature\_data}}\sphinxparamcomma \sphinxparam{\DUrole{n}{TXin90}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Count the number of days per month with at least 6 consecutive days
where daily maximum temperature is above the 90th percentile.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{temperature\_data}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Daily maximum temperature with time dimension.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{TXin90}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} 90th percentile temperature for each month.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
Monthly count of hot days.

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{WAS\_compute\_cessation (class in wass2s.was\_compute\_predictand)@\spxentry{WAS\_compute\_cessation}\spxextra{class in wass2s.was\_compute\_predictand}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_compute_cessation}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_compute\_predictand.}}\sphinxbfcode{\sphinxupquote{WAS\_compute\_cessation}}}
{\sphinxparam{\DUrole{n}{user\_criteria}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
A class to compute cessation dates based on soil moisture balance for different
regions and criteria, leveraging parallel computation for efficiency.
\index{adjust\_duplicates() (wass2s.was\_compute\_predictand.WAS\_compute\_cessation static method)@\spxentry{adjust\_duplicates()}\spxextra{wass2s.was\_compute\_predictand.WAS\_compute\_cessation static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_compute_cessation.adjust_duplicates}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{adjust\_duplicates}}}
{\sphinxparam{\DUrole{n}{series}}\sphinxparamcomma \sphinxparam{\DUrole{n}{increment}\DUrole{o}{=}\DUrole{default_value}{1e\sphinxhyphen{}05}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
If any values in the Series repeat, nudge them by a tiny increment
so that all are unique (to avoid indexing collisions).

\end{fulllineitems}

\index{cessation\_function() (wass2s.was\_compute\_predictand.WAS\_compute\_cessation method)@\spxentry{cessation\_function()}\spxextra{wass2s.was\_compute\_predictand.WAS\_compute\_cessation method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_compute_cessation.cessation_function}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{cessation\_function}}}
{\sphinxparam{\DUrole{n}{x}}\sphinxparamcomma \sphinxparam{\DUrole{n}{ijour\_dem\_cal}}\sphinxparamcomma \sphinxparam{\DUrole{n}{idebut}}\sphinxparamcomma \sphinxparam{\DUrole{n}{ETP}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Cap\_ret\_maxi}}\sphinxparamcomma \sphinxparam{\DUrole{n}{irch\_fin}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute cessation date using soil moisture balance criteria.

\end{fulllineitems}

\index{compute() (wass2s.was\_compute\_predictand.WAS\_compute\_cessation method)@\spxentry{compute()}\spxextra{wass2s.was\_compute\_predictand.WAS\_compute\_cessation method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_compute_cessation.compute}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute}}}
{\sphinxparam{\DUrole{n}{daily\_data}}\sphinxparamcomma \sphinxparam{\DUrole{n}{nb\_cores}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute cessation dates for each pixel using criteria based on regions.

\end{fulllineitems}

\index{compute\_insitu() (wass2s.was\_compute\_predictand.WAS\_compute\_cessation method)@\spxentry{compute\_insitu()}\spxextra{wass2s.was\_compute\_predictand.WAS\_compute\_cessation method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_compute_cessation.compute_insitu}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_insitu}}}
{\sphinxparam{\DUrole{n}{daily\_df}}}
{}
\pysigstopsignatures
\end{fulllineitems}

\index{day\_of\_year() (wass2s.was\_compute\_predictand.WAS\_compute\_cessation static method)@\spxentry{day\_of\_year()}\spxextra{wass2s.was\_compute\_predictand.WAS\_compute\_cessation static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_compute_cessation.day_of_year}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{day\_of\_year}}}
{\sphinxparam{\DUrole{n}{i}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dem\_rech1}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Given a year ‘i’ and a month\sphinxhyphen{}day string ‘dem\_rech1’ (e.g., ‘07\sphinxhyphen{}23’),
return the 1\sphinxhyphen{}based day of the year.

\end{fulllineitems}

\index{default\_criteria (wass2s.was\_compute\_predictand.WAS\_compute\_cessation attribute)@\spxentry{default\_criteria}\spxextra{wass2s.was\_compute\_predictand.WAS\_compute\_cessation attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_compute_cessation.default_criteria}}
\pysigstartsignatures
\pysigline
{\sphinxbfcode{\sphinxupquote{default\_criteria}}\sphinxbfcode{\sphinxupquote{\DUrole{w}{ }\DUrole{p}{=}\DUrole{w}{ }\{0: \{\textquotesingle{}Cap\_ret\_maxi\textquotesingle{}: 70, \textquotesingle{}ETP\textquotesingle{}: 5.0, \textquotesingle{}date\_dry\_soil\textquotesingle{}: \textquotesingle{}01\sphinxhyphen{}01\textquotesingle{}, \textquotesingle{}end\_search\textquotesingle{}: \textquotesingle{}09\sphinxhyphen{}30\textquotesingle{}, \textquotesingle{}start\_search\textquotesingle{}: \textquotesingle{}09\sphinxhyphen{}01\textquotesingle{}, \textquotesingle{}zone\_name\textquotesingle{}: \textquotesingle{}Sahel100\_0mm\textquotesingle{}\}, 1: \{\textquotesingle{}Cap\_ret\_maxi\textquotesingle{}: 70, \textquotesingle{}ETP\textquotesingle{}: 5.0, \textquotesingle{}date\_dry\_soil\textquotesingle{}: \textquotesingle{}01\sphinxhyphen{}01\textquotesingle{}, \textquotesingle{}end\_search\textquotesingle{}: \textquotesingle{}10\sphinxhyphen{}05\textquotesingle{}, \textquotesingle{}start\_search\textquotesingle{}: \textquotesingle{}09\sphinxhyphen{}01\textquotesingle{}, \textquotesingle{}zone\_name\textquotesingle{}: \textquotesingle{}Sahel200\_100mm\textquotesingle{}\}, 2: \{\textquotesingle{}Cap\_ret\_maxi\textquotesingle{}: 70, \textquotesingle{}ETP\textquotesingle{}: 5.0, \textquotesingle{}date\_dry\_soil\textquotesingle{}: \textquotesingle{}01\sphinxhyphen{}01\textquotesingle{}, \textquotesingle{}end\_search\textquotesingle{}: \textquotesingle{}11\sphinxhyphen{}10\textquotesingle{}, \textquotesingle{}start\_search\textquotesingle{}: \textquotesingle{}09\sphinxhyphen{}01\textquotesingle{}, \textquotesingle{}zone\_name\textquotesingle{}: \textquotesingle{}Sahel400\_200mm\textquotesingle{}\}, 3: \{\textquotesingle{}Cap\_ret\_maxi\textquotesingle{}: 70, \textquotesingle{}ETP\textquotesingle{}: 5.0, \textquotesingle{}date\_dry\_soil\textquotesingle{}: \textquotesingle{}01\sphinxhyphen{}01\textquotesingle{}, \textquotesingle{}end\_search\textquotesingle{}: \textquotesingle{}11\sphinxhyphen{}15\textquotesingle{}, \textquotesingle{}start\_search\textquotesingle{}: \textquotesingle{}09\sphinxhyphen{}15\textquotesingle{}, \textquotesingle{}zone\_name\textquotesingle{}: \textquotesingle{}Sahel600\_400mm\textquotesingle{}\}, 4: \{\textquotesingle{}Cap\_ret\_maxi\textquotesingle{}: 70, \textquotesingle{}ETP\textquotesingle{}: 4.5, \textquotesingle{}date\_dry\_soil\textquotesingle{}: \textquotesingle{}01\sphinxhyphen{}01\textquotesingle{}, \textquotesingle{}end\_search\textquotesingle{}: \textquotesingle{}11\sphinxhyphen{}30\textquotesingle{}, \textquotesingle{}start\_search\textquotesingle{}: \textquotesingle{}10\sphinxhyphen{}01\textquotesingle{}, \textquotesingle{}zone\_name\textquotesingle{}: \textquotesingle{}Soudan\textquotesingle{}\}, 5: \{\textquotesingle{}Cap\_ret\_maxi\textquotesingle{}: 70, \textquotesingle{}ETP\textquotesingle{}: 4.0, \textquotesingle{}date\_dry\_soil\textquotesingle{}: \textquotesingle{}01\sphinxhyphen{}01\textquotesingle{}, \textquotesingle{}end\_search\textquotesingle{}: \textquotesingle{}12\sphinxhyphen{}01\textquotesingle{}, \textquotesingle{}start\_search\textquotesingle{}: \textquotesingle{}10\sphinxhyphen{}15\textquotesingle{}, \textquotesingle{}zone\_name\textquotesingle{}: \textquotesingle{}Golfe\_Of\_Guinea\textquotesingle{}\}\}}}}
\pysigstopsignatures
\end{fulllineitems}

\index{rainf\_zone() (wass2s.was\_compute\_predictand.WAS\_compute\_cessation method)@\spxentry{rainf\_zone()}\spxextra{wass2s.was\_compute\_predictand.WAS\_compute\_cessation method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_compute_cessation.rainf_zone}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{rainf\_zone}}}
{\sphinxparam{\DUrole{n}{daily\_data}}}
{}
\pysigstopsignatures
\end{fulllineitems}

\index{transform\_cdt() (wass2s.was\_compute\_predictand.WAS\_compute\_cessation static method)@\spxentry{transform\_cdt()}\spxextra{wass2s.was\_compute\_predictand.WAS\_compute\_cessation static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_compute_cessation.transform_cdt}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{transform\_cdt}}}
{\sphinxparam{\DUrole{n}{df}}}
{}
\pysigstopsignatures\begin{description}
\sphinxlineitem{Transform a DataFrame with:}\begin{itemize}
\item {} 
\sphinxAtStartPar
Row 0 = LON

\item {} 
\sphinxAtStartPar
Row 1 = LAT

\item {} 
\sphinxAtStartPar
Row 2 = ELEV

\item {} 
\sphinxAtStartPar
Rows 3+ = daily data (or any date) with ‘ID’ column containing dates.

\end{itemize}

\end{description}

\sphinxAtStartPar
Returns an xarray DataArray with coords = (T, Y, X), variable = ‘Observation’.

\end{fulllineitems}


\end{fulllineitems}

\index{WAS\_compute\_cessation\_dry\_spell (class in wass2s.was\_compute\_predictand)@\spxentry{WAS\_compute\_cessation\_dry\_spell}\spxextra{class in wass2s.was\_compute\_predictand}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_compute_cessation_dry_spell}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_compute\_predictand.}}\sphinxbfcode{\sphinxupquote{WAS\_compute\_cessation\_dry\_spell}}}
{\sphinxparam{\DUrole{n}{user\_criteria}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
A class for computing the longest dry spell length
after the onset of a rainy season, based on user\sphinxhyphen{}defined criteria.
\index{adjust\_duplicates() (wass2s.was\_compute\_predictand.WAS\_compute\_cessation\_dry\_spell static method)@\spxentry{adjust\_duplicates()}\spxextra{wass2s.was\_compute\_predictand.WAS\_compute\_cessation\_dry\_spell static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_compute_cessation_dry_spell.adjust_duplicates}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{adjust\_duplicates}}}
{\sphinxparam{\DUrole{n}{series}}\sphinxparamcomma \sphinxparam{\DUrole{n}{increment}\DUrole{o}{=}\DUrole{default_value}{1e\sphinxhyphen{}05}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
If any values in the Series repeat, nudge them by a tiny increment
so that all are unique (to avoid indexing collisions).

\end{fulllineitems}

\index{compute() (wass2s.was\_compute\_predictand.WAS\_compute\_cessation\_dry\_spell method)@\spxentry{compute()}\spxextra{wass2s.was\_compute\_predictand.WAS\_compute\_cessation\_dry\_spell method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_compute_cessation_dry_spell.compute}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute}}}
{\sphinxparam{\DUrole{n}{daily\_data}}\sphinxparamcomma \sphinxparam{\DUrole{n}{nb\_cores}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute the longest dry spell length after the rainy season onset
for each pixel in the given daily rainfall DataArray, using different
criteria (both for onset and cessation) based on isohyet zones.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{daily\_data}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Daily rainfall data, coords = (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{nb\_cores}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Number of parallel processes (workers) to use.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
Array with the longest dry spell length per pixel.

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_insitu() (wass2s.was\_compute\_predictand.WAS\_compute\_cessation\_dry\_spell method)@\spxentry{compute\_insitu()}\spxextra{wass2s.was\_compute\_predictand.WAS\_compute\_cessation\_dry\_spell method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_compute_cessation_dry_spell.compute_insitu}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_insitu}}}
{\sphinxparam{\DUrole{n}{daily\_df}}}
{}
\pysigstopsignatures
\end{fulllineitems}

\index{day\_of\_year() (wass2s.was\_compute\_predictand.WAS\_compute\_cessation\_dry\_spell static method)@\spxentry{day\_of\_year()}\spxextra{wass2s.was\_compute\_predictand.WAS\_compute\_cessation\_dry\_spell static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_compute_cessation_dry_spell.day_of_year}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{day\_of\_year}}}
{\sphinxparam{\DUrole{n}{i}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dem\_rech1}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Convert year i and MM\sphinxhyphen{}DD string dem\_rech1 (e.g., ‘07\sphinxhyphen{}23’)
into a 1\sphinxhyphen{}based day of the year.

\end{fulllineitems}

\index{default\_criteria (wass2s.was\_compute\_predictand.WAS\_compute\_cessation\_dry\_spell attribute)@\spxentry{default\_criteria}\spxextra{wass2s.was\_compute\_predictand.WAS\_compute\_cessation\_dry\_spell attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_compute_cessation_dry_spell.default_criteria}}
\pysigstartsignatures
\pysigline
{\sphinxbfcode{\sphinxupquote{default\_criteria}}\sphinxbfcode{\sphinxupquote{\DUrole{w}{ }\DUrole{p}{=}\DUrole{w}{ }\{0: \{\textquotesingle{}Cap\_ret\_maxi\textquotesingle{}: 70, \textquotesingle{}ETP\textquotesingle{}: 5.0, \textquotesingle{}cumulative\textquotesingle{}: 10, \textquotesingle{}date\_dry\_soil\textquotesingle{}: \textquotesingle{}01\sphinxhyphen{}01\textquotesingle{}, \textquotesingle{}end\_search1\textquotesingle{}: \textquotesingle{}08\sphinxhyphen{}15\textquotesingle{}, \textquotesingle{}end\_search2\textquotesingle{}: \textquotesingle{}09\sphinxhyphen{}30\textquotesingle{}, \textquotesingle{}nbjour\textquotesingle{}: 40, \textquotesingle{}number\_dry\_days\textquotesingle{}: 25, \textquotesingle{}start\_search1\textquotesingle{}: \textquotesingle{}05\sphinxhyphen{}01\textquotesingle{}, \textquotesingle{}start\_search2\textquotesingle{}: \textquotesingle{}09\sphinxhyphen{}01\textquotesingle{}, \textquotesingle{}thrd\_rain\_day\textquotesingle{}: 0.85, \textquotesingle{}zone\_name\textquotesingle{}: \textquotesingle{}Sahel100\_0mm\textquotesingle{}\}, 1: \{\textquotesingle{}Cap\_ret\_maxi\textquotesingle{}: 70, \textquotesingle{}ETP\textquotesingle{}: 5.0, \textquotesingle{}cumulative\textquotesingle{}: 15, \textquotesingle{}date\_dry\_soil\textquotesingle{}: \textquotesingle{}01\sphinxhyphen{}01\textquotesingle{}, \textquotesingle{}end\_search1\textquotesingle{}: \textquotesingle{}08\sphinxhyphen{}15\textquotesingle{}, \textquotesingle{}end\_search2\textquotesingle{}: \textquotesingle{}10\sphinxhyphen{}05\textquotesingle{}, \textquotesingle{}nbjour\textquotesingle{}: 40, \textquotesingle{}number\_dry\_days\textquotesingle{}: 25, \textquotesingle{}start\_search1\textquotesingle{}: \textquotesingle{}05\sphinxhyphen{}15\textquotesingle{}, \textquotesingle{}start\_search2\textquotesingle{}: \textquotesingle{}09\sphinxhyphen{}01\textquotesingle{}, \textquotesingle{}thrd\_rain\_day\textquotesingle{}: 0.85, \textquotesingle{}zone\_name\textquotesingle{}: \textquotesingle{}Sahel200\_100mm\textquotesingle{}\}, 2: \{\textquotesingle{}Cap\_ret\_maxi\textquotesingle{}: 70, \textquotesingle{}ETP\textquotesingle{}: 5.0, \textquotesingle{}cumulative\textquotesingle{}: 15, \textquotesingle{}date\_dry\_soil\textquotesingle{}: \textquotesingle{}01\sphinxhyphen{}01\textquotesingle{}, \textquotesingle{}end\_search1\textquotesingle{}: \textquotesingle{}07\sphinxhyphen{}31\textquotesingle{}, \textquotesingle{}end\_search2\textquotesingle{}: \textquotesingle{}11\sphinxhyphen{}10\textquotesingle{}, \textquotesingle{}nbjour\textquotesingle{}: 40, \textquotesingle{}number\_dry\_days\textquotesingle{}: 20, \textquotesingle{}start\_search1\textquotesingle{}: \textquotesingle{}05\sphinxhyphen{}01\textquotesingle{}, \textquotesingle{}start\_search2\textquotesingle{}: \textquotesingle{}09\sphinxhyphen{}01\textquotesingle{}, \textquotesingle{}thrd\_rain\_day\textquotesingle{}: 0.85, \textquotesingle{}zone\_name\textquotesingle{}: \textquotesingle{}Sahel400\_200mm\textquotesingle{}\}, 3: \{\textquotesingle{}Cap\_ret\_maxi\textquotesingle{}: 70, \textquotesingle{}ETP\textquotesingle{}: 5.0, \textquotesingle{}cumulative\textquotesingle{}: 20, \textquotesingle{}date\_dry\_soil\textquotesingle{}: \textquotesingle{}01\sphinxhyphen{}01\textquotesingle{}, \textquotesingle{}end\_search1\textquotesingle{}: \textquotesingle{}07\sphinxhyphen{}31\textquotesingle{}, \textquotesingle{}end\_search2\textquotesingle{}: \textquotesingle{}11\sphinxhyphen{}15\textquotesingle{}, \textquotesingle{}nbjour\textquotesingle{}: 45, \textquotesingle{}number\_dry\_days\textquotesingle{}: 20, \textquotesingle{}start\_search1\textquotesingle{}: \textquotesingle{}03\sphinxhyphen{}15\textquotesingle{}, \textquotesingle{}start\_search2\textquotesingle{}: \textquotesingle{}09\sphinxhyphen{}15\textquotesingle{}, \textquotesingle{}thrd\_rain\_day\textquotesingle{}: 0.85, \textquotesingle{}zone\_name\textquotesingle{}: \textquotesingle{}Sahel600\_400mm\textquotesingle{}\}, 4: \{\textquotesingle{}Cap\_ret\_maxi\textquotesingle{}: 70, \textquotesingle{}ETP\textquotesingle{}: 4.5, \textquotesingle{}cumulative\textquotesingle{}: 20, \textquotesingle{}date\_dry\_soil\textquotesingle{}: \textquotesingle{}01\sphinxhyphen{}01\textquotesingle{}, \textquotesingle{}end\_search1\textquotesingle{}: \textquotesingle{}07\sphinxhyphen{}31\textquotesingle{}, \textquotesingle{}end\_search2\textquotesingle{}: \textquotesingle{}11\sphinxhyphen{}30\textquotesingle{}, \textquotesingle{}nbjour\textquotesingle{}: 50, \textquotesingle{}number\_dry\_days\textquotesingle{}: 10, \textquotesingle{}start\_search1\textquotesingle{}: \textquotesingle{}03\sphinxhyphen{}15\textquotesingle{}, \textquotesingle{}start\_search2\textquotesingle{}: \textquotesingle{}10\sphinxhyphen{}01\textquotesingle{}, \textquotesingle{}thrd\_rain\_day\textquotesingle{}: 0.85, \textquotesingle{}zone\_name\textquotesingle{}: \textquotesingle{}Soudan\textquotesingle{}\}, 5: \{\textquotesingle{}Cap\_ret\_maxi\textquotesingle{}: 70, \textquotesingle{}ETP\textquotesingle{}: 4.0, \textquotesingle{}cumulative\textquotesingle{}: 20, \textquotesingle{}date\_dry\_soil\textquotesingle{}: \textquotesingle{}01\sphinxhyphen{}01\textquotesingle{}, \textquotesingle{}end\_search1\textquotesingle{}: \textquotesingle{}06\sphinxhyphen{}15\textquotesingle{}, \textquotesingle{}end\_search2\textquotesingle{}: \textquotesingle{}12\sphinxhyphen{}01\textquotesingle{}, \textquotesingle{}nbjour\textquotesingle{}: 50, \textquotesingle{}number\_dry\_days\textquotesingle{}: 10, \textquotesingle{}start\_search1\textquotesingle{}: \textquotesingle{}02\sphinxhyphen{}01\textquotesingle{}, \textquotesingle{}start\_search2\textquotesingle{}: \textquotesingle{}10\sphinxhyphen{}15\textquotesingle{}, \textquotesingle{}thrd\_rain\_day\textquotesingle{}: 0.85, \textquotesingle{}zone\_name\textquotesingle{}: \textquotesingle{}Golfe\_Of\_Guinea\textquotesingle{}\}\}}}}
\pysigstopsignatures
\end{fulllineitems}

\index{dry\_spell\_cessation\_function() (wass2s.was\_compute\_predictand.WAS\_compute\_cessation\_dry\_spell method)@\spxentry{dry\_spell\_cessation\_function()}\spxextra{wass2s.was\_compute\_predictand.WAS\_compute\_cessation\_dry\_spell method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_compute_cessation_dry_spell.dry_spell_cessation_function}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{dry\_spell\_cessation\_function}}}
{\sphinxparam{\DUrole{n}{x}}\sphinxparamcomma \sphinxparam{\DUrole{n}{idebut1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{cumul}}\sphinxparamcomma \sphinxparam{\DUrole{n}{nbsec}}\sphinxparamcomma \sphinxparam{\DUrole{n}{jour\_pluvieux}}\sphinxparamcomma \sphinxparam{\DUrole{n}{irch\_fin1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{idebut2}}\sphinxparamcomma \sphinxparam{\DUrole{n}{ijour\_dem\_cal}}\sphinxparamcomma \sphinxparam{\DUrole{n}{ETP}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Cap\_ret\_maxi}}\sphinxparamcomma \sphinxparam{\DUrole{n}{irch\_fin2}}\sphinxparamcomma \sphinxparam{\DUrole{n}{nbjour}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Computes the longest dry spell length after the onset and
determines the cessation date (when soil water returns to 0)
based on water balance, then checks for a dry spell.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{x}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Daily rainfall or similar values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{idebut1}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Start index to begin searching for the onset.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{cumul}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} Cumulative rainfall threshold to trigger onset.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{nbsec}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Maximum number of dry days allowed in the sequence.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{jour\_pluvieux}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} Minimum rainfall to consider a day as rainy.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{irch\_fin1}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Maximum index limit for the onset search.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{idebut2}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Start index for the cessation search.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{ijour\_dem\_cal}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Start index from which the water balance is calculated.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{ETP}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} Daily evapotranspiration (mm).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Cap\_ret\_maxi}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} Maximum soil water retention capacity (mm).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{irch\_fin2}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Maximum index limit for the cessation search.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{nbjour}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Number of days after onset to check for the dry spell.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
Length of the longest dry spell sequence after onset and before soil water
returns to zero, or NaN if not found.

\sphinxlineitem{Return type}
\sphinxAtStartPar
float

\end{description}\end{quote}

\end{fulllineitems}

\index{rainf\_zone() (wass2s.was\_compute\_predictand.WAS\_compute\_cessation\_dry\_spell method)@\spxentry{rainf\_zone()}\spxextra{wass2s.was\_compute\_predictand.WAS\_compute\_cessation\_dry\_spell method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_compute_cessation_dry_spell.rainf_zone}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{rainf\_zone}}}
{\sphinxparam{\DUrole{n}{daily\_data}}}
{}
\pysigstopsignatures
\end{fulllineitems}

\index{transform\_cdt() (wass2s.was\_compute\_predictand.WAS\_compute\_cessation\_dry\_spell static method)@\spxentry{transform\_cdt()}\spxextra{wass2s.was\_compute\_predictand.WAS\_compute\_cessation\_dry\_spell static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_compute_cessation_dry_spell.transform_cdt}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{transform\_cdt}}}
{\sphinxparam{\DUrole{n}{df}}}
{}
\pysigstopsignatures\begin{description}
\sphinxlineitem{Transform a DataFrame with:}\begin{itemize}
\item {} 
\sphinxAtStartPar
Row 0 = LON

\item {} 
\sphinxAtStartPar
Row 1 = LAT

\item {} 
\sphinxAtStartPar
Row 2 = ELEV

\item {} 
\sphinxAtStartPar
Rows 3+ = daily data (or any date) with ‘ID’ column containing dates.

\end{itemize}

\end{description}

\sphinxAtStartPar
Returns an xarray DataArray with coords = (T, Y, X), variable = ‘Observation’.

\end{fulllineitems}


\end{fulllineitems}

\index{WAS\_compute\_onset (class in wass2s.was\_compute\_predictand)@\spxentry{WAS\_compute\_onset}\spxextra{class in wass2s.was\_compute\_predictand}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_compute_onset}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_compute\_predictand.}}\sphinxbfcode{\sphinxupquote{WAS\_compute\_onset}}}
{\sphinxparam{\DUrole{n}{user\_criteria}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
A class that encapsulates methods for transforming precipitation data
from different formats (CPT, CDT) and computing onset dates based on
rainfall criteria.
\index{adjust\_duplicates() (wass2s.was\_compute\_predictand.WAS\_compute\_onset static method)@\spxentry{adjust\_duplicates()}\spxextra{wass2s.was\_compute\_predictand.WAS\_compute\_onset static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_compute_onset.adjust_duplicates}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{adjust\_duplicates}}}
{\sphinxparam{\DUrole{n}{series}}\sphinxparamcomma \sphinxparam{\DUrole{n}{increment}\DUrole{o}{=}\DUrole{default_value}{1e\sphinxhyphen{}05}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
If any values in the Series repeat, nudge them by a tiny increment
so that all are unique (to avoid indexing collisions).

\end{fulllineitems}

\index{compute() (wass2s.was\_compute\_predictand.WAS\_compute\_onset method)@\spxentry{compute()}\spxextra{wass2s.was\_compute\_predictand.WAS\_compute\_onset method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_compute_onset.compute}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute}}}
{\sphinxparam{\DUrole{n}{daily\_data}}\sphinxparamcomma \sphinxparam{\DUrole{n}{nb\_cores}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute onset dates for each pixel in a given daily rainfall DataArray
using different criteria based on isohyet zones.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{daily\_data}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Daily rainfall data, coords = (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{nb\_cores}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Number of parallel processes to use.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
Array with onset dates computed per pixel.

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_insitu() (wass2s.was\_compute\_predictand.WAS\_compute\_onset method)@\spxentry{compute\_insitu()}\spxextra{wass2s.was\_compute\_predictand.WAS\_compute\_onset method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_compute_onset.compute_insitu}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_insitu}}}
{\sphinxparam{\DUrole{n}{daily\_df}}}
{}
\pysigstopsignatures
\end{fulllineitems}

\index{day\_of\_year() (wass2s.was\_compute\_predictand.WAS\_compute\_onset static method)@\spxentry{day\_of\_year()}\spxextra{wass2s.was\_compute\_predictand.WAS\_compute\_onset static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_compute_onset.day_of_year}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{day\_of\_year}}}
{\sphinxparam{\DUrole{n}{i}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dem\_rech1}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Given a year ‘i’ and a month\sphinxhyphen{}day string ‘dem\_rech1’ (e.g., ‘07\sphinxhyphen{}23’),
return the day of the year (1\sphinxhyphen{}based).

\end{fulllineitems}

\index{default\_criteria (wass2s.was\_compute\_predictand.WAS\_compute\_onset attribute)@\spxentry{default\_criteria}\spxextra{wass2s.was\_compute\_predictand.WAS\_compute\_onset attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_compute_onset.default_criteria}}
\pysigstartsignatures
\pysigline
{\sphinxbfcode{\sphinxupquote{default\_criteria}}\sphinxbfcode{\sphinxupquote{\DUrole{w}{ }\DUrole{p}{=}\DUrole{w}{ }\{0: \{\textquotesingle{}cumulative\textquotesingle{}: 10, \textquotesingle{}end\_search\textquotesingle{}: \textquotesingle{}08\sphinxhyphen{}30\textquotesingle{}, \textquotesingle{}number\_dry\_days\textquotesingle{}: 25, \textquotesingle{}start\_search\textquotesingle{}: \textquotesingle{}06\sphinxhyphen{}01\textquotesingle{}, \textquotesingle{}thrd\_rain\_day\textquotesingle{}: 0.85, \textquotesingle{}zone\_name\textquotesingle{}: \textquotesingle{}Sahel100\_0mm\textquotesingle{}\}, 1: \{\textquotesingle{}cumulative\textquotesingle{}: 15, \textquotesingle{}end\_search\textquotesingle{}: \textquotesingle{}08\sphinxhyphen{}15\textquotesingle{}, \textquotesingle{}number\_dry\_days\textquotesingle{}: 25, \textquotesingle{}start\_search\textquotesingle{}: \textquotesingle{}05\sphinxhyphen{}15\textquotesingle{}, \textquotesingle{}thrd\_rain\_day\textquotesingle{}: 0.85, \textquotesingle{}zone\_name\textquotesingle{}: \textquotesingle{}Sahel200\_100mm\textquotesingle{}\}, 2: \{\textquotesingle{}cumulative\textquotesingle{}: 15, \textquotesingle{}end\_search\textquotesingle{}: \textquotesingle{}07\sphinxhyphen{}31\textquotesingle{}, \textquotesingle{}number\_dry\_days\textquotesingle{}: 20, \textquotesingle{}start\_search\textquotesingle{}: \textquotesingle{}05\sphinxhyphen{}01\textquotesingle{}, \textquotesingle{}thrd\_rain\_day\textquotesingle{}: 0.85, \textquotesingle{}zone\_name\textquotesingle{}: \textquotesingle{}Sahel400\_200mm\textquotesingle{}\}, 3: \{\textquotesingle{}cumulative\textquotesingle{}: 20, \textquotesingle{}end\_search\textquotesingle{}: \textquotesingle{}07\sphinxhyphen{}31\textquotesingle{}, \textquotesingle{}number\_dry\_days\textquotesingle{}: 20, \textquotesingle{}start\_search\textquotesingle{}: \textquotesingle{}03\sphinxhyphen{}15\textquotesingle{}, \textquotesingle{}thrd\_rain\_day\textquotesingle{}: 0.85, \textquotesingle{}zone\_name\textquotesingle{}: \textquotesingle{}Sahel600\_400mm\textquotesingle{}\}, 4: \{\textquotesingle{}cumulative\textquotesingle{}: 20, \textquotesingle{}end\_search\textquotesingle{}: \textquotesingle{}07\sphinxhyphen{}31\textquotesingle{}, \textquotesingle{}number\_dry\_days\textquotesingle{}: 10, \textquotesingle{}start\_search\textquotesingle{}: \textquotesingle{}03\sphinxhyphen{}15\textquotesingle{}, \textquotesingle{}thrd\_rain\_day\textquotesingle{}: 0.85, \textquotesingle{}zone\_name\textquotesingle{}: \textquotesingle{}Soudan\textquotesingle{}\}, 5: \{\textquotesingle{}cumulative\textquotesingle{}: 20, \textquotesingle{}end\_search\textquotesingle{}: \textquotesingle{}06\sphinxhyphen{}15\textquotesingle{}, \textquotesingle{}number\_dry\_days\textquotesingle{}: 10, \textquotesingle{}start\_search\textquotesingle{}: \textquotesingle{}02\sphinxhyphen{}01\textquotesingle{}, \textquotesingle{}thrd\_rain\_day\textquotesingle{}: 0.85, \textquotesingle{}zone\_name\textquotesingle{}: \textquotesingle{}Golfe\_Of\_Guinea\textquotesingle{}\}\}}}}
\pysigstopsignatures
\end{fulllineitems}

\index{onset\_function() (wass2s.was\_compute\_predictand.WAS\_compute\_onset method)@\spxentry{onset\_function()}\spxextra{wass2s.was\_compute\_predictand.WAS\_compute\_onset method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_compute_onset.onset_function}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{onset\_function}}}
{\sphinxparam{\DUrole{n}{x}}\sphinxparamcomma \sphinxparam{\DUrole{n}{idebut}}\sphinxparamcomma \sphinxparam{\DUrole{n}{cumul}}\sphinxparamcomma \sphinxparam{\DUrole{n}{nbsec}}\sphinxparamcomma \sphinxparam{\DUrole{n}{jour\_pluvieux}}\sphinxparamcomma \sphinxparam{\DUrole{n}{irch\_fin}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Calculate the onset date of a season based on cumulative rainfall criteria.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{x}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Daily rainfall or similar values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{idebut}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Start index to begin searching for the onset.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{cumul}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} Cumulative rainfall threshold to trigger onset.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{nbsec}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Maximum number of dry days allowed in the sequence.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{jour\_pluvieux}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} Minimum rainfall to consider a day as rainy.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{irch\_fin}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Maximum index limit for the onset.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
Index of the onset date or NaN if onset not found.

\sphinxlineitem{Return type}
\sphinxAtStartPar
int or float

\end{description}\end{quote}

\end{fulllineitems}

\index{rainf\_zone() (wass2s.was\_compute\_predictand.WAS\_compute\_onset method)@\spxentry{rainf\_zone()}\spxextra{wass2s.was\_compute\_predictand.WAS\_compute\_onset method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_compute_onset.rainf_zone}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{rainf\_zone}}}
{\sphinxparam{\DUrole{n}{daily\_data}}}
{}
\pysigstopsignatures
\end{fulllineitems}

\index{transform\_cdt() (wass2s.was\_compute\_predictand.WAS\_compute\_onset static method)@\spxentry{transform\_cdt()}\spxextra{wass2s.was\_compute\_predictand.WAS\_compute\_onset static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_compute_onset.transform_cdt}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{transform\_cdt}}}
{\sphinxparam{\DUrole{n}{df}}}
{}
\pysigstopsignatures\begin{description}
\sphinxlineitem{Transform a DataFrame with:}\begin{itemize}
\item {} 
\sphinxAtStartPar
Row 0 = LON

\item {} 
\sphinxAtStartPar
Row 1 = LAT

\item {} 
\sphinxAtStartPar
Row 2 = ELEV

\item {} 
\sphinxAtStartPar
Rows 3+ = daily data (or any date) with ‘ID’ column containing dates.

\end{itemize}

\end{description}

\sphinxAtStartPar
Returns an xarray DataArray with coords = (T, Y, X), variable = ‘Observation’.

\end{fulllineitems}


\end{fulllineitems}

\index{WAS\_compute\_onset\_dry\_spell (class in wass2s.was\_compute\_predictand)@\spxentry{WAS\_compute\_onset\_dry\_spell}\spxextra{class in wass2s.was\_compute\_predictand}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_compute_onset_dry_spell}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_compute\_predictand.}}\sphinxbfcode{\sphinxupquote{WAS\_compute\_onset\_dry\_spell}}}
{\sphinxparam{\DUrole{n}{user\_criteria}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
A class for computing the longest dry spell length
after the onset of a rainy season, based on user\sphinxhyphen{}defined criteria.
\index{adjust\_duplicates() (wass2s.was\_compute\_predictand.WAS\_compute\_onset\_dry\_spell static method)@\spxentry{adjust\_duplicates()}\spxextra{wass2s.was\_compute\_predictand.WAS\_compute\_onset\_dry\_spell static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_compute_onset_dry_spell.adjust_duplicates}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{adjust\_duplicates}}}
{\sphinxparam{\DUrole{n}{series}}\sphinxparamcomma \sphinxparam{\DUrole{n}{increment}\DUrole{o}{=}\DUrole{default_value}{1e\sphinxhyphen{}05}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
If any values in the Series repeat, nudge them by a tiny increment
so that all are unique (to avoid indexing collisions).

\end{fulllineitems}

\index{compute() (wass2s.was\_compute\_predictand.WAS\_compute\_onset\_dry\_spell method)@\spxentry{compute()}\spxextra{wass2s.was\_compute\_predictand.WAS\_compute\_onset\_dry\_spell method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_compute_onset_dry_spell.compute}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute}}}
{\sphinxparam{\DUrole{n}{daily\_data}}\sphinxparamcomma \sphinxparam{\DUrole{n}{nb\_cores}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute the longest dry spell length after the onset for each pixel in a
given daily rainfall DataArray, using different criteria based on isohyet zones.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{daily\_data}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Daily rainfall data, coords = (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{nb\_cores}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Number of parallel processes to use.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
Array with the longest dry spell length per pixel.

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_insitu() (wass2s.was\_compute\_predictand.WAS\_compute\_onset\_dry\_spell method)@\spxentry{compute\_insitu()}\spxextra{wass2s.was\_compute\_predictand.WAS\_compute\_onset\_dry\_spell method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_compute_onset_dry_spell.compute_insitu}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_insitu}}}
{\sphinxparam{\DUrole{n}{daily\_df}}}
{}
\pysigstopsignatures
\end{fulllineitems}

\index{day\_of\_year() (wass2s.was\_compute\_predictand.WAS\_compute\_onset\_dry\_spell static method)@\spxentry{day\_of\_year()}\spxextra{wass2s.was\_compute\_predictand.WAS\_compute\_onset\_dry\_spell static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_compute_onset_dry_spell.day_of_year}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{day\_of\_year}}}
{\sphinxparam{\DUrole{n}{i}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dem\_rech1}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Given a year ‘i’ and a month\sphinxhyphen{}day string ‘dem\_rech1’ (e.g., ‘07\sphinxhyphen{}23’),
return the 1\sphinxhyphen{}based day of the year.

\end{fulllineitems}

\index{default\_criteria (wass2s.was\_compute\_predictand.WAS\_compute\_onset\_dry\_spell attribute)@\spxentry{default\_criteria}\spxextra{wass2s.was\_compute\_predictand.WAS\_compute\_onset\_dry\_spell attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_compute_onset_dry_spell.default_criteria}}
\pysigstartsignatures
\pysigline
{\sphinxbfcode{\sphinxupquote{default\_criteria}}\sphinxbfcode{\sphinxupquote{\DUrole{w}{ }\DUrole{p}{=}\DUrole{w}{ }\{0: \{\textquotesingle{}cumulative\textquotesingle{}: 10, \textquotesingle{}end\_search\textquotesingle{}: \textquotesingle{}08\sphinxhyphen{}30\textquotesingle{}, \textquotesingle{}nbjour\textquotesingle{}: 40, \textquotesingle{}number\_dry\_days\textquotesingle{}: 25, \textquotesingle{}start\_search\textquotesingle{}: \textquotesingle{}06\sphinxhyphen{}01\textquotesingle{}, \textquotesingle{}thrd\_rain\_day\textquotesingle{}: 0.85, \textquotesingle{}zone\_name\textquotesingle{}: \textquotesingle{}Sahel100\_0mm\textquotesingle{}\}, 1: \{\textquotesingle{}cumulative\textquotesingle{}: 15, \textquotesingle{}end\_search\textquotesingle{}: \textquotesingle{}08\sphinxhyphen{}15\textquotesingle{}, \textquotesingle{}nbjour\textquotesingle{}: 40, \textquotesingle{}number\_dry\_days\textquotesingle{}: 25, \textquotesingle{}start\_search\textquotesingle{}: \textquotesingle{}05\sphinxhyphen{}15\textquotesingle{}, \textquotesingle{}thrd\_rain\_day\textquotesingle{}: 0.85, \textquotesingle{}zone\_name\textquotesingle{}: \textquotesingle{}Sahel200\_100mm\textquotesingle{}\}, 2: \{\textquotesingle{}cumulative\textquotesingle{}: 15, \textquotesingle{}end\_search\textquotesingle{}: \textquotesingle{}07\sphinxhyphen{}31\textquotesingle{}, \textquotesingle{}nbjour\textquotesingle{}: 40, \textquotesingle{}number\_dry\_days\textquotesingle{}: 20, \textquotesingle{}start\_search\textquotesingle{}: \textquotesingle{}05\sphinxhyphen{}01\textquotesingle{}, \textquotesingle{}thrd\_rain\_day\textquotesingle{}: 0.85, \textquotesingle{}zone\_name\textquotesingle{}: \textquotesingle{}Sahel400\_200mm\textquotesingle{}\}, 3: \{\textquotesingle{}cumulative\textquotesingle{}: 20, \textquotesingle{}end\_search\textquotesingle{}: \textquotesingle{}07\sphinxhyphen{}31\textquotesingle{}, \textquotesingle{}nbjour\textquotesingle{}: 45, \textquotesingle{}number\_dry\_days\textquotesingle{}: 20, \textquotesingle{}start\_search\textquotesingle{}: \textquotesingle{}03\sphinxhyphen{}15\textquotesingle{}, \textquotesingle{}thrd\_rain\_day\textquotesingle{}: 0.85, \textquotesingle{}zone\_name\textquotesingle{}: \textquotesingle{}Sahel600\_400mm\textquotesingle{}\}, 4: \{\textquotesingle{}cumulative\textquotesingle{}: 20, \textquotesingle{}end\_search\textquotesingle{}: \textquotesingle{}07\sphinxhyphen{}31\textquotesingle{}, \textquotesingle{}nbjour\textquotesingle{}: 50, \textquotesingle{}number\_dry\_days\textquotesingle{}: 10, \textquotesingle{}start\_search\textquotesingle{}: \textquotesingle{}03\sphinxhyphen{}15\textquotesingle{}, \textquotesingle{}thrd\_rain\_day\textquotesingle{}: 0.85, \textquotesingle{}zone\_name\textquotesingle{}: \textquotesingle{}Soudan\textquotesingle{}\}, 5: \{\textquotesingle{}cumulative\textquotesingle{}: 20, \textquotesingle{}end\_search\textquotesingle{}: \textquotesingle{}06\sphinxhyphen{}15\textquotesingle{}, \textquotesingle{}nbjour\textquotesingle{}: 50, \textquotesingle{}number\_dry\_days\textquotesingle{}: 10, \textquotesingle{}start\_search\textquotesingle{}: \textquotesingle{}02\sphinxhyphen{}01\textquotesingle{}, \textquotesingle{}thrd\_rain\_day\textquotesingle{}: 0.85, \textquotesingle{}zone\_name\textquotesingle{}: \textquotesingle{}Golfe\_Of\_Guinea\textquotesingle{}\}\}}}}
\pysigstopsignatures
\end{fulllineitems}

\index{dry\_spell\_onset\_function() (wass2s.was\_compute\_predictand.WAS\_compute\_onset\_dry\_spell method)@\spxentry{dry\_spell\_onset\_function()}\spxextra{wass2s.was\_compute\_predictand.WAS\_compute\_onset\_dry\_spell method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_compute_onset_dry_spell.dry_spell_onset_function}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{dry\_spell\_onset\_function}}}
{\sphinxparam{\DUrole{n}{x}}\sphinxparamcomma \sphinxparam{\DUrole{n}{idebut}}\sphinxparamcomma \sphinxparam{\DUrole{n}{cumul}}\sphinxparamcomma \sphinxparam{\DUrole{n}{nbsec}}\sphinxparamcomma \sphinxparam{\DUrole{n}{jour\_pluvieux}}\sphinxparamcomma \sphinxparam{\DUrole{n}{irch\_fin}}\sphinxparamcomma \sphinxparam{\DUrole{n}{nbjour}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Calculate the onset date of a season based on cumulative rainfall criteria, and
determine the longest dry spell sequence within a specified period after the onset.

\end{fulllineitems}

\index{dry\_spell\_onset\_function\_() (wass2s.was\_compute\_predictand.WAS\_compute\_onset\_dry\_spell method)@\spxentry{dry\_spell\_onset\_function\_()}\spxextra{wass2s.was\_compute\_predictand.WAS\_compute\_onset\_dry\_spell method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_compute_onset_dry_spell.dry_spell_onset_function_}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{dry\_spell\_onset\_function\_}}}
{\sphinxparam{\DUrole{n}{x}}\sphinxparamcomma \sphinxparam{\DUrole{n}{idebut}}\sphinxparamcomma \sphinxparam{\DUrole{n}{cumul}}\sphinxparamcomma \sphinxparam{\DUrole{n}{nbsec}}\sphinxparamcomma \sphinxparam{\DUrole{n}{jour\_pluvieux}}\sphinxparamcomma \sphinxparam{\DUrole{n}{irch\_fin}}\sphinxparamcomma \sphinxparam{\DUrole{n}{nbjour}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Calculate the onset date of a season based on cumulative rainfall criteria, and
determine the longest dry spell sequence within a specified period after the onset.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{x}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Daily rainfall or similar values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{idebut}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Start index to begin searching for the onset.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{cumul}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} Cumulative rainfall threshold to trigger onset.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{nbsec}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Maximum number of dry days allowed in the sequence.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{jour\_pluvieux}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} Minimum rainfall to consider a day as rainy.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{irch\_fin}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Maximum index limit for the onset.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{nbjour}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Number of days to check for the longest dry spell after onset.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
Length of the longest dry spell sequence after onset or NaN if onset not found.

\sphinxlineitem{Return type}
\sphinxAtStartPar
float

\end{description}\end{quote}

\end{fulllineitems}

\index{rainf\_zone() (wass2s.was\_compute\_predictand.WAS\_compute\_onset\_dry\_spell method)@\spxentry{rainf\_zone()}\spxextra{wass2s.was\_compute\_predictand.WAS\_compute\_onset\_dry\_spell method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_compute_onset_dry_spell.rainf_zone}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{rainf\_zone}}}
{\sphinxparam{\DUrole{n}{daily\_data}}}
{}
\pysigstopsignatures
\end{fulllineitems}

\index{transform\_cdt() (wass2s.was\_compute\_predictand.WAS\_compute\_onset\_dry\_spell static method)@\spxentry{transform\_cdt()}\spxextra{wass2s.was\_compute\_predictand.WAS\_compute\_onset\_dry\_spell static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_compute_onset_dry_spell.transform_cdt}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{transform\_cdt}}}
{\sphinxparam{\DUrole{n}{df}}}
{}
\pysigstopsignatures\begin{description}
\sphinxlineitem{Transform a DataFrame with:}\begin{itemize}
\item {} 
\sphinxAtStartPar
Row 0 = LON

\item {} 
\sphinxAtStartPar
Row 1 = LAT

\item {} 
\sphinxAtStartPar
Row 2 = ELEV

\item {} 
\sphinxAtStartPar
Rows 3+ = daily data (or any date) with ‘ID’ column containing dates.

\end{itemize}

\end{description}

\sphinxAtStartPar
Returns an xarray DataArray with coords = (T, Y, X), variable = ‘Observation’.

\end{fulllineitems}


\end{fulllineitems}

\index{WAS\_count\_dry\_spells (class in wass2s.was\_compute\_predictand)@\spxentry{WAS\_count\_dry\_spells}\spxextra{class in wass2s.was\_compute\_predictand}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_count_dry_spells}}
\pysigstartsignatures
\pysigline
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_compute\_predictand.}}\sphinxbfcode{\sphinxupquote{WAS\_count\_dry\_spells}}}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
A class to compute the number of dry spells within a specified period
(onset to cessation) for each pixel or station in a daily rainfall dataset.
\index{adjust\_duplicates() (wass2s.was\_compute\_predictand.WAS\_count\_dry\_spells static method)@\spxentry{adjust\_duplicates()}\spxextra{wass2s.was\_compute\_predictand.WAS\_count\_dry\_spells static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_count_dry_spells.adjust_duplicates}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{adjust\_duplicates}}}
{\sphinxparam{\DUrole{n}{series}}\sphinxparamcomma \sphinxparam{\DUrole{n}{increment}\DUrole{o}{=}\DUrole{default_value}{1e\sphinxhyphen{}05}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
If any values in the Series repeat, nudge them by a tiny increment
so that all are unique (to avoid indexing collisions).

\end{fulllineitems}

\index{compute() (wass2s.was\_compute\_predictand.WAS\_count\_dry\_spells method)@\spxentry{compute()}\spxextra{wass2s.was\_compute\_predictand.WAS\_count\_dry\_spells method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_count_dry_spells.compute}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute}}}
{\sphinxparam{\DUrole{n}{daily\_data}}\sphinxparamcomma \sphinxparam{\DUrole{n}{onset\_date}}\sphinxparamcomma \sphinxparam{\DUrole{n}{cessation\_date}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dry\_spell\_length}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dry\_threshold}}\sphinxparamcomma \sphinxparam{\DUrole{n}{nb\_cores}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute the number of dry spells for each pixel within the onset and cessation period
in a daily xarray DataArray.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{daily\_data}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Daily rainfall data, coords = (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{onset\_date}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} DataArray containing onset dates for each pixel.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{cessation\_date}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} DataArray containing cessation dates for each pixel.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dry\_spell\_length}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} The length of a dry spell to count.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dry\_threshold}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} Rainfall threshold to classify a day as “dry.”

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{nb\_cores}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Number of parallel processes to use.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
An array with the count of dry spells per pixel.

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_insitu() (wass2s.was\_compute\_predictand.WAS\_count\_dry\_spells method)@\spxentry{compute\_insitu()}\spxextra{wass2s.was\_compute\_predictand.WAS\_count\_dry\_spells method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_count_dry_spells.compute_insitu}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_insitu}}}
{\sphinxparam{\DUrole{n}{daily\_df}}\sphinxparamcomma \sphinxparam{\DUrole{n}{onset\_df\_cpt}}\sphinxparamcomma \sphinxparam{\DUrole{n}{cessation\_df\_cpt}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dry\_spell\_length}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dry\_threshold}\DUrole{o}{=}\DUrole{default_value}{1.0}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute the number of dry spells (of length = dry\_spell\_length) between the
onset and cessation dates for in\sphinxhyphen{}situ stations (CDT format).
\begin{description}
\sphinxlineitem{Returns a DataFrame in CPT format:}\begin{itemize}
\item {} 
\sphinxAtStartPar
Row 0: {[}“LAT”, lat\_stn1, lat\_stn2, …{]}

\item {} 
\sphinxAtStartPar
Row 1: {[}“LON”, lon\_stn1, lon\_stn2, …{]}

\item {} 
\sphinxAtStartPar
Subsequent rows: {[}year, station1\_value, station2\_value, …{]}

\end{itemize}

\end{description}
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{daily\_df}} (\sphinxstyleliteralemphasis{\sphinxupquote{pd.DataFrame}}) \textendash{} CDT rainfall data (ID column = date, station columns).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{onset\_df\_cpt}} (\sphinxstyleliteralemphasis{\sphinxupquote{pd.DataFrame}}) \textendash{} CPT\sphinxhyphen{}format DataFrame containing onset dates (as returned by some method).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{cessation\_df\_cpt}} (\sphinxstyleliteralemphasis{\sphinxupquote{pd.DataFrame}}) \textendash{} CPT\sphinxhyphen{}format DataFrame containing cessation dates.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dry\_spell\_length}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} The length of the dry spell to look for.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dry\_threshold}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Rainfall threshold below which a day is considered “dry.” Defaults to 1.0 mm.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
Final dry\sphinxhyphen{}spell counts in CPT pivot format.

\sphinxlineitem{Return type}
\sphinxAtStartPar
pd.DataFrame

\end{description}\end{quote}

\end{fulllineitems}

\index{count\_dry\_spells() (wass2s.was\_compute\_predictand.WAS\_count\_dry\_spells static method)@\spxentry{count\_dry\_spells()}\spxextra{wass2s.was\_compute\_predictand.WAS\_count\_dry\_spells static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_count_dry_spells.count_dry_spells}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{count\_dry\_spells}}}
{\sphinxparam{\DUrole{n}{x}}\sphinxparamcomma \sphinxparam{\DUrole{n}{onset}}\sphinxparamcomma \sphinxparam{\DUrole{n}{cessation}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dry\_spell\_length}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dry\_threshold}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Count the number of dry spells of a specific length between onset and cessation dates.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{x}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Daily rainfall values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{onset}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Start index for the calculation (onset date).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{cessation}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} End index for the calculation (cessation date).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dry\_spell\_length}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} The length of a dry spell to count.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dry\_threshold}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} Rainfall threshold to classify a day as “dry.”

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
The number of dry spells of the specified length (NaN if invalid).

\sphinxlineitem{Return type}
\sphinxAtStartPar
int or float

\end{description}\end{quote}

\end{fulllineitems}

\index{transform\_cdt() (wass2s.was\_compute\_predictand.WAS\_count\_dry\_spells static method)@\spxentry{transform\_cdt()}\spxextra{wass2s.was\_compute\_predictand.WAS\_count\_dry\_spells static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_count_dry_spells.transform_cdt}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{transform\_cdt}}}
{\sphinxparam{\DUrole{n}{df}}}
{}
\pysigstopsignatures\begin{description}
\sphinxlineitem{Transform a DataFrame with:}\begin{itemize}
\item {} 
\sphinxAtStartPar
Row 0 = LON

\item {} 
\sphinxAtStartPar
Row 1 = LAT

\item {} 
\sphinxAtStartPar
Row 2 = ELEV

\item {} 
\sphinxAtStartPar
Rows 3+ = daily data with ‘ID’ column containing dates.

\end{itemize}

\sphinxlineitem{Returns a DataFrame with columns like:}
\sphinxAtStartPar
DATE | STATION | VALUE | LON | LAT | ELEV | MEAN\_ANNUAL\_RAINFALL | zonename

\end{description}

\end{fulllineitems}

\index{transform\_cpt() (wass2s.was\_compute\_predictand.WAS\_count\_dry\_spells static method)@\spxentry{transform\_cpt()}\spxextra{wass2s.was\_compute\_predictand.WAS\_count\_dry\_spells static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_count_dry_spells.transform_cpt}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{transform\_cpt}}}
{\sphinxparam{\DUrole{n}{df}}\sphinxparamcomma \sphinxparam{\DUrole{n}{missing\_value}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures\begin{description}
\sphinxlineitem{Transform a DataFrame in CPT format with:}\begin{itemize}
\item {} 
\sphinxAtStartPar
Row 0 = LAT

\item {} 
\sphinxAtStartPar
Row 1 = LON

\item {} 
\sphinxAtStartPar
Rows 2+ = numeric year data in wide format (stations in columns).

\end{itemize}

\sphinxlineitem{Returns a DataFrame with columns like:}
\sphinxAtStartPar
YEAR | STATION | VALUE | LAT | LON

\end{description}

\end{fulllineitems}


\end{fulllineitems}

\index{WAS\_count\_rainy\_days (class in wass2s.was\_compute\_predictand)@\spxentry{WAS\_count\_rainy\_days}\spxextra{class in wass2s.was\_compute\_predictand}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_count_rainy_days}}
\pysigstartsignatures
\pysigline
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_compute\_predictand.}}\sphinxbfcode{\sphinxupquote{WAS\_count\_rainy\_days}}}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
A class to compute the number of rainy days between onset and cessation dates
for each pixel or station in a daily rainfall dataset.
\index{compute() (wass2s.was\_compute\_predictand.WAS\_count\_rainy\_days method)@\spxentry{compute()}\spxextra{wass2s.was\_compute\_predictand.WAS\_count\_rainy\_days method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_count_rainy_days.compute}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute}}}
{\sphinxparam{\DUrole{n}{daily\_data}}\sphinxparamcomma \sphinxparam{\DUrole{n}{onset\_date}}\sphinxparamcomma \sphinxparam{\DUrole{n}{cessation\_date}}\sphinxparamcomma \sphinxparam{\DUrole{n}{rain\_threshold}}\sphinxparamcomma \sphinxparam{\DUrole{n}{nb\_cores}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute the number of rainy days for each pixel between onset and cessation dates.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{daily\_data}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Daily rainfall data, coords = (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{onset\_date}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} DataArray containing onset dates for each pixel.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{cessation\_date}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} DataArray containing cessation dates for each pixel.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{rain\_threshold}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} Rainfall threshold to classify a day as “rainy.”

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{nb\_cores}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Number of parallel processes to use.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
Array with the count of rainy days per pixel.

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_insitu() (wass2s.was\_compute\_predictand.WAS\_count\_rainy\_days method)@\spxentry{compute\_insitu()}\spxextra{wass2s.was\_compute\_predictand.WAS\_count\_rainy\_days method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_count_rainy_days.compute_insitu}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_insitu}}}
{\sphinxparam{\DUrole{n}{daily\_df}}\sphinxparamcomma \sphinxparam{\DUrole{n}{onset\_df\_cpt}}\sphinxparamcomma \sphinxparam{\DUrole{n}{cessation\_df\_cpt}}\sphinxparamcomma \sphinxparam{\DUrole{n}{rain\_threshold}\DUrole{o}{=}\DUrole{default_value}{0.85}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute, for in\sphinxhyphen{}situ stations (CDT data), the number of rainy days between
onset and cessation, for each station and year.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{daily\_df}} (\sphinxstyleliteralemphasis{\sphinxupquote{pd.DataFrame}}) \textendash{} CDT precipitation data (ID column = date; columns = stations).
Follows the standard CDT format.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{onset\_df\_cpt}} (\sphinxstyleliteralemphasis{\sphinxupquote{pd.DataFrame}}) \textendash{} Result of \sphinxtitleref{WAS\_compute\_onset.compute\_insitu(…)} for onset (CPT format).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{cessation\_df\_cpt}} (\sphinxstyleliteralemphasis{\sphinxupquote{pd.DataFrame}}) \textendash{} Same format for cessation (CPT format).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{rain\_threshold}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Precipitation threshold for counting a day as “rainy,” by default 0.85 mm.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{df\_final} \textendash{} The count of rainy days in CPT pivot format.

\sphinxlineitem{Return type}
\sphinxAtStartPar
pd.DataFrame

\end{description}\end{quote}

\end{fulllineitems}

\index{count\_rainy\_days() (wass2s.was\_compute\_predictand.WAS\_count\_rainy\_days static method)@\spxentry{count\_rainy\_days()}\spxextra{wass2s.was\_compute\_predictand.WAS\_count\_rainy\_days static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_count_rainy_days.count_rainy_days}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{count\_rainy\_days}}}
{\sphinxparam{\DUrole{n}{x}}\sphinxparamcomma \sphinxparam{\DUrole{n}{onset\_date}}\sphinxparamcomma \sphinxparam{\DUrole{n}{cessation\_date}}\sphinxparamcomma \sphinxparam{\DUrole{n}{rain\_threshold}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Count the number of rainy days between onset and cessation dates.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{x}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Daily rainfall values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{onset\_date}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Start index for the calculation (onset date).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{cessation\_date}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} End index for the calculation (cessation date).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{rain\_threshold}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} Rainfall threshold to classify a day as “rainy.”

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
Number of rainy days (returns NaN if data is invalid).

\sphinxlineitem{Return type}
\sphinxAtStartPar
int or float

\end{description}\end{quote}

\end{fulllineitems}

\index{transform\_cdt() (wass2s.was\_compute\_predictand.WAS\_count\_rainy\_days static method)@\spxentry{transform\_cdt()}\spxextra{wass2s.was\_compute\_predictand.WAS\_count\_rainy\_days static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_count_rainy_days.transform_cdt}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{transform\_cdt}}}
{\sphinxparam{\DUrole{n}{df}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Transform a DataFrame in CDT format into a standardized long DataFrame.
\begin{description}
\sphinxlineitem{CDT format assumptions:}\begin{itemize}
\item {} 
\sphinxAtStartPar
Row 0 = LON

\item {} 
\sphinxAtStartPar
Row 1 = LAT

\item {} 
\sphinxAtStartPar
Row 2 = ELEV

\item {} 
\sphinxAtStartPar
Rows 3+ = daily data with ‘ID’ column holding dates in YYYYMMDD format.

\end{itemize}

\sphinxlineitem{This method returns a DataFrame with columns:}
\sphinxAtStartPar
DATE, STATION, VALUE, LON, LAT, ELEV, (optional) MEAN\_ANNUAL\_RAINFALL, zonename

\end{description}

\end{fulllineitems}


\end{fulllineitems}

\index{WAS\_count\_wet\_spells (class in wass2s.was\_compute\_predictand)@\spxentry{WAS\_count\_wet\_spells}\spxextra{class in wass2s.was\_compute\_predictand}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_count_wet_spells}}
\pysigstartsignatures
\pysigline
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_compute\_predictand.}}\sphinxbfcode{\sphinxupquote{WAS\_count\_wet\_spells}}}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
A class to compute the number of wet spells within a specified period
(onset to cessation) for each pixel or station in a daily rainfall dataset.
\index{compute() (wass2s.was\_compute\_predictand.WAS\_count\_wet\_spells method)@\spxentry{compute()}\spxextra{wass2s.was\_compute\_predictand.WAS\_count\_wet\_spells method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_count_wet_spells.compute}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute}}}
{\sphinxparam{\DUrole{n}{daily\_data}}\sphinxparamcomma \sphinxparam{\DUrole{n}{onset\_date}}\sphinxparamcomma \sphinxparam{\DUrole{n}{cessation\_date}}\sphinxparamcomma \sphinxparam{\DUrole{n}{wet\_spell\_length}}\sphinxparamcomma \sphinxparam{\DUrole{n}{wet\_threshold}}\sphinxparamcomma \sphinxparam{\DUrole{n}{nb\_cores}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute the number of wet spells for each pixel within the onset and cessation period
in a daily xarray DataArray.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{daily\_data}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Daily rainfall data, coords = (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{onset\_date}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} DataArray containing onset dates for each pixel.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{cessation\_date}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} DataArray containing cessation dates for each pixel.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{wet\_spell\_length}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} The length of a wet spell to count.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{wet\_threshold}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} Rainfall threshold to classify a day as “wet.”

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{nb\_cores}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Number of parallel processes to use.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
Array with the count of wet spells per pixel.

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_insitu() (wass2s.was\_compute\_predictand.WAS\_count\_wet\_spells method)@\spxentry{compute\_insitu()}\spxextra{wass2s.was\_compute\_predictand.WAS\_count\_wet\_spells method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_count_wet_spells.compute_insitu}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_insitu}}}
{\sphinxparam{\DUrole{n}{daily\_df}}\sphinxparamcomma \sphinxparam{\DUrole{n}{onset\_df\_cpt}}\sphinxparamcomma \sphinxparam{\DUrole{n}{cessation\_df\_cpt}}\sphinxparamcomma \sphinxparam{\DUrole{n}{wet\_spell\_length}}\sphinxparamcomma \sphinxparam{\DUrole{n}{wet\_threshold}\DUrole{o}{=}\DUrole{default_value}{1.0}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute the number of wet spells (of length = wet\_spell\_length) between
onset and cessation for in\sphinxhyphen{}situ stations (CDT data).
\begin{description}
\sphinxlineitem{Returns a DataFrame in CPT format:}\begin{itemize}
\item {} 
\sphinxAtStartPar
Row 0: {[}“LAT”, lat\_station1, lat\_station2, …{]}

\item {} 
\sphinxAtStartPar
Row 1: {[}“LON”, lon\_station1, lon\_station2, …{]}

\item {} 
\sphinxAtStartPar
Then one row per year: {[}year, station1\_value, station2\_value, …{]}

\end{itemize}

\end{description}
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{daily\_df}} (\sphinxstyleliteralemphasis{\sphinxupquote{pd.DataFrame}}) \textendash{} CDT rainfall data (ID column = date, station columns).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{onset\_df\_cpt}} (\sphinxstyleliteralemphasis{\sphinxupquote{pd.DataFrame}}) \textendash{} CPT\sphinxhyphen{}format DataFrame with onset dates (same station columns).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{cessation\_df\_cpt}} (\sphinxstyleliteralemphasis{\sphinxupquote{pd.DataFrame}}) \textendash{} CPT\sphinxhyphen{}format DataFrame with cessation dates (same station columns).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{wet\_spell\_length}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} The length of a wet spell to count.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{wet\_threshold}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Rainfall threshold classifying a day as “wet.” Defaults to 1.0 mm.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
Final wet\sphinxhyphen{}spell counts in CPT pivot format.

\sphinxlineitem{Return type}
\sphinxAtStartPar
pd.DataFrame

\end{description}\end{quote}

\end{fulllineitems}

\index{count\_wet\_spells() (wass2s.was\_compute\_predictand.WAS\_count\_wet\_spells static method)@\spxentry{count\_wet\_spells()}\spxextra{wass2s.was\_compute\_predictand.WAS\_count\_wet\_spells static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_count_wet_spells.count_wet_spells}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{count\_wet\_spells}}}
{\sphinxparam{\DUrole{n}{x}}\sphinxparamcomma \sphinxparam{\DUrole{n}{onset\_date}}\sphinxparamcomma \sphinxparam{\DUrole{n}{cessation\_date}}\sphinxparamcomma \sphinxparam{\DUrole{n}{wet\_spell\_length}}\sphinxparamcomma \sphinxparam{\DUrole{n}{wet\_threshold}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Count the number of wet spells of a specific length between onset and cessation dates.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{x}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Daily rainfall values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{onset\_date}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Start index for the calculation (onset date).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{cessation\_date}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} End index for the calculation (cessation date).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{wet\_spell\_length}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} The length of a wet spell to count.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{wet\_threshold}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} Rainfall threshold to classify a day as “wet.”

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
The number of wet spells of the specified length (NaN if data is invalid).

\sphinxlineitem{Return type}
\sphinxAtStartPar
int or float

\end{description}\end{quote}

\end{fulllineitems}

\index{transform\_cdt() (wass2s.was\_compute\_predictand.WAS\_count\_wet\_spells static method)@\spxentry{transform\_cdt()}\spxextra{wass2s.was\_compute\_predictand.WAS\_count\_wet\_spells static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_count_wet_spells.transform_cdt}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{transform\_cdt}}}
{\sphinxparam{\DUrole{n}{df}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Transform a CDT\sphinxhyphen{}format DataFrame into a standard table.
\begin{description}
\sphinxlineitem{CDT format assumptions:}\begin{itemize}
\item {} 
\sphinxAtStartPar
Row 0 = LON

\item {} 
\sphinxAtStartPar
Row 1 = LAT

\item {} 
\sphinxAtStartPar
Row 2 = ELEV

\item {} 
\sphinxAtStartPar
Rows 3+ = daily data, ‘ID’ column has dates in YYYYMMDD.

\end{itemize}

\sphinxlineitem{Returns a DataFrame with columns:}
\sphinxAtStartPar
{[}DATE, STATION, VALUE, LON, LAT, ELEV, MEAN\_ANNUAL\_RAINFALL, zonename{]}

\end{description}

\end{fulllineitems}


\end{fulllineitems}

\index{WAS\_r95\_99p (class in wass2s.was\_compute\_predictand)@\spxentry{WAS\_r95\_99p}\spxextra{class in wass2s.was\_compute\_predictand}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_r95_99p}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_compute\_predictand.}}\sphinxbfcode{\sphinxupquote{WAS\_r95\_99p}}}
{\sphinxparam{\DUrole{n}{base\_period}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{slice}}\sphinxparamcomma \sphinxparam{\DUrole{n}{season}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{list}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
A class to compute the R95p and R99p climate indices using either:
\sphinxhyphen{} Dask\sphinxhyphen{}enabled xarray for large raster/time\sphinxhyphen{}series
\sphinxhyphen{} An “insitu” method for station\sphinxhyphen{}based (CDT) data.
\index{compute\_insitu\_r95p() (wass2s.was\_compute\_predictand.WAS\_r95\_99p method)@\spxentry{compute\_insitu\_r95p()}\spxextra{wass2s.was\_compute\_predictand.WAS\_r95\_99p method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_r95_99p.compute_insitu_r95p}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_insitu\_r95p}}}
{\sphinxparam{\DUrole{n}{df\_cdt}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{DataFrame}}}
{{ $\rightarrow$ DataFrame}}
\pysigstopsignatures
\sphinxAtStartPar
Compute R95p index (total precipitation on days above the daily 95th percentile)
for station\sphinxhyphen{}based data in CDT format.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{df\_cdt}} (\sphinxstyleliteralemphasis{\sphinxupquote{pd.DataFrame}}) \textendash{} CDT\sphinxhyphen{}format DataFrame (rows 0..2 = LON/LAT/ELEV, row 3+ = daily data).

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{df\_final} \textendash{} A DataFrame in CPT format with the R95p values pivoted by station vs. year.

\sphinxlineitem{Return type}
\sphinxAtStartPar
pd.DataFrame

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_insitu\_r99p() (wass2s.was\_compute\_predictand.WAS\_r95\_99p method)@\spxentry{compute\_insitu\_r99p()}\spxextra{wass2s.was\_compute\_predictand.WAS\_r95\_99p method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_r95_99p.compute_insitu_r99p}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_insitu\_r99p}}}
{\sphinxparam{\DUrole{n}{df\_cdt}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{DataFrame}}}
{{ $\rightarrow$ DataFrame}}
\pysigstopsignatures
\sphinxAtStartPar
Compute R99p index (total precipitation on days above the daily 99th percentile)
for station\sphinxhyphen{}based data in CDT format.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{df\_cdt}} (\sphinxstyleliteralemphasis{\sphinxupquote{pd.DataFrame}}) \textendash{} CDT\sphinxhyphen{}format DataFrame.

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{df\_final}

\sphinxlineitem{Return type}
\sphinxAtStartPar
pd.DataFrame (CPT format)

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_r95p() (wass2s.was\_compute\_predictand.WAS\_r95\_99p method)@\spxentry{compute\_r95p()}\spxextra{wass2s.was\_compute\_predictand.WAS\_r95\_99p method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_r95_99p.compute_r95p}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_r95p}}}
{\sphinxparam{\DUrole{n}{pr}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{DataArray}}}
{{ $\rightarrow$ DataArray}}
\pysigstopsignatures
\sphinxAtStartPar
Existing method for xarray\sphinxhyphen{}based data (unchanged).

\end{fulllineitems}

\index{compute\_r99p() (wass2s.was\_compute\_predictand.WAS\_r95\_99p method)@\spxentry{compute\_r99p()}\spxextra{wass2s.was\_compute\_predictand.WAS\_r95\_99p method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_r95_99p.compute_r99p}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_r99p}}}
{\sphinxparam{\DUrole{n}{pr}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{DataArray}}}
{{ $\rightarrow$ DataArray}}
\pysigstopsignatures
\sphinxAtStartPar
Existing method for xarray\sphinxhyphen{}based data (unchanged).

\end{fulllineitems}

\index{transform\_cdt() (wass2s.was\_compute\_predictand.WAS\_r95\_99p static method)@\spxentry{transform\_cdt()}\spxextra{wass2s.was\_compute\_predictand.WAS\_r95\_99p static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_compute_predictand.WAS_r95_99p.transform_cdt}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{transform\_cdt}}}
{\sphinxparam{\DUrole{n}{df}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Transform a DataFrame in CDT format into a standardized long DataFrame.
\begin{description}
\sphinxlineitem{CDT format assumptions:}\begin{itemize}
\item {} 
\sphinxAtStartPar
Row 0 = LON

\item {} 
\sphinxAtStartPar
Row 1 = LAT

\item {} 
\sphinxAtStartPar
Row 2 = ELEV

\item {} 
\sphinxAtStartPar
Rows 3+ = daily data with ‘ID’ column holding dates in YYYYMMDD format.

\end{itemize}

\sphinxlineitem{Returns a DataFrame with columns:}
\sphinxAtStartPar
{[}DATE, STATION, VALUE, LON, LAT, ELEV{]}

\end{description}

\end{fulllineitems}


\end{fulllineitems}



\subsection{wass2s.was\_merge\_predictand module}
\label{\detokenize{api:module-wass2s.was_merge_predictand}}\label{\detokenize{api:wass2s-was-merge-predictand-module}}\index{module@\spxentry{module}!wass2s.was\_merge\_predictand@\spxentry{wass2s.was\_merge\_predictand}}\index{wass2s.was\_merge\_predictand@\spxentry{wass2s.was\_merge\_predictand}!module@\spxentry{module}}\index{WAS\_Merging (class in wass2s.was\_merge\_predictand)@\spxentry{WAS\_Merging}\spxextra{class in wass2s.was\_merge\_predictand}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_merge_predictand.WAS_Merging}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_merge\_predictand.}}\sphinxbfcode{\sphinxupquote{WAS\_Merging}}}
{\sphinxparam{\DUrole{n}{df}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{DataFrame}}\sphinxparamcomma \sphinxparam{\DUrole{n}{da}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{Dataset}}\sphinxparamcomma \sphinxparam{\DUrole{n}{date\_month\_day}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{str}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{\textquotesingle{}08\sphinxhyphen{}01\textquotesingle{}}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}
\index{adjust\_duplicates() (wass2s.was\_merge\_predictand.WAS\_Merging method)@\spxentry{adjust\_duplicates()}\spxextra{wass2s.was\_merge\_predictand.WAS\_Merging method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_merge_predictand.WAS_Merging.adjust_duplicates}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{adjust\_duplicates}}}
{\sphinxparam{\DUrole{n}{series}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{Series}}\sphinxparamcomma \sphinxparam{\DUrole{n}{increment}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{float}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{1e\sphinxhyphen{}05}}}
{{ $\rightarrow$ Series}}
\pysigstopsignatures
\sphinxAtStartPar
If any values in the Series repeat, nudge them by a tiny increment
so that all are unique (to avoid indexing collisions).

\end{fulllineitems}

\index{auto\_select\_kriging\_parameters() (wass2s.was\_merge\_predictand.WAS\_Merging method)@\spxentry{auto\_select\_kriging\_parameters()}\spxextra{wass2s.was\_merge\_predictand.WAS\_Merging method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_merge_predictand.WAS_Merging.auto_select_kriging_parameters}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{auto\_select\_kriging\_parameters}}}
{\sphinxparam{\DUrole{n}{df}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{DataFrame}}\sphinxparamcomma \sphinxparam{\DUrole{n}{x\_col}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{str}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{\textquotesingle{}X\textquotesingle{}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_col}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{str}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{\textquotesingle{}Y\textquotesingle{}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{z\_col}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{str}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{\textquotesingle{}residuals\textquotesingle{}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{variogram\_models}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{list}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{nlags\_range}\DUrole{o}{=}\DUrole{default_value}{range(3, 10)}}\sphinxparamcomma \sphinxparam{\DUrole{n}{n\_splits}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{int}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{5}}\sphinxparamcomma \sphinxparam{\DUrole{n}{random\_state}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{int}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{42}}\sphinxparamcomma \sphinxparam{\DUrole{n}{verbose}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{bool}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{False}}\sphinxparamcomma \sphinxparam{\DUrole{n}{enable\_plotting}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{bool}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{False}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Automatically selects the best variogram\_model and nlags for Ordinary Kriging
using cross\sphinxhyphen{}validation.
\begin{quote}\begin{description}
\sphinxlineitem{Returns}
\sphinxAtStartPar
\begin{itemize}
\item {} 
\sphinxAtStartPar
best\_model (str)

\item {} 
\sphinxAtStartPar
best\_nlags (int)

\item {} 
\sphinxAtStartPar
ok\_best (OrdinaryKriging object)

\item {} 
\sphinxAtStartPar
results\_df (pd.DataFrame)

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{multiplicative\_bias() (wass2s.was\_merge\_predictand.WAS\_Merging method)@\spxentry{multiplicative\_bias()}\spxextra{wass2s.was\_merge\_predictand.WAS\_Merging method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_merge_predictand.WAS_Merging.multiplicative_bias}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{multiplicative\_bias}}}
{\sphinxparam{\DUrole{n}{missing\_value: float = \sphinxhyphen{}999.0}}\sphinxparamcomma \sphinxparam{\DUrole{n}{do\_cross\_validation: bool = False) \sphinxhyphen{}\textgreater{} (\textless{}class \textquotesingle{}xarray.core.dataarray.DataArray\textquotesingle{}\textgreater{}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{\textless{}class \textquotesingle{}pandas.core.frame.DataFrame\textquotesingle{}\textgreater{}}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Apply multiplicative bias correction to gridded predictions using ground observations.

\sphinxAtStartPar
This method performs bias adjustment for each time step by comparing standardized observations
and model estimates, interpolating residuals using kriging, and applying a multiplicative correction
across the spatial domain.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{missing\_value}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Value used to represent missing data in the input observational CSV, by default \sphinxhyphen{}999.0.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{do\_cross\_validation}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} If True, perform Leave\sphinxhyphen{}One\sphinxhyphen{}Out Cross\sphinxhyphen{}Validation to estimate kriging performance, by default False.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleemphasis{xr.DataArray} \textendash{} The bias\sphinxhyphen{}corrected spatial dataset over time (with dimensions: T, Y, X), masked over valid areas.

\item {} 
\sphinxAtStartPar
\sphinxstyleemphasis{pd.DataFrame or None} \textendash{} DataFrame containing LOOCV RMSE per time step, or None if cross\sphinxhyphen{}validation was not performed.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{neural\_network\_kriging() (wass2s.was\_merge\_predictand.WAS\_Merging method)@\spxentry{neural\_network\_kriging()}\spxextra{wass2s.was\_merge\_predictand.WAS\_Merging method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_merge_predictand.WAS_Merging.neural_network_kriging}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{neural\_network\_kriging}}}
{\sphinxparam{\DUrole{n}{missing\_value: float = \sphinxhyphen{}999.0}}\sphinxparamcomma \sphinxparam{\DUrole{n}{do\_cross\_validation: bool = False) \sphinxhyphen{}\textgreater{} (\textless{}class \textquotesingle{}xarray.core.dataarray.DataArray\textquotesingle{}\textgreater{}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{pandas.core.frame.DataFrame | None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Performs a two\sphinxhyphen{}step spatial bias adjustment for each time slice, leveraging:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{)}%
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Neural Network} (MLPRegressor) to capture non\sphinxhyphen{}linear relationships between
the large\sphinxhyphen{}scale estimations (predictors) and in\sphinxhyphen{}situ observations (predictands).

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Kriging} of the residuals (observation \sphinxhyphen{} NN\_prediction) to spatially interpolate
the remaining error structure under the assumption that these residuals are
stationary and exhibit spatial autocorrelation.

\end{enumerate}
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{missing\_value}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Value used to fill missing data in the input station dataset, by default \sphinxhyphen{}999.0

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{do\_cross\_validation}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Whether or not to perform cross\sphinxhyphen{}validation (e.g., leave\sphinxhyphen{}one\sphinxhyphen{}out or k\sphinxhyphen{}fold)
during kriging parameter selection, by default False.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleemphasis{xr.DataArray} \textendash{} Bias\sphinxhyphen{}adjusted field over the domain, with the same spatial dimensions as the
original input (and time dimension if applicable).

\item {} 
\sphinxAtStartPar
\sphinxstyleemphasis{pd.DataFrame or None} \textendash{} If \sphinxtitleref{do\_cross\_validation=True}, returns a DataFrame with RMSE records from CV;
otherwise, None.

\end{itemize}


\end{description}\end{quote}
\subsubsection*{Notes}
\begin{itemize}
\item {} 
\sphinxAtStartPar
The hyperparameter search for the MLP uses GridSearchCV with MSE\sphinxhyphen{}based scoring.

\item {} 
\sphinxAtStartPar
Kriging assumes the residuals are reasonably stationary and spatially correlated.

\end{itemize}

\end{fulllineitems}

\index{neural\_network\_kriging\_() (wass2s.was\_merge\_predictand.WAS\_Merging method)@\spxentry{neural\_network\_kriging\_()}\spxextra{wass2s.was\_merge\_predictand.WAS\_Merging method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_merge_predictand.WAS_Merging.neural_network_kriging_}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{neural\_network\_kriging\_}}}
{\sphinxparam{\DUrole{n}{missing\_value: float = \sphinxhyphen{}999.0}}\sphinxparamcomma \sphinxparam{\DUrole{n}{do\_cross\_validation: bool = False) \sphinxhyphen{}\textgreater{} (\textless{}class \textquotesingle{}xarray.core.dataarray.DataArray\textquotesingle{}\textgreater{}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{\textless{}class \textquotesingle{}pandas.core.frame.DataFrame\textquotesingle{}\textgreater{}}}}
{}
\pysigstopsignatures\begin{description}
\sphinxlineitem{Performs spatial bias adjustment for each time slice using:}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{)}%
\item {} 
\sphinxAtStartPar
Neural Network

\item {} 
\sphinxAtStartPar
Kriging of residuals

\end{enumerate}

\end{description}

\sphinxAtStartPar
Optionally performs LOO cross\sphinxhyphen{}validation for each time.

\end{fulllineitems}

\index{plot\_merging\_comparaison() (wass2s.was\_merge\_predictand.WAS\_Merging method)@\spxentry{plot\_merging\_comparaison()}\spxextra{wass2s.was\_merge\_predictand.WAS\_Merging method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_merge_predictand.WAS_Merging.plot_merging_comparaison}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{plot\_merging\_comparaison}}}
{\sphinxparam{\DUrole{n}{df\_Obs}}\sphinxparamcomma \sphinxparam{\DUrole{n}{da\_estimated}}\sphinxparamcomma \sphinxparam{\DUrole{n}{da\_corrected}}\sphinxparamcomma \sphinxparam{\DUrole{n}{missing\_value}\DUrole{o}{=}\DUrole{default_value}{\sphinxhyphen{}999.0}}}
{}
\pysigstopsignatures
\end{fulllineitems}

\index{regression\_kriging() (wass2s.was\_merge\_predictand.WAS\_Merging method)@\spxentry{regression\_kriging()}\spxextra{wass2s.was\_merge\_predictand.WAS\_Merging method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_merge_predictand.WAS_Merging.regression_kriging}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{regression\_kriging}}}
{\sphinxparam{\DUrole{n}{missing\_value: float = \sphinxhyphen{}999.0}}\sphinxparamcomma \sphinxparam{\DUrole{n}{do\_cross\_validation: bool = False) \sphinxhyphen{}\textgreater{} (\textless{}class \textquotesingle{}xarray.core.dataarray.DataArray\textquotesingle{}\textgreater{}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{\textless{}class \textquotesingle{}pandas.core.frame.DataFrame\textquotesingle{}\textgreater{}}}}
{}
\pysigstopsignatures\begin{description}
\sphinxlineitem{Performs spatial bias adjustment for each time slice using:}\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{)}%
\item {} 
\sphinxAtStartPar
Linear Regression

\item {} 
\sphinxAtStartPar
Kriging of residuals

\end{enumerate}

\end{description}

\sphinxAtStartPar
Optionally performs LOO cross\sphinxhyphen{}validation for each time.

\end{fulllineitems}

\index{simple\_bias\_adjustment() (wass2s.was\_merge\_predictand.WAS\_Merging method)@\spxentry{simple\_bias\_adjustment()}\spxextra{wass2s.was\_merge\_predictand.WAS\_Merging method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_merge_predictand.WAS_Merging.simple_bias_adjustment}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{simple\_bias\_adjustment}}}
{\sphinxparam{\DUrole{n}{missing\_value: float = \sphinxhyphen{}999.0}}\sphinxparamcomma \sphinxparam{\DUrole{n}{do\_cross\_validation: bool = False) \sphinxhyphen{}\textgreater{} (\textless{}class \textquotesingle{}xarray.core.dataarray.DataArray\textquotesingle{}\textgreater{}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{\textless{}class \textquotesingle{}pandas.core.frame.DataFrame\textquotesingle{}\textgreater{}}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Performs spatial bias adjustment for each time slice. Optionally does
leave\sphinxhyphen{}one\sphinxhyphen{}out (LOO) cross\sphinxhyphen{}validation to compute RMSE at each time.
\begin{quote}\begin{description}
\sphinxlineitem{Returns}
\sphinxAtStartPar
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleemphasis{xr.DataArray} \textendash{} Concatenated bias\sphinxhyphen{}adjusted values along the time dimension.

\item {} 
\sphinxAtStartPar
\sphinxstyleemphasis{pd.DataFrame or None} \textendash{} A DataFrame containing the LOO RMSE for each time if do\_cross\_validation=True.
Otherwise, returns None.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{transform\_cdt() (wass2s.was\_merge\_predictand.WAS\_Merging method)@\spxentry{transform\_cdt()}\spxextra{wass2s.was\_merge\_predictand.WAS\_Merging method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_merge_predictand.WAS_Merging.transform_cdt}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{transform\_cdt}}}
{\sphinxparam{\DUrole{n}{df}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{DataFrame}}}
{{ $\rightarrow$ DataArray}}
\pysigstopsignatures
\end{fulllineitems}

\index{transform\_cpt() (wass2s.was\_merge\_predictand.WAS\_Merging method)@\spxentry{transform\_cpt()}\spxextra{wass2s.was\_merge\_predictand.WAS\_Merging method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_merge_predictand.WAS_Merging.transform_cpt}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{transform\_cpt}}}
{\sphinxparam{\DUrole{n}{df}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{DataFrame}}\sphinxparamcomma \sphinxparam{\DUrole{n}{missing\_value}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{float}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{\sphinxhyphen{}999.0}}}
{{ $\rightarrow$ DataArray}}
\pysigstopsignatures
\end{fulllineitems}


\end{fulllineitems}



\subsection{wass2s.was\_cross\_validate module}
\label{\detokenize{api:module-wass2s.was_cross_validate}}\label{\detokenize{api:wass2s-was-cross-validate-module}}\index{module@\spxentry{module}!wass2s.was\_cross\_validate@\spxentry{wass2s.was\_cross\_validate}}\index{wass2s.was\_cross\_validate@\spxentry{wass2s.was\_cross\_validate}!module@\spxentry{module}}\index{CustomTimeSeriesSplit (class in wass2s.was\_cross\_validate)@\spxentry{CustomTimeSeriesSplit}\spxextra{class in wass2s.was\_cross\_validate}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_cross_validate.CustomTimeSeriesSplit}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_cross\_validate.}}\sphinxbfcode{\sphinxupquote{CustomTimeSeriesSplit}}}
{\sphinxparam{\DUrole{n}{n\_splits}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
Custom time series cross\sphinxhyphen{}validator for splitting data into training and test sets.

\sphinxAtStartPar
Ensures temporal ordering is maintained by generating training and test indices
suitable for time series data, with an option to omit samples after the test index.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{n\_splits}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Number of splits for the cross\sphinxhyphen{}validation.

\end{description}\end{quote}
\index{get\_n\_splits() (wass2s.was\_cross\_validate.CustomTimeSeriesSplit method)@\spxentry{get\_n\_splits()}\spxextra{wass2s.was\_cross\_validate.CustomTimeSeriesSplit method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_cross_validate.CustomTimeSeriesSplit.get_n_splits}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{get\_n\_splits}}}
{\sphinxparam{\DUrole{n}{X}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{groups}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Return the number of splits for the cross\sphinxhyphen{}validation.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} The data to be split (ignored in this implementation).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} The target variable (ignored in this implementation).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{groups}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Group labels for the samples (ignored in this implementation).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
The number of splits configured for the cross\sphinxhyphen{}validator.

\sphinxlineitem{Return type}
\sphinxAtStartPar
int

\end{description}\end{quote}

\end{fulllineitems}

\index{split() (wass2s.was\_cross\_validate.CustomTimeSeriesSplit method)@\spxentry{split()}\spxextra{wass2s.was\_cross\_validate.CustomTimeSeriesSplit method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_cross_validate.CustomTimeSeriesSplit.split}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{split}}}
{\sphinxparam{\DUrole{n}{X}}\sphinxparamcomma \sphinxparam{\DUrole{n}{nb\_omit}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{groups}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Generate indices to split data into training and test sets.

\sphinxAtStartPar
Yields training indices before the test index (excluding a specified number of samples
after the test index) and test indices for each split.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} The data to be split, typically time series data.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{nb\_omit}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Number of samples to omit from training after the test index to avoid data leakage.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} The target variable (ignored in this implementation).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{groups}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Group labels for the samples (ignored in this implementation).

\end{itemize}

\sphinxlineitem{Yields}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{train\_indices} (\sphinxstyleemphasis{ndarray}) \textendash{} The training set indices for the current split.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{test\_indices} (\sphinxstyleemphasis{list}) \textendash{} The test set indices for the current split.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{WAS\_Cross\_Validator (class in wass2s.was\_cross\_validate)@\spxentry{WAS\_Cross\_Validator}\spxextra{class in wass2s.was\_cross\_validate}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_cross_validate.WAS_Cross_Validator}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_cross\_validate.}}\sphinxbfcode{\sphinxupquote{WAS\_Cross\_Validator}}}
{\sphinxparam{\DUrole{n}{n\_splits}}\sphinxparamcomma \sphinxparam{\DUrole{n}{nb\_omit}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
Performs cross\sphinxhyphen{}validation for time series forecasting models using a custom time series split.

\sphinxAtStartPar
This class wraps a custom time series cross\sphinxhyphen{}validator to evaluate forecasting models,
handling both deterministic hindcasts and probabilistic (tercile) predictions.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{n\_splits}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Number of splits for the cross\sphinxhyphen{}validation.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{nb\_omit}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Number of samples to omit from training after the test index to prevent data leakage.

\end{itemize}

\end{description}\end{quote}
\index{cross\_validate() (wass2s.was\_cross\_validate.WAS\_Cross\_Validator method)@\spxentry{cross\_validate()}\spxextra{wass2s.was\_cross\_validate.WAS\_Cross\_Validator method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_cross_validate.WAS_Cross_Validator.cross_validate}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{cross\_validate}}}
{\sphinxparam{\DUrole{n}{model}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{o}{**}\DUrole{n}{model\_params}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Perform cross\sphinxhyphen{}validation to compute deterministic hindcasts and tercile probabilities.

\sphinxAtStartPar
Iterates over time series splits, trains the model on training data, and generates
predictions for test data. Supports special handling for specific model types
(e.g., CCA, Analog, ELM, ELR, and various machine learning models).
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{model}} (\sphinxstyleliteralemphasis{\sphinxupquote{object}}) \textendash{} The forecasting model instance to evaluate.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Target dataset with dimensions (‘T’, ‘Y’, ‘X’) or (‘T’, ‘M’, ‘Y’, ‘X’).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictor}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Predictor dataset with dimensions (‘T’, ‘M’, ‘Y’, ‘X’) or (‘T’, ‘features’).
Required for most models except specific cases like WAS\_Analog.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Start year of the climatology period for standardization and probability calculations.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} End year of the climatology period for standardization and probability calculations.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{**model\_params}} (\sphinxstyleliteralemphasis{\sphinxupquote{dict}}) \textendash{} Additional keyword arguments to pass to the model’s compute\_model method.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\begin{description}
\sphinxlineitem{If the model supports probability calculations (has compute\_prob method):}\begin{itemize}
\item {} \begin{description}
\sphinxlineitem{hindcast\_det}{[}xarray.DataArray{]}
\sphinxAtStartPar
Deterministic hindcast results with dimensions (‘T’, ‘Y’, ‘X’) or
(‘probability’, ‘T’, ‘Y’, ‘X’) for specific models.

\end{description}

\item {} \begin{description}
\sphinxlineitem{hindcast\_prob}{[}xarray.DataArray{]}
\sphinxAtStartPar
Tercile probabilities with dimensions (‘probability’, ‘T’, ‘Y’, ‘X’),
where ‘probability’ includes {[}‘PB’, ‘PN’, ‘PA’{]} (below\sphinxhyphen{}normal, normal, above\sphinxhyphen{}normal).

\end{description}

\end{itemize}

\sphinxlineitem{If the model does not support probability calculations (e.g., WAS\_mme\_ELR):}\begin{itemize}
\item {} \begin{description}
\sphinxlineitem{hindcast\_det}{[}xarray.DataArray{]}
\sphinxAtStartPar
Deterministic hindcast results with dimensions (‘T’, ‘Y’, ‘X’).

\end{description}

\end{itemize}

\end{description}


\sphinxlineitem{Return type}
\sphinxAtStartPar
tuple or xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_model\_params() (wass2s.was\_cross\_validate.WAS\_Cross\_Validator method)@\spxentry{get\_model\_params()}\spxextra{wass2s.was\_cross\_validate.WAS\_Cross\_Validator method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_cross_validate.WAS_Cross_Validator.get_model_params}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{get\_model\_params}}}
{\sphinxparam{\DUrole{n}{model}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Retrieve parameters required for the model’s compute\_model method.

\sphinxAtStartPar
Extracts parameters dynamically from the model’s attributes that match the
argument names of its compute\_model method.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{model}} (\sphinxstyleliteralemphasis{\sphinxupquote{object}}) \textendash{} The forecasting model instance to inspect.

\sphinxlineitem{Returns}
\sphinxAtStartPar
Dictionary of parameter names and values to pass to the model’s compute\_model method.

\sphinxlineitem{Return type}
\sphinxAtStartPar
dict

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\subsection{wass2s.was\_linear\_models module}
\label{\detokenize{api:module-wass2s.was_linear_models}}\label{\detokenize{api:wass2s-was-linear-models-module}}\index{module@\spxentry{module}!wass2s.was\_linear\_models@\spxentry{wass2s.was\_linear\_models}}\index{wass2s.was\_linear\_models@\spxentry{wass2s.was\_linear\_models}!module@\spxentry{module}}\index{WAS\_ElasticNet\_Model (class in wass2s.was\_linear\_models)@\spxentry{WAS\_ElasticNet\_Model}\spxextra{class in wass2s.was\_linear\_models}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_ElasticNet_Model}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_linear\_models.}}\sphinxbfcode{\sphinxupquote{WAS\_ElasticNet\_Model}}}
{\sphinxparam{\DUrole{n}{alpha\_range}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{l1\_ratio\_range}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{n\_clusters}\DUrole{o}{=}\DUrole{default_value}{5}}\sphinxparamcomma \sphinxparam{\DUrole{n}{nb\_cores}\DUrole{o}{=}\DUrole{default_value}{1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dist\_method}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}gamma\textquotesingle{}}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
A class to implement the ElasticNet model for spatiotemporal regression with clustering,
cross\sphinxhyphen{}validation, and probabilistic predictions.


\subsubsection{Attributes:}
\label{\detokenize{api:attributes}}\begin{description}
\sphinxlineitem{alpha\_range}{[}numpy.ndarray{]}
\sphinxAtStartPar
Range of alpha values (regularization strength) to explore.
Default is from 10\textasciicircum{}\sphinxhyphen{}6 to 10\textasciicircum{}2.

\sphinxlineitem{l1\_ratio\_range}{[}list{]}
\sphinxAtStartPar
Range of l1 ratio values (mixing between L1 and L2 penalties).
Default is {[}0.1, 0.5, 0.7, 0.9, 0.95, 0.99, 1{]}.

\sphinxlineitem{n\_clusters}{[}int{]}
\sphinxAtStartPar
Number of clusters for KMeans\sphinxhyphen{}based spatial grouping. Default is 5.

\sphinxlineitem{nb\_cores}{[}int{]}
\sphinxAtStartPar
Number of CPU cores for parallel computations. Default is 1.

\sphinxlineitem{dist\_method}{[}str{]}
\sphinxAtStartPar
Distribution method for tercile probability calculations
(e.g. ‘gamma’,’t’,’normal’,’lognormal’,’nonparam’). Default = “gamma”.

\end{description}


\subsubsection{Methods:}
\label{\detokenize{api:methods}}\begin{description}
\sphinxlineitem{fit\_predict(x, y, x\_test, y\_test=None, alpha=None, l1\_ratio=None)}
\sphinxAtStartPar
Fits an ElasticNet model to training data and predicts values for test data.

\sphinxlineitem{compute\_hyperparameters(predictand, predictor)}
\sphinxAtStartPar
Computes the optimal alpha and l1 ratio for each cluster using cross\sphinxhyphen{}validation.

\sphinxlineitem{compute\_model(X\_train, y\_train, X\_test, y\_test, alpha, l1\_ratio)}
\sphinxAtStartPar
Performs parallelized ElasticNet modeling for spatiotemporal data.

\sphinxlineitem{calculate\_tercile\_probabilities(…)}
\sphinxAtStartPar
Various static methods for computing tercile probabilities (t, gamma, normal, etc.).

\sphinxlineitem{compute\_prob(Predictant, clim\_year\_start, clim\_year\_end, Predictor, hindcast\_det)}
\sphinxAtStartPar
Computes probabilistic hindcasts for tercile categories based on climatological terciles.

\sphinxlineitem{forecast(Predictant, clim\_year\_start, clim\_year\_end, Predictor, hindcast\_det, Predictor\_for\_year, alpha, l1\_ratio)}
\sphinxAtStartPar
Generates a single\sphinxhyphen{}year forecast using ElasticNet with alpha + l1\_ratio,
and computes tercile probabilities based on the chosen method.

\end{description}
\index{calculate\_tercile\_probabilities() (wass2s.was\_linear\_models.WAS\_ElasticNet\_Model static method)@\spxentry{calculate\_tercile\_probabilities()}\spxextra{wass2s.was\_linear\_models.WAS\_ElasticNet\_Model static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_ElasticNet_Model.calculate_tercile_probabilities}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Student’s t\sphinxhyphen{}based method for tercile probabilities.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_gamma() (wass2s.was\_linear\_models.WAS\_ElasticNet\_Model static method)@\spxentry{calculate\_tercile\_probabilities\_gamma()}\spxextra{wass2s.was\_linear\_models.WAS\_ElasticNet\_Model static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_ElasticNet_Model.calculate_tercile_probabilities_gamma}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_gamma}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T2}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Gamma\sphinxhyphen{}based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_lognormal() (wass2s.was\_linear\_models.WAS\_ElasticNet\_Model static method)@\spxentry{calculate\_tercile\_probabilities\_lognormal()}\spxextra{wass2s.was\_linear\_models.WAS\_ElasticNet\_Model static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_ElasticNet_Model.calculate_tercile_probabilities_lognormal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_lognormal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Lognormal\sphinxhyphen{}based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_nonparametric() (wass2s.was\_linear\_models.WAS\_ElasticNet\_Model static method)@\spxentry{calculate\_tercile\_probabilities\_nonparametric()}\spxextra{wass2s.was\_linear\_models.WAS\_ElasticNet\_Model static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_ElasticNet_Model.calculate_tercile_probabilities_nonparametric}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_nonparametric}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_samples}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Non\sphinxhyphen{}parametric method (requires historical errors).

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_normal() (wass2s.was\_linear\_models.WAS\_ElasticNet\_Model static method)@\spxentry{calculate\_tercile\_probabilities\_normal()}\spxextra{wass2s.was\_linear\_models.WAS\_ElasticNet\_Model static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_ElasticNet_Model.calculate_tercile_probabilities_normal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_normal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Normal\sphinxhyphen{}based method using the Gaussian CDF.

\end{fulllineitems}

\index{compute\_hyperparameters() (wass2s.was\_linear\_models.WAS\_ElasticNet\_Model method)@\spxentry{compute\_hyperparameters()}\spxextra{wass2s.was\_linear\_models.WAS\_ElasticNet\_Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_ElasticNet_Model.compute_hyperparameters}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_hyperparameters}}}
{\sphinxparam{\DUrole{n}{predictand}}\sphinxparamcomma \sphinxparam{\DUrole{n}{predictor}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Computes the optimal alpha and l1 ratio for each cluster using cross\sphinxhyphen{}validation.

\end{fulllineitems}

\index{compute\_model() (wass2s.was\_linear\_models.WAS\_ElasticNet\_Model method)@\spxentry{compute\_model()}\spxextra{wass2s.was\_linear\_models.WAS\_ElasticNet\_Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_ElasticNet_Model.compute_model}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_model}}}
{\sphinxparam{\DUrole{n}{X\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{X\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{alpha}}\sphinxparamcomma \sphinxparam{\DUrole{n}{l1\_ratio}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Performs parallelized ElasticNet modeling for spatiotemporal data.
Returns {[}error, prediction{]} per grid cell.

\end{fulllineitems}

\index{compute\_prob() (wass2s.was\_linear\_models.WAS\_ElasticNet\_Model method)@\spxentry{compute\_prob()}\spxextra{wass2s.was\_linear\_models.WAS\_ElasticNet\_Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_ElasticNet_Model.compute_prob}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_prob}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute tercile probabilities using self.dist\_method.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}\sphinxstyleliteralemphasis{\sphinxupquote{ (}}\sphinxstyleliteralemphasis{\sphinxupquote{T}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{Y}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{X}}\sphinxstyleliteralemphasis{\sphinxupquote{)}}) \textendash{} Observed data.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}})

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} The start and end years for the climatology.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Deterministic forecast with dims (output=2, T, Y, X).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{hindcast\_prob} \textendash{} dims (probability=3, T, Y, X) =\textgreater{} {[}PB, PN, PA{]}.

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{fit\_predict() (wass2s.was\_linear\_models.WAS\_ElasticNet\_Model method)@\spxentry{fit\_predict()}\spxextra{wass2s.was\_linear\_models.WAS\_ElasticNet\_Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_ElasticNet_Model.fit_predict}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{fit\_predict}}}
{\sphinxparam{\DUrole{n}{x}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y}}\sphinxparamcomma \sphinxparam{\DUrole{n}{x\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{alpha}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{l1\_ratio}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Fits an ElasticNet model to training data and predicts on test data.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{x}} (\sphinxstyleliteralemphasis{\sphinxupquote{ndarray}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{shape}}\sphinxstyleliteralemphasis{\sphinxupquote{ (}}\sphinxstyleliteralemphasis{\sphinxupquote{n\_samples}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{n\_features}}\sphinxstyleliteralemphasis{\sphinxupquote{)}})

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y}} (\sphinxstyleliteralemphasis{\sphinxupquote{ndarray}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{shape}}\sphinxstyleliteralemphasis{\sphinxupquote{ (}}\sphinxstyleliteralemphasis{\sphinxupquote{n\_samples}}\sphinxstyleliteralemphasis{\sphinxupquote{,}}\sphinxstyleliteralemphasis{\sphinxupquote{)}})

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{x\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{ndarray}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{shape}}\sphinxstyleliteralemphasis{\sphinxupquote{ (}}\sphinxstyleliteralemphasis{\sphinxupquote{n\_features}}\sphinxstyleliteralemphasis{\sphinxupquote{,}}\sphinxstyleliteralemphasis{\sphinxupquote{) or }}\sphinxstyleliteralemphasis{\sphinxupquote{(}}\sphinxstyleliteralemphasis{\sphinxupquote{1}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{n\_features}}\sphinxstyleliteralemphasis{\sphinxupquote{)}})

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{None}})

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{alpha}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}})

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{l1\_ratio}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}})

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
{[}error, prediction{]} if y\_test is provided;
{[}prediction{]} if y\_test is None.

\sphinxlineitem{Return type}
\sphinxAtStartPar
np.ndarray

\end{description}\end{quote}

\end{fulllineitems}

\index{forecast() (wass2s.was\_linear\_models.WAS\_ElasticNet\_Model method)@\spxentry{forecast()}\spxextra{wass2s.was\_linear\_models.WAS\_ElasticNet\_Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_ElasticNet_Model.forecast}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{forecast}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor\_for\_year}}\sphinxparamcomma \sphinxparam{\DUrole{n}{alpha}}\sphinxparamcomma \sphinxparam{\DUrole{n}{l1\_ratio}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Generates a single\sphinxhyphen{}year forecast using ElasticNet with (alpha, l1\_ratio),
and computes tercile probabilities.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Observed data (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Climatology reference period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Climatology reference period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictor}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Historical predictor data (T, features).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Historical deterministic forecast with dims (output=2, T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictor\_for\_year}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Single\sphinxhyphen{}year predictor data (features,).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{alpha}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Spatial map of alpha values (Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{l1\_ratio}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Spatial map of l1\_ratio values (Y, X).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{result\_} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} dims (output=2, Y, X) =\textgreater{} {[}error, forecast{]}.
For a real forecast scenario, ‘error’ is NaN.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{hindcast\_prob} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} dims (probability=3, Y, X) =\textgreater{} {[}PB, PN, PA{]}.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{WAS\_LassoLars\_Model (class in wass2s.was\_linear\_models)@\spxentry{WAS\_LassoLars\_Model}\spxextra{class in wass2s.was\_linear\_models}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_LassoLars_Model}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_linear\_models.}}\sphinxbfcode{\sphinxupquote{WAS\_LassoLars\_Model}}}
{\sphinxparam{\DUrole{n}{alpha\_range}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{n\_clusters}\DUrole{o}{=}\DUrole{default_value}{5}}\sphinxparamcomma \sphinxparam{\DUrole{n}{nb\_cores}\DUrole{o}{=}\DUrole{default_value}{1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dist\_method}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}gamma\textquotesingle{}}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
A class to implement the Lasso Least Angle Regression (LassoLars) model for spatiotemporal
climate prediction.

\sphinxAtStartPar
This model is designed to work with climate data by clustering spatial regions, computing
hyperparameters for each cluster, and fitting a LassoLars model for predictions. The model
is optimized for parallel execution using Dask.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{alpha\_range}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Range of alpha values for the LassoLars model.
Default is np.array({[}10**i for i in range(\sphinxhyphen{}6, 6){]}).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{n\_clusters}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{default=5}}) \textendash{} Number of clusters to partition the spatial data.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{nb\_cores}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{default=1}}) \textendash{} Number of cores for parallel processing.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dist\_method}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{default=\textquotesingle{}gamma\textquotesingle{}}}) \textendash{} Distribution method for calculating tercile probabilities.
One of \{‘gamma’,’t’,’normal’,’lognormal’,’nonparam’\}.

\end{itemize}

\end{description}\end{quote}
\index{fit\_predict() (wass2s.was\_linear\_models.WAS\_LassoLars\_Model method)@\spxentry{fit\_predict()}\spxextra{wass2s.was\_linear\_models.WAS\_LassoLars\_Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_LassoLars_Model.fit_predict}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{fit\_predict}}}
{\sphinxparam{\DUrole{n}{x}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y}}\sphinxparamcomma \sphinxparam{\DUrole{n}{x\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{alpha}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Fits the LassoLars model to the training data and predicts values for the test data.

\end{fulllineitems}

\index{compute\_hyperparameters() (wass2s.was\_linear\_models.WAS\_LassoLars\_Model method)@\spxentry{compute\_hyperparameters()}\spxextra{wass2s.was\_linear\_models.WAS\_LassoLars\_Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_LassoLars_Model.compute_hyperparameters}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_hyperparameters}}}
{\sphinxparam{\DUrole{n}{predictand}}\sphinxparamcomma \sphinxparam{\DUrole{n}{predictor}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Computes cluster\sphinxhyphen{}wise optimal alpha values for LassoLars using cross\sphinxhyphen{}validation.

\end{fulllineitems}

\index{compute\_model() (wass2s.was\_linear\_models.WAS\_LassoLars\_Model method)@\spxentry{compute\_model()}\spxextra{wass2s.was\_linear\_models.WAS\_LassoLars\_Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_LassoLars_Model.compute_model}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_model}}}
{\sphinxparam{\DUrole{n}{X\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{X\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{alpha}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Fits and predicts the LassoLars model using Dask for parallel execution.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities() (wass2s.was\_linear\_models.WAS\_LassoLars\_Model method)@\spxentry{calculate\_tercile\_probabilities()}\spxextra{wass2s.was\_linear\_models.WAS\_LassoLars\_Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_LassoLars_Model.calculate_tercile_probabilities}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities}}}
{\sphinxparam{\DUrole{n}{...}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Calculates tercile probabilities using the chosen distribution method (Student’s t, gamma, etc.).

\end{fulllineitems}

\index{compute\_prob() (wass2s.was\_linear\_models.WAS\_LassoLars\_Model method)@\spxentry{compute\_prob()}\spxextra{wass2s.was\_linear\_models.WAS\_LassoLars\_Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_LassoLars_Model.compute_prob}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_prob}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Computes the tercile probabilities for hindcast predictions using a climatological period.

\end{fulllineitems}

\index{forecast() (wass2s.was\_linear\_models.WAS\_LassoLars\_Model method)@\spxentry{forecast()}\spxextra{wass2s.was\_linear\_models.WAS\_LassoLars\_Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_LassoLars_Model.forecast}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{forecast}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor\_for\_year}}\sphinxparamcomma \sphinxparam{\DUrole{n}{alpha}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Generates a forecast for a single time step and computes tercile probabilities.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities() (wass2s.was\_linear\_models.WAS\_LassoLars\_Model static method)@\spxentry{calculate\_tercile\_probabilities()}\spxextra{wass2s.was\_linear\_models.WAS\_LassoLars\_Model static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:id0}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Student’s t\sphinxhyphen{}based method

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_gamma() (wass2s.was\_linear\_models.WAS\_LassoLars\_Model static method)@\spxentry{calculate\_tercile\_probabilities\_gamma()}\spxextra{wass2s.was\_linear\_models.WAS\_LassoLars\_Model static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_LassoLars_Model.calculate_tercile_probabilities_gamma}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_gamma}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T2}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Gamma\sphinxhyphen{}based method

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_lognormal() (wass2s.was\_linear\_models.WAS\_LassoLars\_Model static method)@\spxentry{calculate\_tercile\_probabilities\_lognormal()}\spxextra{wass2s.was\_linear\_models.WAS\_LassoLars\_Model static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_LassoLars_Model.calculate_tercile_probabilities_lognormal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_lognormal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Lognormal\sphinxhyphen{}based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_nonparametric() (wass2s.was\_linear\_models.WAS\_LassoLars\_Model static method)@\spxentry{calculate\_tercile\_probabilities\_nonparametric()}\spxextra{wass2s.was\_linear\_models.WAS\_LassoLars\_Model static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_LassoLars_Model.calculate_tercile_probabilities_nonparametric}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_nonparametric}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_samples}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Non\sphinxhyphen{}parametric method (requires historical errors).

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_normal() (wass2s.was\_linear\_models.WAS\_LassoLars\_Model static method)@\spxentry{calculate\_tercile\_probabilities\_normal()}\spxextra{wass2s.was\_linear\_models.WAS\_LassoLars\_Model static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_LassoLars_Model.calculate_tercile_probabilities_normal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_normal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Normal\sphinxhyphen{}based method using the Gaussian CDF.

\end{fulllineitems}

\index{compute\_hyperparameters() (wass2s.was\_linear\_models.WAS\_LassoLars\_Model method)@\spxentry{compute\_hyperparameters()}\spxextra{wass2s.was\_linear\_models.WAS\_LassoLars\_Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:id2}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_hyperparameters}}}
{\sphinxparam{\DUrole{n}{predictand}}\sphinxparamcomma \sphinxparam{\DUrole{n}{predictor}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Computes cluster\sphinxhyphen{}wise optimal alpha values for LassoLars using cross\sphinxhyphen{}validation.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{predictand}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} The response variable for clustering and training (dims: T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{predictor}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Predictor variables used for fitting the model (dims: T, features).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{alpha\_array} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} Cluster\sphinxhyphen{}wise optimal alpha values.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Cluster} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} Cluster assignment for each spatial point.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_model() (wass2s.was\_linear\_models.WAS\_LassoLars\_Model method)@\spxentry{compute\_model()}\spxextra{wass2s.was\_linear\_models.WAS\_LassoLars\_Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:id3}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_model}}}
{\sphinxparam{\DUrole{n}{X\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{X\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{alpha}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Fits and predicts the LassoLars model using Dask for parallel execution.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Training predictor data (dims: T, features).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Training response variable (dims: T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Test predictor data (dims: features,) or broadcastable to (Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Test response variable (dims: Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{alpha}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Cluster\sphinxhyphen{}wise optimal alpha values (dims: Y, X).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
dims (output=2, Y, X) =\textgreater{} {[}error, prediction{]}.

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_prob() (wass2s.was\_linear\_models.WAS\_LassoLars\_Model method)@\spxentry{compute\_prob()}\spxextra{wass2s.was\_linear\_models.WAS\_LassoLars\_Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:id4}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_prob}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute tercile probabilities using self.dist\_method.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}\sphinxstyleliteralemphasis{\sphinxupquote{ (}}\sphinxstyleliteralemphasis{\sphinxupquote{T}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{Y}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{X}}\sphinxstyleliteralemphasis{\sphinxupquote{)}}) \textendash{} Observed data.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}})

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} The start and end years for the climatology.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Deterministic forecast with dims (output=2, T, Y, X).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{hindcast\_prob} \textendash{} dims (probability=3, T, Y, X) =\textgreater{} {[}PB, PN, PA{]}.

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{fit\_predict() (wass2s.was\_linear\_models.WAS\_LassoLars\_Model method)@\spxentry{fit\_predict()}\spxextra{wass2s.was\_linear\_models.WAS\_LassoLars\_Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:id5}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{fit\_predict}}}
{\sphinxparam{\DUrole{n}{x}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y}}\sphinxparamcomma \sphinxparam{\DUrole{n}{x\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{alpha}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Fits the LassoLars model to the training data and predicts values for the test data.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{x}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Training predictors (shape: {[}n\_samples, n\_features{]}).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Training response variable (shape: {[}n\_samples,{]}).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{x\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Test predictors (shape: {[}n\_features,{]} or {[}1, n\_features{]}).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} Test response (scalar or shape {[}1,{]}) for test data.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{alpha}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} Regularization strength parameter for LassoLars.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
{[}error, prediction{]}, or {[}np.nan, np.nan{]} if no valid data.

\sphinxlineitem{Return type}
\sphinxAtStartPar
np.ndarray of shape (2,)

\end{description}\end{quote}

\end{fulllineitems}

\index{forecast() (wass2s.was\_linear\_models.WAS\_LassoLars\_Model method)@\spxentry{forecast()}\spxextra{wass2s.was\_linear\_models.WAS\_LassoLars\_Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:id6}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{forecast}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor\_for\_year}}\sphinxparamcomma \sphinxparam{\DUrole{n}{alpha}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Generates a forecast for a single time step using LassoLars with alpha,
then computes tercile probabilities based on the chosen distribution method.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Observed data (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Start year for the climatological reference period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} End year for the climatological reference period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictor}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Historical predictor data (T, features).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Historical deterministic forecast with dims (output=2, T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictor\_for\_year}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Single\sphinxhyphen{}year predictor data (features,) or shape (1, features).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{alpha}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Spatial map of alpha values (Y, X) for LassoLars.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{result\_} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} dims (output=2, Y, X) =\textgreater{} {[}error, prediction{]}.
For a true forecast scenario, the error is typically NaN.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{hindcast\_prob} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} dims (probability=3, Y, X) =\textgreater{} {[}PB, PN, PA{]} for tercile categories.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{WAS\_Lasso\_Model (class in wass2s.was\_linear\_models)@\spxentry{WAS\_Lasso\_Model}\spxextra{class in wass2s.was\_linear\_models}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_Lasso_Model}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_linear\_models.}}\sphinxbfcode{\sphinxupquote{WAS\_Lasso\_Model}}}
{\sphinxparam{\DUrole{n}{alpha\_range}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{n\_clusters}\DUrole{o}{=}\DUrole{default_value}{5}}\sphinxparamcomma \sphinxparam{\DUrole{n}{nb\_cores}\DUrole{o}{=}\DUrole{default_value}{1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dist\_method}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}gamma\textquotesingle{}}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
WAS\_Lasso\_Model is a class that implements Lasso regression with hyperparameter tuning,
clustering\sphinxhyphen{}based regional optimization, and calculation of tercile probabilities for
climate prediction.


\subsubsection{Attributes:}
\label{\detokenize{api:id7}}\begin{description}
\sphinxlineitem{alpha\_range}{[}numpy.array{]}
\sphinxAtStartPar
Range of alpha values for Lasso regularization parameter.

\sphinxlineitem{n\_clusters}{[}int{]}
\sphinxAtStartPar
Number of clusters to use for regional optimization.

\sphinxlineitem{nb\_cores}{[}int{]}
\sphinxAtStartPar
Number of cores to use for parallel computation.

\sphinxlineitem{dist\_method}{[}str{]}
\sphinxAtStartPar
Distribution method for tercile probability calculations:
one of \{‘gamma’,’t’,’normal’,’lognormal’,’nonparam’\}.

\end{description}


\subsubsection{Methods:}
\label{\detokenize{api:id8}}\begin{description}
\sphinxlineitem{fit\_predict(x, y, x\_test, y\_test, alpha):}
\sphinxAtStartPar
Fits the Lasso model to the provided training data and predicts values
for the test set. Returns {[}error, prediction{]}.

\sphinxlineitem{compute\_hyperparameters(predictand, predictor):}
\sphinxAtStartPar
Performs clustering of the spatial grid and computes optimal alpha values
for each cluster. Returns the alpha values as an xarray and the cluster assignments.

\sphinxlineitem{compute\_model(X\_train, y\_train, X\_test, y\_test, alpha):}
\sphinxAtStartPar
Computes the Lasso model prediction for the training/test datasets
using the given alpha values. Utilizes Dask for parallelized processing.

\sphinxlineitem{calculate\_tercile\_probabilities(…):}
\sphinxAtStartPar
Calculates tercile probabilities for a given forecast using the chosen
distribution method.

\sphinxlineitem{compute\_prob(Predictant, clim\_year\_start, clim\_year\_end, Predictor, hindcast\_det):}
\sphinxAtStartPar
Computes probabilistic forecasts for rainfall terciles based on
climatological terciles, utilizing a hindcast and Lasso regression output.

\sphinxlineitem{forecast(Predictant, clim\_year\_start, clim\_year\_end, Predictor, hindcast\_det,}\begin{quote}

\sphinxAtStartPar
Predictor\_for\_year, alpha):
\end{quote}

\sphinxAtStartPar
Generates a forecast for a single time step using Lasso with alpha,
then computes tercile probabilities based on the chosen distribution method.

\end{description}
\index{calculate\_tercile\_probabilities() (wass2s.was\_linear\_models.WAS\_Lasso\_Model static method)@\spxentry{calculate\_tercile\_probabilities()}\spxextra{wass2s.was\_linear\_models.WAS\_Lasso\_Model static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_Lasso_Model.calculate_tercile_probabilities}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Student’s t\sphinxhyphen{}based method

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_gamma() (wass2s.was\_linear\_models.WAS\_Lasso\_Model static method)@\spxentry{calculate\_tercile\_probabilities\_gamma()}\spxextra{wass2s.was\_linear\_models.WAS\_Lasso\_Model static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_Lasso_Model.calculate_tercile_probabilities_gamma}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_gamma}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T2}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Gamma\sphinxhyphen{}based method

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_lognormal() (wass2s.was\_linear\_models.WAS\_Lasso\_Model static method)@\spxentry{calculate\_tercile\_probabilities\_lognormal()}\spxextra{wass2s.was\_linear\_models.WAS\_Lasso\_Model static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_Lasso_Model.calculate_tercile_probabilities_lognormal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_lognormal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Lognormal\sphinxhyphen{}based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_nonparametric() (wass2s.was\_linear\_models.WAS\_Lasso\_Model static method)@\spxentry{calculate\_tercile\_probabilities\_nonparametric()}\spxextra{wass2s.was\_linear\_models.WAS\_Lasso\_Model static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_Lasso_Model.calculate_tercile_probabilities_nonparametric}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_nonparametric}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_samples}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Non\sphinxhyphen{}parametric method (requires historical errors).

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_normal() (wass2s.was\_linear\_models.WAS\_Lasso\_Model static method)@\spxentry{calculate\_tercile\_probabilities\_normal()}\spxextra{wass2s.was\_linear\_models.WAS\_Lasso\_Model static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_Lasso_Model.calculate_tercile_probabilities_normal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_normal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Normal\sphinxhyphen{}based method using the Gaussian CDF.

\end{fulllineitems}

\index{compute\_hyperparameters() (wass2s.was\_linear\_models.WAS\_Lasso\_Model method)@\spxentry{compute\_hyperparameters()}\spxextra{wass2s.was\_linear\_models.WAS\_Lasso\_Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_Lasso_Model.compute_hyperparameters}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_hyperparameters}}}
{\sphinxparam{\DUrole{n}{predictand}}\sphinxparamcomma \sphinxparam{\DUrole{n}{predictor}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Clusters the spatial domain and finds the best alpha for each cluster by mean time series.
\begin{quote}\begin{description}
\sphinxlineitem{Returns}
\sphinxAtStartPar
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{alpha\_array} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} Spatial map of best alpha values.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Cluster} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} Cluster assignments for each grid cell.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_model() (wass2s.was\_linear\_models.WAS\_Lasso\_Model method)@\spxentry{compute\_model()}\spxextra{wass2s.was\_linear\_models.WAS\_Lasso\_Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_Lasso_Model.compute_model}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_model}}}
{\sphinxparam{\DUrole{n}{X\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{X\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{alpha}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Computes Lasso predictions for spatiotemporal data using provided alpha values.
\begin{quote}\begin{description}
\sphinxlineitem{Returns}
\sphinxAtStartPar
dims (output=2, Y, X) =\textgreater{} {[}error, prediction{]}.

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_prob() (wass2s.was\_linear\_models.WAS\_Lasso\_Model method)@\spxentry{compute\_prob()}\spxextra{wass2s.was\_linear\_models.WAS\_Lasso\_Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_Lasso_Model.compute_prob}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_prob}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute tercile probabilities using self.dist\_method.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}\sphinxstyleliteralemphasis{\sphinxupquote{ (}}\sphinxstyleliteralemphasis{\sphinxupquote{T}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{Y}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{X}}\sphinxstyleliteralemphasis{\sphinxupquote{)}}) \textendash{} Observed data.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}})

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} The start and end years for the climatology.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Deterministic forecast with dims (output=2, T, Y, X).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{hindcast\_prob} \textendash{} dims (probability=3, T, Y, X) =\textgreater{} {[}PB, PN, PA{]}.

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{fit\_predict() (wass2s.was\_linear\_models.WAS\_Lasso\_Model method)@\spxentry{fit\_predict()}\spxextra{wass2s.was\_linear\_models.WAS\_Lasso\_Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_Lasso_Model.fit_predict}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{fit\_predict}}}
{\sphinxparam{\DUrole{n}{x}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y}}\sphinxparamcomma \sphinxparam{\DUrole{n}{x\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{alpha}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Fit a Lasso model and make predictions.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{x}} (\sphinxstyleliteralemphasis{\sphinxupquote{ndarray}}) \textendash{} Training data (shape: {[}n\_samples, n\_features{]}).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y}} (\sphinxstyleliteralemphasis{\sphinxupquote{ndarray}}) \textendash{} Training targets (shape: {[}n\_samples,{]}).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{x\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{ndarray}}) \textendash{} Test data (shape: {[}n\_features,{]} or {[}1, n\_features{]}).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} Target value(s) for test data.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{alpha}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} Regularization parameter for Lasso.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
{[}error, prediction{]}, each of shape (1,) or scalar,
or {[}np.nan, np.nan{]} if no valid data.

\sphinxlineitem{Return type}
\sphinxAtStartPar
ndarray

\end{description}\end{quote}

\end{fulllineitems}

\index{forecast() (wass2s.was\_linear\_models.WAS\_Lasso\_Model method)@\spxentry{forecast()}\spxextra{wass2s.was\_linear\_models.WAS\_Lasso\_Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_Lasso_Model.forecast}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{forecast}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor\_for\_year}}\sphinxparamcomma \sphinxparam{\DUrole{n}{alpha}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Generate a forecast for a single time (year) using Lasso with alpha,
then compute tercile probabilities from the chosen distribution method.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Observed data (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Start year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} End year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictor}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Historical predictor data (T, features).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Historical deterministic forecast with dims (output=2, T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictor\_for\_year}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Single\sphinxhyphen{}year predictor data (features,).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{alpha}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Spatial map of alpha values (Y, X).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{result\_} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} dims (output=2, Y, X) =\textgreater{} {[}error, prediction{]}.
For a real forecast scenario, the error is typically NaN.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{hindcast\_prob} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} dims (probability=3, Y, X) =\textgreater{} {[}PB, PN, PA{]}.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{WAS\_LinearRegression\_Model (class in wass2s.was\_linear\_models)@\spxentry{WAS\_LinearRegression\_Model}\spxextra{class in wass2s.was\_linear\_models}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_LinearRegression_Model}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_linear\_models.}}\sphinxbfcode{\sphinxupquote{WAS\_LinearRegression\_Model}}}
{\sphinxparam{\DUrole{n}{nb\_cores}\DUrole{o}{=}\DUrole{default_value}{1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dist\_method}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}gamma\textquotesingle{}}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
A class to perform linear regression modeling on spatiotemporal datasets for climate prediction.

\sphinxAtStartPar
This class is designed to work with Dask and Xarray for parallelized, high\sphinxhyphen{}performance
regression computations across large datasets with spatial and temporal dimensions. The primary
methods are for fitting the model, making predictions, and calculating probabilistic predictions
for climate terciles.
\index{nb\_cores (wass2s.was\_linear\_models.WAS\_LinearRegression\_Model attribute)@\spxentry{nb\_cores}\spxextra{wass2s.was\_linear\_models.WAS\_LinearRegression\_Model attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_LinearRegression_Model.nb_cores}}
\pysigstartsignatures
\pysigline
{\sphinxbfcode{\sphinxupquote{nb\_cores}}}
\pysigstopsignatures
\sphinxAtStartPar
The number of CPU cores to use for parallel computation (default is 1).
\begin{quote}\begin{description}
\sphinxlineitem{Type}
\sphinxAtStartPar
int, optional

\end{description}\end{quote}

\end{fulllineitems}

\index{dist\_method (wass2s.was\_linear\_models.WAS\_LinearRegression\_Model attribute)@\spxentry{dist\_method}\spxextra{wass2s.was\_linear\_models.WAS\_LinearRegression\_Model attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_LinearRegression_Model.dist_method}}
\pysigstartsignatures
\pysigline
{\sphinxbfcode{\sphinxupquote{dist\_method}}}
\pysigstopsignatures
\sphinxAtStartPar
Distribution method for tercile probability calculations. One of
\{“t”,”gamma”,”normal”,”lognormal”,”nonparam”\}. Default = “gamma”.
\begin{quote}\begin{description}
\sphinxlineitem{Type}
\sphinxAtStartPar
str, optional

\end{description}\end{quote}

\end{fulllineitems}

\index{fit\_predict() (wass2s.was\_linear\_models.WAS\_LinearRegression\_Model method)@\spxentry{fit\_predict()}\spxextra{wass2s.was\_linear\_models.WAS\_LinearRegression\_Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_LinearRegression_Model.fit_predict}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{fit\_predict}}}
{\sphinxparam{\DUrole{n}{x}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y}}\sphinxparamcomma \sphinxparam{\DUrole{n}{x\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Fits a linear regression model, makes predictions, and calculates error if y\_test is provided.

\end{fulllineitems}

\index{compute\_model() (wass2s.was\_linear\_models.WAS\_LinearRegression\_Model method)@\spxentry{compute\_model()}\spxextra{wass2s.was\_linear\_models.WAS\_LinearRegression\_Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_LinearRegression_Model.compute_model}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_model}}}
{\sphinxparam{\DUrole{n}{X\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{X\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Applies the linear regression model across a dataset using parallel computation with Dask.

\end{fulllineitems}

\index{compute\_prob() (wass2s.was\_linear\_models.WAS\_LinearRegression\_Model method)@\spxentry{compute\_prob()}\spxextra{wass2s.was\_linear\_models.WAS\_LinearRegression\_Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_LinearRegression_Model.compute_prob}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_prob}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Computes tercile probabilities for hindcast predictions over specified years.

\end{fulllineitems}

\index{forecast() (wass2s.was\_linear\_models.WAS\_LinearRegression\_Model method)@\spxentry{forecast()}\spxextra{wass2s.was\_linear\_models.WAS\_LinearRegression\_Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_LinearRegression_Model.forecast}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{forecast}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor\_for\_year}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Generates a single\sphinxhyphen{}year forecast and computes tercile probabilities.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities() (wass2s.was\_linear\_models.WAS\_LinearRegression\_Model static method)@\spxentry{calculate\_tercile\_probabilities()}\spxextra{wass2s.was\_linear\_models.WAS\_LinearRegression\_Model static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_LinearRegression_Model.calculate_tercile_probabilities}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Student’s t\sphinxhyphen{}based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_gamma() (wass2s.was\_linear\_models.WAS\_LinearRegression\_Model static method)@\spxentry{calculate\_tercile\_probabilities\_gamma()}\spxextra{wass2s.was\_linear\_models.WAS\_LinearRegression\_Model static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_LinearRegression_Model.calculate_tercile_probabilities_gamma}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_gamma}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T2}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Gamma\sphinxhyphen{}based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_lognormal() (wass2s.was\_linear\_models.WAS\_LinearRegression\_Model static method)@\spxentry{calculate\_tercile\_probabilities\_lognormal()}\spxextra{wass2s.was\_linear\_models.WAS\_LinearRegression\_Model static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_LinearRegression_Model.calculate_tercile_probabilities_lognormal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_lognormal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Lognormal\sphinxhyphen{}based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_nonparametric() (wass2s.was\_linear\_models.WAS\_LinearRegression\_Model static method)@\spxentry{calculate\_tercile\_probabilities\_nonparametric()}\spxextra{wass2s.was\_linear\_models.WAS\_LinearRegression\_Model static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_LinearRegression_Model.calculate_tercile_probabilities_nonparametric}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_nonparametric}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_samples}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Non\sphinxhyphen{}parametric method (requires historical errors).

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_normal() (wass2s.was\_linear\_models.WAS\_LinearRegression\_Model static method)@\spxentry{calculate\_tercile\_probabilities\_normal()}\spxextra{wass2s.was\_linear\_models.WAS\_LinearRegression\_Model static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_LinearRegression_Model.calculate_tercile_probabilities_normal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_normal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Normal\sphinxhyphen{}based method using the Gaussian CDF.

\end{fulllineitems}

\index{compute\_model() (wass2s.was\_linear\_models.WAS\_LinearRegression\_Model method)@\spxentry{compute\_model()}\spxextra{wass2s.was\_linear\_models.WAS\_LinearRegression\_Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:id9}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_model}}}
{\sphinxparam{\DUrole{n}{X\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{X\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Applies linear regression across a spatiotemporal dataset in parallel.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Training predictors with dims (‘T’,’features’).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Training targets with dims (‘T’,’Y’,’X’).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Test predictors, shape (‘features’,) or (T, features).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Test targets with dims (‘Y’,’X’), or broadcastable.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
dims (‘output’,’Y’,’X’), where ‘output’={[}error, prediction{]}.

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_prob() (wass2s.was\_linear\_models.WAS\_LinearRegression\_Model method)@\spxentry{compute\_prob()}\spxextra{wass2s.was\_linear\_models.WAS\_LinearRegression\_Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:id10}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_prob}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute tercile probabilities using self.dist\_method.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}\sphinxstyleliteralemphasis{\sphinxupquote{ (}}\sphinxstyleliteralemphasis{\sphinxupquote{T}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{Y}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{X}}\sphinxstyleliteralemphasis{\sphinxupquote{)}}) \textendash{} Observed data.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}})

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} The start and end years for the climatology.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Deterministic forecast with dims (output=2, T, Y, X).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{hindcast\_prob} \textendash{} dims (probability=3, T, Y, X) =\textgreater{} {[}PB, PN, PA{]}.

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{fit\_predict() (wass2s.was\_linear\_models.WAS\_LinearRegression\_Model method)@\spxentry{fit\_predict()}\spxextra{wass2s.was\_linear\_models.WAS\_LinearRegression\_Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:id11}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{fit\_predict}}}
{\sphinxparam{\DUrole{n}{x}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y}}\sphinxparamcomma \sphinxparam{\DUrole{n}{x\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Fits a linear regression model to the provided training data, makes predictions
on the test data, and calculates the prediction error (if y\_test is provided).
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{x}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{shape}}\sphinxstyleliteralemphasis{\sphinxupquote{ (}}\sphinxstyleliteralemphasis{\sphinxupquote{n\_samples}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{n\_features}}\sphinxstyleliteralemphasis{\sphinxupquote{)}}) \textendash{} Training data (predictors).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{shape}}\sphinxstyleliteralemphasis{\sphinxupquote{ (}}\sphinxstyleliteralemphasis{\sphinxupquote{n\_samples}}\sphinxstyleliteralemphasis{\sphinxupquote{,}}\sphinxstyleliteralemphasis{\sphinxupquote{)}}) \textendash{} Training targets.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{x\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{shape}}\sphinxstyleliteralemphasis{\sphinxupquote{ (}}\sphinxstyleliteralemphasis{\sphinxupquote{n\_features}}\sphinxstyleliteralemphasis{\sphinxupquote{,}}\sphinxstyleliteralemphasis{\sphinxupquote{) or }}\sphinxstyleliteralemphasis{\sphinxupquote{(}}\sphinxstyleliteralemphasis{\sphinxupquote{1}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{n\_features}}\sphinxstyleliteralemphasis{\sphinxupquote{)}}) \textendash{} Test data (predictors).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{None}}) \textendash{} Test target value. If None, no error is computed.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
If y\_test is not None, returns {[}error, prediction{]}.
If y\_test is None, returns {[}prediction{]}.

\sphinxlineitem{Return type}
\sphinxAtStartPar
np.ndarray

\end{description}\end{quote}

\end{fulllineitems}

\index{forecast() (wass2s.was\_linear\_models.WAS\_LinearRegression\_Model method)@\spxentry{forecast()}\spxextra{wass2s.was\_linear\_models.WAS\_LinearRegression\_Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:id12}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{forecast}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor\_for\_year}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Generates a single\sphinxhyphen{}year forecast using linear regression, then computes
tercile probabilities using self.dist\_method.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Observed data with dims (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Start year for climatology

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} End year for climatology

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictor}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Historical predictor data with dims (T, features).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Historical deterministic forecast with dims (output={[}error,prediction{]}, T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictor\_for\_year}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Single\sphinxhyphen{}year predictor with shape (features,) or (1, features).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{result\_} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} dims (output=2, Y, X) =\textgreater{} {[}error, prediction{]}.
For a true forecast, error is typically NaN.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{hindcast\_prob} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} dims (probability=3, Y, X) =\textgreater{} {[}PB, PN, PA{]}.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{WAS\_Ridge\_Model (class in wass2s.was\_linear\_models)@\spxentry{WAS\_Ridge\_Model}\spxextra{class in wass2s.was\_linear\_models}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_Ridge_Model}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_linear\_models.}}\sphinxbfcode{\sphinxupquote{WAS\_Ridge\_Model}}}
{\sphinxparam{\DUrole{n}{alpha\_range}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{n\_clusters}\DUrole{o}{=}\DUrole{default_value}{5}}\sphinxparamcomma \sphinxparam{\DUrole{n}{nb\_cores}\DUrole{o}{=}\DUrole{default_value}{1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dist\_method}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}gamma\textquotesingle{}}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
A class to perform ridge regression modeling for rainfall prediction with spatial clustering
and hyperparameter optimization. By Mandela HOUNGNIBO.
\index{alpha\_range (wass2s.was\_linear\_models.WAS\_Ridge\_Model attribute)@\spxentry{alpha\_range}\spxextra{wass2s.was\_linear\_models.WAS\_Ridge\_Model attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_Ridge_Model.alpha_range}}
\pysigstartsignatures
\pysigline
{\sphinxbfcode{\sphinxupquote{alpha\_range}}}
\pysigstopsignatures
\sphinxAtStartPar
Range of alpha values to explore for ridge regression.
\begin{quote}\begin{description}
\sphinxlineitem{Type}
\sphinxAtStartPar
array\sphinxhyphen{}like

\end{description}\end{quote}

\end{fulllineitems}

\index{n\_clusters (wass2s.was\_linear\_models.WAS\_Ridge\_Model attribute)@\spxentry{n\_clusters}\spxextra{wass2s.was\_linear\_models.WAS\_Ridge\_Model attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_Ridge_Model.n_clusters}}
\pysigstartsignatures
\pysigline
{\sphinxbfcode{\sphinxupquote{n\_clusters}}}
\pysigstopsignatures
\sphinxAtStartPar
Number of clusters for KMeans clustering.
\begin{quote}\begin{description}
\sphinxlineitem{Type}
\sphinxAtStartPar
int

\end{description}\end{quote}

\end{fulllineitems}

\index{nb\_cores (wass2s.was\_linear\_models.WAS\_Ridge\_Model attribute)@\spxentry{nb\_cores}\spxextra{wass2s.was\_linear\_models.WAS\_Ridge\_Model attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_Ridge_Model.nb_cores}}
\pysigstartsignatures
\pysigline
{\sphinxbfcode{\sphinxupquote{nb\_cores}}}
\pysigstopsignatures
\sphinxAtStartPar
Number of cores to use for parallel computation.
\begin{quote}\begin{description}
\sphinxlineitem{Type}
\sphinxAtStartPar
int

\end{description}\end{quote}

\end{fulllineitems}

\index{dist\_method (wass2s.was\_linear\_models.WAS\_Ridge\_Model attribute)@\spxentry{dist\_method}\spxextra{wass2s.was\_linear\_models.WAS\_Ridge\_Model attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_Ridge_Model.dist_method}}
\pysigstartsignatures
\pysigline
{\sphinxbfcode{\sphinxupquote{dist\_method}}}
\pysigstopsignatures
\sphinxAtStartPar
Distribution method for tercile probability calculations:
One of \{‘gamma’, ‘t’, ‘normal’, ‘lognormal’, ‘nonparam’\} (default = ‘gamma’).
\begin{quote}\begin{description}
\sphinxlineitem{Type}
\sphinxAtStartPar
str

\end{description}\end{quote}

\end{fulllineitems}

\index{fit\_predict() (wass2s.was\_linear\_models.WAS\_Ridge\_Model method)@\spxentry{fit\_predict()}\spxextra{wass2s.was\_linear\_models.WAS\_Ridge\_Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_Ridge_Model.fit_predict}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{fit\_predict}}}
{\sphinxparam{\DUrole{n}{x}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y}}\sphinxparamcomma \sphinxparam{\DUrole{n}{x\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{alpha}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Fits a Ridge regression model using the provided data and makes predictions.

\end{fulllineitems}

\index{compute\_hyperparameters() (wass2s.was\_linear\_models.WAS\_Ridge\_Model method)@\spxentry{compute\_hyperparameters()}\spxextra{wass2s.was\_linear\_models.WAS\_Ridge\_Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_Ridge_Model.compute_hyperparameters}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_hyperparameters}}}
{\sphinxparam{\DUrole{n}{predictand}}\sphinxparamcomma \sphinxparam{\DUrole{n}{predictor}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Computes optimal ridge hyperparameters (alpha values) for different clusters.

\end{fulllineitems}

\index{compute\_model() (wass2s.was\_linear\_models.WAS\_Ridge\_Model method)@\spxentry{compute\_model()}\spxextra{wass2s.was\_linear\_models.WAS\_Ridge\_Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_Ridge_Model.compute_model}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_model}}}
{\sphinxparam{\DUrole{n}{X\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{X\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{alpha}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Fits and predicts a Ridge model for spatiotemporal data using Dask for parallel computation.

\end{fulllineitems}

\index{compute\_prob() (wass2s.was\_linear\_models.WAS\_Ridge\_Model method)@\spxentry{compute\_prob()}\spxextra{wass2s.was\_linear\_models.WAS\_Ridge\_Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_Ridge_Model.compute_prob}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_prob}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Computes the probabilities of tercile categories for rainfall prediction using the chosen
distribution method.

\end{fulllineitems}

\index{forecast() (wass2s.was\_linear\_models.WAS\_Ridge\_Model method)@\spxentry{forecast()}\spxextra{wass2s.was\_linear\_models.WAS\_Ridge\_Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_Ridge_Model.forecast}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{forecast}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor\_for\_year}}\sphinxparamcomma \sphinxparam{\DUrole{n}{alpha}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Generates a forecast for a single future time (e.g., year) and computes tercile probabilities.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities() (wass2s.was\_linear\_models.WAS\_Ridge\_Model static method)@\spxentry{calculate\_tercile\_probabilities()}\spxextra{wass2s.was\_linear\_models.WAS\_Ridge\_Model static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_Ridge_Model.calculate_tercile_probabilities}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Student’s t\sphinxhyphen{}based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_gamma() (wass2s.was\_linear\_models.WAS\_Ridge\_Model static method)@\spxentry{calculate\_tercile\_probabilities\_gamma()}\spxextra{wass2s.was\_linear\_models.WAS\_Ridge\_Model static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_Ridge_Model.calculate_tercile_probabilities_gamma}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_gamma}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T2}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Gamma\sphinxhyphen{}based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_lognormal() (wass2s.was\_linear\_models.WAS\_Ridge\_Model static method)@\spxentry{calculate\_tercile\_probabilities\_lognormal()}\spxextra{wass2s.was\_linear\_models.WAS\_Ridge\_Model static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_Ridge_Model.calculate_tercile_probabilities_lognormal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_lognormal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Lognormal\sphinxhyphen{}based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_nonparametric() (wass2s.was\_linear\_models.WAS\_Ridge\_Model static method)@\spxentry{calculate\_tercile\_probabilities\_nonparametric()}\spxextra{wass2s.was\_linear\_models.WAS\_Ridge\_Model static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_Ridge_Model.calculate_tercile_probabilities_nonparametric}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_nonparametric}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_samples}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Non\sphinxhyphen{}parametric method (requires historical errors).

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_normal() (wass2s.was\_linear\_models.WAS\_Ridge\_Model static method)@\spxentry{calculate\_tercile\_probabilities\_normal()}\spxextra{wass2s.was\_linear\_models.WAS\_Ridge\_Model static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_linear_models.WAS_Ridge_Model.calculate_tercile_probabilities_normal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_normal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Normal\sphinxhyphen{}based method using the Gaussian CDF.

\end{fulllineitems}

\index{compute\_hyperparameters() (wass2s.was\_linear\_models.WAS\_Ridge\_Model method)@\spxentry{compute\_hyperparameters()}\spxextra{wass2s.was\_linear\_models.WAS\_Ridge\_Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:id13}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_hyperparameters}}}
{\sphinxparam{\DUrole{n}{predictand}}\sphinxparamcomma \sphinxparam{\DUrole{n}{predictor}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute optimal hyperparameters (alpha) for ridge regression for different clusters.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{predictand}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Predictand data for clustering (dims: T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{predictor}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{ndarray}}) \textendash{} Predictor data for model fitting (dims: T, features).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{alpha\_array} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} Spatial map of alpha values for each grid cell.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{cluster\_da} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} Cluster assignment for each (Y,X).

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_model() (wass2s.was\_linear\_models.WAS\_Ridge\_Model method)@\spxentry{compute\_model()}\spxextra{wass2s.was\_linear\_models.WAS\_Ridge\_Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:id14}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_model}}}
{\sphinxparam{\DUrole{n}{X\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{X\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{alpha}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Fit and predict ridge regression model for spatiotemporal data using Dask for parallel computation.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Training predictor data (dims: T, features).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Training predictand data (dims: T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Test predictor data (dims: features) or broadcastable.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Test predictand data (dims: Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{alpha}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Spatial map of alpha values for each grid cell.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
dims (output=2, Y, X) =\textgreater{} {[}error, prediction{]}.

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_prob() (wass2s.was\_linear\_models.WAS\_Ridge\_Model method)@\spxentry{compute\_prob()}\spxextra{wass2s.was\_linear\_models.WAS\_Ridge\_Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:id15}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_prob}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute tercile probabilities using either ‘t’, ‘gamma’, ‘normal’, ‘lognormal’, or ‘nonparam’.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Observed data array (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Start year for climatology.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} End year for climatology.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Deterministic forecast with shape (output=2, T, Y, X),
where output={[}error, prediction{]}.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{hindcast\_prob} \textendash{} dims (probability=3, T, Y, X) =\textgreater{} {[}PB, PN, PA{]}.

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{fit\_predict() (wass2s.was\_linear\_models.WAS\_Ridge\_Model method)@\spxentry{fit\_predict()}\spxextra{wass2s.was\_linear\_models.WAS\_Ridge\_Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:id16}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{fit\_predict}}}
{\sphinxparam{\DUrole{n}{x}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y}}\sphinxparamcomma \sphinxparam{\DUrole{n}{x\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{alpha}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Fit a ridge regression model and make predictions.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{x}} (\sphinxstyleliteralemphasis{\sphinxupquote{ndarray}}) \textendash{} Training data (shape = {[}n\_samples, n\_features{]}).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y}} (\sphinxstyleliteralemphasis{\sphinxupquote{ndarray}}) \textendash{} Target values for training data (shape = {[}n\_samples,{]}).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{x\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{ndarray}}) \textendash{} Test data (shape = {[}n\_features,{]} or {[}1, n\_features{]}).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} Target value for test data.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{alpha}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} Regularization strength for Ridge regression.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
{[}error, prediction{]}.

\sphinxlineitem{Return type}
\sphinxAtStartPar
ndarray

\end{description}\end{quote}

\end{fulllineitems}

\index{forecast() (wass2s.was\_linear\_models.WAS\_Ridge\_Model method)@\spxentry{forecast()}\spxextra{wass2s.was\_linear\_models.WAS\_Ridge\_Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:id17}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{forecast}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor\_for\_year}}\sphinxparamcomma \sphinxparam{\DUrole{n}{alpha}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Generates a ridge\sphinxhyphen{}based forecast for a single future time (year)
using alpha values and returns both forecast + tercile probabilities.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Observed data (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Start year of climatology.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} End year of climatology.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictor}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Historical predictor data (T, features).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Historical deterministic forecast with dims (output=2, T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictor\_for\_year}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Single\sphinxhyphen{}year predictor data (features,).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{alpha}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Spatial map of alpha values (Y, X).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{result\_} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} dims (output=2, Y, X) =\textgreater{} {[}error, prediction{]}.
The “error” is NaN in a real forecast scenario.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{hindcast\_prob} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} dims (probability=3, Y, X) =\textgreater{} {[}PB, PN, PA{]}.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\subsection{wass2s.was\_eof module}
\label{\detokenize{api:module-wass2s.was_eof}}\label{\detokenize{api:wass2s-was-eof-module}}\index{module@\spxentry{module}!wass2s.was\_eof@\spxentry{wass2s.was\_eof}}\index{wass2s.was\_eof@\spxentry{wass2s.was\_eof}!module@\spxentry{module}}\index{WAS\_EOF (class in wass2s.was\_eof)@\spxentry{WAS\_EOF}\spxextra{class in wass2s.was\_eof}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_eof.WAS_EOF}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_eof.}}\sphinxbfcode{\sphinxupquote{WAS\_EOF}}}
{\sphinxparam{\DUrole{n}{n\_modes}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{use\_coslat}\DUrole{o}{=}\DUrole{default_value}{True}}\sphinxparamcomma \sphinxparam{\DUrole{n}{standardize}\DUrole{o}{=}\DUrole{default_value}{False}}\sphinxparamcomma \sphinxparam{\DUrole{n}{opti\_explained\_variance}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{L2norm}\DUrole{o}{=}\DUrole{default_value}{True}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
A class for performing Empirical Orthogonal Function (EOF) analysis using the xeofs package,
with additional options for detrending and cosine latitude weighting.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{n\_modes}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} The number of EOF modes to retain. If None, the number of modes is determined by
explained variance.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{use\_coslat}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} If True, applies cosine latitude weighting to account for the Earth’s spherical geometry.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{standardize}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} If True, standardizes the input data by removing the mean and dividing by the standard deviation.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{detrend}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} If True, detrends the input data along the time dimension before performing EOF analysis.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{opti\_explained\_variance}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} The target cumulative explained variance (in percent) to determine the optimal number of EOF modes.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{L2norm}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} If True, normalizes the components and scores to have L2 norm.

\end{itemize}

\end{description}\end{quote}
\index{model (wass2s.was\_eof.WAS\_EOF attribute)@\spxentry{model}\spxextra{wass2s.was\_eof.WAS\_EOF attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_eof.WAS_EOF.model}}
\pysigstartsignatures
\pysigline
{\sphinxbfcode{\sphinxupquote{model}}}
\pysigstopsignatures
\sphinxAtStartPar
The EOF model fitted to the predictor data.
\begin{quote}\begin{description}
\sphinxlineitem{Type}
\sphinxAtStartPar
xeofs.models.EOF

\end{description}\end{quote}

\end{fulllineitems}

\index{fit() (wass2s.was\_eof.WAS\_EOF method)@\spxentry{fit()}\spxextra{wass2s.was\_eof.WAS\_EOF method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_eof.WAS_EOF.fit}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{fit}}}
{\sphinxparam{\DUrole{n}{predictor}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dim}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}T\textquotesingle{}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\end{fulllineitems}

\index{inverse\_transform() (wass2s.was\_eof.WAS\_EOF method)@\spxentry{inverse\_transform()}\spxextra{wass2s.was\_eof.WAS\_EOF method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_eof.WAS_EOF.inverse_transform}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{inverse\_transform}}}
{\sphinxparam{\DUrole{n}{pcs}}}
{}
\pysigstopsignatures
\end{fulllineitems}

\index{plot\_EOF() (wass2s.was\_eof.WAS\_EOF method)@\spxentry{plot\_EOF()}\spxextra{wass2s.was\_eof.WAS\_EOF method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_eof.WAS_EOF.plot_EOF}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{plot\_EOF}}}
{\sphinxparam{\DUrole{n}{s\_eofs}}\sphinxparamcomma \sphinxparam{\DUrole{n}{s\_expvar}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Plot the EOF spatial patterns and their explained variance.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{s\_eofs}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} The EOF spatial patterns to plot.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{s\_expvar}} (\sphinxstyleliteralemphasis{\sphinxupquote{numpy.ndarray}}) \textendash{} The explained variance for each EOF mode.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{transform() (wass2s.was\_eof.WAS\_EOF method)@\spxentry{transform()}\spxextra{wass2s.was\_eof.WAS\_EOF method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_eof.WAS_EOF.transform}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{transform}}}
{\sphinxparam{\DUrole{n}{predictor}}}
{}
\pysigstopsignatures
\end{fulllineitems}


\end{fulllineitems}



\subsection{wass2s.was\_pcr module}
\label{\detokenize{api:module-wass2s.was_pcr}}\label{\detokenize{api:wass2s-was-pcr-module}}\index{module@\spxentry{module}!wass2s.was\_pcr@\spxentry{wass2s.was\_pcr}}\index{wass2s.was\_pcr@\spxentry{wass2s.was\_pcr}!module@\spxentry{module}}\index{WAS\_PCR (class in wass2s.was\_pcr)@\spxentry{WAS\_PCR}\spxextra{class in wass2s.was\_pcr}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_pcr.WAS_PCR}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_pcr.}}\sphinxbfcode{\sphinxupquote{WAS\_PCR}}}
{\sphinxparam{\DUrole{n}{regression\_model}}\sphinxparamcomma \sphinxparam{\DUrole{n}{n\_modes}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{use\_coslat}\DUrole{o}{=}\DUrole{default_value}{True}}\sphinxparamcomma \sphinxparam{\DUrole{n}{standardize}\DUrole{o}{=}\DUrole{default_value}{False}}\sphinxparamcomma \sphinxparam{\DUrole{n}{opti\_explained\_variance}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{L2norm}\DUrole{o}{=}\DUrole{default_value}{True}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
A class for performing Principal Component Regression (PCR) using EOF analysis and variable regression models.

\sphinxAtStartPar
This class integrates the WAS\_EOF for dimensionality reduction through Empirical Orthogonal Function (EOF)
analysis and allows the use of different regression models for predicting a target variable based on the
principal components.
\index{eof\_model (wass2s.was\_pcr.WAS\_PCR attribute)@\spxentry{eof\_model}\spxextra{wass2s.was\_pcr.WAS\_PCR attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_pcr.WAS_PCR.eof_model}}
\pysigstartsignatures
\pysigline
{\sphinxbfcode{\sphinxupquote{eof\_model}}}
\pysigstopsignatures
\sphinxAtStartPar
The EOF analysis model used for dimensionality reduction.
\begin{quote}\begin{description}
\sphinxlineitem{Type}
\sphinxAtStartPar
{\hyperref[\detokenize{api:wass2s.was_eof.WAS_EOF}]{\sphinxcrossref{WAS\_EOF}}}

\end{description}\end{quote}

\end{fulllineitems}

\index{reg\_model (wass2s.was\_pcr.WAS\_PCR attribute)@\spxentry{reg\_model}\spxextra{wass2s.was\_pcr.WAS\_PCR attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_pcr.WAS_PCR.reg_model}}
\pysigstartsignatures
\pysigline
{\sphinxbfcode{\sphinxupquote{reg\_model}}}
\pysigstopsignatures
\sphinxAtStartPar
A regression model (e.g., WAS\_LinearRegression\_Model, WAS\_Ridge\_Model, etc.) used for regression on the PCs.
\begin{quote}\begin{description}
\sphinxlineitem{Type}
\sphinxAtStartPar
object

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_model() (wass2s.was\_pcr.WAS\_PCR method)@\spxentry{compute\_model()}\spxextra{wass2s.was\_pcr.WAS\_PCR method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_pcr.WAS_PCR.compute_model}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_model}}}
{\sphinxparam{\DUrole{n}{X\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{X\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{alpha}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{l1\_ratio}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{o}{**}\DUrole{n}{kwargs}}}
{}
\pysigstopsignatures
\end{fulllineitems}

\index{compute\_prob() (wass2s.was\_pcr.WAS\_PCR method)@\spxentry{compute\_prob()}\spxextra{wass2s.was\_pcr.WAS\_PCR method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_pcr.WAS_PCR.compute_prob}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_prob}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}}
{}
\pysigstopsignatures
\end{fulllineitems}

\index{forecast() (wass2s.was\_pcr.WAS\_PCR method)@\spxentry{forecast()}\spxextra{wass2s.was\_pcr.WAS\_PCR method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_pcr.WAS_PCR.forecast}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{forecast}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor\_for\_year}}\sphinxparamcomma \sphinxparam{\DUrole{n}{alpha}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{l1\_ratio}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\end{fulllineitems}


\end{fulllineitems}



\subsection{wass2s.was\_cca module}
\label{\detokenize{api:module-wass2s.was_cca}}\label{\detokenize{api:wass2s-was-cca-module}}\index{module@\spxentry{module}!wass2s.was\_cca@\spxentry{wass2s.was\_cca}}\index{wass2s.was\_cca@\spxentry{wass2s.was\_cca}!module@\spxentry{module}}\index{WAS\_CCA (class in wass2s.was\_cca)@\spxentry{WAS\_CCA}\spxextra{class in wass2s.was\_cca}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_cca.WAS_CCA}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_cca.}}\sphinxbfcode{\sphinxupquote{WAS\_CCA}}}
{\sphinxparam{\DUrole{n}{n\_modes}\DUrole{o}{=}\DUrole{default_value}{5}}\sphinxparamcomma \sphinxparam{\DUrole{n}{n\_pca\_modes}\DUrole{o}{=}\DUrole{default_value}{10}}\sphinxparamcomma \sphinxparam{\DUrole{n}{standardize}\DUrole{o}{=}\DUrole{default_value}{False}}\sphinxparamcomma \sphinxparam{\DUrole{n}{use\_coslat}\DUrole{o}{=}\DUrole{default_value}{True}}\sphinxparamcomma \sphinxparam{\DUrole{n}{use\_pca}\DUrole{o}{=}\DUrole{default_value}{True}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dist\_method}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}gamma\textquotesingle{}}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}
\index{calculate\_tercile\_probabilities() (wass2s.was\_cca.WAS\_CCA static method)@\spxentry{calculate\_tercile\_probabilities()}\spxextra{wass2s.was\_cca.WAS\_CCA static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_cca.WAS_CCA.calculate_tercile_probabilities}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Student’s t\sphinxhyphen{}based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_gamma() (wass2s.was\_cca.WAS\_CCA static method)@\spxentry{calculate\_tercile\_probabilities\_gamma()}\spxextra{wass2s.was\_cca.WAS\_CCA static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_cca.WAS_CCA.calculate_tercile_probabilities_gamma}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_gamma}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T2}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Gamma\sphinxhyphen{}based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_lognormal() (wass2s.was\_cca.WAS\_CCA static method)@\spxentry{calculate\_tercile\_probabilities\_lognormal()}\spxextra{wass2s.was\_cca.WAS\_CCA static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_cca.WAS_CCA.calculate_tercile_probabilities_lognormal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_lognormal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Lognormal\sphinxhyphen{}based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_nonparametric() (wass2s.was\_cca.WAS\_CCA static method)@\spxentry{calculate\_tercile\_probabilities\_nonparametric()}\spxextra{wass2s.was\_cca.WAS\_CCA static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_cca.WAS_CCA.calculate_tercile_probabilities_nonparametric}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_nonparametric}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_samples}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Non\sphinxhyphen{}parametric method (requires historical errors).

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_normal() (wass2s.was\_cca.WAS\_CCA static method)@\spxentry{calculate\_tercile\_probabilities\_normal()}\spxextra{wass2s.was\_cca.WAS\_CCA static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_cca.WAS_CCA.calculate_tercile_probabilities_normal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_normal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Normal\sphinxhyphen{}based method using the Gaussian CDF.

\end{fulllineitems}

\index{compute\_model() (wass2s.was\_cca.WAS\_CCA method)@\spxentry{compute\_model()}\spxextra{wass2s.was\_cca.WAS\_CCA method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_cca.WAS_CCA.compute_model}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_model}}}
{\sphinxparam{\DUrole{n}{X\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{X\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute the CCA model and generate hindcasts.

\sphinxAtStartPar
Parameters:
\sphinxhyphen{} X\_train: xarray DataArray for predictor training data.
\sphinxhyphen{} y\_train: xarray DataArray for predictand training data.
\sphinxhyphen{} X\_test: xarray DataArray for predictor testing data.
\sphinxhyphen{} y\_test: xarray DataArray for predictand testing data.

\sphinxAtStartPar
Returns:
\sphinxhyphen{} hindcast: xarray DataArray containing predictions and errors.

\end{fulllineitems}

\index{compute\_prob() (wass2s.was\_cca.WAS\_CCA method)@\spxentry{compute\_prob()}\spxextra{wass2s.was\_cca.WAS\_CCA method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_cca.WAS_CCA.compute_prob}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_prob}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute tercile probabilities using self.dist\_method.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}\sphinxstyleliteralemphasis{\sphinxupquote{ (}}\sphinxstyleliteralemphasis{\sphinxupquote{T}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{Y}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{X}}\sphinxstyleliteralemphasis{\sphinxupquote{)}}) \textendash{} Observed data.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}})

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} The start and end years for the climatology.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Deterministic forecast with dims (output=2, T, Y, X).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{hindcast\_prob} \textendash{} dims (probability=3, T, Y, X) =\textgreater{} {[}PB, PN, PA{]}.

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{fit\_cca() (wass2s.was\_cca.WAS\_CCA method)@\spxentry{fit\_cca()}\spxextra{wass2s.was\_cca.WAS\_CCA method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_cca.WAS_CCA.fit_cca}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{fit\_cca}}}
{\sphinxparam{\DUrole{n}{X\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_train}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Fit the CCA model using the training data.

\sphinxAtStartPar
Parameters:
\sphinxhyphen{} X\_train: xarray DataArray for predictor training data.
\sphinxhyphen{} y\_train: xarray DataArray for predictand training data.

\end{fulllineitems}

\index{forecast() (wass2s.was\_cca.WAS\_CCA method)@\spxentry{forecast()}\spxextra{wass2s.was\_cca.WAS\_CCA method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_cca.WAS_CCA.forecast}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{forecast}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor\_for\_year}}}
{}
\pysigstopsignatures
\end{fulllineitems}

\index{plot\_cca\_results() (wass2s.was\_cca.WAS\_CCA method)@\spxentry{plot\_cca\_results()}\spxextra{wass2s.was\_cca.WAS\_CCA method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_cca.WAS_CCA.plot_cca_results}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{plot\_cca\_results}}}
{\sphinxparam{\DUrole{n}{X}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Y}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{n\_modes}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Plots the CCA modes and scores.

\sphinxAtStartPar
Parameters:
\sphinxhyphen{} X: Optional xarray DataArray for predictors. If provided, the model will be fitted using X and Y.
\sphinxhyphen{} Y: Optional xarray DataArray for predictands.
\sphinxhyphen{} n\_modes: Number of modes to plot. If None, plots all modes.

\end{fulllineitems}

\index{preprocess\_data() (wass2s.was\_cca.WAS\_CCA method)@\spxentry{preprocess\_data()}\spxextra{wass2s.was\_cca.WAS\_CCA method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_cca.WAS_CCA.preprocess_data}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{preprocess\_data}}}
{\sphinxparam{\DUrole{n}{X}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Y}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Preprocess the data by detrending, masking, and filling missing values.

\sphinxAtStartPar
Parameters:
\sphinxhyphen{} X: xarray DataArray for predictors.
\sphinxhyphen{} Y: xarray DataArray for predictands.

\sphinxAtStartPar
Returns:
\sphinxhyphen{} X\_final: Preprocessed X data.
\sphinxhyphen{} Y\_final: Preprocessed Y data.

\end{fulllineitems}

\index{preprocess\_test\_data() (wass2s.was\_cca.WAS\_CCA method)@\spxentry{preprocess\_test\_data()}\spxextra{wass2s.was\_cca.WAS\_CCA method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_cca.WAS_CCA.preprocess_test_data}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{preprocess\_test\_data}}}
{\sphinxparam{\DUrole{n}{X\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{X\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_train}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Preprocess the test data.

\sphinxAtStartPar
Parameters:
\sphinxhyphen{} X\_test: xarray DataArray for predictor testing data.
\sphinxhyphen{} y\_test: xarray DataArray for predictand testing data.
\sphinxhyphen{} X\_train: xarray DataArray for predictor training data.
\sphinxhyphen{} y\_train: xarray DataArray for predictand training data.

\sphinxAtStartPar
Returns:
\sphinxhyphen{} X\_test\_prepared: Preprocessed X test data.
\sphinxhyphen{} y\_test\_prepared: Preprocessed Y test data.

\end{fulllineitems}


\end{fulllineitems}

\index{WAS\_CCA\_ (class in wass2s.was\_cca)@\spxentry{WAS\_CCA\_}\spxextra{class in wass2s.was\_cca}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_cca.WAS_CCA_}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_cca.}}\sphinxbfcode{\sphinxupquote{WAS\_CCA\_}}}
{\sphinxparam{\DUrole{n}{n\_modes}\DUrole{o}{=}\DUrole{default_value}{5}}\sphinxparamcomma \sphinxparam{\DUrole{n}{n\_pca\_modes}\DUrole{o}{=}\DUrole{default_value}{10}}\sphinxparamcomma \sphinxparam{\DUrole{n}{standardize}\DUrole{o}{=}\DUrole{default_value}{False}}\sphinxparamcomma \sphinxparam{\DUrole{n}{use\_coslat}\DUrole{o}{=}\DUrole{default_value}{True}}\sphinxparamcomma \sphinxparam{\DUrole{n}{use\_pca}\DUrole{o}{=}\DUrole{default_value}{True}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}
\index{calculate\_tercile\_probabilities() (wass2s.was\_cca.WAS\_CCA\_ static method)@\spxentry{calculate\_tercile\_probabilities()}\spxextra{wass2s.was\_cca.WAS\_CCA\_ static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_cca.WAS_CCA_.calculate_tercile_probabilities}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Calculates the probability of each tercile category.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_gamma() (wass2s.was\_cca.WAS\_CCA\_ static method)@\spxentry{calculate\_tercile\_probabilities\_gamma()}\spxextra{wass2s.was\_cca.WAS\_CCA\_ static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_cca.WAS_CCA_.calculate_tercile_probabilities_gamma}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_gamma}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T2}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}}}
{}
\pysigstopsignatures
\end{fulllineitems}

\index{compute\_model() (wass2s.was\_cca.WAS\_CCA\_ method)@\spxentry{compute\_model()}\spxextra{wass2s.was\_cca.WAS\_CCA\_ method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_cca.WAS_CCA_.compute_model}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_model}}}
{\sphinxparam{\DUrole{n}{X\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{X\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute the CCA model and generate hindcasts.

\sphinxAtStartPar
Parameters:
\sphinxhyphen{} X\_train: xarray DataArray for predictor training data.
\sphinxhyphen{} y\_train: xarray DataArray for predictand training data.
\sphinxhyphen{} X\_test: xarray DataArray for predictor testing data.
\sphinxhyphen{} y\_test: xarray DataArray for predictand testing data.

\sphinxAtStartPar
Returns:
\sphinxhyphen{} hindcast: xarray DataArray containing predictions and errors.

\end{fulllineitems}

\index{compute\_prob() (wass2s.was\_cca.WAS\_CCA\_ method)@\spxentry{compute\_prob()}\spxextra{wass2s.was\_cca.WAS\_CCA\_ method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_cca.WAS_CCA_.compute_prob}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_prob}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Computes tercile category probabilities for hindcasts over a climatological period.

\end{fulllineitems}

\index{fit\_cca() (wass2s.was\_cca.WAS\_CCA\_ method)@\spxentry{fit\_cca()}\spxextra{wass2s.was\_cca.WAS\_CCA\_ method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_cca.WAS_CCA_.fit_cca}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{fit\_cca}}}
{\sphinxparam{\DUrole{n}{X\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_train}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Fit the CCA model using the training data.

\sphinxAtStartPar
Parameters:
\sphinxhyphen{} X\_train: xarray DataArray for predictor training data.
\sphinxhyphen{} y\_train: xarray DataArray for predictand training data.

\end{fulllineitems}

\index{forecast() (wass2s.was\_cca.WAS\_CCA\_ method)@\spxentry{forecast()}\spxextra{wass2s.was\_cca.WAS\_CCA\_ method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_cca.WAS_CCA_.forecast}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{forecast}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor\_for\_year}}}
{}
\pysigstopsignatures
\end{fulllineitems}

\index{plot\_cca\_results() (wass2s.was\_cca.WAS\_CCA\_ method)@\spxentry{plot\_cca\_results()}\spxextra{wass2s.was\_cca.WAS\_CCA\_ method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_cca.WAS_CCA_.plot_cca_results}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{plot\_cca\_results}}}
{\sphinxparam{\DUrole{n}{X}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Y}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{n\_modes}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Plots the CCA modes and scores.

\sphinxAtStartPar
Parameters:
\sphinxhyphen{} X: Optional xarray DataArray for predictors. If provided, the model will be fitted using X and Y.
\sphinxhyphen{} Y: Optional xarray DataArray for predictands.
\sphinxhyphen{} n\_modes: Number of modes to plot. If None, plots all modes.

\end{fulllineitems}

\index{preprocess\_data() (wass2s.was\_cca.WAS\_CCA\_ method)@\spxentry{preprocess\_data()}\spxextra{wass2s.was\_cca.WAS\_CCA\_ method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_cca.WAS_CCA_.preprocess_data}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{preprocess\_data}}}
{\sphinxparam{\DUrole{n}{X}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Y}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Preprocess the data by detrending, masking, and filling missing values.

\sphinxAtStartPar
Parameters:
\sphinxhyphen{} X: xarray DataArray for predictors.
\sphinxhyphen{} Y: xarray DataArray for predictands.

\sphinxAtStartPar
Returns:
\sphinxhyphen{} X\_final: Preprocessed X data.
\sphinxhyphen{} Y\_final: Preprocessed Y data.

\end{fulllineitems}

\index{preprocess\_test\_data() (wass2s.was\_cca.WAS\_CCA\_ method)@\spxentry{preprocess\_test\_data()}\spxextra{wass2s.was\_cca.WAS\_CCA\_ method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_cca.WAS_CCA_.preprocess_test_data}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{preprocess\_test\_data}}}
{\sphinxparam{\DUrole{n}{X\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{X\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_train}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Preprocess the test data.

\sphinxAtStartPar
Parameters:
\sphinxhyphen{} X\_test: xarray DataArray for predictor testing data.
\sphinxhyphen{} y\_test: xarray DataArray for predictand testing data.
\sphinxhyphen{} X\_train: xarray DataArray for predictor training data.
\sphinxhyphen{} y\_train: xarray DataArray for predictand training data.

\sphinxAtStartPar
Returns:
\sphinxhyphen{} X\_test\_prepared: Preprocessed X test data.
\sphinxhyphen{} y\_test\_prepared: Preprocessed Y test data.

\end{fulllineitems}


\end{fulllineitems}



\subsection{wass2s.was\_machine\_learning module}
\label{\detokenize{api:module-wass2s.was_machine_learning}}\label{\detokenize{api:wass2s-was-machine-learning-module}}\index{module@\spxentry{module}!wass2s.was\_machine\_learning@\spxentry{wass2s.was\_machine\_learning}}\index{wass2s.was\_machine\_learning@\spxentry{wass2s.was\_machine\_learning}!module@\spxentry{module}}\index{WAS\_LogisticRegression\_Model (class in wass2s.was\_machine\_learning)@\spxentry{WAS\_LogisticRegression\_Model}\spxextra{class in wass2s.was\_machine\_learning}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_LogisticRegression_Model}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_machine\_learning.}}\sphinxbfcode{\sphinxupquote{WAS\_LogisticRegression\_Model}}}
{\sphinxparam{\DUrole{n}{nb\_cores}\DUrole{o}{=}\DUrole{default_value}{1}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
A logistic regression\sphinxhyphen{}based approach to classifying climate data into terciles and
then predicting the class probabilities for new data.
\index{classify() (wass2s.was\_machine\_learning.WAS\_LogisticRegression\_Model static method)@\spxentry{classify()}\spxextra{wass2s.was\_machine\_learning.WAS\_LogisticRegression\_Model static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_LogisticRegression_Model.classify}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{classify}}}
{\sphinxparam{\DUrole{n}{y}}\sphinxparamcomma \sphinxparam{\DUrole{n}{index\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{index\_end}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Classifies the values of a 1D array \sphinxtitleref{y} into terciles.
We only use a slice of y for the training/climatology period to define the 33rd and 67th percentiles.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{shape}}\sphinxstyleliteralemphasis{\sphinxupquote{ (}}\sphinxstyleliteralemphasis{\sphinxupquote{n\_samples}}\sphinxstyleliteralemphasis{\sphinxupquote{,}}\sphinxstyleliteralemphasis{\sphinxupquote{)}}) \textendash{} The time series of values we want to classify (e.g., rainfall).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{index\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} The start and end indices defining the climatology/training window.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{index\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} The start and end indices defining the climatology/training window.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{y\_class} (\sphinxstyleemphasis{array, shape (n\_samples,)}) \textendash{} The tercile class of each value in \sphinxtitleref{y}, coded as 0 (below), 1 (middle), or 2 (above).

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{tercile\_33} (\sphinxstyleemphasis{float}) \textendash{} The 33rd percentile threshold used to split the data.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{tercile\_67} (\sphinxstyleemphasis{float}) \textendash{} The 67th percentile threshold used to split the data.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_class() (wass2s.was\_machine\_learning.WAS\_LogisticRegression\_Model method)@\spxentry{compute\_class()}\spxextra{wass2s.was\_machine\_learning.WAS\_LogisticRegression\_Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_LogisticRegression_Model.compute_class}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_class}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Assigns tercile classes for each point in the \sphinxtitleref{Predictant} array.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} The observed variable (e.g., rainfall) with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} First year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Last year of the climatology period.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{Predictant\_class} \textendash{} The tercile class for each grid cell and time, labeled 0, 1, or 2.

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_model() (wass2s.was\_machine\_learning.WAS\_LogisticRegression\_Model method)@\spxentry{compute\_model()}\spxextra{wass2s.was\_machine\_learning.WAS\_LogisticRegression\_Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_LogisticRegression_Model.compute_model}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_model}}}
{\sphinxparam{\DUrole{n}{X\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{X\_test}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Computes logistic\sphinxhyphen{}regression\sphinxhyphen{}based class probabilities for each grid cell in \sphinxtitleref{y\_train}.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Predictors with dimensions (T, features).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Tercile class labels with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Test predictors with dimensions (T, features).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
Class probabilities (3) for each grid cell.

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{fit\_predict() (wass2s.was\_machine\_learning.WAS\_LogisticRegression\_Model method)@\spxentry{fit\_predict()}\spxextra{wass2s.was\_machine\_learning.WAS\_LogisticRegression\_Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_LogisticRegression_Model.fit_predict}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{fit\_predict}}}
{\sphinxparam{\DUrole{n}{x}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y}}\sphinxparamcomma \sphinxparam{\DUrole{n}{x\_test}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Trains a logistic regression model on (x, y) and predicts class probabilities for x\_test.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{x}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{shape}}\sphinxstyleliteralemphasis{\sphinxupquote{ (}}\sphinxstyleliteralemphasis{\sphinxupquote{n\_samples}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{n\_features}}\sphinxstyleliteralemphasis{\sphinxupquote{)}}) \textendash{} Predictor data for training.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{shape}}\sphinxstyleliteralemphasis{\sphinxupquote{ (}}\sphinxstyleliteralemphasis{\sphinxupquote{n\_samples}}\sphinxstyleliteralemphasis{\sphinxupquote{,}}\sphinxstyleliteralemphasis{\sphinxupquote{)}}) \textendash{} Class labels (0, 1, 2) for training.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{x\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{shape}}\sphinxstyleliteralemphasis{\sphinxupquote{ (}}\sphinxstyleliteralemphasis{\sphinxupquote{n\_features}}\sphinxstyleliteralemphasis{\sphinxupquote{,}}\sphinxstyleliteralemphasis{\sphinxupquote{)}}) \textendash{} Predictor data for the forecast/unknown scenario.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{preds\_proba} \textendash{} Probability of each of the 3 tercile classes.
If fewer than 3 classes were present in training, the array is padded with NaNs.

\sphinxlineitem{Return type}
\sphinxAtStartPar
np.ndarray, shape (3,)

\end{description}\end{quote}

\end{fulllineitems}

\index{forecast() (wass2s.was\_machine\_learning.WAS\_LogisticRegression\_Model method)@\spxentry{forecast()}\spxextra{wass2s.was\_machine\_learning.WAS\_LogisticRegression\_Model method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_LogisticRegression_Model.forecast}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{forecast}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor\_for\_year}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Runs the trained logistic model on a single forecast year.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} The observed variable (T, Y, X), used for classification (training).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictor}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} The training predictors (T, features).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictor\_for\_year}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Predictors for the forecast period or year, shape (features,).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
Probability of each tercile class (PB, PN, PA) for every grid cell,
after removing the time dimension (because it’s just one forecast).

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{WAS\_MLP (class in wass2s.was\_machine\_learning)@\spxentry{WAS\_MLP}\spxextra{class in wass2s.was\_machine\_learning}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_MLP}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_machine\_learning.}}\sphinxbfcode{\sphinxupquote{WAS\_MLP}}}
{\sphinxparam{\DUrole{n}{nb\_cores}\DUrole{o}{=}\DUrole{default_value}{1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dist\_method}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}gamma\textquotesingle{}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{n\_clusters}\DUrole{o}{=}\DUrole{default_value}{5}}\sphinxparamcomma \sphinxparam{\DUrole{n}{param\_grid}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
A class to perform MLP (Multi\sphinxhyphen{}Layer Perceptron) regression on spatiotemporal
datasets for climate prediction, with hyperparameter tuning via clustering + grid search.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{nb\_cores}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Number of CPU cores to use for parallel computation.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dist\_method}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} Distribution method for tercile probability calculations.
One of \{‘gamma’, ‘t’, ‘normal’, ‘lognormal’, ‘nonparam’\}.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{n\_clusters}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Number of clusters to use for KMeans.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{param\_grid}} (\sphinxstyleliteralemphasis{\sphinxupquote{dict}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{None}}) \textendash{} The hyperparameter search grid for MLPRegressor.
If None, a default grid is used.

\end{itemize}

\end{description}\end{quote}


\begin{fulllineitems}

\pysigstartsignatures
\pysigline
{\sphinxbfcode{\sphinxupquote{nb\_cores,~dist\_method,~n\_clusters,~param\_grid}}}
\pysigstopsignatures
\end{fulllineitems}

\index{calculate\_tercile\_probabilities() (wass2s.was\_machine\_learning.WAS\_MLP static method)@\spxentry{calculate\_tercile\_probabilities()}\spxextra{wass2s.was\_machine\_learning.WAS\_MLP static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_MLP.calculate_tercile_probabilities}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Student’s t\sphinxhyphen{}based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_gamma() (wass2s.was\_machine\_learning.WAS\_MLP static method)@\spxentry{calculate\_tercile\_probabilities\_gamma()}\spxextra{wass2s.was\_machine\_learning.WAS\_MLP static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_MLP.calculate_tercile_probabilities_gamma}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_gamma}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T2}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Gamma\sphinxhyphen{}based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_lognormal() (wass2s.was\_machine\_learning.WAS\_MLP static method)@\spxentry{calculate\_tercile\_probabilities\_lognormal()}\spxextra{wass2s.was\_machine\_learning.WAS\_MLP static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_MLP.calculate_tercile_probabilities_lognormal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_lognormal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Lognormal\sphinxhyphen{}based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_nonparametric() (wass2s.was\_machine\_learning.WAS\_MLP static method)@\spxentry{calculate\_tercile\_probabilities\_nonparametric()}\spxextra{wass2s.was\_machine\_learning.WAS\_MLP static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_MLP.calculate_tercile_probabilities_nonparametric}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_nonparametric}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_samples}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Non\sphinxhyphen{}parametric method (requires historical errors).

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_normal() (wass2s.was\_machine\_learning.WAS\_MLP static method)@\spxentry{calculate\_tercile\_probabilities\_normal()}\spxextra{wass2s.was\_machine\_learning.WAS\_MLP static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_MLP.calculate_tercile_probabilities_normal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_normal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Normal\sphinxhyphen{}based method using the Gaussian CDF.

\end{fulllineitems}

\index{compute\_hyperparameters() (wass2s.was\_machine\_learning.WAS\_MLP method)@\spxentry{compute\_hyperparameters()}\spxextra{wass2s.was\_machine\_learning.WAS\_MLP method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_MLP.compute_hyperparameters}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_hyperparameters}}}
{\sphinxparam{\DUrole{n}{predictand}}\sphinxparamcomma \sphinxparam{\DUrole{n}{predictor}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Performs KMeans clustering on the spatial mean of \sphinxtitleref{predictand}, then for each cluster
runs a cross\sphinxhyphen{}validation grid search on MLP hyperparameters using the cluster\sphinxhyphen{}mean time series.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{predictand}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Target variable with dimensions (‘T’, ‘Y’, ‘X’).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{predictor}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Predictor variables with dimensions (‘T’, ‘features’).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar

\sphinxAtStartPar
\sphinxstylestrong{hl\_array, act\_array, lr\_array, cluster\_da} \textendash{} DataArrays storing the best local hyperparameters for each grid cell
(derived from cluster membership) and the cluster assignments.
Note: We show example outputs for hidden\_layer\_sizes, activation, learning\_rate\_init.
\begin{quote}

\sphinxAtStartPar
You can extend this to all parameters in your \sphinxtitleref{param\_grid}.
\end{quote}


\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_model() (wass2s.was\_machine\_learning.WAS\_MLP method)@\spxentry{compute\_model()}\spxextra{wass2s.was\_machine\_learning.WAS\_MLP method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_MLP.compute_model}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_model}}}
{\sphinxparam{\DUrole{n}{X\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{X\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hl\_array}}\sphinxparamcomma \sphinxparam{\DUrole{n}{act\_array}}\sphinxparamcomma \sphinxparam{\DUrole{n}{lr\_array}}\sphinxparamcomma \sphinxparam{\DUrole{n}{maxiter\_array}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Runs MLP fit/predict for each (Y,X) cell in parallel, using cluster\sphinxhyphen{}based hyperparams.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Training predictors with dims (‘T’,’features’).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Training target with dims (‘T’,’Y’,’X’).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Test predictors, shape (‘features’,) or broadcastable.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Test target with dims (‘Y’,’X’).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hl\_array}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Local best hyperparameters from compute\_hyperparameters.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{act\_array}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Local best hyperparameters from compute\_hyperparameters.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{lr\_array}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Local best hyperparameters from compute\_hyperparameters.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
dims (‘output’, ‘Y’, ‘X’), where ‘output’ = {[}error, prediction{]}.

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_prob() (wass2s.was\_machine\_learning.WAS\_MLP method)@\spxentry{compute\_prob()}\spxextra{wass2s.was\_machine\_learning.WAS\_MLP method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_MLP.compute_prob}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_prob}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute tercile probabilities using self.dist\_method.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}\sphinxstyleliteralemphasis{\sphinxupquote{ (}}\sphinxstyleliteralemphasis{\sphinxupquote{T}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{Y}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{X}}\sphinxstyleliteralemphasis{\sphinxupquote{)}}) \textendash{} Observed data.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}})

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} The start and end years for the climatology.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Deterministic forecast with dims (output=2, T, Y, X).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{hindcast\_prob} \textendash{} dims (probability=3, T, Y, X) =\textgreater{} {[}PB, PN, PA{]}.

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{fit\_predict() (wass2s.was\_machine\_learning.WAS\_MLP method)@\spxentry{fit\_predict()}\spxextra{wass2s.was\_machine\_learning.WAS\_MLP method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_MLP.fit_predict}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{fit\_predict}}}
{\sphinxparam{\DUrole{n}{X\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{X\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hl\_sizes}}\sphinxparamcomma \sphinxparam{\DUrole{n}{activation}}\sphinxparamcomma \sphinxparam{\DUrole{n}{lr\_init}}\sphinxparamcomma \sphinxparam{\DUrole{n}{maxiter}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Trains an MLP (with local hyperparams) on the provided training data, then predicts on X\_test.
Returns {[}error, prediction{]}.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.ndarray}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{shape}}\sphinxstyleliteralemphasis{\sphinxupquote{ (}}\sphinxstyleliteralemphasis{\sphinxupquote{n\_samples}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{n\_features}}\sphinxstyleliteralemphasis{\sphinxupquote{)}})

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.ndarray}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{shape}}\sphinxstyleliteralemphasis{\sphinxupquote{ (}}\sphinxstyleliteralemphasis{\sphinxupquote{n\_samples}}\sphinxstyleliteralemphasis{\sphinxupquote{,}}\sphinxstyleliteralemphasis{\sphinxupquote{)}})

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.ndarray}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{shape}}\sphinxstyleliteralemphasis{\sphinxupquote{ (}}\sphinxstyleliteralemphasis{\sphinxupquote{n\_features}}\sphinxstyleliteralemphasis{\sphinxupquote{,}}\sphinxstyleliteralemphasis{\sphinxupquote{) or }}\sphinxstyleliteralemphasis{\sphinxupquote{(}}\sphinxstyleliteralemphasis{\sphinxupquote{1}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{n\_features}}\sphinxstyleliteralemphasis{\sphinxupquote{)}})

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{np.nan}})

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hl\_sizes}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{ (}}\sphinxstyleliteralemphasis{\sphinxupquote{stored as string in xarray}}\sphinxstyleliteralemphasis{\sphinxupquote{) or }}\sphinxstyleliteralemphasis{\sphinxupquote{None}})

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{activation}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}})

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{lr\_init}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}})

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
{[}error, predicted\_value{]}

\sphinxlineitem{Return type}
\sphinxAtStartPar
np.ndarray of shape (2,)

\end{description}\end{quote}

\end{fulllineitems}

\index{forecast() (wass2s.was\_machine\_learning.WAS\_MLP method)@\spxentry{forecast()}\spxextra{wass2s.was\_machine\_learning.WAS\_MLP method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_MLP.forecast}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{forecast}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor\_for\_year}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hl\_array}}\sphinxparamcomma \sphinxparam{\DUrole{n}{act\_array}}\sphinxparamcomma \sphinxparam{\DUrole{n}{lr\_array}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Generate a forecast for a single future time (e.g., future year),
then compute tercile probabilities using the chosen distribution method.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Observed data with dims (T, Y, X), used for computing climatological terciles.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Start year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} End year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictor}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Historical predictor data with dims (T, features).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Historical deterministic forecast with dims (output={[}error,prediction{]}, T, Y, X).
Used to compute error variance or error samples.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictor\_for\_year}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Predictor data for the forecast year, shape (features,) or (1, features).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hl\_array}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Hyperparameters from \sphinxtitleref{compute\_hyperparameters},
each with dims (Y, X) specifying local MLP settings.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{act\_array}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Hyperparameters from \sphinxtitleref{compute\_hyperparameters},
each with dims (Y, X) specifying local MLP settings.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{lr\_array}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Hyperparameters from \sphinxtitleref{compute\_hyperparameters},
each with dims (Y, X) specifying local MLP settings.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{result\_} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} dims (‘output’,’Y’,’X’), containing {[}error, prediction{]}.
For a forecast, the “error” is generally NaN.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{hindcast\_prob} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} dims (probability=3, Y, X) =\textgreater{} PB, PN, PA tercile probabilities.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{WAS\_PoissonRegression (class in wass2s.was\_machine\_learning)@\spxentry{WAS\_PoissonRegression}\spxextra{class in wass2s.was\_machine\_learning}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_PoissonRegression}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_machine\_learning.}}\sphinxbfcode{\sphinxupquote{WAS\_PoissonRegression}}}
{\sphinxparam{\DUrole{n}{nb\_cores}\DUrole{o}{=}\DUrole{default_value}{1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dist\_method}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}gamma\textquotesingle{}}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
A class to perform Poisson Regression on spatiotemporal datasets for count data prediction.

\sphinxAtStartPar
This class is designed to work with Dask and Xarray for parallelized, high\sphinxhyphen{}performance
regression computations across large datasets with spatial and temporal dimensions. The primary
methods are for fitting the Poisson regression model, making predictions, and calculating
probabilistic predictions for climate terciles.
\index{nb\_cores (wass2s.was\_machine\_learning.WAS\_PoissonRegression attribute)@\spxentry{nb\_cores}\spxextra{wass2s.was\_machine\_learning.WAS\_PoissonRegression attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_PoissonRegression.nb_cores}}
\pysigstartsignatures
\pysigline
{\sphinxbfcode{\sphinxupquote{nb\_cores}}}
\pysigstopsignatures
\sphinxAtStartPar
The number of CPU cores to use for parallel computation (default is 1).
\begin{quote}\begin{description}
\sphinxlineitem{Type}
\sphinxAtStartPar
int

\end{description}\end{quote}

\end{fulllineitems}

\index{dist\_method (wass2s.was\_machine\_learning.WAS\_PoissonRegression attribute)@\spxentry{dist\_method}\spxextra{wass2s.was\_machine\_learning.WAS\_PoissonRegression attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_PoissonRegression.dist_method}}
\pysigstartsignatures
\pysigline
{\sphinxbfcode{\sphinxupquote{dist\_method}}}
\pysigstopsignatures
\sphinxAtStartPar
The method to use for tercile probability calculations, e.g. \{“t”, “gamma”, “normal”,
“lognormal”, “nonparam”\} (default is “gamma”).
\begin{quote}\begin{description}
\sphinxlineitem{Type}
\sphinxAtStartPar
str

\end{description}\end{quote}

\end{fulllineitems}

\index{fit\_predict() (wass2s.was\_machine\_learning.WAS\_PoissonRegression method)@\spxentry{fit\_predict()}\spxextra{wass2s.was\_machine\_learning.WAS\_PoissonRegression method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_PoissonRegression.fit_predict}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{fit\_predict}}}
{\sphinxparam{\DUrole{n}{x}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y}}\sphinxparamcomma \sphinxparam{\DUrole{n}{x\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Fits a Poisson regression model to the training data, predicts on test data, and computes error.

\end{fulllineitems}

\index{compute\_model() (wass2s.was\_machine\_learning.WAS\_PoissonRegression method)@\spxentry{compute\_model()}\spxextra{wass2s.was\_machine\_learning.WAS\_PoissonRegression method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_PoissonRegression.compute_model}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_model}}}
{\sphinxparam{\DUrole{n}{X\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{X\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Applies the Poisson regression model across a dataset using parallel computation
with Dask, returning predictions and error metrics.

\end{fulllineitems}

\index{compute\_prob() (wass2s.was\_machine\_learning.WAS\_PoissonRegression method)@\spxentry{compute\_prob()}\spxextra{wass2s.was\_machine\_learning.WAS\_PoissonRegression method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_PoissonRegression.compute_prob}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_prob}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Computes tercile probabilities for hindcast rainfall (or count data) predictions
over specified climatological years, using the chosen \sphinxtitleref{dist\_method}.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities() (wass2s.was\_machine\_learning.WAS\_PoissonRegression static method)@\spxentry{calculate\_tercile\_probabilities()}\spxextra{wass2s.was\_machine\_learning.WAS\_PoissonRegression static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_PoissonRegression.calculate_tercile_probabilities}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Student’s t\sphinxhyphen{}based method for calculating tercile probabilities.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_gamma() (wass2s.was\_machine\_learning.WAS\_PoissonRegression static method)@\spxentry{calculate\_tercile\_probabilities\_gamma()}\spxextra{wass2s.was\_machine\_learning.WAS\_PoissonRegression static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_PoissonRegression.calculate_tercile_probabilities_gamma}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_gamma}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T2}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Gamma\sphinxhyphen{}based method for calculating tercile probabilities.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_lognormal() (wass2s.was\_machine\_learning.WAS\_PoissonRegression static method)@\spxentry{calculate\_tercile\_probabilities\_lognormal()}\spxextra{wass2s.was\_machine\_learning.WAS\_PoissonRegression static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_PoissonRegression.calculate_tercile_probabilities_lognormal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_lognormal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Lognormal\sphinxhyphen{}based method for tercile probabilities.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_nonparametric() (wass2s.was\_machine\_learning.WAS\_PoissonRegression static method)@\spxentry{calculate\_tercile\_probabilities\_nonparametric()}\spxextra{wass2s.was\_machine\_learning.WAS\_PoissonRegression static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_PoissonRegression.calculate_tercile_probabilities_nonparametric}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_nonparametric}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_samples}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Non\sphinxhyphen{}parametric method (requires historical errors).

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_normal() (wass2s.was\_machine\_learning.WAS\_PoissonRegression static method)@\spxentry{calculate\_tercile\_probabilities\_normal()}\spxextra{wass2s.was\_machine\_learning.WAS\_PoissonRegression static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_PoissonRegression.calculate_tercile_probabilities_normal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_normal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Normal\sphinxhyphen{}based method using the Gaussian CDF.

\end{fulllineitems}

\index{compute\_model() (wass2s.was\_machine\_learning.WAS\_PoissonRegression method)@\spxentry{compute\_model()}\spxextra{wass2s.was\_machine\_learning.WAS\_PoissonRegression method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:id18}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_model}}}
{\sphinxparam{\DUrole{n}{X\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{X\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Computes predictions for spatiotemporal data using Poisson Regression with parallel processing.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Predictor data with dimensions (T, features).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Training target values (count data) with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Test data (predictors) with shape (features,) or (T, features), typically squeezed.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Test target values (count data) with dimensions (Y, X) or broadcastable to (T, Y, X).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
An array with a new dimension (‘output’, size=2) capturing {[}error, prediction{]}.

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_prob() (wass2s.was\_machine\_learning.WAS\_PoissonRegression method)@\spxentry{compute\_prob()}\spxextra{wass2s.was\_machine\_learning.WAS\_PoissonRegression method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:id19}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_prob}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute tercile probabilities using self.dist\_method.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}\sphinxstyleliteralemphasis{\sphinxupquote{ (}}\sphinxstyleliteralemphasis{\sphinxupquote{T}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{Y}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{X}}\sphinxstyleliteralemphasis{\sphinxupquote{)}}) \textendash{} Observed data.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}})

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} The start and end years for the climatology.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Deterministic forecast with dims (output=2, T, Y, X).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{hindcast\_prob} \textendash{} dims (probability=3, T, Y, X) =\textgreater{} {[}PB, PN, PA{]}.

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{fit\_predict() (wass2s.was\_machine\_learning.WAS\_PoissonRegression method)@\spxentry{fit\_predict()}\spxextra{wass2s.was\_machine\_learning.WAS\_PoissonRegression method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:id20}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{fit\_predict}}}
{\sphinxparam{\DUrole{n}{x}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y}}\sphinxparamcomma \sphinxparam{\DUrole{n}{x\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Fits a Poisson regression model to the provided training data, makes predictions
on the test data, and calculates the prediction error.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{x}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{shape}}\sphinxstyleliteralemphasis{\sphinxupquote{ (}}\sphinxstyleliteralemphasis{\sphinxupquote{n\_samples}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{n\_features}}\sphinxstyleliteralemphasis{\sphinxupquote{)}}) \textendash{} Training data (predictors).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{shape}}\sphinxstyleliteralemphasis{\sphinxupquote{ (}}\sphinxstyleliteralemphasis{\sphinxupquote{n\_samples}}\sphinxstyleliteralemphasis{\sphinxupquote{,}}\sphinxstyleliteralemphasis{\sphinxupquote{)}}) \textendash{} Training targets (non\sphinxhyphen{}negative count data).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{x\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{shape}}\sphinxstyleliteralemphasis{\sphinxupquote{ (}}\sphinxstyleliteralemphasis{\sphinxupquote{n\_features}}\sphinxstyleliteralemphasis{\sphinxupquote{,}}\sphinxstyleliteralemphasis{\sphinxupquote{) or }}\sphinxstyleliteralemphasis{\sphinxupquote{(}}\sphinxstyleliteralemphasis{\sphinxupquote{1}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{n\_features}}\sphinxstyleliteralemphasis{\sphinxupquote{)}}) \textendash{} Test data (predictors).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} Test target value (actual counts).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
{[}prediction\_error, predicted\_value{]}

\sphinxlineitem{Return type}
\sphinxAtStartPar
np.ndarray of shape (2,)

\end{description}\end{quote}

\end{fulllineitems}

\index{forecast() (wass2s.was\_machine\_learning.WAS\_PoissonRegression method)@\spxentry{forecast()}\spxextra{wass2s.was\_machine\_learning.WAS\_PoissonRegression method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_PoissonRegression.forecast}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{forecast}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor\_for\_year}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Generate forecasts for a single time (e.g., future year) and compute
tercile probabilities based on the chosen distribution method.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Target variable with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Start year of climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} End year of climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictor}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Historical predictor data with dimensions (T, features).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Deterministic hindcast array that includes ‘error’ and ‘prediction’ over the historical period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictor\_for\_year}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Predictor data for the forecast year, shape (features,) or (1, features).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
{\color{red}\bfseries{}result\_}  : xarray.DataArray or numpy array with the forecast’s {[}error, prediction{]}.
hindcast\_prob : xarray.DataArray of shape (probability=3, Y, X) with PB, PN, and PA.

\sphinxlineitem{Return type}
\sphinxAtStartPar
tuple ({\color{red}\bfseries{}result\_}, hindcast\_prob)

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{WAS\_PolynomialRegression (class in wass2s.was\_machine\_learning)@\spxentry{WAS\_PolynomialRegression}\spxextra{class in wass2s.was\_machine\_learning}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_PolynomialRegression}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_machine\_learning.}}\sphinxbfcode{\sphinxupquote{WAS\_PolynomialRegression}}}
{\sphinxparam{\DUrole{n}{nb\_cores}\DUrole{o}{=}\DUrole{default_value}{1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{degree}\DUrole{o}{=}\DUrole{default_value}{2}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dist\_method}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}gamma\textquotesingle{}}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
A class to perform Polynomial Regression on spatiotemporal datasets for climate prediction.

\sphinxAtStartPar
This class is designed to work with Dask and Xarray for parallelized, high\sphinxhyphen{}performance
regression computations across large datasets with spatial and temporal dimensions. The primary
methods are for fitting the polynomial regression model, making predictions, and calculating
probabilistic predictions for climate terciles.
\index{nb\_cores (wass2s.was\_machine\_learning.WAS\_PolynomialRegression attribute)@\spxentry{nb\_cores}\spxextra{wass2s.was\_machine\_learning.WAS\_PolynomialRegression attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_PolynomialRegression.nb_cores}}
\pysigstartsignatures
\pysigline
{\sphinxbfcode{\sphinxupquote{nb\_cores}}}
\pysigstopsignatures
\sphinxAtStartPar
The number of CPU cores to use for parallel computation (default is 1).
\begin{quote}\begin{description}
\sphinxlineitem{Type}
\sphinxAtStartPar
int, optional

\end{description}\end{quote}

\end{fulllineitems}

\index{degree (wass2s.was\_machine\_learning.WAS\_PolynomialRegression attribute)@\spxentry{degree}\spxextra{wass2s.was\_machine\_learning.WAS\_PolynomialRegression attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_PolynomialRegression.degree}}
\pysigstartsignatures
\pysigline
{\sphinxbfcode{\sphinxupquote{degree}}}
\pysigstopsignatures
\sphinxAtStartPar
The degree of the polynomial (default is 2).
\begin{quote}\begin{description}
\sphinxlineitem{Type}
\sphinxAtStartPar
int, optional

\end{description}\end{quote}

\end{fulllineitems}

\index{dist\_method (wass2s.was\_machine\_learning.WAS\_PolynomialRegression attribute)@\spxentry{dist\_method}\spxextra{wass2s.was\_machine\_learning.WAS\_PolynomialRegression attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_PolynomialRegression.dist_method}}
\pysigstartsignatures
\pysigline
{\sphinxbfcode{\sphinxupquote{dist\_method}}}
\pysigstopsignatures
\sphinxAtStartPar
The distribution method to compute tercile probabilities. One of
\{“t”, “gamma”, “normal”, “lognormal”, “nonparam”\} (default is “gamma”).
\begin{quote}\begin{description}
\sphinxlineitem{Type}
\sphinxAtStartPar
str, optional

\end{description}\end{quote}

\end{fulllineitems}

\index{fit\_predict() (wass2s.was\_machine\_learning.WAS\_PolynomialRegression method)@\spxentry{fit\_predict()}\spxextra{wass2s.was\_machine\_learning.WAS\_PolynomialRegression method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_PolynomialRegression.fit_predict}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{fit\_predict}}}
{\sphinxparam{\DUrole{n}{x}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y}}\sphinxparamcomma \sphinxparam{\DUrole{n}{x\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Fits a Polynomial Regression model to the training data, predicts on test data,
and computes error.

\end{fulllineitems}

\index{compute\_model() (wass2s.was\_machine\_learning.WAS\_PolynomialRegression method)@\spxentry{compute\_model()}\spxextra{wass2s.was\_machine\_learning.WAS\_PolynomialRegression method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_PolynomialRegression.compute_model}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_model}}}
{\sphinxparam{\DUrole{n}{X\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{X\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Applies the Polynomial Regression model across a dataset using parallel computation
with Dask, returning predictions and error metrics.

\end{fulllineitems}

\index{compute\_prob() (wass2s.was\_machine\_learning.WAS\_PolynomialRegression method)@\spxentry{compute\_prob()}\spxextra{wass2s.was\_machine\_learning.WAS\_PolynomialRegression method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_PolynomialRegression.compute_prob}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_prob}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Computes tercile probabilities for hindcast rainfall predictions
over specified climatological years.

\end{fulllineitems}

\index{forecast() (wass2s.was\_machine\_learning.WAS\_PolynomialRegression method)@\spxentry{forecast()}\spxextra{wass2s.was\_machine\_learning.WAS\_PolynomialRegression method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_PolynomialRegression.forecast}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{forecast}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor\_for\_year}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Generates a forecast for a single year (or time step) and calculates tercile probabilities
using the chosen distribution method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_gamma() (wass2s.was\_machine\_learning.WAS\_PolynomialRegression static method)@\spxentry{calculate\_tercile\_probabilities\_gamma()}\spxextra{wass2s.was\_machine\_learning.WAS\_PolynomialRegression static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_PolynomialRegression.calculate_tercile_probabilities_gamma}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_gamma}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T2}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Gamma\sphinxhyphen{}based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_lognormal() (wass2s.was\_machine\_learning.WAS\_PolynomialRegression static method)@\spxentry{calculate\_tercile\_probabilities\_lognormal()}\spxextra{wass2s.was\_machine\_learning.WAS\_PolynomialRegression static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_PolynomialRegression.calculate_tercile_probabilities_lognormal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_lognormal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Lognormal\sphinxhyphen{}based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_nonparametric() (wass2s.was\_machine\_learning.WAS\_PolynomialRegression static method)@\spxentry{calculate\_tercile\_probabilities\_nonparametric()}\spxextra{wass2s.was\_machine\_learning.WAS\_PolynomialRegression static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_PolynomialRegression.calculate_tercile_probabilities_nonparametric}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_nonparametric}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_samples}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Non\sphinxhyphen{}parametric method (requires historical errors).

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_normal() (wass2s.was\_machine\_learning.WAS\_PolynomialRegression static method)@\spxentry{calculate\_tercile\_probabilities\_normal()}\spxextra{wass2s.was\_machine\_learning.WAS\_PolynomialRegression static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_PolynomialRegression.calculate_tercile_probabilities_normal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_normal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Normal\sphinxhyphen{}based method using the Gaussian CDF.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_t() (wass2s.was\_machine\_learning.WAS\_PolynomialRegression static method)@\spxentry{calculate\_tercile\_probabilities\_t()}\spxextra{wass2s.was\_machine\_learning.WAS\_PolynomialRegression static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_PolynomialRegression.calculate_tercile_probabilities_t}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_t}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Calculates the probability of each tercile category using a Student’s t\sphinxhyphen{}based approach.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{best\_guess}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{shape}}\sphinxstyleliteralemphasis{\sphinxupquote{ (}}\sphinxstyleliteralemphasis{\sphinxupquote{n\_time}}\sphinxstyleliteralemphasis{\sphinxupquote{,}}\sphinxstyleliteralemphasis{\sphinxupquote{)}}) \textendash{} Forecasted values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{error\_variance}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Error variance associated with the forecasted value.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{first\_tercile}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Lower tercile threshold.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{second\_tercile}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Upper tercile threshold.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dof}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Degrees of freedom for the t\sphinxhyphen{}distribution.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{pred\_prob} \textendash{} Probability in each tercile category {[}Below, Normal, Above{]}.

\sphinxlineitem{Return type}
\sphinxAtStartPar
np.ndarray, shape (3, n\_time)

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_model() (wass2s.was\_machine\_learning.WAS\_PolynomialRegression method)@\spxentry{compute\_model()}\spxextra{wass2s.was\_machine\_learning.WAS\_PolynomialRegression method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:id21}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_model}}}
{\sphinxparam{\DUrole{n}{X\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{X\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Computes predictions for spatiotemporal data using Polynomial Regression with parallel processing.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Training data (predictors) with dimensions (T, features).
(It must be chunked properly in Dask, or at least be amenable to chunking.)

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Training target values with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Test data (predictors) with dimensions (features,) or (T, features).
Typically, you’d match time steps or have a single test.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Test target values with dimensions (Y, X) or broadcastable to (T, Y, X).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
An array with shape (2, Y, X) after computing, where the first index
is error and the second is the prediction.

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_prob() (wass2s.was\_machine\_learning.WAS\_PolynomialRegression method)@\spxentry{compute\_prob()}\spxextra{wass2s.was\_machine\_learning.WAS\_PolynomialRegression method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:id22}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_prob}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute tercile probabilities using self.dist\_method.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}\sphinxstyleliteralemphasis{\sphinxupquote{ (}}\sphinxstyleliteralemphasis{\sphinxupquote{T}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{Y}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{X}}\sphinxstyleliteralemphasis{\sphinxupquote{)}}) \textendash{} Observed data.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}})

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} The start and end years for the climatology.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Deterministic forecast with dims (output=2, T, Y, X).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{hindcast\_prob} \textendash{} dims (probability=3, T, Y, X) =\textgreater{} {[}PB, PN, PA{]}.

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{fit\_predict() (wass2s.was\_machine\_learning.WAS\_PolynomialRegression method)@\spxentry{fit\_predict()}\spxextra{wass2s.was\_machine\_learning.WAS\_PolynomialRegression method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:id23}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{fit\_predict}}}
{\sphinxparam{\DUrole{n}{x}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y}}\sphinxparamcomma \sphinxparam{\DUrole{n}{x\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Fits a Polynomial Regression model to the provided training data, makes predictions
on the test data, and calculates the prediction error.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{x}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{shape}}\sphinxstyleliteralemphasis{\sphinxupquote{ (}}\sphinxstyleliteralemphasis{\sphinxupquote{n\_samples}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{n\_features}}\sphinxstyleliteralemphasis{\sphinxupquote{)}}) \textendash{} Training data (predictors).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{shape}}\sphinxstyleliteralemphasis{\sphinxupquote{ (}}\sphinxstyleliteralemphasis{\sphinxupquote{n\_samples}}\sphinxstyleliteralemphasis{\sphinxupquote{,}}\sphinxstyleliteralemphasis{\sphinxupquote{)}}) \textendash{} Training targets.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{x\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{shape}}\sphinxstyleliteralemphasis{\sphinxupquote{ (}}\sphinxstyleliteralemphasis{\sphinxupquote{n\_features}}\sphinxstyleliteralemphasis{\sphinxupquote{,}}\sphinxstyleliteralemphasis{\sphinxupquote{) or }}\sphinxstyleliteralemphasis{\sphinxupquote{(}}\sphinxstyleliteralemphasis{\sphinxupquote{1}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{n\_features}}\sphinxstyleliteralemphasis{\sphinxupquote{)}}) \textendash{} Test data (predictors) for which we want predictions.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} Test target value (for computing error).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
Array containing {[}prediction\_error, predicted\_value{]}.

\sphinxlineitem{Return type}
\sphinxAtStartPar
np.ndarray of shape (2,)

\end{description}\end{quote}

\end{fulllineitems}

\index{forecast() (wass2s.was\_machine\_learning.WAS\_PolynomialRegression method)@\spxentry{forecast()}\spxextra{wass2s.was\_machine\_learning.WAS\_PolynomialRegression method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:id24}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{forecast}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor\_for\_year}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Generate forecasts for a single time (e.g., future year) and compute
tercile probabilities based on the chosen distribution method.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Target variable with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Start year of climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} End year of climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictor}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Historical predictor data with dimensions (T, features).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Deterministic hindcast array that includes ‘error’ and ‘prediction’ over the historical period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictor\_for\_year}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Predictor data for the forecast year, shape (features,) or (1, features).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
{\color{red}\bfseries{}result\_}  : xarray.DataArray or numpy array with the forecast’s {[}error, prediction{]}.
hindcast\_prob : xarray.DataArray of shape (probability=3, Y, X) with PB, PN, and PA.

\sphinxlineitem{Return type}
\sphinxAtStartPar
tuple ({\color{red}\bfseries{}result\_}, hindcast\_prob)

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{WAS\_RandomForest\_XGBoost\_ML\_Stacking (class in wass2s.was\_machine\_learning)@\spxentry{WAS\_RandomForest\_XGBoost\_ML\_Stacking}\spxextra{class in wass2s.was\_machine\_learning}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_RandomForest_XGBoost_ML_Stacking}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_machine\_learning.}}\sphinxbfcode{\sphinxupquote{WAS\_RandomForest\_XGBoost\_ML\_Stacking}}}
{\sphinxparam{\DUrole{n}{nb\_cores}\DUrole{o}{=}\DUrole{default_value}{1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dist\_method}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}gamma\textquotesingle{}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{n\_clusters}\DUrole{o}{=}\DUrole{default_value}{5}}\sphinxparamcomma \sphinxparam{\DUrole{n}{param\_grid}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
A class to perform Stacking Ensemble with RandomForest + XGBoost as base learners
and a LinearRegression as the meta\sphinxhyphen{}model. Also supports:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Hyperparameter tuning via KMeans + GridSearchCV

\item {} 
\sphinxAtStartPar
Parallel spatiotemporal training/prediction using xarray + Dask

\item {} 
\sphinxAtStartPar
Probability computation (terciles) under different distributions.

\end{itemize}
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{nb\_cores}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Number of CPU cores to use for parallel computation (default=1).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dist\_method}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Distribution method for tercile probability calculations.
One of \{‘gamma’, ‘t’, ‘normal’, ‘lognormal’, ‘nonparam’\} (default=’gamma’).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{n\_clusters}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Number of clusters for KMeans (default=5).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{param\_grid}} (\sphinxstyleliteralemphasis{\sphinxupquote{dict}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{None}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} The hyperparameter grid for GridSearchCV over the StackingRegressor.
If None, uses a default small example grid.

\end{itemize}

\end{description}\end{quote}
\subsubsection*{Notes}

\sphinxAtStartPar
In scikit\sphinxhyphen{}learn, you can reference parameters inside stacking base estimators
with naming like “estimators\_\_rf\_\_n\_estimators”, “estimators\_\_xgb\_\_learning\_rate”, etc.
The exact syntax can vary by sklearn version.
\index{calculate\_tercile\_probabilities() (wass2s.was\_machine\_learning.WAS\_RandomForest\_XGBoost\_ML\_Stacking static method)@\spxentry{calculate\_tercile\_probabilities()}\spxextra{wass2s.was\_machine\_learning.WAS\_RandomForest\_XGBoost\_ML\_Stacking static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_RandomForest_XGBoost_ML_Stacking.calculate_tercile_probabilities}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Student’s t\sphinxhyphen{}based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_gamma() (wass2s.was\_machine\_learning.WAS\_RandomForest\_XGBoost\_ML\_Stacking static method)@\spxentry{calculate\_tercile\_probabilities\_gamma()}\spxextra{wass2s.was\_machine\_learning.WAS\_RandomForest\_XGBoost\_ML\_Stacking static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_RandomForest_XGBoost_ML_Stacking.calculate_tercile_probabilities_gamma}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_gamma}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T2}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Gamma\sphinxhyphen{}based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_lognormal() (wass2s.was\_machine\_learning.WAS\_RandomForest\_XGBoost\_ML\_Stacking static method)@\spxentry{calculate\_tercile\_probabilities\_lognormal()}\spxextra{wass2s.was\_machine\_learning.WAS\_RandomForest\_XGBoost\_ML\_Stacking static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_RandomForest_XGBoost_ML_Stacking.calculate_tercile_probabilities_lognormal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_lognormal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Lognormal\sphinxhyphen{}based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_nonparametric() (wass2s.was\_machine\_learning.WAS\_RandomForest\_XGBoost\_ML\_Stacking static method)@\spxentry{calculate\_tercile\_probabilities\_nonparametric()}\spxextra{wass2s.was\_machine\_learning.WAS\_RandomForest\_XGBoost\_ML\_Stacking static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_RandomForest_XGBoost_ML_Stacking.calculate_tercile_probabilities_nonparametric}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_nonparametric}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_samples}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Non\sphinxhyphen{}parametric method (requires historical errors).

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_normal() (wass2s.was\_machine\_learning.WAS\_RandomForest\_XGBoost\_ML\_Stacking static method)@\spxentry{calculate\_tercile\_probabilities\_normal()}\spxextra{wass2s.was\_machine\_learning.WAS\_RandomForest\_XGBoost\_ML\_Stacking static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_RandomForest_XGBoost_ML_Stacking.calculate_tercile_probabilities_normal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_normal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Normal\sphinxhyphen{}based method using the Gaussian CDF.

\end{fulllineitems}

\index{compute\_hyperparameters() (wass2s.was\_machine\_learning.WAS\_RandomForest\_XGBoost\_ML\_Stacking method)@\spxentry{compute\_hyperparameters()}\spxextra{wass2s.was\_machine\_learning.WAS\_RandomForest\_XGBoost\_ML\_Stacking method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_RandomForest_XGBoost_ML_Stacking.compute_hyperparameters}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_hyperparameters}}}
{\sphinxparam{\DUrole{n}{predictand}}\sphinxparamcomma \sphinxparam{\DUrole{n}{predictor}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Cluster grid cells (Y,X) via KMeans on the mean of \sphinxtitleref{predictand} (over T).
Then for each cluster, run a cross\sphinxhyphen{}validation GridSearch over a StackingRegressor
to find best hyperparameters. Store results in DataArrays.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{predictand}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Target variable with dims (‘T’,’Y’,’X’).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{predictor}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Predictor variables with dims (‘T’,’features’).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{best\_param\_da} (\sphinxstyleemphasis{xarray.DataArray (dtype=object or str)}) \textendash{} A DataArray holding best hyperparameter sets (as strings) for each grid cell.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{cluster\_da} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} The integer cluster assignment for each (Y, X).

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_model() (wass2s.was\_machine\_learning.WAS\_RandomForest\_XGBoost\_ML\_Stacking method)@\spxentry{compute\_model()}\spxextra{wass2s.was\_machine\_learning.WAS\_RandomForest\_XGBoost\_ML\_Stacking method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_RandomForest_XGBoost_ML_Stacking.compute_model}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_model}}}
{\sphinxparam{\DUrole{n}{X\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{X\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{best\_param\_da}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Parallel fit/predict across the entire spatial domain, using cluster\sphinxhyphen{}based hyperparams.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Training data (predictors) with dims (‘T’,’features’).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Training target with dims (‘T’,’Y’,’X’).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Test data (predictors), shape (features,) or broadcastable across (Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Test target with dims (‘Y’,’X’).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{best\_param\_da}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} The per\sphinxhyphen{}grid best\_params from compute\_hyperparameters (as strings).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
dims (‘output’,’Y’,’X’), where ‘output’ = {[}error, prediction{]}.

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_prob() (wass2s.was\_machine\_learning.WAS\_RandomForest\_XGBoost\_ML\_Stacking method)@\spxentry{compute\_prob()}\spxextra{wass2s.was\_machine\_learning.WAS\_RandomForest\_XGBoost\_ML\_Stacking method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_RandomForest_XGBoost_ML_Stacking.compute_prob}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_prob}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute tercile probabilities using self.dist\_method.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}\sphinxstyleliteralemphasis{\sphinxupquote{ (}}\sphinxstyleliteralemphasis{\sphinxupquote{T}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{Y}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{X}}\sphinxstyleliteralemphasis{\sphinxupquote{)}}) \textendash{} Observed data.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}})

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} The start and end years for the climatology.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Deterministic forecast with dims (output=2, T, Y, X).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{hindcast\_prob} \textendash{} dims (probability=3, T, Y, X) =\textgreater{} {[}PB, PN, PA{]}.

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{fit\_predict() (wass2s.was\_machine\_learning.WAS\_RandomForest\_XGBoost\_ML\_Stacking method)@\spxentry{fit\_predict()}\spxextra{wass2s.was\_machine\_learning.WAS\_RandomForest\_XGBoost\_ML\_Stacking method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_RandomForest_XGBoost_ML_Stacking.fit_predict}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{fit\_predict}}}
{\sphinxparam{\DUrole{n}{X\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{X\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{best\_params\_str}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Fit a local StackingRegressor with the best hyperparams (parsed from best\_params\_str),
then predict on X\_test, returning {[}error, prediction{]}.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.ndarray}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{shape}}\sphinxstyleliteralemphasis{\sphinxupquote{ (}}\sphinxstyleliteralemphasis{\sphinxupquote{n\_samples}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{n\_features}}\sphinxstyleliteralemphasis{\sphinxupquote{)}})

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.ndarray}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{shape}}\sphinxstyleliteralemphasis{\sphinxupquote{ (}}\sphinxstyleliteralemphasis{\sphinxupquote{n\_samples}}\sphinxstyleliteralemphasis{\sphinxupquote{,}}\sphinxstyleliteralemphasis{\sphinxupquote{)}})

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.ndarray}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{shape}}\sphinxstyleliteralemphasis{\sphinxupquote{ (}}\sphinxstyleliteralemphasis{\sphinxupquote{n\_features}}\sphinxstyleliteralemphasis{\sphinxupquote{,}}\sphinxstyleliteralemphasis{\sphinxupquote{) or }}\sphinxstyleliteralemphasis{\sphinxupquote{(}}\sphinxstyleliteralemphasis{\sphinxupquote{1}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{n\_features}}\sphinxstyleliteralemphasis{\sphinxupquote{)}})

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{np.nan}})

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{best\_params\_str}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} String of best\_params (e.g. “\{‘estimators\_\_rf\_\_n\_estimators’:100, …\}”)

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
{[}error, predicted\_value{]}

\sphinxlineitem{Return type}
\sphinxAtStartPar
np.ndarray of shape (2,)

\end{description}\end{quote}

\end{fulllineitems}

\index{forecast() (wass2s.was\_machine\_learning.WAS\_RandomForest\_XGBoost\_ML\_Stacking method)@\spxentry{forecast()}\spxextra{wass2s.was\_machine\_learning.WAS\_RandomForest\_XGBoost\_ML\_Stacking method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_RandomForest_XGBoost_ML_Stacking.forecast}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{forecast}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor\_for\_year}}\sphinxparamcomma \sphinxparam{\DUrole{n}{best\_param\_da}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Generate a forecast for a single time (e.g., future year), then compute
tercile probabilities from the chosen distribution method.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Observed data with dims (T, Y, X), used for climatological terciles.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Start year of the climatology.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} End year of the climatology.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictor}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Historical predictor data, dims (T, features).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Historical deterministic forecast, dims (output={[}error,prediction{]}, T, Y, X).
Used to compute error variance or error samples.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictor\_for\_year}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Predictor data for the forecast year, shape (features,) or (1, features).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{best\_param\_da}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Grid\sphinxhyphen{}based hyperparameters from compute\_hyperparameters.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{result\_} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} dims (‘output’,’Y’,’X’) =\textgreater{} {[}error, prediction{]}.
For a forecast, the ‘error’ will generally be NaN.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{hindcast\_prob} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} dims (probability=3, Y, X) =\textgreater{} tercile probabilities PB, PN, PA.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{WAS\_RandomForest\_XGBoost\_Stacking\_MLP (class in wass2s.was\_machine\_learning)@\spxentry{WAS\_RandomForest\_XGBoost\_Stacking\_MLP}\spxextra{class in wass2s.was\_machine\_learning}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_RandomForest_XGBoost_Stacking_MLP}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_machine\_learning.}}\sphinxbfcode{\sphinxupquote{WAS\_RandomForest\_XGBoost\_Stacking\_MLP}}}
{\sphinxparam{\DUrole{n}{nb\_cores}\DUrole{o}{=}\DUrole{default_value}{1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dist\_method}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}gamma\textquotesingle{}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{n\_clusters}\DUrole{o}{=}\DUrole{default_value}{5}}\sphinxparamcomma \sphinxparam{\DUrole{n}{param\_grid}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
A class that performs stacking of RandomForest + XGBoost (base learners)
and an MLPRegressor (meta\sphinxhyphen{}learner). Features:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Hyperparameter tuning via cluster\sphinxhyphen{}based GridSearchCV

\item {} 
\sphinxAtStartPar
Parallel spatiotemporal training/prediction

\item {} 
\sphinxAtStartPar
Tercile probability calculations with various distributions

\end{itemize}
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{nb\_cores}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Number of CPU cores to use for parallel computation.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dist\_method}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} Distribution method for tercile probability calculations.
One of \{‘gamma’, ‘t’, ‘normal’, ‘lognormal’, ‘nonparam’\}.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{n\_clusters}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Number of clusters for KMeans.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{param\_grid}} (\sphinxstyleliteralemphasis{\sphinxupquote{dict}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{None}}) \textendash{} Hyperparameter search grid for GridSearchCV. If None, a minimal default is used.

\end{itemize}

\end{description}\end{quote}
\subsubsection*{Notes}
\begin{itemize}
\item {} 
\sphinxAtStartPar
When referencing parameters inside stacking estimators, scikit\sphinxhyphen{}learn uses
“estimators\_\_\textless{}est\_name\textgreater{}\_\_\textless{}param\_name\textgreater{}” for base models, or
“final\_estimator\_\_\textless{}param\textgreater{}” for the meta\sphinxhyphen{}model. For example:
\begin{itemize}
\item {} 
\sphinxAtStartPar
“estimators\_\_rf\_\_n\_estimators” =\textgreater{} sets n\_estimators for ‘rf’

\item {} 
\sphinxAtStartPar
“estimators\_\_xgb\_\_max\_depth”   =\textgreater{} sets max\_depth for ‘xgb’

\item {} 
\sphinxAtStartPar
“final\_estimator\_\_hidden\_layer\_sizes” =\textgreater{} sets hidden\_layer\_sizes in MLPRegressor

\end{itemize}

\end{itemize}
\index{calculate\_tercile\_probabilities() (wass2s.was\_machine\_learning.WAS\_RandomForest\_XGBoost\_Stacking\_MLP static method)@\spxentry{calculate\_tercile\_probabilities()}\spxextra{wass2s.was\_machine\_learning.WAS\_RandomForest\_XGBoost\_Stacking\_MLP static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_RandomForest_XGBoost_Stacking_MLP.calculate_tercile_probabilities}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Student’s t\sphinxhyphen{}based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_gamma() (wass2s.was\_machine\_learning.WAS\_RandomForest\_XGBoost\_Stacking\_MLP static method)@\spxentry{calculate\_tercile\_probabilities\_gamma()}\spxextra{wass2s.was\_machine\_learning.WAS\_RandomForest\_XGBoost\_Stacking\_MLP static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_RandomForest_XGBoost_Stacking_MLP.calculate_tercile_probabilities_gamma}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_gamma}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T2}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Gamma\sphinxhyphen{}based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_lognormal() (wass2s.was\_machine\_learning.WAS\_RandomForest\_XGBoost\_Stacking\_MLP static method)@\spxentry{calculate\_tercile\_probabilities\_lognormal()}\spxextra{wass2s.was\_machine\_learning.WAS\_RandomForest\_XGBoost\_Stacking\_MLP static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_RandomForest_XGBoost_Stacking_MLP.calculate_tercile_probabilities_lognormal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_lognormal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Lognormal\sphinxhyphen{}based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_nonparametric() (wass2s.was\_machine\_learning.WAS\_RandomForest\_XGBoost\_Stacking\_MLP static method)@\spxentry{calculate\_tercile\_probabilities\_nonparametric()}\spxextra{wass2s.was\_machine\_learning.WAS\_RandomForest\_XGBoost\_Stacking\_MLP static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_RandomForest_XGBoost_Stacking_MLP.calculate_tercile_probabilities_nonparametric}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_nonparametric}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_samples}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Non\sphinxhyphen{}parametric method (requires historical errors).

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_normal() (wass2s.was\_machine\_learning.WAS\_RandomForest\_XGBoost\_Stacking\_MLP static method)@\spxentry{calculate\_tercile\_probabilities\_normal()}\spxextra{wass2s.was\_machine\_learning.WAS\_RandomForest\_XGBoost\_Stacking\_MLP static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_RandomForest_XGBoost_Stacking_MLP.calculate_tercile_probabilities_normal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_normal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Normal\sphinxhyphen{}based method using the Gaussian CDF.

\end{fulllineitems}

\index{compute\_hyperparameters() (wass2s.was\_machine\_learning.WAS\_RandomForest\_XGBoost\_Stacking\_MLP method)@\spxentry{compute\_hyperparameters()}\spxextra{wass2s.was\_machine\_learning.WAS\_RandomForest\_XGBoost\_Stacking\_MLP method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_RandomForest_XGBoost_Stacking_MLP.compute_hyperparameters}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_hyperparameters}}}
{\sphinxparam{\DUrole{n}{predictand}}\sphinxparamcomma \sphinxparam{\DUrole{n}{predictor}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Cluster grid cells (Y,X) via KMeans on the mean of \sphinxtitleref{predictand}.
For each cluster, run GridSearchCV on a StackingRegressor that has:
\begin{itemize}
\item {} 
\sphinxAtStartPar
RandomForest (rf) + XGBoost (xgb) as base learners

\item {} 
\sphinxAtStartPar
MLPRegressor as meta\sphinxhyphen{}learner

\end{itemize}
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{predictand}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Target variable with dims (‘T’, ‘Y’, ‘X’).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{predictor}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Predictor variables with dims (‘T’,’features’).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{best\_param\_da} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} DataArray storing the best hyperparams (as strings) for each grid cell.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{cluster\_da} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} The integer cluster assignment for each (Y,X).

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_model() (wass2s.was\_machine\_learning.WAS\_RandomForest\_XGBoost\_Stacking\_MLP method)@\spxentry{compute\_model()}\spxextra{wass2s.was\_machine\_learning.WAS\_RandomForest\_XGBoost\_Stacking\_MLP method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_RandomForest_XGBoost_Stacking_MLP.compute_model}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_model}}}
{\sphinxparam{\DUrole{n}{X\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{X\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{best\_param\_da}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Parallel training + prediction across the entire spatial domain,
referencing local best\_params for each grid cell.

\sphinxAtStartPar
Returns an xarray.DataArray with dim ‘output’ = {[}error, prediction{]}.

\end{fulllineitems}

\index{compute\_prob() (wass2s.was\_machine\_learning.WAS\_RandomForest\_XGBoost\_Stacking\_MLP method)@\spxentry{compute\_prob()}\spxextra{wass2s.was\_machine\_learning.WAS\_RandomForest\_XGBoost\_Stacking\_MLP method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_RandomForest_XGBoost_Stacking_MLP.compute_prob}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_prob}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute tercile probabilities using self.dist\_method.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}\sphinxstyleliteralemphasis{\sphinxupquote{ (}}\sphinxstyleliteralemphasis{\sphinxupquote{T}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{Y}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{X}}\sphinxstyleliteralemphasis{\sphinxupquote{)}}) \textendash{} Observed data.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}})

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} The start and end years for the climatology.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Deterministic forecast with dims (output=2, T, Y, X).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{hindcast\_prob} \textendash{} dims (probability=3, T, Y, X) =\textgreater{} {[}PB, PN, PA{]}.

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{fit\_predict() (wass2s.was\_machine\_learning.WAS\_RandomForest\_XGBoost\_Stacking\_MLP method)@\spxentry{fit\_predict()}\spxextra{wass2s.was\_machine\_learning.WAS\_RandomForest\_XGBoost\_Stacking\_MLP method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_RandomForest_XGBoost_Stacking_MLP.fit_predict}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{fit\_predict}}}
{\sphinxparam{\DUrole{n}{X\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{X\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{best\_params\_str}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
For a single grid cell, parse the local best\_params dict, set them on the
StackingRegressor (with RF + XGB base, MLP meta), train and predict.

\sphinxAtStartPar
Returns {[}error, prediction{]}.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.ndarray}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{shape}}\sphinxstyleliteralemphasis{\sphinxupquote{ (}}\sphinxstyleliteralemphasis{\sphinxupquote{n\_samples}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{n\_features}}\sphinxstyleliteralemphasis{\sphinxupquote{)}})

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.ndarray}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{shape}}\sphinxstyleliteralemphasis{\sphinxupquote{ (}}\sphinxstyleliteralemphasis{\sphinxupquote{n\_samples}}\sphinxstyleliteralemphasis{\sphinxupquote{,}}\sphinxstyleliteralemphasis{\sphinxupquote{)}})

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.ndarray}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{shape}}\sphinxstyleliteralemphasis{\sphinxupquote{ (}}\sphinxstyleliteralemphasis{\sphinxupquote{n\_features}}\sphinxstyleliteralemphasis{\sphinxupquote{,}}\sphinxstyleliteralemphasis{\sphinxupquote{) or }}\sphinxstyleliteralemphasis{\sphinxupquote{(}}\sphinxstyleliteralemphasis{\sphinxupquote{1}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{n\_features}}\sphinxstyleliteralemphasis{\sphinxupquote{)}})

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{np.nan}})

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{best\_params\_str}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} Local best hyperparams as a stringified dict.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
{[}error, prediction{]}

\sphinxlineitem{Return type}
\sphinxAtStartPar
np.ndarray of shape (2,)

\end{description}\end{quote}

\end{fulllineitems}

\index{forecast() (wass2s.was\_machine\_learning.WAS\_RandomForest\_XGBoost\_Stacking\_MLP method)@\spxentry{forecast()}\spxextra{wass2s.was\_machine\_learning.WAS\_RandomForest\_XGBoost\_Stacking\_MLP method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_RandomForest_XGBoost_Stacking_MLP.forecast}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{forecast}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor\_for\_year}}\sphinxparamcomma \sphinxparam{\DUrole{n}{best\_param\_da}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Generate a forecast for a single future time (e.g., future year),
then compute tercile probabilities from the chosen distribution method.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Observed data with dims (T, Y, X) used for computing climatological terciles.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Start year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} End year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictor}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Historical predictor data, shape (T, features).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Historical deterministic forecast with dims (output={[}error,prediction{]}, T, Y, X).
Used to estimate error variance or error samples.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictor\_for\_year}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Predictor data for the forecast year, shape (features,) or (1, features).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{best\_param\_da}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Grid\sphinxhyphen{}based best hyperparams from \sphinxtitleref{compute\_hyperparameters}.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{result\_} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} dims (‘output’,’Y’,’X’) =\textgreater{} {[}error, prediction{]}.
For a true forecast, the ‘error’ is typically NaN.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{hindcast\_prob} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} dims (probability=3, Y, X) =\textgreater{} PB, PN, PA tercile probabilities.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{WAS\_SVR (class in wass2s.was\_machine\_learning)@\spxentry{WAS\_SVR}\spxextra{class in wass2s.was\_machine\_learning}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_SVR}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_machine\_learning.}}\sphinxbfcode{\sphinxupquote{WAS\_SVR}}}
{\sphinxparam{\DUrole{n}{nb\_cores}\DUrole{o}{=}\DUrole{default_value}{1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{n\_clusters}\DUrole{o}{=}\DUrole{default_value}{5}}\sphinxparamcomma \sphinxparam{\DUrole{n}{kernel}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}linear\textquotesingle{}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{gamma}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{C\_range}\DUrole{o}{=}\DUrole{default_value}{{[}0.1, 1, 10, 100{]}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{epsilon\_range}\DUrole{o}{=}\DUrole{default_value}{{[}0.01, 0.1, 0.5, 1{]}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{degree\_range}\DUrole{o}{=}\DUrole{default_value}{{[}2, 3, 4{]}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dist\_method}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}gamma\textquotesingle{}}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
A class to perform Support Vector Regression (SVR) on spatiotemporal datasets for climate prediction.

\sphinxAtStartPar
This class is designed to work with Dask and Xarray for parallelized, high\sphinxhyphen{}performance
regression computations across large datasets with spatial and temporal dimensions. The primary
methods are for fitting the SVR model, making predictions, and calculating probabilistic predictions
for climate terciles.
\index{nb\_cores (wass2s.was\_machine\_learning.WAS\_SVR attribute)@\spxentry{nb\_cores}\spxextra{wass2s.was\_machine\_learning.WAS\_SVR attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_SVR.nb_cores}}
\pysigstartsignatures
\pysigline
{\sphinxbfcode{\sphinxupquote{nb\_cores}}}
\pysigstopsignatures
\sphinxAtStartPar
The number of CPU cores to use for parallel computation (default is 1).
\begin{quote}\begin{description}
\sphinxlineitem{Type}
\sphinxAtStartPar
int, optional

\end{description}\end{quote}

\end{fulllineitems}

\index{n\_clusters (wass2s.was\_machine\_learning.WAS\_SVR attribute)@\spxentry{n\_clusters}\spxextra{wass2s.was\_machine\_learning.WAS\_SVR attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_SVR.n_clusters}}
\pysigstartsignatures
\pysigline
{\sphinxbfcode{\sphinxupquote{n\_clusters}}}
\pysigstopsignatures
\sphinxAtStartPar
The number of clusters to use in KMeans clustering (default is 5).
\begin{quote}\begin{description}
\sphinxlineitem{Type}
\sphinxAtStartPar
int, optional

\end{description}\end{quote}

\end{fulllineitems}

\index{kernel (wass2s.was\_machine\_learning.WAS\_SVR attribute)@\spxentry{kernel}\spxextra{wass2s.was\_machine\_learning.WAS\_SVR attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_SVR.kernel}}
\pysigstartsignatures
\pysigline
{\sphinxbfcode{\sphinxupquote{kernel}}}
\pysigstopsignatures
\sphinxAtStartPar
Kernel type to be used in SVR (‘linear’, ‘poly’, ‘rbf’, or ‘all’) (default is ‘linear’).
\begin{quote}\begin{description}
\sphinxlineitem{Type}
\sphinxAtStartPar
str, optional

\end{description}\end{quote}

\end{fulllineitems}

\index{gamma (wass2s.was\_machine\_learning.WAS\_SVR attribute)@\spxentry{gamma}\spxextra{wass2s.was\_machine\_learning.WAS\_SVR attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_SVR.gamma}}
\pysigstartsignatures
\pysigline
{\sphinxbfcode{\sphinxupquote{gamma}}}
\pysigstopsignatures
\sphinxAtStartPar
gamma of ‘rbf’ kernel function. Ignored by all other kernels, {[}“auto”, “scale”, None{]} by default None.
\begin{quote}\begin{description}
\sphinxlineitem{Type}
\sphinxAtStartPar
str, optional

\end{description}\end{quote}

\end{fulllineitems}

\index{C\_range (wass2s.was\_machine\_learning.WAS\_SVR attribute)@\spxentry{C\_range}\spxextra{wass2s.was\_machine\_learning.WAS\_SVR attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_SVR.C_range}}
\pysigstartsignatures
\pysigline
{\sphinxbfcode{\sphinxupquote{C\_range}}}
\pysigstopsignatures
\sphinxAtStartPar
List of C values to consider during hyperparameter tuning.
\begin{quote}\begin{description}
\sphinxlineitem{Type}
\sphinxAtStartPar
list, optional

\end{description}\end{quote}

\end{fulllineitems}

\index{epsilon\_range (wass2s.was\_machine\_learning.WAS\_SVR attribute)@\spxentry{epsilon\_range}\spxextra{wass2s.was\_machine\_learning.WAS\_SVR attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_SVR.epsilon_range}}
\pysigstartsignatures
\pysigline
{\sphinxbfcode{\sphinxupquote{epsilon\_range}}}
\pysigstopsignatures
\sphinxAtStartPar
List of epsilon values to consider during hyperparameter tuning.
\begin{quote}\begin{description}
\sphinxlineitem{Type}
\sphinxAtStartPar
list, optional

\end{description}\end{quote}

\end{fulllineitems}

\index{degree\_range (wass2s.was\_machine\_learning.WAS\_SVR attribute)@\spxentry{degree\_range}\spxextra{wass2s.was\_machine\_learning.WAS\_SVR attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_SVR.degree_range}}
\pysigstartsignatures
\pysigline
{\sphinxbfcode{\sphinxupquote{degree\_range}}}
\pysigstopsignatures
\sphinxAtStartPar
List of degrees to consider for the ‘poly’ kernel during hyperparameter tuning.
\begin{quote}\begin{description}
\sphinxlineitem{Type}
\sphinxAtStartPar
list, optional

\end{description}\end{quote}

\end{fulllineitems}

\index{dist\_method (wass2s.was\_machine\_learning.WAS\_SVR attribute)@\spxentry{dist\_method}\spxextra{wass2s.was\_machine\_learning.WAS\_SVR attribute}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_SVR.dist_method}}
\pysigstartsignatures
\pysigline
{\sphinxbfcode{\sphinxupquote{dist\_method}}}
\pysigstopsignatures
\sphinxAtStartPar
Distribution method (“gamma”, “t”, “normal”, “lognormal”, “nonparam”) for probability calculations.
\begin{quote}\begin{description}
\sphinxlineitem{Type}
\sphinxAtStartPar
str, optional

\end{description}\end{quote}

\end{fulllineitems}

\index{calculate\_tercile\_probabilities() (wass2s.was\_machine\_learning.WAS\_SVR static method)@\spxentry{calculate\_tercile\_probabilities()}\spxextra{wass2s.was\_machine\_learning.WAS\_SVR static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_SVR.calculate_tercile_probabilities}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Calculates tercile probabilities using a Student’s t\sphinxhyphen{}based approach.
\begin{description}
\sphinxlineitem{best\_guess}{[}array\sphinxhyphen{}like{]}
\sphinxAtStartPar
Model predictions for each time.

\sphinxlineitem{error\_variance}{[}float or array\sphinxhyphen{}like{]}
\sphinxAtStartPar
Variance of prediction errors.

\sphinxlineitem{first\_tercile, second\_tercile}{[}float or array\sphinxhyphen{}like{]}
\sphinxAtStartPar
The lower and upper tercile boundaries.

\sphinxlineitem{dof}{[}int{]}
\sphinxAtStartPar
Degrees of freedom for the t\sphinxhyphen{}distribution.

\end{description}
\begin{quote}\begin{description}
\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{pred\_prob} \textendash{} Probability in each of the 3 categories (below, normal, above).

\sphinxlineitem{Return type}
\sphinxAtStartPar
np.ndarray

\end{description}\end{quote}

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_gamma() (wass2s.was\_machine\_learning.WAS\_SVR static method)@\spxentry{calculate\_tercile\_probabilities\_gamma()}\spxextra{wass2s.was\_machine\_learning.WAS\_SVR static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_SVR.calculate_tercile_probabilities_gamma}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_gamma}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T2}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Calculates tercile probabilities assuming Gamma\sphinxhyphen{}distributed errors.
\begin{description}
\sphinxlineitem{best\_guess}{[}array\sphinxhyphen{}like{]}
\sphinxAtStartPar
Model predictions for each time.

\sphinxlineitem{error\_variance}{[}float or array\sphinxhyphen{}like{]}
\sphinxAtStartPar
Variance of prediction errors.

\sphinxlineitem{T1, T2}{[}float or array\sphinxhyphen{}like{]}
\sphinxAtStartPar
The lower (T1) and upper (T2) tercile boundaries.

\end{description}
\begin{quote}\begin{description}
\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{pred\_prob} \textendash{} 3 rows for probabilities (PB, PN, PA) over time dimension.

\sphinxlineitem{Return type}
\sphinxAtStartPar
np.ndarray

\end{description}\end{quote}

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_lognormal() (wass2s.was\_machine\_learning.WAS\_SVR static method)@\spxentry{calculate\_tercile\_probabilities\_lognormal()}\spxextra{wass2s.was\_machine\_learning.WAS\_SVR static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_SVR.calculate_tercile_probabilities_lognormal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_lognormal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Lognormal\sphinxhyphen{}based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_nonparametric() (wass2s.was\_machine\_learning.WAS\_SVR static method)@\spxentry{calculate\_tercile\_probabilities\_nonparametric()}\spxextra{wass2s.was\_machine\_learning.WAS\_SVR static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_SVR.calculate_tercile_probabilities_nonparametric}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_nonparametric}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_samples}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Non\sphinxhyphen{}parametric method (requires historical errors).

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_normal() (wass2s.was\_machine\_learning.WAS\_SVR static method)@\spxentry{calculate\_tercile\_probabilities\_normal()}\spxextra{wass2s.was\_machine\_learning.WAS\_SVR static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_SVR.calculate_tercile_probabilities_normal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_normal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Normal\sphinxhyphen{}based method using the Gaussian CDF.

\end{fulllineitems}

\index{compute\_hyperparameters() (wass2s.was\_machine\_learning.WAS\_SVR method)@\spxentry{compute\_hyperparameters()}\spxextra{wass2s.was\_machine\_learning.WAS\_SVR method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_SVR.compute_hyperparameters}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_hyperparameters}}}
{\sphinxparam{\DUrole{n}{predictand}}\sphinxparamcomma \sphinxparam{\DUrole{n}{predictor}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Computes optimal SVR hyperparameters (C and epsilon) for each spatial cluster.

\sphinxAtStartPar
We cluster the spatial grid based on the mean values in \sphinxtitleref{predictand},
then do a grid search for SVR hyperparameters on the average time series of each cluster.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{predictand}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Target variable with dimensions (‘T’, ‘Y’, ‘X’).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{predictor}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Predictor variables with dimensions (‘T’, ‘features’).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
DataArrays containing the best\sphinxhyphen{}fitting hyperparameters and cluster labels for each grid cell.

\sphinxlineitem{Return type}
\sphinxAtStartPar
C\_array, epsilon\_array, degree\_array, Cluster

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_model() (wass2s.was\_machine\_learning.WAS\_SVR method)@\spxentry{compute\_model()}\spxextra{wass2s.was\_machine\_learning.WAS\_SVR method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_SVR.compute_model}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_model}}}
{\sphinxparam{\DUrole{n}{X\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{X\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{epsilon}}\sphinxparamcomma \sphinxparam{\DUrole{n}{C}}\sphinxparamcomma \sphinxparam{\DUrole{n}{degree\_array}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Computes predictions for spatiotemporal data using SVR with parallel processing via Dask.

\sphinxAtStartPar
We break the data into chunks, apply the \sphinxtitleref{fit\_predict} function in parallel,
and combine the results into an output DataArray.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Training predictors with dimensions (‘T’, ‘features’).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Training targets with dimensions (‘T’, ‘Y’, ‘X’).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Test predictors with dimensions (‘features’,).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Test target values with dimensions (‘Y’, ‘X’).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{epsilon}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Epsilon hyperparameters per grid point.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{C}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} C hyperparameters per grid point.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{degree\_array}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Polynomial degrees per grid point (only used if kernel=’poly’).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
Predictions \& errors, stacked along a new ‘output’ dimension (size=2).

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_prob() (wass2s.was\_machine\_learning.WAS\_SVR method)@\spxentry{compute\_prob()}\spxextra{wass2s.was\_machine\_learning.WAS\_SVR method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_SVR.compute_prob}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_prob}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute tercile probabilities using self.dist\_method.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}\sphinxstyleliteralemphasis{\sphinxupquote{ (}}\sphinxstyleliteralemphasis{\sphinxupquote{T}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{Y}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{X}}\sphinxstyleliteralemphasis{\sphinxupquote{)}}) \textendash{} Observed data.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}})

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} The start and end years for the climatology.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Deterministic forecast with dims (output=2, T, Y, X).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{hindcast\_prob} \textendash{} dims (probability=3, T, Y, X) =\textgreater{} {[}PB, PN, PA{]}.

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{fit\_predict() (wass2s.was\_machine\_learning.WAS\_SVR method)@\spxentry{fit\_predict()}\spxextra{wass2s.was\_machine\_learning.WAS\_SVR method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_SVR.fit_predict}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{fit\_predict}}}
{\sphinxparam{\DUrole{n}{x}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y}}\sphinxparamcomma \sphinxparam{\DUrole{n}{x\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{epsilon}}\sphinxparamcomma \sphinxparam{\DUrole{n}{C}}\sphinxparamcomma \sphinxparam{\DUrole{n}{degree}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Fits an SVR model to the provided training data, makes predictions on the test data,
and calculates the prediction error.

\sphinxAtStartPar
We handle data\sphinxhyphen{}type issues (e.g., bytes input), set up the SVR with the requested
parameters, fit it, and return both the error and the prediction.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{x}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{shape}}\sphinxstyleliteralemphasis{\sphinxupquote{ (}}\sphinxstyleliteralemphasis{\sphinxupquote{n\_samples}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{n\_features}}\sphinxstyleliteralemphasis{\sphinxupquote{)}}) \textendash{} Training predictors.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{shape}}\sphinxstyleliteralemphasis{\sphinxupquote{ (}}\sphinxstyleliteralemphasis{\sphinxupquote{n\_samples}}\sphinxstyleliteralemphasis{\sphinxupquote{,}}\sphinxstyleliteralemphasis{\sphinxupquote{)}}) \textendash{} Training targets.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{x\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{shape}}\sphinxstyleliteralemphasis{\sphinxupquote{ (}}\sphinxstyleliteralemphasis{\sphinxupquote{n\_features}}\sphinxstyleliteralemphasis{\sphinxupquote{,}}\sphinxstyleliteralemphasis{\sphinxupquote{)}}) \textendash{} Test predictors.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{None}}) \textendash{} Test target value. Used to calculate error if available.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{epsilon}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} Epsilon parameter for SVR (defines epsilon\sphinxhyphen{}tube).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{C}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} Regularization parameter for SVR.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{degree}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Degree for ‘poly’ kernel. Ignored if kernel != ‘poly’.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
A 2\sphinxhyphen{}element array containing {[}error, prediction{]}.

\sphinxlineitem{Return type}
\sphinxAtStartPar
np.ndarray

\end{description}\end{quote}

\end{fulllineitems}

\index{forecast() (wass2s.was\_machine\_learning.WAS\_SVR method)@\spxentry{forecast()}\spxextra{wass2s.was\_machine\_learning.WAS\_SVR method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_SVR.forecast}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{forecast}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor\_for\_year}}\sphinxparamcomma \sphinxparam{\DUrole{n}{epsilon}}\sphinxparamcomma \sphinxparam{\DUrole{n}{C}}\sphinxparamcomma \sphinxparam{\DUrole{n}{kernel\_array}}\sphinxparamcomma \sphinxparam{\DUrole{n}{degree\_array}}\sphinxparamcomma \sphinxparam{\DUrole{n}{gamma\_array}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Generates forecasts and computes probabilities for a specific year.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Target variable (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Start year for climatology.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} End year for climatology.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictor}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Historical predictor data (T, features).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Deterministic hindcasts (includes ‘prediction’ and ‘error’ outputs).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictor\_for\_year}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Predictor data for the target forecast year (features).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{epsilon}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Hyperparameter grids for the model.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{C}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Hyperparameter grids for the model.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{kernel\_array}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Hyperparameter grids for the model.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{degree\_array}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Hyperparameter grids for the model.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{gamma\_array}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Hyperparameter grids for the model.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{)}%
\item {} 
\sphinxAtStartPar
The forecast results (error, prediction) for that year.

\item {} 
\sphinxAtStartPar
The corresponding tercile probabilities (PB, PN, PA).

\end{enumerate}


\sphinxlineitem{Return type}
\sphinxAtStartPar
tuple

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{WAS\_Stacking\_Ridge (class in wass2s.was\_machine\_learning)@\spxentry{WAS\_Stacking\_Ridge}\spxextra{class in wass2s.was\_machine\_learning}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_Stacking_Ridge}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_machine\_learning.}}\sphinxbfcode{\sphinxupquote{WAS\_Stacking\_Ridge}}}
{\sphinxparam{\DUrole{n}{nb\_cores}\DUrole{o}{=}\DUrole{default_value}{1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dist\_method}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}gamma\textquotesingle{}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{n\_clusters}\DUrole{o}{=}\DUrole{default_value}{5}}\sphinxparamcomma \sphinxparam{\DUrole{n}{param\_grid}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}
\begin{description}
\sphinxlineitem{A class that performs stacking of the following base learners:}\begin{itemize}
\item {} 
\sphinxAtStartPar
RandomForestRegressor (rf)

\item {} 
\sphinxAtStartPar
XGBRegressor (xgb)

\item {} 
\sphinxAtStartPar
MLPRegressor (mlp\_base)

\end{itemize}

\end{description}

\sphinxAtStartPar
and uses Ridge as the meta\sphinxhyphen{}model.
\begin{description}
\sphinxlineitem{Like the previous classes, this supports:}\begin{itemize}
\item {} 
\sphinxAtStartPar
Cluster\sphinxhyphen{}based hyperparameter tuning via KMeans + GridSearchCV

\item {} 
\sphinxAtStartPar
Parallel spatiotemporal training/prediction with xarray + dask

\item {} 
\sphinxAtStartPar
Various distribution methods for tercile probability calculations.

\end{itemize}

\end{description}
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{nb\_cores}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Number of CPU cores to use for parallel computation.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dist\_method}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} Distribution method for tercile probability calculations:
One of \{‘gamma’, ‘t’, ‘normal’, ‘lognormal’, ‘nonparam’\}.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{n\_clusters}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Number of clusters for KMeans (used in hyperparameter tuning).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{param\_grid}} (\sphinxstyleliteralemphasis{\sphinxupquote{Example for}}) \textendash{} Hyperparameter grid for GridSearchCV. If None, a minimal default is used.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{param\_grid}} \textendash{} \begin{description}
\sphinxlineitem{\{}
\sphinxAtStartPar
“estimators\_\_rf\_\_n\_estimators”: {[}50, 100{]},
“estimators\_\_xgb\_\_max\_depth”: {[}3, 6{]},
“estimators\_\_mlp\_base\_\_hidden\_layer\_sizes”: {[}(20,), (50, 10){]},
“final\_estimator\_\_alpha”: {[}0.1, 0.9, 5.0{]},

\end{description}

\sphinxAtStartPar
\}


\end{itemize}

\end{description}\end{quote}
\index{compute\_hyperparameters() (wass2s.was\_machine\_learning.WAS\_Stacking\_Ridge method)@\spxentry{compute\_hyperparameters()}\spxextra{wass2s.was\_machine\_learning.WAS\_Stacking\_Ridge method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_Stacking_Ridge.compute_hyperparameters}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_hyperparameters}}}
{\sphinxparam{\DUrole{n}{predictand}}\sphinxparamcomma \sphinxparam{\DUrole{n}{predictor}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Performs cluster\sphinxhyphen{}based hyperparam tuning, returns best\sphinxhyphen{}param DataArray.

\end{fulllineitems}

\index{fit\_predict() (wass2s.was\_machine\_learning.WAS\_Stacking\_Ridge method)@\spxentry{fit\_predict()}\spxextra{wass2s.was\_machine\_learning.WAS\_Stacking\_Ridge method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_Stacking_Ridge.fit_predict}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{fit\_predict}}}
{\sphinxparam{\DUrole{n}{X\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{X\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{best\_params\_str}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Trains a local stacking model with the best hyperparams for that grid cell, then predicts.

\end{fulllineitems}

\index{compute\_model() (wass2s.was\_machine\_learning.WAS\_Stacking\_Ridge method)@\spxentry{compute\_model()}\spxextra{wass2s.was\_machine\_learning.WAS\_Stacking\_Ridge method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_Stacking_Ridge.compute_model}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_model}}}
{\sphinxparam{\DUrole{n}{X\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{X\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{best\_param\_da}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Calls fit\_predict(…) in parallel across all grid cells.

\end{fulllineitems}

\index{compute\_prob() (wass2s.was\_machine\_learning.WAS\_Stacking\_Ridge method)@\spxentry{compute\_prob()}\spxextra{wass2s.was\_machine\_learning.WAS\_Stacking\_Ridge method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_Stacking_Ridge.compute_prob}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_prob}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Computes tercile probabilities using self.dist\_method.

\end{fulllineitems}

\index{forecast() (wass2s.was\_machine\_learning.WAS\_Stacking\_Ridge method)@\spxentry{forecast()}\spxextra{wass2s.was\_machine\_learning.WAS\_Stacking\_Ridge method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_Stacking_Ridge.forecast}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{forecast}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor\_for\_year}}\sphinxparamcomma \sphinxparam{\DUrole{n}{best\_param\_da}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Fits a forecast for a single future year (or time) and calculates tercile probabilities.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities() (wass2s.was\_machine\_learning.WAS\_Stacking\_Ridge static method)@\spxentry{calculate\_tercile\_probabilities()}\spxextra{wass2s.was\_machine\_learning.WAS\_Stacking\_Ridge static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_Stacking_Ridge.calculate_tercile_probabilities}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}}}
{}
\pysigstopsignatures
\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_gamma() (wass2s.was\_machine\_learning.WAS\_Stacking\_Ridge static method)@\spxentry{calculate\_tercile\_probabilities\_gamma()}\spxextra{wass2s.was\_machine\_learning.WAS\_Stacking\_Ridge static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_Stacking_Ridge.calculate_tercile_probabilities_gamma}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_gamma}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T2}}}
{}
\pysigstopsignatures
\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_lognormal() (wass2s.was\_machine\_learning.WAS\_Stacking\_Ridge static method)@\spxentry{calculate\_tercile\_probabilities\_lognormal()}\spxextra{wass2s.was\_machine\_learning.WAS\_Stacking\_Ridge static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_Stacking_Ridge.calculate_tercile_probabilities_lognormal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_lognormal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_nonparametric() (wass2s.was\_machine\_learning.WAS\_Stacking\_Ridge static method)@\spxentry{calculate\_tercile\_probabilities\_nonparametric()}\spxextra{wass2s.was\_machine\_learning.WAS\_Stacking\_Ridge static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_Stacking_Ridge.calculate_tercile_probabilities_nonparametric}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_nonparametric}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_samples}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Non\sphinxhyphen{}parametric method (requires historical errors).

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_normal() (wass2s.was\_machine\_learning.WAS\_Stacking\_Ridge static method)@\spxentry{calculate\_tercile\_probabilities\_normal()}\spxextra{wass2s.was\_machine\_learning.WAS\_Stacking\_Ridge static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_machine_learning.WAS_Stacking_Ridge.calculate_tercile_probabilities_normal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_normal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\end{fulllineitems}

\index{compute\_hyperparameters() (wass2s.was\_machine\_learning.WAS\_Stacking\_Ridge method)@\spxentry{compute\_hyperparameters()}\spxextra{wass2s.was\_machine\_learning.WAS\_Stacking\_Ridge method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:id25}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_hyperparameters}}}
{\sphinxparam{\DUrole{n}{predictand}}\sphinxparamcomma \sphinxparam{\DUrole{n}{predictor}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Runs KMeans clustering on the mean of \sphinxtitleref{predictand} (over time).
Then, for each cluster, runs a cross\sphinxhyphen{}validation GridSearch over a stacking model with:
\begin{itemize}
\item {} 
\sphinxAtStartPar
RF, XGB, MLP (as base estimators)

\item {} 
\sphinxAtStartPar
Ridge (as the meta\sphinxhyphen{}estimator).

\end{itemize}
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{predictand}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Target variable with dims (‘T’,’Y’,’X’).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{predictor}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Predictor variables with dims (‘T’,’features’).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{best\_param\_da} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} DataArray storing best hyperparams (as string) per grid cell.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{cluster\_da} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} Cluster assignment for each (Y,X).

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_model() (wass2s.was\_machine\_learning.WAS\_Stacking\_Ridge method)@\spxentry{compute\_model()}\spxextra{wass2s.was\_machine\_learning.WAS\_Stacking\_Ridge method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:id26}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_model}}}
{\sphinxparam{\DUrole{n}{X\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{X\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{best\_param\_da}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Parallel training + prediction across all spatial grid points.
Uses local best hyperparams from best\_param\_da for each pixel.

\sphinxAtStartPar
Returns an xarray.DataArray with dim (‘output’,’Y’,’X’) =\textgreater{} {[}error, prediction{]}.

\end{fulllineitems}

\index{compute\_prob() (wass2s.was\_machine\_learning.WAS\_Stacking\_Ridge method)@\spxentry{compute\_prob()}\spxextra{wass2s.was\_machine\_learning.WAS\_Stacking\_Ridge method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:id27}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_prob}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute tercile probabilities using self.dist\_method.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}\sphinxstyleliteralemphasis{\sphinxupquote{ (}}\sphinxstyleliteralemphasis{\sphinxupquote{T}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{Y}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{X}}\sphinxstyleliteralemphasis{\sphinxupquote{)}}) \textendash{} Observed data.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}})

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} The start and end years for the climatology.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Deterministic forecast with dims (output=2, T, Y, X).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{hindcast\_prob} \textendash{} dims (probability=3, T, Y, X) =\textgreater{} {[}PB, PN, PA{]}.

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{fit\_predict() (wass2s.was\_machine\_learning.WAS\_Stacking\_Ridge method)@\spxentry{fit\_predict()}\spxextra{wass2s.was\_machine\_learning.WAS\_Stacking\_Ridge method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:id28}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{fit\_predict}}}
{\sphinxparam{\DUrole{n}{X\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{X\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{best\_params\_str}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
For a single grid cell, parse the best params, instantiate the stacking regressor,
fit to local data, and predict.

\sphinxAtStartPar
Returns {[}error, prediction{]}.

\end{fulllineitems}

\index{forecast() (wass2s.was\_machine\_learning.WAS\_Stacking\_Ridge method)@\spxentry{forecast()}\spxextra{wass2s.was\_machine\_learning.WAS\_Stacking\_Ridge method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:id29}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{forecast}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor\_for\_year}}\sphinxparamcomma \sphinxparam{\DUrole{n}{best\_param\_da}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Forecast for a single future year (or time) and compute tercile probabilities.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Observed data with dims (T, Y, X), used for computing climatology thresholds.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Start of climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} End of climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictor}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Historical predictor data, shape (T, features).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Historical deterministic forecast with dims (output={[}error,prediction{]}, T, Y, X)
for computing error variance or samples.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictor\_for\_year}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Predictor data for the forecast year, shape (features,) or (1, features).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{best\_param\_da}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Local best hyperparams from compute\_hyperparameters, shape (Y, X).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{result\_} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} dims (output=2, Y, X) =\textgreater{} {[}error, prediction{]}.
In a real forecast, “error” is typically NaN since we have no future observation.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{hindcast\_prob} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} dims (probability=3, Y, X) =\textgreater{} {[}PB, PN, PA{]}.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\subsection{wass2s.was\_analog module}
\label{\detokenize{api:module-wass2s.was_analog}}\label{\detokenize{api:wass2s-was-analog-module}}\index{module@\spxentry{module}!wass2s.was\_analog@\spxentry{wass2s.was\_analog}}\index{wass2s.was\_analog@\spxentry{wass2s.was\_analog}!module@\spxentry{module}}\index{WAS\_Analog (class in wass2s.was\_analog)@\spxentry{WAS\_Analog}\spxextra{class in wass2s.was\_analog}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_analog.WAS_Analog}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_analog.}}\sphinxbfcode{\sphinxupquote{WAS\_Analog}}}
{\sphinxparam{\DUrole{n}{dir\_to\_save}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year\_forecast}}\sphinxparamcomma \sphinxparam{\DUrole{n}{reanalysis\_name}}\sphinxparamcomma \sphinxparam{\DUrole{n}{model\_name}}\sphinxparamcomma \sphinxparam{\DUrole{n}{method\_analog}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}som\textquotesingle{}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{best\_prcp\_models}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{month\_of\_initialization}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{lead\_time}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{ensemble\_mean}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}mean\textquotesingle{}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{define\_extent}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{index\_compute}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{some\_grid\_size}\DUrole{o}{=}\DUrole{default_value}{(None, None)}}\sphinxparamcomma \sphinxparam{\DUrole{n}{some\_learning\_rate}\DUrole{o}{=}\DUrole{default_value}{0.5}}\sphinxparamcomma \sphinxparam{\DUrole{n}{some\_neighborhood\_function}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}gaussian\textquotesingle{}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{some\_sigma}\DUrole{o}{=}\DUrole{default_value}{1.0}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dist\_method}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}gamma\textquotesingle{}}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
Analog\sphinxhyphen{}based forecasting toolkit for seasonal climate applications.

\sphinxAtStartPar
This class orchestrates the end\sphinxhyphen{}to\sphinxhyphen{}end workflow required to build
\sphinxstylestrong{analog ensembles} for Sea\sphinxhyphen{}Surface Temperature (SST) predictors and
to translate them into deterministic and probabilistic rainfall
forecasts over West Africa (or any user\sphinxhyphen{}defined domain).  Three
alternative analog\sphinxhyphen{}selection strategies are supported:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Self\sphinxhyphen{}Organising Maps} (\sphinxtitleref{method\_analog=”som”}, default)

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Correlation ranking} (\sphinxtitleref{“cor\_based”})

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Principal\sphinxhyphen{}Component (EOF) similarity} (\sphinxtitleref{“pca\_based”})

\end{itemize}

\sphinxAtStartPar
In addition, the class encapsulates data acquisition (reanalysis +
seasonal hindcasts), preprocessing, EOF/SOM training, tercile\sphinxhyphen{}based
probability generation with multiple distributional options
(Student\sphinxhyphen{}t, Gamma, Gaussian, Log\sphinxhyphen{}normal, non\sphinxhyphen{}parametric), and a set of
convenient visualisation helpers.


\subsubsection{Parameters:}
\label{\detokenize{api:parameters}}\begin{description}
\sphinxlineitem{dir\_to\_save}{[}str{]}
\sphinxAtStartPar
Directory path to save downloaded and processed data files.

\sphinxlineitem{year\_start}{[}int{]}
\sphinxAtStartPar
Starting year for historical data.

\sphinxlineitem{year\_forecast}{[}int{]}
\sphinxAtStartPar
Target forecast year.

\sphinxlineitem{reanalysis\_name}{[}str{]}
\sphinxAtStartPar
Name of the reanalysis dataset (e.g., “ERA5.SST” or “NOAA.SST”).

\sphinxlineitem{model\_name}{[}str{]}
\sphinxAtStartPar
Name of the forecast model (e.g., “ECMWF\_51.SST”).

\sphinxlineitem{method\_analog}{[}str, optional{]}
\sphinxAtStartPar
Analog method to use (“som”, “cor\_based”, or “pca\_based”). Default is “som”.

\sphinxlineitem{best\_prcp\_models}{[}list, optional{]}
\sphinxAtStartPar
List of best precipitation models to consider.

\sphinxlineitem{month\_of\_initialization}{[}int, optional{]}
\sphinxAtStartPar
Month of initialization for forecasts. If None, uses current month.

\sphinxlineitem{lead\_time}{[}list, optional{]}
\sphinxAtStartPar
List of lead times in months. If None, defaults to {[}1, 2, 3, 4, 5{]}.

\sphinxlineitem{ensemble\_mean}{[}str, optional{]}
\sphinxAtStartPar
Method for ensemble mean (“mean” or “median”). Default is “mean”.

\sphinxlineitem{clim\_year\_start}{[}int, optional{]}
\sphinxAtStartPar
Start year for climatology period.

\sphinxlineitem{clim\_year\_end}{[}int, optional{]}
\sphinxAtStartPar
End year for climatology period.

\sphinxlineitem{define\_extent}{[}tuple, optional{]}
\sphinxAtStartPar
Bounding box as (lon\_min, lon\_max, lat\_min, lat\_max) for regional analysis.

\sphinxlineitem{index\_compute}{[}list, optional{]}
\sphinxAtStartPar
List of climate indices to compute.

\sphinxlineitem{some\_grid\_size}{[}tuple, optional{]}
\sphinxAtStartPar
Grid size for SOM (rows, columns). Default is (None, None) which uses automatic sizing.

\sphinxlineitem{some\_learning\_rate}{[}float, optional{]}
\sphinxAtStartPar
Learning rate for SOM training. Default is 0.5.

\sphinxlineitem{some\_neighborhood\_function}{[}str, optional{]}
\sphinxAtStartPar
Neighborhood function for SOM (“gaussian”, “mexican\_hat”, etc.). Default is “gaussian”.

\sphinxlineitem{some\_sigma}{[}float, optional{]}
\sphinxAtStartPar
Initial neighborhood radius for SOM. Default is 1.0.

\sphinxlineitem{dist\_method}{[}str, optional{]}
\sphinxAtStartPar
Method for probability calculation (“gamma”, “t”, “normal”, “lognormal”, “nonparam”).
Default is “gamma”.

\end{description}


\subsubsection{Methods:}
\label{\detokenize{api:id30}}\begin{description}
\sphinxlineitem{download\_sst\_reanalysis():}
\sphinxAtStartPar
Downloads sea surface temperature reanalysis data.

\sphinxlineitem{download\_models():}
\sphinxAtStartPar
Downloads seasonal forecast model data.

\sphinxlineitem{standardize\_timeseries():}
\sphinxAtStartPar
Standardizes time series data.

\sphinxlineitem{calc\_index():}
\sphinxAtStartPar
Calculates climate indices from SST data.

\sphinxlineitem{compute\_model():}
\sphinxAtStartPar
Computes analog forecasts.

\sphinxlineitem{compute\_prob():}
\sphinxAtStartPar
Computes tercile probabilities from forecasts.

\sphinxlineitem{forecast():}
\sphinxAtStartPar
Generates forecasts for a target year.

\sphinxlineitem{composite\_plot():}
\sphinxAtStartPar
Creates composite plots of forecast results.

\end{description}
\index{Corr\_Based() (wass2s.was\_analog.WAS\_Analog method)@\spxentry{Corr\_Based()}\spxextra{wass2s.was\_analog.WAS\_Analog method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_analog.WAS_Analog.Corr_Based}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{Corr\_Based}}}
{\sphinxparam{\DUrole{n}{predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{ddd}}\sphinxparamcomma \sphinxparam{\DUrole{n}{itrain}}\sphinxparamcomma \sphinxparam{\DUrole{n}{ireference\_year}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Identify similar years using correlation\sphinxhyphen{}based analog method.

\sphinxAtStartPar
Finds years with high spatial correlation to the reference year’s SST data.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Observed predictand data with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{ddd}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} SST predictor data with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{itrain}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}) \textendash{} Indices of training years.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{ireference\_year}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}) \textendash{} Indices of the reference year.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{similar\_years} \textendash{} Array of years similar to the reference year.

\sphinxlineitem{Return type}
\sphinxAtStartPar
np.ndarray

\end{description}\end{quote}

\end{fulllineitems}

\index{Pca\_Based() (wass2s.was\_analog.WAS\_Analog method)@\spxentry{Pca\_Based()}\spxextra{wass2s.was\_analog.WAS\_Analog method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_analog.WAS_Analog.Pca_Based}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{Pca\_Based}}}
{\sphinxparam{\DUrole{n}{predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{ddd}}\sphinxparamcomma \sphinxparam{\DUrole{n}{itrain}}\sphinxparamcomma \sphinxparam{\DUrole{n}{ireference\_year}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Identify similar years using PCA\sphinxhyphen{}based analog method.

\sphinxAtStartPar
Uses EOF analysis to compute principal components and finds years with similar scores to the reference year.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Observed predictand data with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{ddd}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} SST predictor data with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{itrain}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}) \textendash{} Indices of training years.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{ireference\_year}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}) \textendash{} Indices of the reference year.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{similar\_years} \textendash{} Array of years similar to the reference year.

\sphinxlineitem{Return type}
\sphinxAtStartPar
np.ndarray

\end{description}\end{quote}

\end{fulllineitems}

\index{SOM() (wass2s.was\_analog.WAS\_Analog method)@\spxentry{SOM()}\spxextra{wass2s.was\_analog.WAS\_Analog method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_analog.WAS_Analog.SOM}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{SOM}}}
{\sphinxparam{\DUrole{n}{predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{ddd}}\sphinxparamcomma \sphinxparam{\DUrole{n}{itrain}}\sphinxparamcomma \sphinxparam{\DUrole{n}{ireference\_year}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Identify similar years using Self\sphinxhyphen{}Organizing Maps (SOM).

\sphinxAtStartPar
Trains a SOM on SST data or climate indices and finds years mapped to the same Best Matching Unit (BMU) as the reference year.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Observed predictand data with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{ddd}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} SST predictor data with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{itrain}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}) \textendash{} Indices of training years.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{ireference\_year}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}) \textendash{} Indices of the reference year.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{similar\_years} \textendash{} Array of years similar to the reference year.

\sphinxlineitem{Return type}
\sphinxAtStartPar
np.ndarray

\end{description}\end{quote}

\end{fulllineitems}

\index{calc\_index() (wass2s.was\_analog.WAS\_Analog method)@\spxentry{calc\_index()}\spxextra{wass2s.was\_analog.WAS\_Analog method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_analog.WAS_Analog.calc_index}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{calc\_index}}}
{\sphinxparam{\DUrole{n}{indices}}\sphinxparamcomma \sphinxparam{\DUrole{n}{sst}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Calculate climate indices from SST data.

\sphinxAtStartPar
Computes specified climate indices (e.g., NINO34, DMI) from SST data by averaging over predefined regions
or computing differences for derived indices.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{indices}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}) \textendash{} List of climate indices to compute (e.g., {[}‘NINO34’, ‘DMI’{]}).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{sst}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} SST data with dimensions (T, Y, X).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{indices\_dataset} \textendash{} Dataset containing computed climate indices as variables.

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.Dataset

\end{description}\end{quote}

\end{fulllineitems}

\index{calculate\_tercile\_probabilities() (wass2s.was\_analog.WAS\_Analog static method)@\spxentry{calculate\_tercile\_probabilities()}\spxextra{wass2s.was\_analog.WAS\_Analog static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_analog.WAS_Analog.calculate_tercile_probabilities}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Student’s t\sphinxhyphen{}based method

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_gamma() (wass2s.was\_analog.WAS\_Analog static method)@\spxentry{calculate\_tercile\_probabilities\_gamma()}\spxextra{wass2s.was\_analog.WAS\_Analog static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_analog.WAS_Analog.calculate_tercile_probabilities_gamma}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_gamma}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T2}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Gamma\sphinxhyphen{}based method

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_lognormal() (wass2s.was\_analog.WAS\_Analog static method)@\spxentry{calculate\_tercile\_probabilities\_lognormal()}\spxextra{wass2s.was\_analog.WAS\_Analog static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_analog.WAS_Analog.calculate_tercile_probabilities_lognormal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_lognormal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Lognormal\sphinxhyphen{}based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_nonparametric() (wass2s.was\_analog.WAS\_Analog static method)@\spxentry{calculate\_tercile\_probabilities\_nonparametric()}\spxextra{wass2s.was\_analog.WAS\_Analog static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_analog.WAS_Analog.calculate_tercile_probabilities_nonparametric}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_nonparametric}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_samples}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Non\sphinxhyphen{}parametric method (require historical errors)

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_normal() (wass2s.was\_analog.WAS\_Analog static method)@\spxentry{calculate\_tercile\_probabilities\_normal()}\spxextra{wass2s.was\_analog.WAS\_Analog static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_analog.WAS_Analog.calculate_tercile_probabilities_normal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_normal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Normal\sphinxhyphen{}based method using the Gaussian CDF.

\end{fulllineitems}

\index{composite\_plot() (wass2s.was\_analog.WAS\_Analog method)@\spxentry{composite\_plot()}\spxextra{wass2s.was\_analog.WAS\_Analog method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_analog.WAS_Analog.composite_plot}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{composite\_plot}}}
{\sphinxparam{\DUrole{n}{predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}\sphinxparamcomma \sphinxparam{\DUrole{n}{plot\_predictor}\DUrole{o}{=}\DUrole{default_value}{True}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Create composite plots of predictors or predictands.

\sphinxAtStartPar
Plots SST composites for the forecast year and similar years, or precipitation ratios relative to climatology.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Observed predictand data with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} Start year for climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} End year for climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Deterministic hindcast data with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{plot\_predictor}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} If True, plot SST predictors; otherwise, plot precipitation ratios. Default is True.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{similar\_years} \textendash{} Array of similar years used in the composite.

\sphinxlineitem{Return type}
\sphinxAtStartPar
np.ndarray

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_model() (wass2s.was\_analog.WAS\_Analog method)@\spxentry{compute\_model()}\spxextra{wass2s.was\_analog.WAS\_Analog method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_analog.WAS_Analog.compute_model}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_model}}}
{\sphinxparam{\DUrole{n}{predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{ddd}}\sphinxparamcomma \sphinxparam{\DUrole{n}{itrain}}\sphinxparamcomma \sphinxparam{\DUrole{n}{itest}}}
{}
\pysigstopsignatures
\end{fulllineitems}

\index{compute\_prob() (wass2s.was\_analog.WAS\_Analog method)@\spxentry{compute\_prob()}\spxextra{wass2s.was\_analog.WAS\_Analog method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_analog.WAS_Analog.compute_prob}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_prob}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute tercile probabilities using either ‘t’, ‘gamma’, ‘normal’, ‘lognormal’, or ‘nonparam’.


\paragraph{Parameters:}
\label{\detokenize{api:id31}}\begin{description}
\sphinxlineitem{Predictant}{[}xarray.DataArray{]}
\sphinxAtStartPar
Observed data array with dimensions (T, Y, X)

\sphinxlineitem{clim\_year\_start}{[}int{]}
\sphinxAtStartPar
Start year for climatology

\sphinxlineitem{clim\_year\_end}{[}int{]}
\sphinxAtStartPar
End year for climatology

\sphinxlineitem{hindcast\_det}{[}xarray.DataArray{]}
\sphinxAtStartPar
Deterministic forecast (same shape as Predictant, minus M dimension)

\sphinxlineitem{method}{[}str, default = “gamma”{]}
\sphinxAtStartPar
Method to use for calculating tercile probabilities:
\sphinxhyphen{} “t”
\sphinxhyphen{} “gamma”
\sphinxhyphen{} “normal”
\sphinxhyphen{} “lognormal”
\sphinxhyphen{} “nonparam”

\sphinxlineitem{error\_samples}{[}xarray.DataArray or None{]}
\sphinxAtStartPar
Only required for non\sphinxhyphen{}parametric method, shape (ensemble, T, Y, X) or something similar.

\end{description}


\paragraph{Returns:}
\label{\detokenize{api:returns}}\begin{description}
\sphinxlineitem{hindcast\_prob}{[}xarray.DataArray{]}
\sphinxAtStartPar
Probability for each tercile category (PB, PN, PA)
with dimensions (probability=3, T, Y, X).

\end{description}

\end{fulllineitems}

\index{download\_and\_process() (wass2s.was\_analog.WAS\_Analog method)@\spxentry{download\_and\_process()}\spxextra{wass2s.was\_analog.WAS\_Analog method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_analog.WAS_Analog.download_and_process}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{download\_and\_process}}}
{\sphinxparam{\DUrole{n}{center\_variable}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Download and process SST data for reanalysis and forecast.

\sphinxAtStartPar
Combines reanalysis and forecast SST data, standardizes, and applies a rolling mean.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{center\_variable}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Center\sphinxhyphen{}variable identifier (e.g., ‘ECMWF\_51.SST’). Default is None (uses class attributes).

\sphinxlineitem{Returns}
\sphinxAtStartPar
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{concatenated\_ds\_st} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} Standardized and processed SST data.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{ds\_shifted} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} Time\sphinxhyphen{}shifted version of the processed SST data.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{download\_models() (wass2s.was\_analog.WAS\_Analog method)@\spxentry{download\_models()}\spxextra{wass2s.was\_analog.WAS\_Analog method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_analog.WAS_Analog.download_models}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{download\_models}}}
{\sphinxparam{\DUrole{n}{area}\DUrole{o}{=}\DUrole{default_value}{{[}60, \sphinxhyphen{}180, \sphinxhyphen{}60, 180{]}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{force\_download}\DUrole{o}{=}\DUrole{default_value}{False}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Download SST seasonal forecast data.

\sphinxAtStartPar
Downloads forecast data for specified models, initialization month, lead times, and spatial area.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{area}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Bounding box as {[}North, West, South, East{]}. Default is {[}60, \sphinxhyphen{}180, \sphinxhyphen{}60, 180{]}.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{force\_download}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} If True, forces re\sphinxhyphen{}download even if file exists. Default is False.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{ds\_centers} \textendash{} Combined forecast dataset across models.

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.Dataset

\end{description}\end{quote}

\end{fulllineitems}

\index{download\_sst\_reanalysis() (wass2s.was\_analog.WAS\_Analog method)@\spxentry{download\_sst\_reanalysis()}\spxextra{wass2s.was\_analog.WAS\_Analog method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_analog.WAS_Analog.download_sst_reanalysis}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{download\_sst\_reanalysis}}}
{\sphinxparam{\DUrole{n}{area}\DUrole{o}{=}\DUrole{default_value}{{[}60, \sphinxhyphen{}180, \sphinxhyphen{}60, 180{]}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{force\_download}\DUrole{o}{=}\DUrole{default_value}{False}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Download Sea Surface Temperature (SST) reanalysis data.

\sphinxAtStartPar
Downloads SST data from the specified reanalysis dataset for the given years and spatial area,
handling both NOAA ERSST and ERA5 datasets.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{area}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Bounding box as {[}North, West, South, East{]}. Default is {[}60, \sphinxhyphen{}180, \sphinxhyphen{}60, 180{]}.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{force\_download}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} If True, forces re\sphinxhyphen{}download even if file exists. Default is False.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{combined\_ds} \textendash{} Combined SST dataset for the specified years.

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.Dataset

\end{description}\end{quote}

\end{fulllineitems}

\index{forecast() (wass2s.was\_analog.WAS\_Analog method)@\spxentry{forecast()}\spxextra{wass2s.was\_analog.WAS\_Analog method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_analog.WAS_Analog.forecast}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{forecast}}}
{\sphinxparam{\DUrole{n}{predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}\sphinxparamcomma \sphinxparam{\DUrole{n}{forecast\_year}}}
{}
\pysigstopsignatures
\end{fulllineitems}

\index{plot\_indices() (wass2s.was\_analog.WAS\_Analog method)@\spxentry{plot\_indices()}\spxextra{wass2s.was\_analog.WAS\_Analog method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_analog.WAS_Analog.plot_indices}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{plot\_indices}}}
{}
{}
\pysigstopsignatures
\end{fulllineitems}

\index{standardize\_timeseries() (wass2s.was\_analog.WAS\_Analog method)@\spxentry{standardize\_timeseries()}\spxextra{wass2s.was\_analog.WAS\_Analog method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_analog.WAS_Analog.standardize_timeseries}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{standardize\_timeseries}}}
{\sphinxparam{\DUrole{n}{ds}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Standardize the dataset over a specified climatology period.

\end{fulllineitems}


\end{fulllineitems}



\subsection{wass2s.was\_verification module}
\label{\detokenize{api:module-wass2s.was_verification}}\label{\detokenize{api:wass2s-was-verification-module}}\index{module@\spxentry{module}!wass2s.was\_verification@\spxentry{wass2s.was\_verification}}\index{wass2s.was\_verification@\spxentry{wass2s.was\_verification}!module@\spxentry{module}}\index{WAS\_Verification (class in wass2s.was\_verification)@\spxentry{WAS\_Verification}\spxextra{class in wass2s.was\_verification}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_verification.WAS_Verification}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_verification.}}\sphinxbfcode{\sphinxupquote{WAS\_Verification}}}
{\sphinxparam{\DUrole{n}{dist\_method}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}gamma\textquotesingle{}}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
Verification class for evaluating weather and climate forecasts.

\sphinxAtStartPar
Provides methods to compute deterministic, probabilistic, and ensemble\sphinxhyphen{}based metrics,
as well as visualization tools for model performance assessment.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dist\_method}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Distribution method for tercile probability calculations
(‘t’, ‘gamma’, ‘nonparam’, ‘normal’, ‘lognormal’, ‘weibull\_min’). Default is ‘gamma’.

\end{description}\end{quote}
\index{calculate\_groc() (wass2s.was\_verification.WAS\_Verification method)@\spxentry{calculate\_groc()}\spxextra{wass2s.was\_verification.WAS\_Verification method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_verification.WAS_Verification.calculate_groc}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{calculate\_groc}}}
{\sphinxparam{\DUrole{n}{y\_true}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_probs}}\sphinxparamcomma \sphinxparam{\DUrole{n}{index\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{index\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{n\_classes}\DUrole{o}{=}\DUrole{default_value}{3}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute Generalized Receiver Operating Characteristic (GROC) score.

\sphinxAtStartPar
Averages the Area Under the Curve (AUC) for each tercile category.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_true}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Observed values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_probs}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Forecast probabilities with shape (n\_classes, n\_samples).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{index\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Start index of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{index\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} End index of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{n\_classes}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Number of classes (default is 3 for terciles).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
GROC score, ranging from 0 to 1. Returns np.nan if insufficient valid data.

\sphinxlineitem{Return type}
\sphinxAtStartPar
float

\end{description}\end{quote}

\end{fulllineitems}

\index{calculate\_rpss() (wass2s.was\_verification.WAS\_Verification method)@\spxentry{calculate\_rpss()}\spxextra{wass2s.was\_verification.WAS\_Verification method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_verification.WAS_Verification.calculate_rpss}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{calculate\_rpss}}}
{\sphinxparam{\DUrole{n}{y\_true}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_probs}}\sphinxparamcomma \sphinxparam{\DUrole{n}{index\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{index\_end}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute Ranked Probability Skill Score (RPSS).

\sphinxAtStartPar
Compares the Ranked Probability Score (RPS) of the forecast to a climatological reference.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_true}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Observed values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_probs}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Forecast probabilities with shape (n\_classes, n\_samples).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{index\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Start index of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{index\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} End index of the climatology period.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
RPSS score, ranging from \sphinxhyphen{}Inf to 1. Returns np.nan if insufficient valid data.

\sphinxlineitem{Return type}
\sphinxAtStartPar
float

\end{description}\end{quote}

\end{fulllineitems}

\index{calculate\_rpss\_() (wass2s.was\_verification.WAS\_Verification method)@\spxentry{calculate\_rpss\_()}\spxextra{wass2s.was\_verification.WAS\_Verification method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_verification.WAS_Verification.calculate_rpss_}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{calculate\_rpss\_}}}
{\sphinxparam{\DUrole{n}{y\_true}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_probs}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute Ranked Probability Skill Score (RPSS) for a single grid point or sample.

\sphinxAtStartPar
Compares the Ranked Probability Score (RPS) of the forecast to a climatological
reference with uniform probabilities (1/3 for each tercile).
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_true}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}\sphinxstyleliteralemphasis{\sphinxupquote{ of }}\sphinxstyleliteralemphasis{\sphinxupquote{shape}}\sphinxstyleliteralemphasis{\sphinxupquote{ (}}\sphinxstyleliteralemphasis{\sphinxupquote{n\_samples}}\sphinxstyleliteralemphasis{\sphinxupquote{,}}\sphinxstyleliteralemphasis{\sphinxupquote{)}}) \textendash{} True class labels, already classified into terciles (0: below\sphinxhyphen{}normal, 1: near\sphinxhyphen{}normal, 2: above\sphinxhyphen{}normal).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_probs}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}\sphinxstyleliteralemphasis{\sphinxupquote{ of }}\sphinxstyleliteralemphasis{\sphinxupquote{shape}}\sphinxstyleliteralemphasis{\sphinxupquote{ (}}\sphinxstyleliteralemphasis{\sphinxupquote{3}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{n\_samples}}\sphinxstyleliteralemphasis{\sphinxupquote{)}}) \textendash{} Forecast probabilities for each tercile category.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
RPSS score, ranging from \sphinxhyphen{}Inf to 1 (1 indicates perfect forecast skill).
Returns np.nan if insufficient valid data.

\sphinxlineitem{Return type}
\sphinxAtStartPar
float

\end{description}\end{quote}

\end{fulllineitems}

\index{calculate\_tercile\_probabilities() (wass2s.was\_verification.WAS\_Verification static method)@\spxentry{calculate\_tercile\_probabilities()}\spxextra{wass2s.was\_verification.WAS\_Verification static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_verification.WAS_Verification.calculate_tercile_probabilities}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Calculate tercile probabilities using Student’s t\sphinxhyphen{}distribution.

\sphinxAtStartPar
Computes probabilities for below\sphinxhyphen{}normal, normal, and above\sphinxhyphen{}normal categories.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{best\_guess}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Forecast or best\sphinxhyphen{}guess values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{error\_variance}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Variance of forecast errors.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{first\_tercile}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} First tercile threshold values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{second\_tercile}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Second tercile threshold values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dof}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Degrees of freedom for the t\sphinxhyphen{}distribution.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{pred\_prob} \textendash{} Array of shape (3, n\_time) with probabilities for below, normal, and above categories.

\sphinxlineitem{Return type}
\sphinxAtStartPar
np.ndarray

\end{description}\end{quote}

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_gamma() (wass2s.was\_verification.WAS\_Verification static method)@\spxentry{calculate\_tercile\_probabilities\_gamma()}\spxextra{wass2s.was\_verification.WAS\_Verification static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_verification.WAS_Verification.calculate_tercile_probabilities_gamma}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_gamma}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T2}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Calculate tercile probabilities using Gamma distribution.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{best\_guess}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Forecast or best\sphinxhyphen{}guess values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{error\_variance}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Variance of forecast errors.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{T1}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} First tercile threshold values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{T2}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Second tercile threshold values.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{pred\_prob} \textendash{} Array of shape (3, n\_time) with probabilities for below, normal, and above categories.

\sphinxlineitem{Return type}
\sphinxAtStartPar
np.ndarray

\end{description}\end{quote}

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_lognormal() (wass2s.was\_verification.WAS\_Verification static method)@\spxentry{calculate\_tercile\_probabilities\_lognormal()}\spxextra{wass2s.was\_verification.WAS\_Verification static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_verification.WAS_Verification.calculate_tercile_probabilities_lognormal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_lognormal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Calculate tercile probabilities using Lognormal distribution.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{best\_guess}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Forecast or best\sphinxhyphen{}guess values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{error\_variance}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Variance of forecast errors.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{first\_tercile}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} First tercile threshold values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{second\_tercile}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Second tercile threshold values.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{pred\_prob} \textendash{} Array of shape (3, n\_time) with probabilities for below, normal, and above categories.

\sphinxlineitem{Return type}
\sphinxAtStartPar
np.ndarray

\end{description}\end{quote}

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_nonparametric() (wass2s.was\_verification.WAS\_Verification static method)@\spxentry{calculate\_tercile\_probabilities\_nonparametric()}\spxextra{wass2s.was\_verification.WAS\_Verification static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_verification.WAS_Verification.calculate_tercile_probabilities_nonparametric}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_nonparametric}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_samples}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Calculate tercile probabilities using a non\sphinxhyphen{}parametric method.

\sphinxAtStartPar
Uses historical error samples to estimate probabilities empirically.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{best\_guess}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Forecast or best\sphinxhyphen{}guess values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{error\_samples}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Historical error samples.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{first\_tercile}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} First tercile threshold values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{second\_tercile}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Second tercile threshold values.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{pred\_prob} \textendash{} Array of shape (3, n\_time) with probabilities for below, normal, and above categories.

\sphinxlineitem{Return type}
\sphinxAtStartPar
np.ndarray

\end{description}\end{quote}

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_normal() (wass2s.was\_verification.WAS\_Verification static method)@\spxentry{calculate\_tercile\_probabilities\_normal()}\spxextra{wass2s.was\_verification.WAS\_Verification static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_verification.WAS_Verification.calculate_tercile_probabilities_normal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_normal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Calculate tercile probabilities using Normal distribution.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{best\_guess}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Forecast or best\sphinxhyphen{}guess values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{error\_variance}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Variance of forecast errors.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{first\_tercile}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} First tercile threshold values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{second\_tercile}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Second tercile threshold values.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{pred\_prob} \textendash{} Array of shape (3, n\_time) with probabilities for below, normal, and above categories.

\sphinxlineitem{Return type}
\sphinxAtStartPar
np.ndarray

\end{description}\end{quote}

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_weibull\_min() (wass2s.was\_verification.WAS\_Verification static method)@\spxentry{calculate\_tercile\_probabilities\_weibull\_min()}\spxextra{wass2s.was\_verification.WAS\_Verification static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_verification.WAS_Verification.calculate_tercile_probabilities_weibull_min}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_weibull\_min}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Calculate tercile probabilities using Weibull minimum distribution.

\sphinxAtStartPar
Assumes \sphinxtitleref{best\_guess} as the location, \sphinxtitleref{error\_std} as the scale, and \sphinxtitleref{dof} as the shape parameter.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{best\_guess}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Forecast or best\sphinxhyphen{}guess values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{error\_variance}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Variance of forecast errors.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{first\_tercile}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} First tercile threshold values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{second\_tercile}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Second tercile threshold values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dof}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Shape parameter for the Weibull minimum distribution.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{pred\_prob} \textendash{} Array of shape (3, n\_time) with probabilities for below, normal, and above categories.

\sphinxlineitem{Return type}
\sphinxAtStartPar
np.ndarray

\end{description}\end{quote}

\end{fulllineitems}

\index{classify() (wass2s.was\_verification.WAS\_Verification method)@\spxentry{classify()}\spxextra{wass2s.was\_verification.WAS\_Verification method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_verification.WAS_Verification.classify}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{classify}}}
{\sphinxparam{\DUrole{n}{y}}\sphinxparamcomma \sphinxparam{\DUrole{n}{index\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{index\_end}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Classify data into terciles based on climatological thresholds.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Input data to classify.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{index\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Start index of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{index\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} End index of the climatology period.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\begin{itemize}
\item {} \begin{description}
\sphinxlineitem{y\_class}{[}array\sphinxhyphen{}like{]}
\sphinxAtStartPar
Classified data (0: below\sphinxhyphen{}normal, 1: near\sphinxhyphen{}normal, 2: above\sphinxhyphen{}normal).

\end{description}

\item {} \begin{description}
\sphinxlineitem{tercile\_33}{[}float{]}
\sphinxAtStartPar
33rd percentile threshold.

\end{description}

\item {} \begin{description}
\sphinxlineitem{tercile\_67}{[}float{]}
\sphinxAtStartPar
67th percentile threshold.

\end{description}

\end{itemize}


\sphinxlineitem{Return type}
\sphinxAtStartPar
tuple

\end{description}\end{quote}

\end{fulllineitems}

\index{classify\_data\_into\_terciles() (wass2s.was\_verification.WAS\_Verification method)@\spxentry{classify\_data\_into\_terciles()}\spxextra{wass2s.was\_verification.WAS\_Verification method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_verification.WAS_Verification.classify_data_into_terciles}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{classify\_data\_into\_terciles}}}
{\sphinxparam{\DUrole{n}{y}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T2}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Classify data into terciles based on given thresholds.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Input data to classify.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{T1}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} First tercile threshold (33rd percentile).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{T2}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} Second tercile threshold (67th percentile).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
Classified data (0: below\sphinxhyphen{}normal, 1: near\sphinxhyphen{}normal, 2: above\sphinxhyphen{}normal).

\sphinxlineitem{Return type}
\sphinxAtStartPar
array\sphinxhyphen{}like

\end{description}\end{quote}

\end{fulllineitems}

\index{classify\_percent() (wass2s.was\_verification.WAS\_Verification static method)@\spxentry{classify\_percent()}\spxextra{wass2s.was\_verification.WAS\_Verification static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_verification.WAS_Verification.classify_percent}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{classify\_percent}}}
{\sphinxparam{\DUrole{n}{p}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Classify a percentage value into predefined categories based on thresholds.

\sphinxAtStartPar
Maps a percentage ratio to one of five categories representing deviation from average.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{p}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Percentage value(s) to classify, typically representing a ratio to normal (\%).

\sphinxlineitem{Returns}
\sphinxAtStartPar
Category code:
\sphinxhyphen{} 1: Well Above Average (\textgreater{}= 150\%)
\sphinxhyphen{} 2: Above Average (\textgreater{}= 110\%)
\sphinxhyphen{} 3: Near Average (\textgreater{}= 90\%)
\sphinxhyphen{} 4: Below Average (\textgreater{}= 50\%)
\sphinxhyphen{} 5: Well Below Average (\textless{} 50\%)

\sphinxlineitem{Return type}
\sphinxAtStartPar
int or array\sphinxhyphen{}like

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_class() (wass2s.was\_verification.WAS\_Verification method)@\spxentry{compute\_class()}\spxextra{wass2s.was\_verification.WAS\_Verification method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_verification.WAS_Verification.compute_class}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_class}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute tercile class labels for observed data.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Observed data with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} Start year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} End year of the climatology period.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
Classified data with dimensions (T, Y, X), where values are
0 (below\sphinxhyphen{}normal), 1 (near\sphinxhyphen{}normal), or 2 (above\sphinxhyphen{}normal).

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_crps() (wass2s.was\_verification.WAS\_Verification method)@\spxentry{compute\_crps()}\spxextra{wass2s.was\_verification.WAS\_Verification method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_verification.WAS_Verification.compute_crps}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_crps}}}
{\sphinxparam{\DUrole{n}{y\_true}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_pred}}\sphinxparamcomma \sphinxparam{\DUrole{n}{member\_dim}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}number\textquotesingle{}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dim}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}T\textquotesingle{}}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute Continuous Ranked Probability Score (CRPS) for ensemble forecasts.

\sphinxAtStartPar
Measures the difference between the forecast ensemble distribution and observations.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_true}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Observed data with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_pred}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Ensemble forecast data with dimensions (T, number, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{member\_dim}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Dimension name for ensemble members. Default is ‘number’.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dim}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Dimension to compute CRPS over (typically time). Default is ‘T’.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
CRPS values with dimensions (Y, X).

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_deterministic\_score() (wass2s.was\_verification.WAS\_Verification method)@\spxentry{compute\_deterministic\_score()}\spxextra{wass2s.was\_verification.WAS\_Verification method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_verification.WAS_Verification.compute_deterministic_score}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_deterministic\_score}}}
{\sphinxparam{\DUrole{n}{score\_func}}\sphinxparamcomma \sphinxparam{\DUrole{n}{obs}}\sphinxparamcomma \sphinxparam{\DUrole{n}{pred}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Apply a deterministic scoring function over xarray DataArrays.

\sphinxAtStartPar
Computes the specified metric across the time dimension for each grid point.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{score\_func}} (\sphinxstyleliteralemphasis{\sphinxupquote{callable}}) \textendash{} Scoring function to apply (e.g., pearson\_corr, kling\_gupta\_efficiency).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{obs}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Observed data with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{pred}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Predicted data with dimensions (T, Y, X).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
Score values with dimensions (Y, X).

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_one\_year\_rpss() (wass2s.was\_verification.WAS\_Verification method)@\spxentry{compute\_one\_year\_rpss()}\spxextra{wass2s.was\_verification.WAS\_Verification method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_verification.WAS_Verification.compute_one_year_rpss}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_one\_year\_rpss}}}
{\sphinxparam{\DUrole{n}{obs}}\sphinxparamcomma \sphinxparam{\DUrole{n}{prob\_pred}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute and visualize the Ranked Probability Skill Score (RPSS) for a specific year.

\sphinxAtStartPar
Applies the RPSS calculation across a gridded dataset for a single year, using
tercile classifications based on a climatology period, and plots the results on a map.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{obs}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Observed data with dimensions (T, Y, X), where T is time, Y is latitude, and X is longitude.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{prob\_pred}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Forecast probabilities with dimensions (probability, T, Y, X), where probability includes
{[}‘PB’, ‘PN’, ‘PA’{]} (below\sphinxhyphen{}normal, near\sphinxhyphen{}normal, above\sphinxhyphen{}normal).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} Start year of the climatology period for tercile classification.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} End year of the climatology period for tercile classification.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{year}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} Specific year to compute the RPSS for.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
Displays a geographical plot of the RPSS values with a colorbar.

\sphinxlineitem{Return type}
\sphinxAtStartPar
None

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_probabilistic\_score() (wass2s.was\_verification.WAS\_Verification method)@\spxentry{compute\_probabilistic\_score()}\spxextra{wass2s.was\_verification.WAS\_Verification method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_verification.WAS_Verification.compute_probabilistic_score}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_probabilistic\_score}}}
{\sphinxparam{\DUrole{n}{score\_func}}\sphinxparamcomma \sphinxparam{\DUrole{n}{obs}}\sphinxparamcomma \sphinxparam{\DUrole{n}{prob\_pred}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Apply a probabilistic scoring function over xarray DataArrays.

\sphinxAtStartPar
Computes the specified probabilistic metric across the time dimension for each grid point.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{score\_func}} (\sphinxstyleliteralemphasis{\sphinxupquote{callable}}) \textendash{} Probabilistic scoring function to apply (e.g., calculate\_rpss, calculate\_groc).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{obs}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Observed data with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{prob\_pred}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Forecast probabilities with dimensions (probability, T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} Start year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} End year of the climatology period.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
Score values with dimensions (Y, X).

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{gcm\_compute\_prob() (wass2s.was\_verification.WAS\_Verification method)@\spxentry{gcm\_compute\_prob()}\spxextra{wass2s.was\_verification.WAS\_Verification method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_verification.WAS_Verification.gcm_compute_prob}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{gcm\_compute\_prob}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute tercile probabilities for GCM hindcasts.

\sphinxAtStartPar
Supports multiple distribution methods for calculating probabilities.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Observed data with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} Start year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} End year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Deterministic hindcast data with dimensions (T, Y, X).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
Tercile probabilities with dimensions (probability, T, Y, X), where
‘probability’ includes {[}‘PB’, ‘PN’, ‘PA’{]} (below\sphinxhyphen{}normal, normal, above\sphinxhyphen{}normal).

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{gcm\_compute\_prob\_ensemble\_method() (wass2s.was\_verification.WAS\_Verification method)@\spxentry{gcm\_compute\_prob\_ensemble\_method()}\spxextra{wass2s.was\_verification.WAS\_Verification method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_verification.WAS_Verification.gcm_compute_prob_ensemble_method}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{gcm\_compute\_prob\_ensemble\_method}}}
{\sphinxparam{\DUrole{n}{Obs\_data}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{model\_data}}\sphinxparamcomma \sphinxparam{\DUrole{n}{ensemble}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}mean\textquotesingle{}}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute probabilistic forecasts for GCM ensemble data.

\sphinxAtStartPar
Uses the specified ensemble statistic to derive best\sphinxhyphen{}guess forecasts and computes
tercile probabilities.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Obs\_data}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Observed data with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} Start year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} End year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{model\_data}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Model ensemble data with dimensions (T, number, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{ensemble}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Ensemble statistic to use (‘mean’ or other supported methods). Default is ‘mean’.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
Tercile probabilities with dimensions (probability, T, Y, X).

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{gcm\_validation\_compute() (wass2s.was\_verification.WAS\_Verification method)@\spxentry{gcm\_validation\_compute()}\spxextra{wass2s.was\_verification.WAS\_Verification method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_verification.WAS_Verification.gcm_validation_compute}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{gcm\_validation\_compute}}}
{\sphinxparam{\DUrole{n}{models\_files\_path}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Obs}}\sphinxparamcomma \sphinxparam{\DUrole{n}{score}}\sphinxparamcomma \sphinxparam{\DUrole{n}{month\_of\_initialization}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dir\_to\_save\_roc\_reliability}}\sphinxparamcomma \sphinxparam{\DUrole{n}{lead\_time}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{ensemble\_mean}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{gridded}\DUrole{o}{=}\DUrole{default_value}{True}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Validate multiple General Circulation Model (GCM) forecasts using specified metrics.

\sphinxAtStartPar
Computes deterministic, probabilistic, or ensemble\sphinxhyphen{}based scores for GCM hindcasts
by processing model data from provided file paths and comparing against observations.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{models\_files\_path}} (\sphinxstyleliteralemphasis{\sphinxupquote{dict}}) \textendash{} Dictionary mapping model identifiers (e.g., model names) to file paths of hindcast NetCDF files.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Obs}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Observed data with dimensions (T, Y, X), where T is time, Y is latitude, and X is longitude.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{score}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} Score to compute, must be a key in self.scores (e.g., ‘Pearson’, ‘RPSS’, ‘ROC\_CURVE’, ‘RELIABILITY\_DIAGRAM’).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{month\_of\_initialization}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Month of forecast initialization (1\sphinxhyphen{}12).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} Start year of the climatology period for computing tercile thresholds.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} End year of the climatology period for computing tercile thresholds.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dir\_to\_save\_roc\_reliability}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{Path}}) \textendash{} Directory to save ROC curves and reliability diagram plots.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{lead\_time}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}\sphinxstyleliteralemphasis{\sphinxupquote{ of }}\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Lead times in months to define the forecast season (e.g., {[}1, 2, 3{]} for a 3\sphinxhyphen{}month season).
If None, no season is specified.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{ensemble\_mean}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Ensemble statistic to use for deterministic or probabilistic scores (e.g., ‘mean’).
If None, ensemble mean is computed automatically when required.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{gridded}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Whether to perform gridded validation (True) or non\sphinxhyphen{}gridded (not implemented). Default is True.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\begin{description}
\sphinxlineitem{If score\_type is ‘det\_score’, ‘prob\_score’, or ‘ensemble\_score’:}
\sphinxAtStartPar
Dictionary with model identifiers as keys and xarray.DataArray of scores (dimensions Y, X) as values.

\sphinxlineitem{If score\_type is ‘all\_grid\_prob\_score’ (e.g., ROC\_CURVE, RELIABILITY\_DIAGRAM):}
\sphinxAtStartPar
None, as results are saved as plots.

\sphinxlineitem{If score\_type is ‘all\_grid\_det\_score’:}
\sphinxAtStartPar
None (not implemented).

\end{description}


\sphinxlineitem{Return type}
\sphinxAtStartPar
dict or None

\sphinxlineitem{Raises}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{ValueError}} \textendash{} If the score is not recognized or if non\sphinxhyphen{}gridded validation is attempted (not implemented).

\end{description}\end{quote}

\end{fulllineitems}

\index{gcm\_validation\_compute\_() (wass2s.was\_verification.WAS\_Verification method)@\spxentry{gcm\_validation\_compute\_()}\spxextra{wass2s.was\_verification.WAS\_Verification method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_verification.WAS_Verification.gcm_validation_compute_}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{gcm\_validation\_compute\_}}}
{\sphinxparam{\DUrole{n}{center\_variable}}\sphinxparamcomma \sphinxparam{\DUrole{n}{month\_of\_initialization}}\sphinxparamcomma \sphinxparam{\DUrole{n}{lead\_time}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dir\_model}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Obs}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{area}}\sphinxparamcomma \sphinxparam{\DUrole{n}{score}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dir\_to\_save\_roc\_reliability}}\sphinxparamcomma \sphinxparam{\DUrole{n}{ensemble\_mean}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{gridded}\DUrole{o}{=}\DUrole{default_value}{True}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Validate GCM forecasts using specified metrics.

\sphinxAtStartPar
Computes deterministic, probabilistic, or ensemble scores for GCM hindcasts.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{center\_variable}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}\sphinxstyleliteralemphasis{\sphinxupquote{ of }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} List of model identifiers (e.g., ‘center.variable’).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{month\_of\_initialization}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Month of forecast initialization (1\sphinxhyphen{}12).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{lead\_time}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}\sphinxstyleliteralemphasis{\sphinxupquote{ of }}\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Lead times in months for the forecast season.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dir\_model}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{Path}}) \textendash{} Directory containing model hindcast files.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Obs}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Observed data with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Start year of the validation period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} End year of the validation period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Start year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} End year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{area}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} Geographical area for validation (not used in current implementation).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{score}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} Score to compute (e.g., ‘Pearson’, ‘RPSS’, ‘ROC\_CURVE’).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dir\_to\_save\_roc\_reliability}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{Path}}) \textendash{} Directory to save ROC and reliability plots.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{ensemble\_mean}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Ensemble statistic to use if needed (e.g., ‘mean’). Default is None.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{gridded}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Whether to perform gridded validation. Default is True.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
Dictionary of model scores with keys as model identifiers and values as xarray.DataArray,
or None for plotting scores (e.g., ROC\_CURVE, RELIABILITY\_DIAGRAM).

\sphinxlineitem{Return type}
\sphinxAtStartPar
dict or None

\end{description}\end{quote}

\end{fulllineitems}

\index{get\_scores\_metadata() (wass2s.was\_verification.WAS\_Verification method)@\spxentry{get\_scores\_metadata()}\spxextra{wass2s.was\_verification.WAS\_Verification method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_verification.WAS_Verification.get_scores_metadata}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{get\_scores\_metadata}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Retrieve metadata for all available scoring metrics.
\begin{quote}\begin{description}
\sphinxlineitem{Returns}
\sphinxAtStartPar
Dictionary containing score names as keys and tuples of metadata
(description, min\_value, max\_value, score\_type, colormap, function) as values.

\sphinxlineitem{Return type}
\sphinxAtStartPar
dict

\end{description}\end{quote}

\end{fulllineitems}

\index{ignorance\_score() (wass2s.was\_verification.WAS\_Verification method)@\spxentry{ignorance\_score()}\spxextra{wass2s.was\_verification.WAS\_Verification method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_verification.WAS_Verification.ignorance_score}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{ignorance\_score}}}
{\sphinxparam{\DUrole{n}{y\_true}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_probs}}\sphinxparamcomma \sphinxparam{\DUrole{n}{index\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{index\_end}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute Ignorance Score based on Weijs (2010).

\sphinxAtStartPar
Measures the logarithmic loss of forecast probabilities for the true category.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_true}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Observed values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_probs}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Forecast probabilities with shape (n\_classes, n\_samples).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{index\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Start index of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{index\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} End index of the climatology period.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
Ignorance score, non\sphinxhyphen{}negative. Returns np.nan if insufficient valid data.

\sphinxlineitem{Return type}
\sphinxAtStartPar
float

\end{description}\end{quote}

\end{fulllineitems}

\index{index\_of\_agreement() (wass2s.was\_verification.WAS\_Verification method)@\spxentry{index\_of\_agreement()}\spxextra{wass2s.was\_verification.WAS\_Verification method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_verification.WAS_Verification.index_of_agreement}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{index\_of\_agreement}}}
{\sphinxparam{\DUrole{n}{y\_true}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_pred}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute Index of Agreement (IOA).

\sphinxAtStartPar
Measures the degree of model prediction accuracy relative to observed variability.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_true}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Observed values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_pred}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Predicted values.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
IOA score, ranging from 0 to 1 (1 is perfect). Returns np.nan if insufficient valid data.

\sphinxlineitem{Return type}
\sphinxAtStartPar
float

\end{description}\end{quote}

\end{fulllineitems}

\index{kling\_gupta\_efficiency() (wass2s.was\_verification.WAS\_Verification method)@\spxentry{kling\_gupta\_efficiency()}\spxextra{wass2s.was\_verification.WAS\_Verification method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_verification.WAS_Verification.kling_gupta_efficiency}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{kling\_gupta\_efficiency}}}
{\sphinxparam{\DUrole{n}{y\_true}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_pred}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute Kling\sphinxhyphen{}Gupta Efficiency (KGE) metric.

\sphinxAtStartPar
KGE combines correlation, bias, and variability ratios to assess model performance.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_true}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Observed values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_pred}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Predicted values.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
KGE score, ranging from \sphinxhyphen{}Inf to 1 (1 is perfect). Returns np.nan if insufficient valid data.

\sphinxlineitem{Return type}
\sphinxAtStartPar
float

\end{description}\end{quote}

\end{fulllineitems}

\index{mean\_absolute\_error() (wass2s.was\_verification.WAS\_Verification method)@\spxentry{mean\_absolute\_error()}\spxextra{wass2s.was\_verification.WAS\_Verification method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_verification.WAS_Verification.mean_absolute_error}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{mean\_absolute\_error}}}
{\sphinxparam{\DUrole{n}{y\_true}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_pred}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute Mean Absolute Error (MAE).

\sphinxAtStartPar
Measures the average magnitude of errors in predictions.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_true}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Observed values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_pred}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Predicted values.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
MAE value, non\sphinxhyphen{}negative. Returns np.nan if insufficient valid data.

\sphinxlineitem{Return type}
\sphinxAtStartPar
float

\end{description}\end{quote}

\end{fulllineitems}

\index{nash\_sutcliffe\_efficiency() (wass2s.was\_verification.WAS\_Verification method)@\spxentry{nash\_sutcliffe\_efficiency()}\spxextra{wass2s.was\_verification.WAS\_Verification method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_verification.WAS_Verification.nash_sutcliffe_efficiency}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{nash\_sutcliffe\_efficiency}}}
{\sphinxparam{\DUrole{n}{y\_true}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_pred}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute Nash\sphinxhyphen{}Sutcliffe Efficiency (NSE).

\sphinxAtStartPar
Measures the predictive skill of the model compared to the mean of observations.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_true}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Observed values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_pred}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Predicted values.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
NSE score, ranging from \sphinxhyphen{}Inf to 1 (1 is perfect). Returns np.nan if insufficient valid data.

\sphinxlineitem{Return type}
\sphinxAtStartPar
float

\end{description}\end{quote}

\end{fulllineitems}

\index{pearson\_corr() (wass2s.was\_verification.WAS\_Verification method)@\spxentry{pearson\_corr()}\spxextra{wass2s.was\_verification.WAS\_Verification method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_verification.WAS_Verification.pearson_corr}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{pearson\_corr}}}
{\sphinxparam{\DUrole{n}{y\_true}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_pred}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute Pearson Correlation Coefficient.

\sphinxAtStartPar
Measures the linear correlation between observed and predicted values.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_true}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Observed values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_pred}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Predicted values.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
Pearson correlation coefficient, ranging from \sphinxhyphen{}1 to 1. Returns np.nan if insufficient valid data.

\sphinxlineitem{Return type}
\sphinxAtStartPar
float

\end{description}\end{quote}

\end{fulllineitems}

\index{plot\_model\_score() (wass2s.was\_verification.WAS\_Verification method)@\spxentry{plot\_model\_score()}\spxextra{wass2s.was\_verification.WAS\_Verification method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_verification.WAS_Verification.plot_model_score}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{plot\_model\_score}}}
{\sphinxparam{\DUrole{n}{model\_metric}}\sphinxparamcomma \sphinxparam{\DUrole{n}{score}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dir\_save\_score}}\sphinxparamcomma \sphinxparam{\DUrole{n}{figure\_name}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}WAS\_MLR\textquotesingle{}}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Plot a deterministic score on a map.

\sphinxAtStartPar
Creates a geographical plot of the specified metric for a single model.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{model\_metric}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Score values with dimensions (Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{score}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} Name of the score to plot (e.g., ‘Pearson’, ‘MAE’).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dir\_save\_score}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{Path}}) \textendash{} Directory to save the plot.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{figure\_name}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Prefix for the figure filename. Default is ‘WAS\_MLR’.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{plot\_models\_score() (wass2s.was\_verification.WAS\_Verification method)@\spxentry{plot\_models\_score()}\spxextra{wass2s.was\_verification.WAS\_Verification method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_verification.WAS_Verification.plot_models_score}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{plot\_models\_score}}}
{\sphinxparam{\DUrole{n}{model\_metrics}}\sphinxparamcomma \sphinxparam{\DUrole{n}{score}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dir\_save\_score}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Plot multiple model scores on a grid of maps.

\sphinxAtStartPar
Creates a subplot grid with geographical plots for each model’s score.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{model\_metrics}} (\sphinxstyleliteralemphasis{\sphinxupquote{dict}}) \textendash{} Dictionary of model names and their corresponding score DataArrays (Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{score}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} Name of the score to plot (e.g., ‘Pearson’, ‘MAE’).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dir\_save\_score}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{Path}}) \textendash{} Directory to save the plot.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{plot\_roc\_curves() (wass2s.was\_verification.WAS\_Verification method)@\spxentry{plot\_roc\_curves()}\spxextra{wass2s.was\_verification.WAS\_Verification method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_verification.WAS_Verification.plot_roc_curves}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{plot\_roc\_curves}}}
{\sphinxparam{\DUrole{n}{modelname}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dir\_to\_save\_score}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_true}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_probs}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{n\_bootstraps}\DUrole{o}{=}\DUrole{default_value}{200}}\sphinxparamcomma \sphinxparam{\DUrole{n}{ci}\DUrole{o}{=}\DUrole{default_value}{0.95}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Plot ROC Curves with Confidence Intervals for probabilistic forecasts.

\sphinxAtStartPar
Visualizes the Receiver Operating Characteristic for each tercile category.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{modelname}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} Name of the model for labeling the plot.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dir\_to\_save\_score}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{Path}}) \textendash{} Directory to save the plot.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_true}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Observed data with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_probs}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Forecast probabilities with dimensions (probability, T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} Start year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} End year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{n\_bootstraps}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Number of bootstrap samples for confidence intervals. Default is 200.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{ci}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Confidence interval level (e.g., 0.95 for 95\%). Default is 0.95.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{ratio\_to\_average() (wass2s.was\_verification.WAS\_Verification method)@\spxentry{ratio\_to\_average()}\spxextra{wass2s.was\_verification.WAS\_Verification method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_verification.WAS_Verification.ratio_to_average}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{ratio\_to\_average}}}
{\sphinxparam{\DUrole{n}{predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute and visualize the ratio of a specific year’s data to the climatological mean.

\sphinxAtStartPar
Calculates the percentage ratio of the predictand for a given year relative to
the mean over a climatology period, classifies it into categories, and plots the
result on a geographical map.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Observed data with dimensions (T, Y, X), where T is time, Y is latitude, and X is longitude.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} Start year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} End year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{year}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} Specific year to compute the ratio for.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
Displays a geographical plot of the classified ratios with a custom colormap and legend.

\sphinxlineitem{Return type}
\sphinxAtStartPar
None

\end{description}\end{quote}

\end{fulllineitems}

\index{reliability\_diagram() (wass2s.was\_verification.WAS\_Verification method)@\spxentry{reliability\_diagram()}\spxextra{wass2s.was\_verification.WAS\_Verification method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_verification.WAS_Verification.reliability_diagram}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{reliability\_diagram}}}
{\sphinxparam{\DUrole{n}{modelname}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dir\_to\_save\_score}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_true}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_probs}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{bins}\DUrole{o}{=}\DUrole{default_value}{array({[}0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7{]})}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Plot Reliability Diagrams for probabilistic forecasts.

\sphinxAtStartPar
Visualizes the calibration of forecast probabilities against observed frequencies.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{modelname}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} Name of the model for labeling the plot.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dir\_to\_save\_score}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{Path}}) \textendash{} Directory to save the plot.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_true}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Observed data with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_probs}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Forecast probabilities with dimensions (probability, T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} Start year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} End year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{bins}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Probability bins for discretizing forecast probabilities.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{reliability\_score\_grid() (wass2s.was\_verification.WAS\_Verification method)@\spxentry{reliability\_score\_grid()}\spxextra{wass2s.was\_verification.WAS\_Verification method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_verification.WAS_Verification.reliability_score_grid}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{reliability\_score\_grid}}}
{\sphinxparam{\DUrole{n}{y\_true}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_probs}}\sphinxparamcomma \sphinxparam{\DUrole{n}{index\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{index\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{bins}\DUrole{o}{=}\DUrole{default_value}{array({[}0., 0.025, 0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95, 0.975, 1.{]})}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute Reliability Score on a grid based on Weijs (2010).

\sphinxAtStartPar
Measures the calibration of forecast probabilities against observed frequencies.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_true}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Observed values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_probs}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Forecast probabilities with shape (n\_classes, n\_samples).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{index\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Start index of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{index\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} End index of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{bins}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Probability bins for discretizing forecast probabilities.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
Reliability score. Returns np.nan if insufficient valid data.

\sphinxlineitem{Return type}
\sphinxAtStartPar
float

\end{description}\end{quote}

\end{fulllineitems}

\index{resolution\_and\_reliability\_over\_all\_grid() (wass2s.was\_verification.WAS\_Verification method)@\spxentry{resolution\_and\_reliability\_over\_all\_grid()}\spxextra{wass2s.was\_verification.WAS\_Verification method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_verification.WAS_Verification.resolution_and_reliability_over_all_grid}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{resolution\_and\_reliability\_over\_all\_grid}}}
{\sphinxparam{\DUrole{n}{dir\_to\_save\_score}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_true}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_probs}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{bins}\DUrole{o}{=}\DUrole{default_value}{array({[}0., 0.025, 0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95, 0.975, 1.{]})}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute Resolution and Reliability scores over all grid points.

\sphinxAtStartPar
Based on Weijs (2010), computes scores by aggregating across all grid points.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dir\_to\_save\_score}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{Path}}) \textendash{} Directory to save score outputs.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_true}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Observed data with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_probs}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Forecast probabilities with dimensions (probability, T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} Start year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} End year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{bins}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Probability bins for discretizing forecast probabilities.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\begin{itemize}
\item {} \begin{description}
\sphinxlineitem{resolution\_sum}{[}float{]}
\sphinxAtStartPar
Aggregated resolution score.

\end{description}

\item {} \begin{description}
\sphinxlineitem{reliability\_sum}{[}float{]}
\sphinxAtStartPar
Aggregated reliability score.

\end{description}

\end{itemize}


\sphinxlineitem{Return type}
\sphinxAtStartPar
tuple

\end{description}\end{quote}

\end{fulllineitems}

\index{resolution\_score\_grid() (wass2s.was\_verification.WAS\_Verification method)@\spxentry{resolution\_score\_grid()}\spxextra{wass2s.was\_verification.WAS\_Verification method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_verification.WAS_Verification.resolution_score_grid}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{resolution\_score\_grid}}}
{\sphinxparam{\DUrole{n}{y\_true}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_probs}}\sphinxparamcomma \sphinxparam{\DUrole{n}{index\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{index\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{bins}\DUrole{o}{=}\DUrole{default_value}{array({[}0., 0.025, 0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4, 0.45, 0.5, 0.55, 0.6, 0.65, 0.7, 0.75, 0.8, 0.85, 0.9, 0.95, 0.975, 1.{]})}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute Resolution Score on a grid based on Weijs (2010).

\sphinxAtStartPar
Measures the ability of the forecast to distinguish between different outcomes.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_true}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Observed values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_probs}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Forecast probabilities with shape (n\_classes, n\_samples).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{index\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Start index of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{index\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} End index of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{bins}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Probability bins for discretizing forecast probabilities.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
Resolution score, non\sphinxhyphen{}negative. Returns np.nan if insufficient valid data.

\sphinxlineitem{Return type}
\sphinxAtStartPar
float

\end{description}\end{quote}

\end{fulllineitems}

\index{root\_mean\_square\_error() (wass2s.was\_verification.WAS\_Verification method)@\spxentry{root\_mean\_square\_error()}\spxextra{wass2s.was\_verification.WAS\_Verification method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_verification.WAS_Verification.root_mean_square_error}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{root\_mean\_square\_error}}}
{\sphinxparam{\DUrole{n}{y\_true}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_pred}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute Root Mean Square Error (RMSE).

\sphinxAtStartPar
Measures the square root of the average squared errors in predictions.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_true}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Observed values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_pred}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Predicted values.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
RMSE value, non\sphinxhyphen{}negative. Returns np.nan if insufficient valid data.

\sphinxlineitem{Return type}
\sphinxAtStartPar
float

\end{description}\end{quote}

\end{fulllineitems}

\index{taylor\_diagram() (wass2s.was\_verification.WAS\_Verification method)@\spxentry{taylor\_diagram()}\spxextra{wass2s.was\_verification.WAS\_Verification method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_verification.WAS_Verification.taylor_diagram}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{taylor\_diagram}}}
{\sphinxparam{\DUrole{n}{y\_true}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_pred}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Placeholder for Taylor Diagram visualization.

\sphinxAtStartPar
Visualizes model performance in terms of correlation, standard deviation, and RMSE.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_true}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Observed values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_pred}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Predicted values.

\end{itemize}

\end{description}\end{quote}
\subsubsection*{Notes}

\sphinxAtStartPar
Implementation pending.

\end{fulllineitems}

\index{weighted\_gcm\_forecasts() (wass2s.was\_verification.WAS\_Verification method)@\spxentry{weighted\_gcm\_forecasts()}\spxextra{wass2s.was\_verification.WAS\_Verification method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_verification.WAS_Verification.weighted_gcm_forecasts}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{weighted\_gcm\_forecasts}}}
{\sphinxparam{\DUrole{n}{Obs}}\sphinxparamcomma \sphinxparam{\DUrole{n}{best\_models}}\sphinxparamcomma \sphinxparam{\DUrole{n}{scores}}\sphinxparamcomma \sphinxparam{\DUrole{n}{lead\_time}}\sphinxparamcomma \sphinxparam{\DUrole{n}{model\_dir}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{variable}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}PRCP\textquotesingle{}}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Generate weighted ensemble forecasts from selected GCMs based on their performance scores.

\sphinxAtStartPar
Combines hindcasts and forecasts from multiple models using weights derived from
the GROC score, scales the results to match observed climatology, and computes
tercile probabilities.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Obs}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Observed data with dimensions (T, Y, X), used for scaling and probability calculations.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{best\_models}} (\sphinxstyleliteralemphasis{\sphinxupquote{dict}}) \textendash{} Dictionary of model identifiers (keys) to be included in the ensemble.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{scores}} (\sphinxstyleliteralemphasis{\sphinxupquote{dict}}) \textendash{} Dictionary containing scores (e.g., GROC) for each model, with model identifiers as keys.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{lead\_time}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}\sphinxstyleliteralemphasis{\sphinxupquote{ of }}\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} Lead times in months for the forecast season (e.g., {[}1, 2, 3{]} for a 3\sphinxhyphen{}month season).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{model\_dir}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{Path}}) \textendash{} Directory containing hindcast and forecast NetCDF files.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} Start year of the climatology period for computing tercile thresholds.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} End year of the climatology period for computing tercile thresholds.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{variable}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Variable name in the NetCDF files (e.g., ‘PRCP’ for precipitation). Default is ‘PRCP’.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\begin{itemize}
\item {} \begin{description}
\sphinxlineitem{hindcast\_det}{[}xarray.DataArray{]}
\sphinxAtStartPar
Weighted deterministic hindcast with dimensions (T, Y, X).

\end{description}

\item {} \begin{description}
\sphinxlineitem{hindcast\_prob}{[}xarray.DataArray{]}
\sphinxAtStartPar
Tercile probabilities for hindcasts with dimensions (probability, T, Y, X).

\end{description}

\item {} \begin{description}
\sphinxlineitem{forecast\_prob}{[}xarray.DataArray{]}
\sphinxAtStartPar
Tercile probabilities for forecasts with dimensions (probability, Y, X).

\end{description}

\end{itemize}


\sphinxlineitem{Return type}
\sphinxAtStartPar
tuple

\end{description}\end{quote}
\subsubsection*{Notes}
\begin{itemize}
\item {} 
\sphinxAtStartPar
Model files are expected to follow a naming convention like
‘hindcast\_\{center\}\_\{variable\}\_\{init\_month\}\_\{season\}\_\{lead\}.nc’.

\item {} 
\sphinxAtStartPar
The GROC score is used as the weighting metric.

\item {} 
\sphinxAtStartPar
A scaling factor is applied based on the ratio of observed to hindcast mean.

\end{itemize}

\end{fulllineitems}


\end{fulllineitems}



\subsection{wass2s.was\_mme module}
\label{\detokenize{api:module-wass2s.was_mme}}\label{\detokenize{api:wass2s-was-mme-module}}\index{module@\spxentry{module}!wass2s.was\_mme@\spxentry{wass2s.was\_mme}}\index{wass2s.was\_mme@\spxentry{wass2s.was\_mme}!module@\spxentry{module}}\index{BMA (class in wass2s.was\_mme)@\spxentry{BMA}\spxextra{class in wass2s.was\_mme}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.BMA}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_mme.}}\sphinxbfcode{\sphinxupquote{BMA}}}
{\sphinxparam{\DUrole{n}{observations}}\sphinxparamcomma \sphinxparam{\DUrole{n}{model\_predictions}}\sphinxparamcomma \sphinxparam{\DUrole{n}{model\_names}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{alpha}\DUrole{o}{=}\DUrole{default_value}{1.0}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_metric}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}rmse\textquotesingle{}}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}
\index{compute\_error\_based\_prior() (wass2s.was\_mme.BMA method)@\spxentry{compute\_error\_based\_prior()}\spxextra{wass2s.was\_mme.BMA method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.BMA.compute_error_based_prior}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_error\_based\_prior}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute either RMSE or MAE for each model vs. observations,
then use exp(\sphinxhyphen{}alpha * error) for priors.

\end{fulllineitems}

\index{compute\_model\_posterior\_probs() (wass2s.was\_mme.BMA method)@\spxentry{compute\_model\_posterior\_probs()}\spxextra{wass2s.was\_mme.BMA method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.BMA.compute_model_posterior_probs}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_model\_posterior\_probs}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Combine model priors and WAIC\sphinxhyphen{}based likelihood approximation to get posterior probabilities.

\end{fulllineitems}

\index{fit\_models\_pymc() (wass2s.was\_mme.BMA method)@\spxentry{fit\_models\_pymc()}\spxextra{wass2s.was\_mme.BMA method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.BMA.fit_models_pymc}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{fit\_models\_pymc}}}
{\sphinxparam{\DUrole{n}{draws}\DUrole{o}{=}\DUrole{default_value}{2000}}\sphinxparamcomma \sphinxparam{\DUrole{n}{tune}\DUrole{o}{=}\DUrole{default_value}{1000}}\sphinxparamcomma \sphinxparam{\DUrole{n}{chains}\DUrole{o}{=}\DUrole{default_value}{4}}\sphinxparamcomma \sphinxparam{\DUrole{n}{target\_accept}\DUrole{o}{=}\DUrole{default_value}{0.9}}\sphinxparamcomma \sphinxparam{\DUrole{n}{init}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}adapt\_diag\textquotesingle{}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{verbose}\DUrole{o}{=}\DUrole{default_value}{True}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Fit a PyMC model for each set of predictions: y \textasciitilde{} offset + scale * preds + noise.
Then compute WAIC and store offset, scale from posterior means.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{draws}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} The number of samples (in each chain) to draw from the posterior.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{tune}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} The number of tuning (burn\sphinxhyphen{}in) steps.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{chains}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} The number of chains to run.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{target\_accept}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} The target acceptance probability for the sampler.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{init}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} The initialization method for PyMC’s sampler. E.g., “adapt\_diag”, “jitter+adapt\_diag”, “advi+adapt\_diag”, “adapt\_full”, “jitter+adapt\_full”, “auto”.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{predict() (wass2s.was\_mme.BMA method)@\spxentry{predict()}\spxextra{wass2s.was\_mme.BMA method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.BMA.predict}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{predict}}}
{\sphinxparam{\DUrole{n}{future\_model\_preds\_list}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute out\sphinxhyphen{}of\sphinxhyphen{}sample (future) predictions for each model, applying offset+scale,
and then weighting by posterior probabilities.

\end{fulllineitems}

\index{predict\_in\_sample() (wass2s.was\_mme.BMA method)@\spxentry{predict\_in\_sample()}\spxextra{wass2s.was\_mme.BMA method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.BMA.predict_in_sample}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{predict\_in\_sample}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute in\sphinxhyphen{}sample predictions using offset + scale for each model, weighted by posterior\_probs.

\end{fulllineitems}

\index{summary() (wass2s.was\_mme.BMA method)@\spxentry{summary()}\spxextra{wass2s.was\_mme.BMA method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.BMA.summary}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{summary}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Print a summary for whichever error metric is used (RMSE or MAE).

\end{fulllineitems}


\end{fulllineitems}

\index{NonHomogeneousGaussianRegression (class in wass2s.was\_mme)@\spxentry{NonHomogeneousGaussianRegression}\spxextra{class in wass2s.was\_mme}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.NonHomogeneousGaussianRegression}}
\pysigstartsignatures
\pysigline
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_mme.}}\sphinxbfcode{\sphinxupquote{NonHomogeneousGaussianRegression}}}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
Placeholder for Non\sphinxhyphen{}Homogeneous Gaussian Regression model.

\sphinxAtStartPar
This class is not implemented in the provided code and serves as a placeholder for future development.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{None}}

\end{description}\end{quote}

\end{fulllineitems}

\index{WAS\_Min2009\_ProbWeighted (class in wass2s.was\_mme)@\spxentry{WAS\_Min2009\_ProbWeighted}\spxextra{class in wass2s.was\_mme}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_Min2009_ProbWeighted}}
\pysigstartsignatures
\pysigline
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_mme.}}\sphinxbfcode{\sphinxupquote{WAS\_Min2009\_ProbWeighted}}}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
Probability\sphinxhyphen{}Weighted Multi\sphinxhyphen{}Model Ensemble based on Min et al. (2009).

\sphinxAtStartPar
Implements a specific weighting scheme for combining multiple climate models,
where weights are derived from model scores with a threshold\sphinxhyphen{}based transformation.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{None}}

\end{description}\end{quote}
\index{compute() (wass2s.was\_mme.WAS\_Min2009\_ProbWeighted method)@\spxentry{compute()}\spxextra{wass2s.was\_mme.WAS\_Min2009\_ProbWeighted method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_Min2009_ProbWeighted.compute}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute}}}
{\sphinxparam{\DUrole{n}{rainfall}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hdcst}}\sphinxparamcomma \sphinxparam{\DUrole{n}{fcst}}\sphinxparamcomma \sphinxparam{\DUrole{n}{scores}}\sphinxparamcomma \sphinxparam{\DUrole{n}{threshold}\DUrole{o}{=}\DUrole{default_value}{0.5}}\sphinxparamcomma \sphinxparam{\DUrole{n}{complete}\DUrole{o}{=}\DUrole{default_value}{False}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute probability\sphinxhyphen{}weighted ensemble estimates for hindcast and forecast datasets.

\sphinxAtStartPar
Applies a weighting scheme where scores below the threshold are set to 0, and others to 1.
Optionally fills missing values with unweighted averages.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{rainfall}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Observed rainfall data with dimensions (T, Y, X, M).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hdcst}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Hindcast data with dimensions (T, M, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{fcst}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Forecast data with dimensions (T, M, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{scores}} (\sphinxstyleliteralemphasis{\sphinxupquote{dict}}) \textendash{} Dictionary mapping model names to score arrays.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{threshold}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Threshold below which scores are set to 0. Default is 0.5.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{complete}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} If True, fill missing values with unweighted averages. Default is False.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{hindcast\_weighted} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} Weighted hindcast ensemble with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{forecast\_weighted} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} Weighted forecast ensemble with dimensions (T, Y, X).

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{WAS\_mme\_AdaBoost (class in wass2s.was\_mme)@\spxentry{WAS\_mme\_AdaBoost}\spxextra{class in wass2s.was\_mme}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_AdaBoost}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_mme.}}\sphinxbfcode{\sphinxupquote{WAS\_mme\_AdaBoost}}}
{\sphinxparam{\DUrole{n}{n\_estimators}\DUrole{o}{=}\DUrole{default_value}{50}}\sphinxparamcomma \sphinxparam{\DUrole{n}{learning\_rate}\DUrole{o}{=}\DUrole{default_value}{0.1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{random\_state}\DUrole{o}{=}\DUrole{default_value}{42}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dist\_method}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}gamma\textquotesingle{}}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
AdaBoost\sphinxhyphen{}based Multi\sphinxhyphen{}Model Ensemble (MME) forecasting.

\sphinxAtStartPar
This class implements a single\sphinxhyphen{}model forecasting approach using scikit\sphinxhyphen{}learn’s AdaBoostRegressor
for deterministic predictions, with optional tercile probability calculations using
various statistical distributions.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{n\_estimators}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Number of boosting iterations. Default is 50.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{learning\_rate}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Learning rate for boosting. Default is 0.1.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{random\_state}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Seed for random number generation for reproducibility. Default is 42.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dist\_method}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Distribution method for tercile probability calculations
(‘t’, ‘gamma’, ‘nonparam’, ‘normal’, ‘lognormal’, ‘weibull\_min’).
Default is ‘gamma’.

\end{itemize}

\end{description}\end{quote}
\index{calculate\_tercile\_probabilities() (wass2s.was\_mme.WAS\_mme\_AdaBoost static method)@\spxentry{calculate\_tercile\_probabilities()}\spxextra{wass2s.was\_mme.WAS\_mme\_AdaBoost static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_AdaBoost.calculate_tercile_probabilities}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Student’s t\sphinxhyphen{}based method

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_gamma() (wass2s.was\_mme.WAS\_mme\_AdaBoost static method)@\spxentry{calculate\_tercile\_probabilities\_gamma()}\spxextra{wass2s.was\_mme.WAS\_mme\_AdaBoost static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_AdaBoost.calculate_tercile_probabilities_gamma}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_gamma}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T2}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Gamma\sphinxhyphen{}distribution based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_lognormal() (wass2s.was\_mme.WAS\_mme\_AdaBoost static method)@\spxentry{calculate\_tercile\_probabilities\_lognormal()}\spxextra{wass2s.was\_mme.WAS\_mme\_AdaBoost static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_AdaBoost.calculate_tercile_probabilities_lognormal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_lognormal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Lognormal\sphinxhyphen{}distribution based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_nonparametric() (wass2s.was\_mme.WAS\_mme\_AdaBoost static method)@\spxentry{calculate\_tercile\_probabilities\_nonparametric()}\spxextra{wass2s.was\_mme.WAS\_mme\_AdaBoost static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_AdaBoost.calculate_tercile_probabilities_nonparametric}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_nonparametric}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_samples}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Non\sphinxhyphen{}parametric method using historical error samples.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_normal() (wass2s.was\_mme.WAS\_mme\_AdaBoost static method)@\spxentry{calculate\_tercile\_probabilities\_normal()}\spxextra{wass2s.was\_mme.WAS\_mme\_AdaBoost static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_AdaBoost.calculate_tercile_probabilities_normal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_normal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Normal\sphinxhyphen{}distribution based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_weibull\_min() (wass2s.was\_mme.WAS\_mme\_AdaBoost static method)@\spxentry{calculate\_tercile\_probabilities\_weibull\_min()}\spxextra{wass2s.was\_mme.WAS\_mme\_AdaBoost static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_AdaBoost.calculate_tercile_probabilities_weibull_min}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_weibull\_min}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Weibull minimum\sphinxhyphen{}based method.
\begin{description}
\sphinxlineitem{Here, we assume:}\begin{itemize}
\item {} 
\sphinxAtStartPar
best\_guess is used as the location,

\item {} 
\sphinxAtStartPar
error\_std (sqrt(error\_variance)) as the scale, and

\item {} 
\sphinxAtStartPar
dof (degrees of freedom) as the shape parameter.

\end{itemize}

\end{description}
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{best\_guess}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Forecast or best guess values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{error\_variance}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Variance associated with forecast errors.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{first\_tercile}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} First tercile threshold values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{second\_tercile}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Second tercile threshold values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dof}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Shape parameter for the Weibull minimum distribution.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{pred\_prob} \textendash{} A 3 x n\_time array with probabilities for being below the first tercile,
between the first and second tercile, and above the second tercile.

\sphinxlineitem{Return type}
\sphinxAtStartPar
np.ndarray

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_model() (wass2s.was\_mme.WAS\_mme\_AdaBoost method)@\spxentry{compute\_model()}\spxextra{wass2s.was\_mme.WAS\_mme\_AdaBoost method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_AdaBoost.compute_model}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_model}}}
{\sphinxparam{\DUrole{n}{X\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{X\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute deterministic hindcast using the AdaBoost model.

\sphinxAtStartPar
Fits the AdaBoostRegressor on training data and predicts deterministic values for the test data.
Handles data stacking and NaN removal to ensure robust predictions.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Training predictor data with dimensions (T, M, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Training predictand data with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Testing predictor data with dimensions (T, M, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Testing predictand data with dimensions (T, Y, X).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{predicted\_da} \textendash{} Deterministic hindcast with dimensions (T, Y, X).

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_prob() (wass2s.was\_mme.WAS\_mme\_AdaBoost method)@\spxentry{compute\_prob()}\spxextra{wass2s.was\_mme.WAS\_mme\_AdaBoost method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_AdaBoost.compute_prob}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_prob}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute tercile probabilities using the chosen distribution method.
Predictant is expected to be an xarray DataArray with dims (T, Y, X).

\end{fulllineitems}

\index{forecast() (wass2s.was\_mme.WAS\_mme\_AdaBoost method)@\spxentry{forecast()}\spxextra{wass2s.was\_mme.WAS\_mme\_AdaBoost method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_AdaBoost.forecast}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{forecast}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det\_cross}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor\_for\_year}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Generate deterministic and probabilistic forecast for a target year using the AdaBoost model.

\sphinxAtStartPar
Fits the AdaBoostRegressor on standardized hindcast data, predicts deterministic values for the target year,
reverses standardization, and computes tercile probabilities.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Observed predictand data with dimensions (T, Y, X) or (T, M, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} Start year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} End year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Deterministic hindcast data for training with dimensions (T, M, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det\_cross}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Deterministic hindcast data for error estimation with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictor\_for\_year}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Predictor data for the target year with dimensions (T, M, Y, X).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{result\_da} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} Deterministic forecast with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{hindcast\_prob} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} Tercile probabilities with dimensions (probability, T, Y, X), where probability
includes {[}‘PB’, ‘PN’, ‘PA’{]} (below\sphinxhyphen{}normal, normal, above\sphinxhyphen{}normal).

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{WAS\_mme\_BMA (class in wass2s.was\_mme)@\spxentry{WAS\_mme\_BMA}\spxextra{class in wass2s.was\_mme}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_BMA}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_mme.}}\sphinxbfcode{\sphinxupquote{WAS\_mme\_BMA}}}
{\sphinxparam{\DUrole{n}{obs}}\sphinxparamcomma \sphinxparam{\DUrole{n}{all\_hdcst\_models}}\sphinxparamcomma \sphinxparam{\DUrole{n}{all\_fcst\_models}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dist\_method}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}gamma\textquotesingle{}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{alpha\_}\DUrole{o}{=}\DUrole{default_value}{0.5}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_metric\_}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}rmse\textquotesingle{}}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}
\index{calculate\_tercile\_probabilities() (wass2s.was\_mme.WAS\_mme\_BMA static method)@\spxentry{calculate\_tercile\_probabilities()}\spxextra{wass2s.was\_mme.WAS\_mme\_BMA static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_BMA.calculate_tercile_probabilities}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Student’s t\sphinxhyphen{}based method

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_gamma() (wass2s.was\_mme.WAS\_mme\_BMA static method)@\spxentry{calculate\_tercile\_probabilities\_gamma()}\spxextra{wass2s.was\_mme.WAS\_mme\_BMA static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_BMA.calculate_tercile_probabilities_gamma}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_gamma}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T2}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Gamma\sphinxhyphen{}distribution based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_lognormal() (wass2s.was\_mme.WAS\_mme\_BMA static method)@\spxentry{calculate\_tercile\_probabilities\_lognormal()}\spxextra{wass2s.was\_mme.WAS\_mme\_BMA static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_BMA.calculate_tercile_probabilities_lognormal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_lognormal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Lognormal\sphinxhyphen{}distribution based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_nonparametric() (wass2s.was\_mme.WAS\_mme\_BMA static method)@\spxentry{calculate\_tercile\_probabilities\_nonparametric()}\spxextra{wass2s.was\_mme.WAS\_mme\_BMA static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_BMA.calculate_tercile_probabilities_nonparametric}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_nonparametric}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_samples}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Non\sphinxhyphen{}parametric method using historical error samples.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_normal() (wass2s.was\_mme.WAS\_mme\_BMA static method)@\spxentry{calculate\_tercile\_probabilities\_normal()}\spxextra{wass2s.was\_mme.WAS\_mme\_BMA static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_BMA.calculate_tercile_probabilities_normal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_normal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Normal\sphinxhyphen{}distribution based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_weibull\_min() (wass2s.was\_mme.WAS\_mme\_BMA static method)@\spxentry{calculate\_tercile\_probabilities\_weibull\_min()}\spxextra{wass2s.was\_mme.WAS\_mme\_BMA static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_BMA.calculate_tercile_probabilities_weibull_min}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_weibull\_min}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Weibull minimum\sphinxhyphen{}based method.
\begin{description}
\sphinxlineitem{Here, we assume:}\begin{itemize}
\item {} 
\sphinxAtStartPar
best\_guess is used as the location,

\item {} 
\sphinxAtStartPar
error\_std (sqrt(error\_variance)) as the scale, and

\item {} 
\sphinxAtStartPar
dof (degrees of freedom) as the shape parameter.

\end{itemize}

\end{description}
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{best\_guess}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Forecast or best guess values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{error\_variance}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Variance associated with forecast errors.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{first\_tercile}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} First tercile threshold values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{second\_tercile}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Second tercile threshold values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dof}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Shape parameter for the Weibull minimum distribution.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{pred\_prob} \textendash{} A 3 x n\_time array with probabilities for being below the first tercile,
between the first and second tercile, and above the second tercile.

\sphinxlineitem{Return type}
\sphinxAtStartPar
np.ndarray

\end{description}\end{quote}

\end{fulllineitems}

\index{compute() (wass2s.was\_mme.WAS\_mme\_BMA method)@\spxentry{compute()}\spxextra{wass2s.was\_mme.WAS\_mme\_BMA method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_BMA.compute}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute}}}
{\sphinxparam{\DUrole{n}{draws}}\sphinxparamcomma \sphinxparam{\DUrole{n}{tune}}\sphinxparamcomma \sphinxparam{\DUrole{n}{chains}}\sphinxparamcomma \sphinxparam{\DUrole{n}{verbose}\DUrole{o}{=}\DUrole{default_value}{False}}\sphinxparamcomma \sphinxparam{\DUrole{n}{target\_accept}\DUrole{o}{=}\DUrole{default_value}{0.9}}\sphinxparamcomma \sphinxparam{\DUrole{n}{init}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}jitter+adapt\_diag\textquotesingle{}}}}
{}
\pysigstopsignatures\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{draws}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} The number of samples (in each chain) to draw from the posterior.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{tune}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} The number of tuning (burn\sphinxhyphen{}in) steps.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{chains}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} The number of chains to run.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{verbose}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}) \textendash{} Show progress.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{target\_accept}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}) \textendash{} The target acceptance probability for the sampler.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{init}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} The initialization method for PyMC’s sampler. E.g., “adapt\_diag”, “jitter+adapt\_diag”, “advi+adapt\_diag”, “adapt\_full”, “jitter+adapt\_full”, “auto”.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcasts}} (\sphinxstyleliteralemphasis{\sphinxupquote{Runs the BMA workflow on}}) \textendash{} \begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{)}%
\item {} 
\sphinxAtStartPar
compute\_rmse\_based\_prior

\item {} 
\sphinxAtStartPar
fit\_models\_pymc

\item {} 
\sphinxAtStartPar
compute\_model\_posterior\_probs

\end{enumerate}


\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{(}}\sphinxstyleliteralstrong{\sphinxupquote{T}} (\sphinxstyleliteralemphasis{\sphinxupquote{Returns in\sphinxhyphen{}sample predictions as an xarray.DataArray}})

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Y}}

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X}}\sphinxstyleliteralstrong{\sphinxupquote{)}}\sphinxstyleliteralstrong{\sphinxupquote{.}}

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_prob() (wass2s.was\_mme.WAS\_mme\_BMA method)@\spxentry{compute\_prob()}\spxextra{wass2s.was\_mme.WAS\_mme\_BMA method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_BMA.compute_prob}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_prob}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute tercile probabilities for the hindcast using the chosen distribution method.
Predictant is an xarray DataArray with dims (T, Y, X).

\end{fulllineitems}

\index{forecast() (wass2s.was\_mme.WAS\_mme\_BMA method)@\spxentry{forecast()}\spxextra{wass2s.was\_mme.WAS\_mme\_BMA method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_BMA.forecast}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{forecast}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Apply BMA offset+scale weights to future forecasts, returning an xarray.DataArray (T, Y, X).

\end{fulllineitems}

\index{summary() (wass2s.was\_mme.WAS\_mme\_BMA method)@\spxentry{summary()}\spxextra{wass2s.was\_mme.WAS\_mme\_BMA method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_BMA.summary}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{summary}}}
{}
{}
\pysigstopsignatures
\sphinxAtStartPar
Print BMA summary information.

\end{fulllineitems}


\end{fulllineitems}

\index{WAS\_mme\_ELM (class in wass2s.was\_mme)@\spxentry{WAS\_mme\_ELM}\spxextra{class in wass2s.was\_mme}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_ELM}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_mme.}}\sphinxbfcode{\sphinxupquote{WAS\_mme\_ELM}}}
{\sphinxparam{\DUrole{n}{elm\_kwargs}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dist\_method}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}gamma\textquotesingle{}}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
Extreme Learning Machine (ELM) for Multi\sphinxhyphen{}Model Ensemble (MME) forecasting derived from xcast.

\sphinxAtStartPar
This class implements an Extreme Learning Machine model for deterministic forecasting,
with optional tercile probability calculations using various statistical distributions.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{elm\_kwargs}} (\sphinxstyleliteralemphasis{\sphinxupquote{dict}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Keyword arguments to pass to the xcast ELM model. If None, default parameters are used:
\{‘regularization’: 10, ‘hidden\_layer\_size’: 5, ‘activation’: ‘lin’, ‘preprocessing’: ‘none’, ‘n\_estimators’: 5\}.
Default is None.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dist\_method}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Distribution method for tercile probability calculations (‘t’, ‘gamma’, ‘nonparam’, ‘normal’, ‘lognormal’, ‘weibull\_min’).
Default is ‘gamma’.

\end{itemize}

\end{description}\end{quote}
\index{calculate\_tercile\_probabilities() (wass2s.was\_mme.WAS\_mme\_ELM static method)@\spxentry{calculate\_tercile\_probabilities()}\spxextra{wass2s.was\_mme.WAS\_mme\_ELM static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_ELM.calculate_tercile_probabilities}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Student’s t\sphinxhyphen{}based method

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_gamma() (wass2s.was\_mme.WAS\_mme\_ELM static method)@\spxentry{calculate\_tercile\_probabilities\_gamma()}\spxextra{wass2s.was\_mme.WAS\_mme\_ELM static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_ELM.calculate_tercile_probabilities_gamma}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_gamma}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T2}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Gamma\sphinxhyphen{}distribution based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_lognormal() (wass2s.was\_mme.WAS\_mme\_ELM static method)@\spxentry{calculate\_tercile\_probabilities\_lognormal()}\spxextra{wass2s.was\_mme.WAS\_mme\_ELM static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_ELM.calculate_tercile_probabilities_lognormal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_lognormal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Lognormal\sphinxhyphen{}distribution based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_nonparametric() (wass2s.was\_mme.WAS\_mme\_ELM static method)@\spxentry{calculate\_tercile\_probabilities\_nonparametric()}\spxextra{wass2s.was\_mme.WAS\_mme\_ELM static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_ELM.calculate_tercile_probabilities_nonparametric}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_nonparametric}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_samples}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Non\sphinxhyphen{}parametric method using historical error samples.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_normal() (wass2s.was\_mme.WAS\_mme\_ELM static method)@\spxentry{calculate\_tercile\_probabilities\_normal()}\spxextra{wass2s.was\_mme.WAS\_mme\_ELM static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_ELM.calculate_tercile_probabilities_normal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_normal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Normal\sphinxhyphen{}distribution based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_weibull\_min() (wass2s.was\_mme.WAS\_mme\_ELM static method)@\spxentry{calculate\_tercile\_probabilities\_weibull\_min()}\spxextra{wass2s.was\_mme.WAS\_mme\_ELM static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_ELM.calculate_tercile_probabilities_weibull_min}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_weibull\_min}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Weibull minimum\sphinxhyphen{}based method.
\begin{description}
\sphinxlineitem{Here, we assume:}\begin{itemize}
\item {} 
\sphinxAtStartPar
best\_guess is used as the location,

\item {} 
\sphinxAtStartPar
error\_std (sqrt(error\_variance)) as the scale, and

\item {} 
\sphinxAtStartPar
dof (degrees of freedom) as the shape parameter.

\end{itemize}

\end{description}
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{best\_guess}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Forecast or best guess values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{error\_variance}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Variance associated with forecast errors.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{first\_tercile}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} First tercile threshold values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{second\_tercile}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Second tercile threshold values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dof}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Shape parameter for the Weibull minimum distribution.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{pred\_prob} \textendash{} A 3 x n\_time array with probabilities for being below the first tercile,
between the first and second tercile, and above the second tercile.

\sphinxlineitem{Return type}
\sphinxAtStartPar
np.ndarray

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_model() (wass2s.was\_mme.WAS\_mme\_ELM method)@\spxentry{compute\_model()}\spxextra{wass2s.was\_mme.WAS\_mme\_ELM method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_ELM.compute_model}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_model}}}
{\sphinxparam{\DUrole{n}{X\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{X\_test}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute deterministic hindcast using the ELM model.

\sphinxAtStartPar
Fits the ELM model on training data and predicts deterministic values for the test data.
Applies regridding and drymasking to ensure data consistency.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Training predictor data with dimensions (T, M, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Training predictand data with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Testing predictor data with dimensions (T, M, Y, X).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{result\_} \textendash{} Deterministic hindcast with dimensions (T, Y, X).

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_prob() (wass2s.was\_mme.WAS\_mme\_ELM method)@\spxentry{compute\_prob()}\spxextra{wass2s.was\_mme.WAS\_mme\_ELM method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_ELM.compute_prob}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_prob}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute tercile probabilities for hindcast data.

\sphinxAtStartPar
Calculates probabilities for below\sphinxhyphen{}normal, normal, and above\sphinxhyphen{}normal categories using
the specified distribution method, based on climatological terciles.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Observed predictand data with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} Start year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} End year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Deterministic hindcast data with dimensions (T, Y, X).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{hindcast\_prob} \textendash{} Tercile probabilities with dimensions (probability, T, Y, X), where probability
includes {[}‘PB’, ‘PN’, ‘PA’{]} (below\sphinxhyphen{}normal, normal, above\sphinxhyphen{}normal).

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{forecast() (wass2s.was\_mme.WAS\_mme\_ELM method)@\spxentry{forecast()}\spxextra{wass2s.was\_mme.WAS\_mme\_ELM method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_ELM.forecast}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{forecast}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det\_cross\_val}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor\_for\_year}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Generate deterministic and probabilistic forecast for a target year using the ELM model.

\sphinxAtStartPar
Fits the ELM model on hindcast data, predicts deterministic values for the target year,
and computes tercile probabilities. Applies regridding, drymasking, and standardization.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Observed predictand data with dimensions (T, Y, X) or (T, M, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} Start year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} End year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Deterministic hindcast data for training with dimensions (T, M, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det\_cross\_val}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Deterministic hindcast data for error estimation with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictor\_for\_year}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Predictor data for the target year with dimensions (T, M, Y, X).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{result\_} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} Deterministic forecast with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{hindcast\_prob} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} Tercile probabilities with dimensions (probability, T, Y, X), where probability
includes {[}‘PB’, ‘PN’, ‘PA’{]} (below\sphinxhyphen{}normal, normal, above\sphinxhyphen{}normal).

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{WAS\_mme\_ELR (class in wass2s.was\_mme)@\spxentry{WAS\_mme\_ELR}\spxextra{class in wass2s.was\_mme}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_ELR}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_mme.}}\sphinxbfcode{\sphinxupquote{WAS\_mme\_ELR}}}
{\sphinxparam{\DUrole{n}{elm\_kwargs}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
Extended Logistic Regression (ELR) for Multi\sphinxhyphen{}Model Ensemble (MME) forecasting derived from xcast package.

\sphinxAtStartPar
This class implements an Extended Logistic Regression for probabilistic forecasting,
directly computing tercile probabilities without requiring separate probability calculations.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{elm\_kwargs}} (\sphinxstyleliteralemphasis{\sphinxupquote{dict}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Keyword arguments to pass to the xcast ELR model. If None, an empty dictionary is used.
Default is None.

\end{description}\end{quote}
\index{compute\_model() (wass2s.was\_mme.WAS\_mme\_ELR method)@\spxentry{compute\_model()}\spxextra{wass2s.was\_mme.WAS\_mme\_ELR method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_ELR.compute_model}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_model}}}
{\sphinxparam{\DUrole{n}{X\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{X\_test}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute probabilistic hindcast using the ELR model.

\sphinxAtStartPar
Fits the ELR model on training data and predicts tercile probabilities for the test data.
Applies regridding and drymasking to ensure data consistency.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Training predictor data with dimensions (T, M, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Training predictand data with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Testing predictor data with dimensions (T, M, Y, X).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{result\_} \textendash{} Tercile probabilities with dimensions (probability, T, Y, X), where probability
includes {[}‘PB’, ‘PN’, ‘PA’{]} (below\sphinxhyphen{}normal, normal, above\sphinxhyphen{}normal).

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{forecast() (wass2s.was\_mme.WAS\_mme\_ELR method)@\spxentry{forecast()}\spxextra{wass2s.was\_mme.WAS\_mme\_ELR method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_ELR.forecast}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{forecast}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor\_for\_year}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Generate probabilistic forecast for a target year using the ELR model.

\sphinxAtStartPar
Fits the ELR model on hindcast data and predicts tercile probabilities for the target year.
Applies regridding and drymasking to ensure data consistency.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Observed predictand data with dimensions (T, Y, X) or (T, M, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} Start year of the climatology period (not used in this method).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} End year of the climatology period (not used in this method).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Deterministic hindcast data with dimensions (T, M, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictor\_for\_year}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Predictor data for the target year with dimensions (T, M, Y, X).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{hindcast\_prob} \textendash{} Tercile probabilities with dimensions (probability, T, Y, X), where probability
includes {[}‘PB’, ‘PN’, ‘PA’{]} (below\sphinxhyphen{}normal, normal, above\sphinxhyphen{}normal).

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{WAS\_mme\_GA (class in wass2s.was\_mme)@\spxentry{WAS\_mme\_GA}\spxextra{class in wass2s.was\_mme}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_GA}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_mme.}}\sphinxbfcode{\sphinxupquote{WAS\_mme\_GA}}}
{\sphinxparam{\DUrole{n}{population\_size}\DUrole{o}{=}\DUrole{default_value}{20}}\sphinxparamcomma \sphinxparam{\DUrole{n}{max\_iter}\DUrole{o}{=}\DUrole{default_value}{50}}\sphinxparamcomma \sphinxparam{\DUrole{n}{crossover\_rate}\DUrole{o}{=}\DUrole{default_value}{0.7}}\sphinxparamcomma \sphinxparam{\DUrole{n}{mutation\_rate}\DUrole{o}{=}\DUrole{default_value}{0.01}}\sphinxparamcomma \sphinxparam{\DUrole{n}{random\_state}\DUrole{o}{=}\DUrole{default_value}{42}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dist\_method}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}gamma\textquotesingle{}}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
Genetic Algorithm\sphinxhyphen{}based Multi\sphinxhyphen{}Model Ensemble Weighting.

\sphinxAtStartPar
Uses a Genetic Algorithm to optimize weights for combining multiple climate models,
minimizing the mean squared error (MSE) against observations. Supports tercile probability
calculations.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{population\_size}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Number of individuals in the GA population. Default is 20.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{max\_iter}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Maximum number of generations for the GA. Default is 50.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{crossover\_rate}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Probability of performing crossover. Default is 0.7.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mutation\_rate}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Probability of mutating a gene. Default is 0.01.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{random\_state}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Seed for random number generation. Default is 42.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dist\_method}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Distribution method for probability calculations (‘t’, ‘gamma’, ‘nonparam’,
‘normal’, ‘lognormal’, ‘weibull\_min’). Default is ‘gamma’.

\end{itemize}

\end{description}\end{quote}
\index{calculate\_tercile\_probabilities() (wass2s.was\_mme.WAS\_mme\_GA static method)@\spxentry{calculate\_tercile\_probabilities()}\spxextra{wass2s.was\_mme.WAS\_mme\_GA static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_GA.calculate_tercile_probabilities}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Student’s t\sphinxhyphen{}based method for tercile probabilities.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_gamma() (wass2s.was\_mme.WAS\_mme\_GA static method)@\spxentry{calculate\_tercile\_probabilities\_gamma()}\spxextra{wass2s.was\_mme.WAS\_mme\_GA static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_GA.calculate_tercile_probabilities_gamma}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_gamma}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T2}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Gamma\sphinxhyphen{}distribution based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_lognormal() (wass2s.was\_mme.WAS\_mme\_GA static method)@\spxentry{calculate\_tercile\_probabilities\_lognormal()}\spxextra{wass2s.was\_mme.WAS\_mme\_GA static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_GA.calculate_tercile_probabilities_lognormal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_lognormal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Lognormal\sphinxhyphen{}distribution based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_nonparametric() (wass2s.was\_mme.WAS\_mme\_GA static method)@\spxentry{calculate\_tercile\_probabilities\_nonparametric()}\spxextra{wass2s.was\_mme.WAS\_mme\_GA static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_GA.calculate_tercile_probabilities_nonparametric}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_nonparametric}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_samples}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Non\sphinxhyphen{}parametric method using historical error samples.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_normal() (wass2s.was\_mme.WAS\_mme\_GA static method)@\spxentry{calculate\_tercile\_probabilities\_normal()}\spxextra{wass2s.was\_mme.WAS\_mme\_GA static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_GA.calculate_tercile_probabilities_normal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_normal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Normal\sphinxhyphen{}distribution based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_weibull\_min() (wass2s.was\_mme.WAS\_mme\_GA static method)@\spxentry{calculate\_tercile\_probabilities\_weibull\_min()}\spxextra{wass2s.was\_mme.WAS\_mme\_GA static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_GA.calculate_tercile_probabilities_weibull_min}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_weibull\_min}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Weibull minimum\sphinxhyphen{}based method.

\end{fulllineitems}

\index{compute\_model() (wass2s.was\_mme.WAS\_mme\_GA method)@\spxentry{compute\_model()}\spxextra{wass2s.was\_mme.WAS\_mme\_GA method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_GA.compute_model}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_model}}}
{\sphinxparam{\DUrole{n}{X\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{X\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Train the GA and predict on test data.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Training predictor data with dimensions (T, Y, X, M).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Training predictand data with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Testing predictor data with dimensions (T, Y, X, M).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Testing predictand data with dimensions (T, Y, X).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{predicted\_da} \textendash{} Predictions with dimensions (T, Y, X).

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_prob() (wass2s.was\_mme.WAS\_mme\_GA method)@\spxentry{compute\_prob()}\spxextra{wass2s.was\_mme.WAS\_mme\_GA method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_GA.compute_prob}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_prob}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute tercile probabilities for hindcast data using the GA\sphinxhyphen{}optimized weights.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Observed predictand data with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} Start year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} End year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Deterministic hindcast data with dimensions (T, Y, X).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{hindcast\_prob} \textendash{} Tercile probabilities with dimensions (probability, T, Y, X).

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{forecast() (wass2s.was\_mme.WAS\_mme\_GA method)@\spxentry{forecast()}\spxextra{wass2s.was\_mme.WAS\_mme\_GA method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_GA.forecast}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{forecast}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det\_cross}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor\_for\_year}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Forecast for a target year and compute tercile probabilities.

\sphinxAtStartPar
Standardizes data, fits the GA, predicts for the target year, and computes probabilities.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Historical predictand data with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} Start year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} End year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Deterministic hindcast data for training with dimensions (T, Y, X, M).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det\_cross}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Deterministic hindcast data for error estimation with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictor\_for\_year}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Predictor data for the target year with dimensions (T, Y, X, M).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{result\_da} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} Deterministic forecast with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{hindcast\_prob} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} Tercile probability forecast with dimensions (probability, T, Y, X).

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{WAS\_mme\_GradientBoosting (class in wass2s.was\_mme)@\spxentry{WAS\_mme\_GradientBoosting}\spxextra{class in wass2s.was\_mme}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_GradientBoosting}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_mme.}}\sphinxbfcode{\sphinxupquote{WAS\_mme\_GradientBoosting}}}
{\sphinxparam{\DUrole{n}{n\_estimators}\DUrole{o}{=}\DUrole{default_value}{100}}\sphinxparamcomma \sphinxparam{\DUrole{n}{learning\_rate}\DUrole{o}{=}\DUrole{default_value}{0.1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{max\_depth}\DUrole{o}{=}\DUrole{default_value}{3}}\sphinxparamcomma \sphinxparam{\DUrole{n}{random\_state}\DUrole{o}{=}\DUrole{default_value}{42}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dist\_method}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}gamma\textquotesingle{}}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}
\index{calculate\_tercile\_probabilities() (wass2s.was\_mme.WAS\_mme\_GradientBoosting static method)@\spxentry{calculate\_tercile\_probabilities()}\spxextra{wass2s.was\_mme.WAS\_mme\_GradientBoosting static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_GradientBoosting.calculate_tercile_probabilities}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Student’s t\sphinxhyphen{}based method

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_gamma() (wass2s.was\_mme.WAS\_mme\_GradientBoosting static method)@\spxentry{calculate\_tercile\_probabilities\_gamma()}\spxextra{wass2s.was\_mme.WAS\_mme\_GradientBoosting static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_GradientBoosting.calculate_tercile_probabilities_gamma}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_gamma}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T2}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_lognormal() (wass2s.was\_mme.WAS\_mme\_GradientBoosting static method)@\spxentry{calculate\_tercile\_probabilities\_lognormal()}\spxextra{wass2s.was\_mme.WAS\_mme\_GradientBoosting static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_GradientBoosting.calculate_tercile_probabilities_lognormal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_lognormal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_nonparametric() (wass2s.was\_mme.WAS\_mme\_GradientBoosting static method)@\spxentry{calculate\_tercile\_probabilities\_nonparametric()}\spxextra{wass2s.was\_mme.WAS\_mme\_GradientBoosting static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_GradientBoosting.calculate_tercile_probabilities_nonparametric}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_nonparametric}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_samples}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_normal() (wass2s.was\_mme.WAS\_mme\_GradientBoosting static method)@\spxentry{calculate\_tercile\_probabilities\_normal()}\spxextra{wass2s.was\_mme.WAS\_mme\_GradientBoosting static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_GradientBoosting.calculate_tercile_probabilities_normal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_normal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_weibull\_min() (wass2s.was\_mme.WAS\_mme\_GradientBoosting static method)@\spxentry{calculate\_tercile\_probabilities\_weibull\_min()}\spxextra{wass2s.was\_mme.WAS\_mme\_GradientBoosting static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_GradientBoosting.calculate_tercile_probabilities_weibull_min}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_weibull\_min}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Weibull minimum\sphinxhyphen{}based method.
\begin{description}
\sphinxlineitem{Here, we assume:}\begin{itemize}
\item {} 
\sphinxAtStartPar
best\_guess is used as the location,

\item {} 
\sphinxAtStartPar
error\_std (sqrt(error\_variance)) as the scale, and

\item {} 
\sphinxAtStartPar
dof (degrees of freedom) as the shape parameter.

\end{itemize}

\end{description}
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{best\_guess}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Forecast or best guess values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{error\_variance}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Variance associated with forecast errors.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{first\_tercile}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} First tercile threshold values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{second\_tercile}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Second tercile threshold values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dof}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Shape parameter for the Weibull minimum distribution.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{pred\_prob} \textendash{} A 3 x n\_time array with probabilities for being below the first tercile,
between the first and second tercile, and above the second tercile.

\sphinxlineitem{Return type}
\sphinxAtStartPar
np.ndarray

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_model() (wass2s.was\_mme.WAS\_mme\_GradientBoosting method)@\spxentry{compute\_model()}\spxextra{wass2s.was\_mme.WAS\_mme\_GradientBoosting method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_GradientBoosting.compute_model}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_model}}}
{\sphinxparam{\DUrole{n}{X\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{X\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Fit the GradientBoostingRegressor on the training data and predict on X\_test.
The input data (xarray DataArrays) are assumed to have dimensions including ‘T’, ‘Y’, ‘X’.
The predictions are then reshaped back to (T, Y, X).

\end{fulllineitems}

\index{compute\_prob() (wass2s.was\_mme.WAS\_mme\_GradientBoosting method)@\spxentry{compute\_prob()}\spxextra{wass2s.was\_mme.WAS\_mme\_GradientBoosting method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_GradientBoosting.compute_prob}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_prob}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute tercile probabilities using the chosen distribution method.
Predictant is expected to be an xarray DataArray with dims (T, Y, X).

\end{fulllineitems}

\index{forecast() (wass2s.was\_mme.WAS\_mme\_GradientBoosting method)@\spxentry{forecast()}\spxextra{wass2s.was\_mme.WAS\_mme\_GradientBoosting method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_GradientBoosting.forecast}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{forecast}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det\_cross}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor\_for\_year}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Forecast method using a single MLP model.
Steps:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Standardize the predictor for the target year using hindcast climatology.

\item {} 
\sphinxAtStartPar
Fit the MLP (if not already fitted) on standardized hindcast data.

\item {} 
\sphinxAtStartPar
Predict for the target year.

\item {} 
\sphinxAtStartPar
Reconstruct predictions into original (T, Y, X) shape.

\item {} 
\sphinxAtStartPar
Reverse the standardization.

\item {} 
\sphinxAtStartPar
Compute tercile probabilities using the chosen distribution.

\end{itemize}

\end{fulllineitems}


\end{fulllineitems}

\index{WAS\_mme\_LGBM\_Boosting (class in wass2s.was\_mme)@\spxentry{WAS\_mme\_LGBM\_Boosting}\spxextra{class in wass2s.was\_mme}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_LGBM_Boosting}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_mme.}}\sphinxbfcode{\sphinxupquote{WAS\_mme\_LGBM\_Boosting}}}
{\sphinxparam{\DUrole{n}{n\_estimators}\DUrole{o}{=}\DUrole{default_value}{100}}\sphinxparamcomma \sphinxparam{\DUrole{n}{learning\_rate}\DUrole{o}{=}\DUrole{default_value}{0.1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{max\_depth}\DUrole{o}{=}\DUrole{default_value}{\sphinxhyphen{}1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{random\_state}\DUrole{o}{=}\DUrole{default_value}{42}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dist\_method}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}gamma\textquotesingle{}}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
LightGBM\sphinxhyphen{}based Multi\sphinxhyphen{}Model Ensemble (MME) forecasting.

\sphinxAtStartPar
This class implements a single\sphinxhyphen{}model forecasting approach using LightGBM’s LGBMRegressor
for deterministic predictions, with optional tercile probability calculations using
various statistical distributions.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{n\_estimators}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Number of boosting iterations. Default is 100.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{learning\_rate}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Learning rate for boosting. Default is 0.1.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{max\_depth}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Maximum tree depth (\sphinxhyphen{}1 for no limit). Default is \sphinxhyphen{}1.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{random\_state}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Seed for random number generation for reproducibility. Default is 42.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dist\_method}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Distribution method for tercile probability calculations
(‘t’, ‘gamma’, ‘nonparam’, ‘normal’, ‘lognormal’, ‘weibull\_min’).
Default is ‘gamma’.

\end{itemize}

\end{description}\end{quote}
\index{calculate\_tercile\_probabilities() (wass2s.was\_mme.WAS\_mme\_LGBM\_Boosting static method)@\spxentry{calculate\_tercile\_probabilities()}\spxextra{wass2s.was\_mme.WAS\_mme\_LGBM\_Boosting static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_LGBM_Boosting.calculate_tercile_probabilities}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Student’s t\sphinxhyphen{}based method

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_gamma() (wass2s.was\_mme.WAS\_mme\_LGBM\_Boosting static method)@\spxentry{calculate\_tercile\_probabilities\_gamma()}\spxextra{wass2s.was\_mme.WAS\_mme\_LGBM\_Boosting static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_LGBM_Boosting.calculate_tercile_probabilities_gamma}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_gamma}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T2}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Gamma\sphinxhyphen{}distribution based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_lognormal() (wass2s.was\_mme.WAS\_mme\_LGBM\_Boosting static method)@\spxentry{calculate\_tercile\_probabilities\_lognormal()}\spxextra{wass2s.was\_mme.WAS\_mme\_LGBM\_Boosting static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_LGBM_Boosting.calculate_tercile_probabilities_lognormal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_lognormal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Lognormal\sphinxhyphen{}distribution based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_nonparametric() (wass2s.was\_mme.WAS\_mme\_LGBM\_Boosting static method)@\spxentry{calculate\_tercile\_probabilities\_nonparametric()}\spxextra{wass2s.was\_mme.WAS\_mme\_LGBM\_Boosting static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_LGBM_Boosting.calculate_tercile_probabilities_nonparametric}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_nonparametric}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_samples}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Non\sphinxhyphen{}parametric method using historical error samples.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_normal() (wass2s.was\_mme.WAS\_mme\_LGBM\_Boosting static method)@\spxentry{calculate\_tercile\_probabilities\_normal()}\spxextra{wass2s.was\_mme.WAS\_mme\_LGBM\_Boosting static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_LGBM_Boosting.calculate_tercile_probabilities_normal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_normal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Normal\sphinxhyphen{}distribution based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_weibull\_min() (wass2s.was\_mme.WAS\_mme\_LGBM\_Boosting static method)@\spxentry{calculate\_tercile\_probabilities\_weibull\_min()}\spxextra{wass2s.was\_mme.WAS\_mme\_LGBM\_Boosting static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_LGBM_Boosting.calculate_tercile_probabilities_weibull_min}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_weibull\_min}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Weibull minimum\sphinxhyphen{}based method.
\begin{description}
\sphinxlineitem{Here, we assume:}\begin{itemize}
\item {} 
\sphinxAtStartPar
best\_guess is used as the location,

\item {} 
\sphinxAtStartPar
error\_std (sqrt(error\_variance)) as the scale, and

\item {} 
\sphinxAtStartPar
dof (degrees of freedom) as the shape parameter.

\end{itemize}

\end{description}
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{best\_guess}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Forecast or best guess values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{error\_variance}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Variance associated with forecast errors.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{first\_tercile}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} First tercile threshold values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{second\_tercile}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Second tercile threshold values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dof}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Shape parameter for the Weibull minimum distribution.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{pred\_prob} \textendash{} A 3 x n\_time array with probabilities for being below the first tercile,
between the first and second tercile, and above the second tercile.

\sphinxlineitem{Return type}
\sphinxAtStartPar
np.ndarray

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_model() (wass2s.was\_mme.WAS\_mme\_LGBM\_Boosting method)@\spxentry{compute\_model()}\spxextra{wass2s.was\_mme.WAS\_mme\_LGBM\_Boosting method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_LGBM_Boosting.compute_model}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_model}}}
{\sphinxparam{\DUrole{n}{X\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{X\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute deterministic hindcast using the LightGBM model.

\sphinxAtStartPar
Fits the LGBMRegressor on training data and predicts deterministic values for the test data.
Handles data stacking and NaN removal to ensure robust predictions.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Training predictor data with dimensions (T, M, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Training predictand data with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Testing predictor data with dimensions (T, M, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Testing predictand data with dimensions (T, Y, X).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{predicted\_da} \textendash{} Deterministic hindcast with dimensions (T, Y, X).

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_prob() (wass2s.was\_mme.WAS\_mme\_LGBM\_Boosting method)@\spxentry{compute\_prob()}\spxextra{wass2s.was\_mme.WAS\_mme\_LGBM\_Boosting method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_LGBM_Boosting.compute_prob}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_prob}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute tercile probabilities using the chosen distribution method.
Predictant is expected to be an xarray DataArray with dims (T, Y, X).

\end{fulllineitems}

\index{forecast() (wass2s.was\_mme.WAS\_mme\_LGBM\_Boosting method)@\spxentry{forecast()}\spxextra{wass2s.was\_mme.WAS\_mme\_LGBM\_Boosting method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_LGBM_Boosting.forecast}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{forecast}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det\_cross}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor\_for\_year}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Generate deterministic and probabilistic forecast for a target year using the LightGBM model.

\sphinxAtStartPar
Fits the LGBMRegressor on standardized hindcast data, predicts deterministic values for the target year,
reverses standardization, and computes tercile probabilities.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Observed predictand data with dimensions (T, Y, X) or (T, M, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} Start year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} End year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Deterministic hindcast data for training with dimensions (T, M, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det\_cross}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Deterministic hindcast data for error estimation with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictor\_for\_year}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Predictor data for the target year with dimensions (T, M, Y, X).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{result\_da} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} Deterministic forecast with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{hindcast\_prob} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} Tercile probabilities with dimensions (probability, T, Y, X), where probability
includes {[}‘PB’, ‘PN’, ‘PA’{]} (below\sphinxhyphen{}normal, normal, above\sphinxhyphen{}normal).

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{WAS\_mme\_MLP (class in wass2s.was\_mme)@\spxentry{WAS\_mme\_MLP}\spxextra{class in wass2s.was\_mme}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_MLP}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_mme.}}\sphinxbfcode{\sphinxupquote{WAS\_mme\_MLP}}}
{\sphinxparam{\DUrole{n}{hidden\_layer\_sizes}\DUrole{o}{=}\DUrole{default_value}{(10, 5)}}\sphinxparamcomma \sphinxparam{\DUrole{n}{activation}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}relu\textquotesingle{}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{solver}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}adam\textquotesingle{}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{max\_iter}\DUrole{o}{=}\DUrole{default_value}{200}}\sphinxparamcomma \sphinxparam{\DUrole{n}{alpha}\DUrole{o}{=}\DUrole{default_value}{0.01}}\sphinxparamcomma \sphinxparam{\DUrole{n}{random\_state}\DUrole{o}{=}\DUrole{default_value}{42}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dist\_method}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}gamma\textquotesingle{}}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
Multi\sphinxhyphen{}Layer Perceptron (MLP) for Multi\sphinxhyphen{}Model Ensemble (MME) forecasting.

\sphinxAtStartPar
This class implements a Multi\sphinxhyphen{}Layer Perceptron model using scikit\sphinxhyphen{}learn’s MLPRegressor
for deterministic forecasting, with optional tercile probability calculations using
various statistical distributions.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hidden\_layer\_sizes}} (\sphinxstyleliteralemphasis{\sphinxupquote{tuple}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Sizes of the hidden layers in the MLP (e.g., (10, 5)). Default is (10, 5).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{activation}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Activation function for the hidden layers (‘identity’, ‘logistic’, ‘tanh’, ‘relu’).
Default is ‘relu’.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{solver}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Optimization algorithm (‘lbfgs’, ‘sgd’, ‘adam’). Default is ‘adam’.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{max\_iter}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Maximum number of iterations for the solver. Default is 200.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{alpha}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} L2 regularization parameter. Default is 0.01.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{random\_state}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Seed for random number generation for reproducibility. Default is 42.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dist\_method}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Distribution method for tercile probability calculations (‘t’, ‘gamma’, ‘nonparam’, ‘normal’, ‘lognormal’, ‘weibull\_min’).
Default is ‘gamma’.

\end{itemize}

\end{description}\end{quote}
\index{calculate\_tercile\_probabilities() (wass2s.was\_mme.WAS\_mme\_MLP static method)@\spxentry{calculate\_tercile\_probabilities()}\spxextra{wass2s.was\_mme.WAS\_mme\_MLP static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_MLP.calculate_tercile_probabilities}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Student’s t\sphinxhyphen{}based method

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_gamma() (wass2s.was\_mme.WAS\_mme\_MLP static method)@\spxentry{calculate\_tercile\_probabilities\_gamma()}\spxextra{wass2s.was\_mme.WAS\_mme\_MLP static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_MLP.calculate_tercile_probabilities_gamma}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_gamma}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T2}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Gamma\sphinxhyphen{}distribution based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_lognormal() (wass2s.was\_mme.WAS\_mme\_MLP static method)@\spxentry{calculate\_tercile\_probabilities\_lognormal()}\spxextra{wass2s.was\_mme.WAS\_mme\_MLP static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_MLP.calculate_tercile_probabilities_lognormal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_lognormal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Lognormal\sphinxhyphen{}distribution based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_nonparametric() (wass2s.was\_mme.WAS\_mme\_MLP static method)@\spxentry{calculate\_tercile\_probabilities\_nonparametric()}\spxextra{wass2s.was\_mme.WAS\_mme\_MLP static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_MLP.calculate_tercile_probabilities_nonparametric}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_nonparametric}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_samples}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Non\sphinxhyphen{}parametric method using historical error samples.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_normal() (wass2s.was\_mme.WAS\_mme\_MLP static method)@\spxentry{calculate\_tercile\_probabilities\_normal()}\spxextra{wass2s.was\_mme.WAS\_mme\_MLP static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_MLP.calculate_tercile_probabilities_normal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_normal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Normal\sphinxhyphen{}distribution based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_weibull\_min() (wass2s.was\_mme.WAS\_mme\_MLP static method)@\spxentry{calculate\_tercile\_probabilities\_weibull\_min()}\spxextra{wass2s.was\_mme.WAS\_mme\_MLP static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_MLP.calculate_tercile_probabilities_weibull_min}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_weibull\_min}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Weibull minimum\sphinxhyphen{}based method.
\begin{description}
\sphinxlineitem{Here, we assume:}\begin{itemize}
\item {} 
\sphinxAtStartPar
best\_guess is used as the location,

\item {} 
\sphinxAtStartPar
error\_std (sqrt(error\_variance)) as the scale, and

\item {} 
\sphinxAtStartPar
dof (degrees of freedom) as the shape parameter.

\end{itemize}

\end{description}
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{best\_guess}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Forecast or best guess values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{error\_variance}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Variance associated with forecast errors.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{first\_tercile}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} First tercile threshold values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{second\_tercile}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Second tercile threshold values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dof}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Shape parameter for the Weibull minimum distribution.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{pred\_prob} \textendash{} A 3 x n\_time array with probabilities for being below the first tercile,
between the first and second tercile, and above the second tercile.

\sphinxlineitem{Return type}
\sphinxAtStartPar
np.ndarray

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_model() (wass2s.was\_mme.WAS\_mme\_MLP method)@\spxentry{compute\_model()}\spxextra{wass2s.was\_mme.WAS\_mme\_MLP method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_MLP.compute_model}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_model}}}
{\sphinxparam{\DUrole{n}{X\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{X\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute deterministic hindcast using the MLP model.

\sphinxAtStartPar
Fits the MLPRegressor on training data and predicts deterministic values for the test data.
Handles data stacking and NaN removal.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Training predictor data with dimensions (T, M, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Training predictand data with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Testing predictor data with dimensions (T, M, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Testing predictand data with dimensions (T, Y, X).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{predicted\_da} \textendash{} Deterministic hindcast with dimensions (T, Y, X).

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_prob() (wass2s.was\_mme.WAS\_mme\_MLP method)@\spxentry{compute\_prob()}\spxextra{wass2s.was\_mme.WAS\_mme\_MLP method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_MLP.compute_prob}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_prob}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute tercile probabilities for the hindcast using the chosen distribution method.
Predictant is an xarray DataArray with dims (T, Y, X).

\end{fulllineitems}

\index{forecast() (wass2s.was\_mme.WAS\_mme\_MLP method)@\spxentry{forecast()}\spxextra{wass2s.was\_mme.WAS\_mme\_MLP method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_MLP.forecast}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{forecast}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det\_cross}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor\_for\_year}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Generate deterministic and probabilistic forecast for a target year using the MLP model.

\sphinxAtStartPar
Fits the MLPRegressor on standardized hindcast data, predicts deterministic values for the target year,
reverses standardization, and computes tercile probabilities.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Observed predictand data with dimensions (T, Y, X) or (T, M, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} Start year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} End year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Deterministic hindcast data for training with dimensions (T, M, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det\_cross}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Deterministic hindcast data for error estimation with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictor\_for\_year}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Predictor data for the target year with dimensions (T, M, Y, X).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{result\_da} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} Deterministic forecast with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{hindcast\_prob} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} Tercile probabilities with dimensions (probability, T, Y, X), where probability
includes {[}‘PB’, ‘PN’, ‘PA’{]} (below\sphinxhyphen{}normal, normal, above\sphinxhyphen{}normal).

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{WAS\_mme\_StackXGboost\_Ml (class in wass2s.was\_mme)@\spxentry{WAS\_mme\_StackXGboost\_Ml}\spxextra{class in wass2s.was\_mme}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_StackXGboost_Ml}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_mme.}}\sphinxbfcode{\sphinxupquote{WAS\_mme\_StackXGboost\_Ml}}}
{\sphinxparam{\DUrole{n}{n\_estimators}\DUrole{o}{=}\DUrole{default_value}{100}}\sphinxparamcomma \sphinxparam{\DUrole{n}{max\_depth}\DUrole{o}{=}\DUrole{default_value}{3}}\sphinxparamcomma \sphinxparam{\DUrole{n}{learning\_rate}\DUrole{o}{=}\DUrole{default_value}{0.1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{random\_state}\DUrole{o}{=}\DUrole{default_value}{42}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dist\_method}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}gamma\textquotesingle{}}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
Stacking ensemble with XGBoost base model and Linear Regression meta\sphinxhyphen{}model for Multi\sphinxhyphen{}Model Ensemble (MME) forecasting.

\sphinxAtStartPar
This class implements a stacking ensemble using XGBRegressor as the base model,
with a LinearRegression meta\sphinxhyphen{}model, for deterministic forecasting and optional tercile probability calculations.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{n\_estimators}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Number of gradient boosted trees in XGBoost. Default is 100.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{max\_depth}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Maximum depth of each tree in XGBoost. Default is 3.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{learning\_rate}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Boosting learning rate for XGBoost. Default is 0.1.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{random\_state}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Seed for random number generation for reproducibility. Default is 42.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dist\_method}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Distribution method for tercile probability calculations
(‘t’, ‘gamma’, ‘nonparam’, ‘normal’, ‘lognormal’, ‘weibull\_min’). Default is ‘gamma’.

\end{itemize}

\end{description}\end{quote}
\index{calculate\_tercile\_probabilities() (wass2s.was\_mme.WAS\_mme\_StackXGboost\_Ml static method)@\spxentry{calculate\_tercile\_probabilities()}\spxextra{wass2s.was\_mme.WAS\_mme\_StackXGboost\_Ml static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_StackXGboost_Ml.calculate_tercile_probabilities}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Student’s t\sphinxhyphen{}based method

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_gamma() (wass2s.was\_mme.WAS\_mme\_StackXGboost\_Ml static method)@\spxentry{calculate\_tercile\_probabilities\_gamma()}\spxextra{wass2s.was\_mme.WAS\_mme\_StackXGboost\_Ml static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_StackXGboost_Ml.calculate_tercile_probabilities_gamma}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_gamma}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T2}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Gamma\sphinxhyphen{}distribution based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_lognormal() (wass2s.was\_mme.WAS\_mme\_StackXGboost\_Ml static method)@\spxentry{calculate\_tercile\_probabilities\_lognormal()}\spxextra{wass2s.was\_mme.WAS\_mme\_StackXGboost\_Ml static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_StackXGboost_Ml.calculate_tercile_probabilities_lognormal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_lognormal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Lognormal\sphinxhyphen{}distribution based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_nonparametric() (wass2s.was\_mme.WAS\_mme\_StackXGboost\_Ml static method)@\spxentry{calculate\_tercile\_probabilities\_nonparametric()}\spxextra{wass2s.was\_mme.WAS\_mme\_StackXGboost\_Ml static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_StackXGboost_Ml.calculate_tercile_probabilities_nonparametric}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_nonparametric}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_samples}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Non\sphinxhyphen{}parametric method using historical error samples.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_normal() (wass2s.was\_mme.WAS\_mme\_StackXGboost\_Ml static method)@\spxentry{calculate\_tercile\_probabilities\_normal()}\spxextra{wass2s.was\_mme.WAS\_mme\_StackXGboost\_Ml static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_StackXGboost_Ml.calculate_tercile_probabilities_normal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_normal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Normal\sphinxhyphen{}distribution based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_weibull\_min() (wass2s.was\_mme.WAS\_mme\_StackXGboost\_Ml static method)@\spxentry{calculate\_tercile\_probabilities\_weibull\_min()}\spxextra{wass2s.was\_mme.WAS\_mme\_StackXGboost\_Ml static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_StackXGboost_Ml.calculate_tercile_probabilities_weibull_min}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_weibull\_min}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Weibull minimum\sphinxhyphen{}based method.
\begin{description}
\sphinxlineitem{Here, we assume:}\begin{itemize}
\item {} 
\sphinxAtStartPar
best\_guess is used as the location,

\item {} 
\sphinxAtStartPar
error\_std (sqrt(error\_variance)) as the scale, and

\item {} 
\sphinxAtStartPar
dof (degrees of freedom) as the shape parameter.

\end{itemize}

\end{description}

\end{fulllineitems}

\index{compute\_model() (wass2s.was\_mme.WAS\_mme\_StackXGboost\_Ml method)@\spxentry{compute\_model()}\spxextra{wass2s.was\_mme.WAS\_mme\_StackXGboost\_Ml method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_StackXGboost_Ml.compute_model}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_model}}}
{\sphinxparam{\DUrole{n}{X\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{X\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Train a stacking regressor with XGBoost as the base model and
Linear Regression as the meta\sphinxhyphen{}model, then generate deterministic
predictions on X\_test.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Predictor training data with dimensions (T, Y, X, M) or (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Predictand training data with dimensions (T, Y, X, M) or (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Predictor testing data with dimensions (T, Y, X, M) or (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Predictand testing data with dimensions (T, Y, X, M) or (T, Y, X).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{predicted\_da} \textendash{} The predictions over X\_test in the original grid shape.

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_prob() (wass2s.was\_mme.WAS\_mme\_StackXGboost\_Ml method)@\spxentry{compute\_prob()}\spxextra{wass2s.was\_mme.WAS\_mme\_StackXGboost\_Ml method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_StackXGboost_Ml.compute_prob}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_prob}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute tercile probabilities using the chosen distribution method.
This method extracts the climatology terciles from Predictant over the period
{[}clim\_year\_start, clim\_year\_end{]}, computes an error variance (or uses error samples),
and then applies the chosen probability function.

\end{fulllineitems}

\index{forecast() (wass2s.was\_mme.WAS\_mme\_StackXGboost\_Ml method)@\spxentry{forecast()}\spxextra{wass2s.was\_mme.WAS\_mme\_StackXGboost\_Ml method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_StackXGboost_Ml.forecast}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{forecast}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det\_cross}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor\_for\_year}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Forecast method that uses the trained stacking ensemble to predict for a new year,
then computes tercile probabilities.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Historical predictand data.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} Start of the climatology period (e.g., 1981).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} End of the climatology period (e.g., 2010).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Deterministic hindcasts used for training (predictors).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det\_cross}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Deterministic hindcasts for cross\sphinxhyphen{}validation (for error estimation).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictor\_for\_year}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Predictor data for the target forecast year.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{result\_da} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} The deterministic forecast for the target year.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{hindcast\_prob} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} Tercile probability forecast for the target year.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{WAS\_mme\_Stack\_KNN\_Tree\_SVR (class in wass2s.was\_mme)@\spxentry{WAS\_mme\_Stack\_KNN\_Tree\_SVR}\spxextra{class in wass2s.was\_mme}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_KNN_Tree_SVR}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_mme.}}\sphinxbfcode{\sphinxupquote{WAS\_mme\_Stack\_KNN\_Tree\_SVR}}}
{\sphinxparam{\DUrole{n}{n\_neighbors}\DUrole{o}{=}\DUrole{default_value}{5}}\sphinxparamcomma \sphinxparam{\DUrole{n}{tree\_max\_depth}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{svr\_C}\DUrole{o}{=}\DUrole{default_value}{1.0}}\sphinxparamcomma \sphinxparam{\DUrole{n}{svr\_kernel}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}rbf\textquotesingle{}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{random\_state}\DUrole{o}{=}\DUrole{default_value}{42}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dist\_method}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}gamma\textquotesingle{}}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
Stacking ensemble with K\sphinxhyphen{}Nearest Neighbors and Decision Tree base models, and SVR meta\sphinxhyphen{}model for Multi\sphinxhyphen{}Model Ensemble (MME) forecasting.

\sphinxAtStartPar
This class implements a stacking ensemble using KNeighborsRegressor and DecisionTreeRegressor as base models,
with an SVR meta\sphinxhyphen{}model, for deterministic forecasting and optional tercile probability calculations.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{n\_neighbors}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Number of neighbors for K\sphinxhyphen{}Nearest Neighbors. Default is 5.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{tree\_max\_depth}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{None}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Maximum depth for the Decision Tree (None for no limit). Default is None.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{svr\_C}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Regularization parameter for SVR. Default is 1.0.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{svr\_kernel}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Kernel type for SVR (‘linear’, ‘poly’, ‘rbf’, ‘sigmoid’). Default is ‘rbf’.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{random\_state}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Seed for random number generation for reproducibility. Default is 42.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dist\_method}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Distribution method for tercile probability calculations
(‘t’, ‘gamma’, ‘nonparam’, ‘normal’, ‘lognormal’, ‘weibull\_min’). Default is ‘gamma’.

\end{itemize}

\end{description}\end{quote}
\index{calculate\_tercile\_probabilities() (wass2s.was\_mme.WAS\_mme\_Stack\_KNN\_Tree\_SVR static method)@\spxentry{calculate\_tercile\_probabilities()}\spxextra{wass2s.was\_mme.WAS\_mme\_Stack\_KNN\_Tree\_SVR static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_KNN_Tree_SVR.calculate_tercile_probabilities}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Student’s t\sphinxhyphen{}based method

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_gamma() (wass2s.was\_mme.WAS\_mme\_Stack\_KNN\_Tree\_SVR static method)@\spxentry{calculate\_tercile\_probabilities\_gamma()}\spxextra{wass2s.was\_mme.WAS\_mme\_Stack\_KNN\_Tree\_SVR static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_KNN_Tree_SVR.calculate_tercile_probabilities_gamma}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_gamma}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T2}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Gamma\sphinxhyphen{}distribution based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_lognormal() (wass2s.was\_mme.WAS\_mme\_Stack\_KNN\_Tree\_SVR static method)@\spxentry{calculate\_tercile\_probabilities\_lognormal()}\spxextra{wass2s.was\_mme.WAS\_mme\_Stack\_KNN\_Tree\_SVR static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_KNN_Tree_SVR.calculate_tercile_probabilities_lognormal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_lognormal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Lognormal\sphinxhyphen{}distribution based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_nonparametric() (wass2s.was\_mme.WAS\_mme\_Stack\_KNN\_Tree\_SVR static method)@\spxentry{calculate\_tercile\_probabilities\_nonparametric()}\spxextra{wass2s.was\_mme.WAS\_mme\_Stack\_KNN\_Tree\_SVR static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_KNN_Tree_SVR.calculate_tercile_probabilities_nonparametric}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_nonparametric}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_samples}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Non\sphinxhyphen{}parametric method using historical error samples.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_normal() (wass2s.was\_mme.WAS\_mme\_Stack\_KNN\_Tree\_SVR static method)@\spxentry{calculate\_tercile\_probabilities\_normal()}\spxextra{wass2s.was\_mme.WAS\_mme\_Stack\_KNN\_Tree\_SVR static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_KNN_Tree_SVR.calculate_tercile_probabilities_normal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_normal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Normal\sphinxhyphen{}distribution based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_weibull\_min() (wass2s.was\_mme.WAS\_mme\_Stack\_KNN\_Tree\_SVR static method)@\spxentry{calculate\_tercile\_probabilities\_weibull\_min()}\spxextra{wass2s.was\_mme.WAS\_mme\_Stack\_KNN\_Tree\_SVR static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_KNN_Tree_SVR.calculate_tercile_probabilities_weibull_min}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_weibull\_min}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Weibull minimum\sphinxhyphen{}based method.
\begin{description}
\sphinxlineitem{Here, we assume:}\begin{itemize}
\item {} 
\sphinxAtStartPar
best\_guess is used as the location,

\item {} 
\sphinxAtStartPar
error\_std (sqrt(error\_variance)) as the scale, and

\item {} 
\sphinxAtStartPar
dof (degrees of freedom) as the shape parameter.

\end{itemize}

\end{description}
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{best\_guess}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Forecast or best guess values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{error\_variance}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Variance associated with forecast errors.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{first\_tercile}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} First tercile threshold values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{second\_tercile}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Second tercile threshold values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dof}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Shape parameter for the Weibull minimum distribution.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{pred\_prob} \textendash{} A 3 x n\_time array with probabilities for being below the first tercile,
between the first and second tercile, and above the second tercile.

\sphinxlineitem{Return type}
\sphinxAtStartPar
np.ndarray

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_model() (wass2s.was\_mme.WAS\_mme\_Stack\_KNN\_Tree\_SVR method)@\spxentry{compute\_model()}\spxextra{wass2s.was\_mme.WAS\_mme\_Stack\_KNN\_Tree\_SVR method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_KNN_Tree_SVR.compute_model}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_model}}}
{\sphinxparam{\DUrole{n}{X\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{X\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute deterministic hindcast using the stacking ensemble of KNN and Decision Tree with an SVR meta\sphinxhyphen{}model.

\sphinxAtStartPar
Fits the stacking ensemble (KNeighborsRegressor and DecisionTreeRegressor base models with an SVR meta\sphinxhyphen{}model)
on training data and predicts deterministic values for the test data.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Training predictor data with dimensions (T, M, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Training predictand data with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Testing predictor data with dimensions (T, M, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Testing predictand data with dimensions (T, Y, X).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{predicted\_da} \textendash{} Deterministic hindcast with dimensions (T, Y, X).

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_prob() (wass2s.was\_mme.WAS\_mme\_Stack\_KNN\_Tree\_SVR method)@\spxentry{compute\_prob()}\spxextra{wass2s.was\_mme.WAS\_mme\_Stack\_KNN\_Tree\_SVR method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_KNN_Tree_SVR.compute_prob}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_prob}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute tercile probabilities using the chosen distribution method.
Predictant is expected to be an xarray DataArray with dimensions (T, Y, X).

\end{fulllineitems}

\index{forecast() (wass2s.was\_mme.WAS\_mme\_Stack\_KNN\_Tree\_SVR method)@\spxentry{forecast()}\spxextra{wass2s.was\_mme.WAS\_mme\_Stack\_KNN\_Tree\_SVR method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_KNN_Tree_SVR.forecast}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{forecast}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det\_cross}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor\_for\_year}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Generate deterministic and probabilistic forecast for a target year using the stacking ensemble.

\sphinxAtStartPar
Fits the stacking ensemble (KNN and Decision Tree base models with an SVR meta\sphinxhyphen{}model)
on standardized hindcast data, predicts deterministic values for the target year,
reverses standardization, and computes tercile probabilities.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Observed predictand data with dimensions (T, Y, X) or (T, M, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} Start year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} End year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Deterministic hindcast data for training with dimensions (T, M, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det\_cross}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Deterministic hindcast data for error estimation with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictor\_for\_year}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Predictor data for the target year with dimensions (T, M, Y, X).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{result\_da} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} Deterministic forecast with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{hindcast\_prob} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} Tercile probabilities with dimensions (probability, T, Y, X), where probability
includes {[}‘PB’, ‘PN’, ‘PA’{]} (below\sphinxhyphen{}normal, normal, above\sphinxhyphen{}normal).

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{WAS\_mme\_Stack\_Lasso\_RF\_MLP (class in wass2s.was\_mme)@\spxentry{WAS\_mme\_Stack\_Lasso\_RF\_MLP}\spxextra{class in wass2s.was\_mme}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_Lasso_RF_MLP}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_mme.}}\sphinxbfcode{\sphinxupquote{WAS\_mme\_Stack\_Lasso\_RF\_MLP}}}
{\sphinxparam{\DUrole{n}{lasso\_alpha}\DUrole{o}{=}\DUrole{default_value}{0.01}}\sphinxparamcomma \sphinxparam{\DUrole{n}{n\_estimators}\DUrole{o}{=}\DUrole{default_value}{100}}\sphinxparamcomma \sphinxparam{\DUrole{n}{mlp\_hidden\_layer\_sizes}\DUrole{o}{=}\DUrole{default_value}{(10, 5)}}\sphinxparamcomma \sphinxparam{\DUrole{n}{mlp\_activation}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}relu\textquotesingle{}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{mlp\_solver}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}adam\textquotesingle{}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{mlp\_max\_iter}\DUrole{o}{=}\DUrole{default_value}{200}}\sphinxparamcomma \sphinxparam{\DUrole{n}{mlp\_alpha}\DUrole{o}{=}\DUrole{default_value}{0.01}}\sphinxparamcomma \sphinxparam{\DUrole{n}{random\_state}\DUrole{o}{=}\DUrole{default_value}{42}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dist\_method}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}gamma\textquotesingle{}}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
Stacking ensemble with Lasso and Random Forest base models, and MLP meta\sphinxhyphen{}model for Multi\sphinxhyphen{}Model Ensemble (MME) forecasting.

\sphinxAtStartPar
This class implements a stacking ensemble using Lasso and RandomForestRegressor as base models,
with an MLPRegressor meta\sphinxhyphen{}model, for deterministic forecasting and optional tercile probability calculations.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{lasso\_alpha}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Regularization strength for the Lasso base model. Default is 0.01.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{n\_estimators}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Number of trees in the Random Forest base model. Default is 100.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mlp\_hidden\_layer\_sizes}} (\sphinxstyleliteralemphasis{\sphinxupquote{tuple}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Sizes of the hidden layers for the MLP meta\sphinxhyphen{}model (e.g., (10, 5)). Default is (10, 5).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mlp\_activation}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Activation function for the MLP (‘identity’, ‘logistic’, ‘tanh’, ‘relu’). Default is ‘relu’.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mlp\_solver}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Optimization algorithm for the MLP (‘lbfgs’, ‘sgd’, ‘adam’). Default is ‘adam’.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mlp\_max\_iter}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Maximum number of iterations for the MLP solver. Default is 200.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mlp\_alpha}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} L2 regularization parameter for the MLP. Default is 0.01.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{random\_state}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Seed for random number generation for reproducibility. Default is 42.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dist\_method}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Distribution method for tercile probability calculations
(‘t’, ‘gamma’, ‘nonparam’, ‘normal’, ‘lognormal’, ‘weibull\_min’).
Default is ‘gamma’.

\end{itemize}

\end{description}\end{quote}
\index{calculate\_tercile\_probabilities() (wass2s.was\_mme.WAS\_mme\_Stack\_Lasso\_RF\_MLP static method)@\spxentry{calculate\_tercile\_probabilities()}\spxextra{wass2s.was\_mme.WAS\_mme\_Stack\_Lasso\_RF\_MLP static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_Lasso_RF_MLP.calculate_tercile_probabilities}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Student’s t\sphinxhyphen{}based method

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_gamma() (wass2s.was\_mme.WAS\_mme\_Stack\_Lasso\_RF\_MLP static method)@\spxentry{calculate\_tercile\_probabilities\_gamma()}\spxextra{wass2s.was\_mme.WAS\_mme\_Stack\_Lasso\_RF\_MLP static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_Lasso_RF_MLP.calculate_tercile_probabilities_gamma}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_gamma}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T2}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Gamma\sphinxhyphen{}distribution based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_lognormal() (wass2s.was\_mme.WAS\_mme\_Stack\_Lasso\_RF\_MLP static method)@\spxentry{calculate\_tercile\_probabilities\_lognormal()}\spxextra{wass2s.was\_mme.WAS\_mme\_Stack\_Lasso\_RF\_MLP static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_Lasso_RF_MLP.calculate_tercile_probabilities_lognormal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_lognormal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Lognormal\sphinxhyphen{}distribution based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_nonparametric() (wass2s.was\_mme.WAS\_mme\_Stack\_Lasso\_RF\_MLP static method)@\spxentry{calculate\_tercile\_probabilities\_nonparametric()}\spxextra{wass2s.was\_mme.WAS\_mme\_Stack\_Lasso\_RF\_MLP static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_Lasso_RF_MLP.calculate_tercile_probabilities_nonparametric}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_nonparametric}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_samples}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Non\sphinxhyphen{}parametric method using historical error samples.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_normal() (wass2s.was\_mme.WAS\_mme\_Stack\_Lasso\_RF\_MLP static method)@\spxentry{calculate\_tercile\_probabilities\_normal()}\spxextra{wass2s.was\_mme.WAS\_mme\_Stack\_Lasso\_RF\_MLP static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_Lasso_RF_MLP.calculate_tercile_probabilities_normal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_normal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Normal\sphinxhyphen{}distribution based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_weibull\_min() (wass2s.was\_mme.WAS\_mme\_Stack\_Lasso\_RF\_MLP static method)@\spxentry{calculate\_tercile\_probabilities\_weibull\_min()}\spxextra{wass2s.was\_mme.WAS\_mme\_Stack\_Lasso\_RF\_MLP static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_Lasso_RF_MLP.calculate_tercile_probabilities_weibull_min}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_weibull\_min}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Weibull minimum\sphinxhyphen{}based method.
\begin{description}
\sphinxlineitem{Here, we assume:}\begin{itemize}
\item {} 
\sphinxAtStartPar
best\_guess is used as the location,

\item {} 
\sphinxAtStartPar
error\_std (sqrt(error\_variance)) as the scale, and

\item {} 
\sphinxAtStartPar
dof (degrees of freedom) as the shape parameter.

\end{itemize}

\end{description}
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{best\_guess}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Forecast or best guess values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{error\_variance}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Variance associated with forecast errors.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{first\_tercile}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} First tercile threshold values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{second\_tercile}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Second tercile threshold values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dof}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Shape parameter for the Weibull minimum distribution.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{pred\_prob} \textendash{} A 3 x n\_time array with probabilities for being below the first tercile,
between the first and second tercile, and above the second tercile.

\sphinxlineitem{Return type}
\sphinxAtStartPar
np.ndarray

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_model() (wass2s.was\_mme.WAS\_mme\_Stack\_Lasso\_RF\_MLP method)@\spxentry{compute\_model()}\spxextra{wass2s.was\_mme.WAS\_mme\_Stack\_Lasso\_RF\_MLP method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_Lasso_RF_MLP.compute_model}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_model}}}
{\sphinxparam{\DUrole{n}{X\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{X\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute deterministic hindcast using the stacking ensemble of Lasso and Random Forest with an MLP meta\sphinxhyphen{}model.

\sphinxAtStartPar
Fits the stacking ensemble (Lasso and Random Forest base models with an MLPRegressor meta\sphinxhyphen{}model)
on training data and predicts deterministic values for the test data.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Training predictor data with dimensions (T, M, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Training predictand data with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Testing predictor data with dimensions (T, M, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Testing predictand data with dimensions (T, Y, X).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{predicted\_da} \textendash{} Deterministic hindcast with dimensions (T, Y, X).

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_prob() (wass2s.was\_mme.WAS\_mme\_Stack\_Lasso\_RF\_MLP method)@\spxentry{compute\_prob()}\spxextra{wass2s.was\_mme.WAS\_mme\_Stack\_Lasso\_RF\_MLP method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_Lasso_RF_MLP.compute_prob}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_prob}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute tercile probabilities using the chosen distribution method.
Predictant should be an xarray DataArray with dims (T, Y, X).

\end{fulllineitems}

\index{forecast() (wass2s.was\_mme.WAS\_mme\_Stack\_Lasso\_RF\_MLP method)@\spxentry{forecast()}\spxextra{wass2s.was\_mme.WAS\_mme\_Stack\_Lasso\_RF\_MLP method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_Lasso_RF_MLP.forecast}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{forecast}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det\_cross}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor\_for\_year}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Generate deterministic and probabilistic forecast for a target year using the stacking ensemble.

\sphinxAtStartPar
Fits the stacking ensemble (Lasso and Random Forest base models with an MLPRegressor meta\sphinxhyphen{}model)
on standardized hindcast data, predicts deterministic values for the target year,
reverses standardization, and computes tercile probabilities.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Observed predictand data with dimensions (T, Y, X) or (T, M, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} Start year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} End year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Deterministic hindcast data for training with dimensions (T, M, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det\_cross}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Deterministic hindcast data for error estimation with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictor\_for\_year}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Predictor data for the target year with dimensions (T, M, Y, X).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{result\_da} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} Deterministic forecast with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{hindcast\_prob} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} Tercile probabilities with dimensions (probability, T, Y, X), where probability
includes {[}‘PB’, ‘PN’, ‘PA’{]} (below\sphinxhyphen{}normal, normal, above\sphinxhyphen{}normal).

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{WAS\_mme\_Stack\_MLP\_Ada\_Ridge (class in wass2s.was\_mme)@\spxentry{WAS\_mme\_Stack\_MLP\_Ada\_Ridge}\spxextra{class in wass2s.was\_mme}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_MLP_Ada_Ridge}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_mme.}}\sphinxbfcode{\sphinxupquote{WAS\_mme\_Stack\_MLP\_Ada\_Ridge}}}
{\sphinxparam{\DUrole{n}{hidden\_layer\_sizes}\DUrole{o}{=}\DUrole{default_value}{(10, 5)}}\sphinxparamcomma \sphinxparam{\DUrole{n}{activation}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}relu\textquotesingle{}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{max\_iter}\DUrole{o}{=}\DUrole{default_value}{200}}\sphinxparamcomma \sphinxparam{\DUrole{n}{solver}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}adam\textquotesingle{}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{mlp\_alpha}\DUrole{o}{=}\DUrole{default_value}{0.01}}\sphinxparamcomma \sphinxparam{\DUrole{n}{n\_estimators\_adaboost}\DUrole{o}{=}\DUrole{default_value}{50}}\sphinxparamcomma \sphinxparam{\DUrole{n}{ridge\_alpha}\DUrole{o}{=}\DUrole{default_value}{1.0}}\sphinxparamcomma \sphinxparam{\DUrole{n}{random\_state}\DUrole{o}{=}\DUrole{default_value}{42}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dist\_method}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}gamma\textquotesingle{}}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
Stacking ensemble with MLP and AdaBoost base models, and Ridge meta\sphinxhyphen{}model for Multi\sphinxhyphen{}Model Ensemble (MME) forecasting.

\sphinxAtStartPar
This class implements a stacking ensemble using MLPRegressor and AdaBoostRegressor as base models,
with a Ridge meta\sphinxhyphen{}model, for deterministic forecasting and optional tercile probability calculations.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hidden\_layer\_sizes}} (\sphinxstyleliteralemphasis{\sphinxupquote{tuple}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Sizes of the hidden layers for the MLP base model (e.g., (10, 5)). Default is (10, 5).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{activation}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Activation function for the MLP (‘identity’, ‘logistic’, ‘tanh’, ‘relu’). Default is ‘relu’.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{max\_iter}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Maximum number of iterations for the MLP solver. Default is 200.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{solver}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Optimization algorithm for the MLP (‘lbfgs’, ‘sgd’, ‘adam’). Default is ‘adam’.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{mlp\_alpha}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} L2 regularization parameter for the MLP. Default is 0.01.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{n\_estimators\_adaboost}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Number of boosting iterations for AdaBoost. Default is 50.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{ridge\_alpha}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Regularization strength for the Ridge meta\sphinxhyphen{}model. Default is 1.0.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{random\_state}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Seed for random number generation for reproducibility. Default is 42.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dist\_method}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Distribution method for tercile probability calculations
(‘t’, ‘gamma’, ‘nonparam’, ‘normal’, ‘lognormal’, ‘weibull\_min’). Default is ‘gamma’.

\end{itemize}

\end{description}\end{quote}
\index{calculate\_tercile\_probabilities() (wass2s.was\_mme.WAS\_mme\_Stack\_MLP\_Ada\_Ridge static method)@\spxentry{calculate\_tercile\_probabilities()}\spxextra{wass2s.was\_mme.WAS\_mme\_Stack\_MLP\_Ada\_Ridge static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_MLP_Ada_Ridge.calculate_tercile_probabilities}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Student’s t\sphinxhyphen{}based method

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_gamma() (wass2s.was\_mme.WAS\_mme\_Stack\_MLP\_Ada\_Ridge static method)@\spxentry{calculate\_tercile\_probabilities\_gamma()}\spxextra{wass2s.was\_mme.WAS\_mme\_Stack\_MLP\_Ada\_Ridge static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_MLP_Ada_Ridge.calculate_tercile_probabilities_gamma}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_gamma}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T2}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Gamma\sphinxhyphen{}distribution based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_lognormal() (wass2s.was\_mme.WAS\_mme\_Stack\_MLP\_Ada\_Ridge static method)@\spxentry{calculate\_tercile\_probabilities\_lognormal()}\spxextra{wass2s.was\_mme.WAS\_mme\_Stack\_MLP\_Ada\_Ridge static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_MLP_Ada_Ridge.calculate_tercile_probabilities_lognormal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_lognormal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Lognormal\sphinxhyphen{}distribution based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_nonparametric() (wass2s.was\_mme.WAS\_mme\_Stack\_MLP\_Ada\_Ridge static method)@\spxentry{calculate\_tercile\_probabilities\_nonparametric()}\spxextra{wass2s.was\_mme.WAS\_mme\_Stack\_MLP\_Ada\_Ridge static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_MLP_Ada_Ridge.calculate_tercile_probabilities_nonparametric}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_nonparametric}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_samples}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Non\sphinxhyphen{}parametric method using historical error samples.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_normal() (wass2s.was\_mme.WAS\_mme\_Stack\_MLP\_Ada\_Ridge static method)@\spxentry{calculate\_tercile\_probabilities\_normal()}\spxextra{wass2s.was\_mme.WAS\_mme\_Stack\_MLP\_Ada\_Ridge static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_MLP_Ada_Ridge.calculate_tercile_probabilities_normal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_normal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Normal\sphinxhyphen{}distribution based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_weibull\_min() (wass2s.was\_mme.WAS\_mme\_Stack\_MLP\_Ada\_Ridge static method)@\spxentry{calculate\_tercile\_probabilities\_weibull\_min()}\spxextra{wass2s.was\_mme.WAS\_mme\_Stack\_MLP\_Ada\_Ridge static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_MLP_Ada_Ridge.calculate_tercile_probabilities_weibull_min}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_weibull\_min}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Weibull minimum\sphinxhyphen{}based method.
\begin{description}
\sphinxlineitem{Here, we assume:}\begin{itemize}
\item {} 
\sphinxAtStartPar
best\_guess is used as the location,

\item {} 
\sphinxAtStartPar
error\_std (sqrt(error\_variance)) as the scale, and

\item {} 
\sphinxAtStartPar
dof (degrees of freedom) as the shape parameter.

\end{itemize}

\end{description}
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{best\_guess}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Forecast or best guess values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{error\_variance}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Variance associated with forecast errors.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{first\_tercile}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} First tercile threshold values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{second\_tercile}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Second tercile threshold values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dof}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Shape parameter for the Weibull minimum distribution.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{pred\_prob} \textendash{} A 3 x n\_time array with probabilities for being below the first tercile,
between the first and second tercile, and above the second tercile.

\sphinxlineitem{Return type}
\sphinxAtStartPar
np.ndarray

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_model() (wass2s.was\_mme.WAS\_mme\_Stack\_MLP\_Ada\_Ridge method)@\spxentry{compute\_model()}\spxextra{wass2s.was\_mme.WAS\_mme\_Stack\_MLP\_Ada\_Ridge method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_MLP_Ada_Ridge.compute_model}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_model}}}
{\sphinxparam{\DUrole{n}{X\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{X\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute deterministic hindcast using the stacking ensemble of MLP and AdaBoost with a Ridge meta\sphinxhyphen{}model.

\sphinxAtStartPar
Fits the stacking ensemble (MLP and AdaBoost base models with a Ridge meta\sphinxhyphen{}model)
on training data and predicts deterministic values for the test data.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Training predictor data with dimensions (T, M, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Training predictand data with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Testing predictor data with dimensions (T, M, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Testing predictand data with dimensions (T, Y, X).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{predicted\_da} \textendash{} Deterministic hindcast with dimensions (T, Y, X).

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_prob() (wass2s.was\_mme.WAS\_mme\_Stack\_MLP\_Ada\_Ridge method)@\spxentry{compute\_prob()}\spxextra{wass2s.was\_mme.WAS\_mme\_Stack\_MLP\_Ada\_Ridge method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_MLP_Ada_Ridge.compute_prob}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_prob}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute tercile probabilities using the chosen distribution method.
Predictant is expected to be an xarray DataArray with dims (T, Y, X).

\end{fulllineitems}

\index{forecast() (wass2s.was\_mme.WAS\_mme\_Stack\_MLP\_Ada\_Ridge method)@\spxentry{forecast()}\spxextra{wass2s.was\_mme.WAS\_mme\_Stack\_MLP\_Ada\_Ridge method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_MLP_Ada_Ridge.forecast}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{forecast}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det\_cross}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor\_for\_year}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Generate deterministic and probabilistic forecast for a target year using the stacking ensemble.

\sphinxAtStartPar
Fits the stacking ensemble (MLP and AdaBoost base models with a Ridge meta\sphinxhyphen{}model)
on standardized hindcast data, predicts deterministic values for the target year,
reverses standardization, and computes tercile probabilities.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Observed predictand data with dimensions (T, Y, X) or (T, M, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} Start year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} End year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Deterministic hindcast data for training with dimensions (T, M, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det\_cross}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Deterministic hindcast data for error estimation with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictor\_for\_year}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Predictor data for the target year with dimensions (T, M, Y, X).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{result\_da} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} Deterministic forecast with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{hindcast\_prob} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} Tercile probabilities with dimensions (probability, T, Y, X), where probability
includes {[}‘PB’, ‘PN’, ‘PA’{]} (below\sphinxhyphen{}normal, normal, above\sphinxhyphen{}normal).

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{WAS\_mme\_Stack\_MLP\_RF (class in wass2s.was\_mme)@\spxentry{WAS\_mme\_Stack\_MLP\_RF}\spxextra{class in wass2s.was\_mme}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_MLP_RF}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_mme.}}\sphinxbfcode{\sphinxupquote{WAS\_mme\_Stack\_MLP\_RF}}}
{\sphinxparam{\DUrole{n}{hidden\_layer\_sizes}\DUrole{o}{=}\DUrole{default_value}{(10, 5)}}\sphinxparamcomma \sphinxparam{\DUrole{n}{activation}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}relu\textquotesingle{}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{max\_iter}\DUrole{o}{=}\DUrole{default_value}{200}}\sphinxparamcomma \sphinxparam{\DUrole{n}{solver}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}adam\textquotesingle{}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{random\_state}\DUrole{o}{=}\DUrole{default_value}{42}}\sphinxparamcomma \sphinxparam{\DUrole{n}{alpha}\DUrole{o}{=}\DUrole{default_value}{0.01}}\sphinxparamcomma \sphinxparam{\DUrole{n}{n\_estimators}\DUrole{o}{=}\DUrole{default_value}{100}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dist\_method}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}gamma\textquotesingle{}}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
Stacking ensemble with MLP and Random Forest for Multi\sphinxhyphen{}Model Ensemble (MME) forecasting.

\sphinxAtStartPar
This class implements a stacking ensemble using MLPRegressor and RandomForestRegressor as base models,
with a LinearRegression meta\sphinxhyphen{}model, for deterministic forecasting and optional tercile probability calculations.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hidden\_layer\_sizes}} (\sphinxstyleliteralemphasis{\sphinxupquote{tuple}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Sizes of the hidden layers for the MLP base model (e.g., (10, 5)). Default is (10, 5).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{activation}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Activation function for the MLP (‘identity’, ‘logistic’, ‘tanh’, ‘relu’). Default is ‘relu’.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{max\_iter}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Maximum number of iterations for the MLP solver. Default is 200.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{solver}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Optimization algorithm for the MLP (‘lbfgs’, ‘sgd’, ‘adam’). Default is ‘adam’.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{random\_state}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Seed for random number generation for reproducibility. Default is 42.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{alpha}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} L2 regularization parameter for the MLP. Default is 0.01.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{n\_estimators}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Number of trees in the Random Forest base model. Default is 100.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dist\_method}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Distribution method for tercile probability calculations
(‘t’, ‘gamma’, ‘nonparam’, ‘normal’, ‘lognormal’, ‘weibull\_min’).
Default is ‘gamma’.

\end{itemize}

\end{description}\end{quote}
\index{calculate\_tercile\_probabilities() (wass2s.was\_mme.WAS\_mme\_Stack\_MLP\_RF static method)@\spxentry{calculate\_tercile\_probabilities()}\spxextra{wass2s.was\_mme.WAS\_mme\_Stack\_MLP\_RF static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_MLP_RF.calculate_tercile_probabilities}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Student’s t\sphinxhyphen{}based method

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_gamma() (wass2s.was\_mme.WAS\_mme\_Stack\_MLP\_RF static method)@\spxentry{calculate\_tercile\_probabilities\_gamma()}\spxextra{wass2s.was\_mme.WAS\_mme\_Stack\_MLP\_RF static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_MLP_RF.calculate_tercile_probabilities_gamma}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_gamma}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T2}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Gamma\sphinxhyphen{}distribution based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_lognormal() (wass2s.was\_mme.WAS\_mme\_Stack\_MLP\_RF static method)@\spxentry{calculate\_tercile\_probabilities\_lognormal()}\spxextra{wass2s.was\_mme.WAS\_mme\_Stack\_MLP\_RF static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_MLP_RF.calculate_tercile_probabilities_lognormal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_lognormal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Lognormal\sphinxhyphen{}distribution based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_nonparametric() (wass2s.was\_mme.WAS\_mme\_Stack\_MLP\_RF static method)@\spxentry{calculate\_tercile\_probabilities\_nonparametric()}\spxextra{wass2s.was\_mme.WAS\_mme\_Stack\_MLP\_RF static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_MLP_RF.calculate_tercile_probabilities_nonparametric}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_nonparametric}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_samples}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Non\sphinxhyphen{}parametric method using historical error samples.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_normal() (wass2s.was\_mme.WAS\_mme\_Stack\_MLP\_RF static method)@\spxentry{calculate\_tercile\_probabilities\_normal()}\spxextra{wass2s.was\_mme.WAS\_mme\_Stack\_MLP\_RF static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_MLP_RF.calculate_tercile_probabilities_normal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_normal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Normal\sphinxhyphen{}distribution based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_weibull\_min() (wass2s.was\_mme.WAS\_mme\_Stack\_MLP\_RF static method)@\spxentry{calculate\_tercile\_probabilities\_weibull\_min()}\spxextra{wass2s.was\_mme.WAS\_mme\_Stack\_MLP\_RF static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_MLP_RF.calculate_tercile_probabilities_weibull_min}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_weibull\_min}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Weibull minimum\sphinxhyphen{}based method.
\begin{description}
\sphinxlineitem{Here, we assume:}\begin{itemize}
\item {} 
\sphinxAtStartPar
best\_guess is used as the location,

\item {} 
\sphinxAtStartPar
error\_std (sqrt(error\_variance)) as the scale, and

\item {} 
\sphinxAtStartPar
dof (degrees of freedom) as the shape parameter.

\end{itemize}

\end{description}
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{best\_guess}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Forecast or best guess values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{error\_variance}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Variance associated with forecast errors.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{first\_tercile}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} First tercile threshold values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{second\_tercile}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Second tercile threshold values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dof}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Shape parameter for the Weibull minimum distribution.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{pred\_prob} \textendash{} A 3 x n\_time array with probabilities for being below the first tercile,
between the first and second tercile, and above the second tercile.

\sphinxlineitem{Return type}
\sphinxAtStartPar
np.ndarray

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_model() (wass2s.was\_mme.WAS\_mme\_Stack\_MLP\_RF method)@\spxentry{compute\_model()}\spxextra{wass2s.was\_mme.WAS\_mme\_Stack\_MLP\_RF method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_MLP_RF.compute_model}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_model}}}
{\sphinxparam{\DUrole{n}{X\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{X\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute deterministic hindcast using the stacking ensemble of MLP and Random Forest.

\sphinxAtStartPar
Fits the stacking ensemble (MLP and Random Forest base models with a LinearRegression meta\sphinxhyphen{}model)
on training data and predicts deterministic values for the test data.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Training predictor data with dimensions (T, M, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Training predictand data with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Testing predictor data with dimensions (T, M, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Testing predictand data with dimensions (T, Y, X).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{predicted\_da} \textendash{} Deterministic hindcast with dimensions (T, Y, X).

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_prob() (wass2s.was\_mme.WAS\_mme\_Stack\_MLP\_RF method)@\spxentry{compute\_prob()}\spxextra{wass2s.was\_mme.WAS\_mme\_Stack\_MLP\_RF method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_MLP_RF.compute_prob}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_prob}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute tercile probabilities using the chosen distribution method.
This method extracts the climatology terciles from Predictant over the period
{[}clim\_year\_start, clim\_year\_end{]}, computes an error variance (or uses error samples),
and then applies the chosen probability function.

\end{fulllineitems}

\index{forecast() (wass2s.was\_mme.WAS\_mme\_Stack\_MLP\_RF method)@\spxentry{forecast()}\spxextra{wass2s.was\_mme.WAS\_mme\_Stack\_MLP\_RF method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_MLP_RF.forecast}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{forecast}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det\_cross}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor\_for\_year}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Forecast method that uses the trained stacking ensemble to predict for a new year,
then computes tercile probabilities.

\end{fulllineitems}


\end{fulllineitems}

\index{WAS\_mme\_Stack\_RF\_GB\_Ridge (class in wass2s.was\_mme)@\spxentry{WAS\_mme\_Stack\_RF\_GB\_Ridge}\spxextra{class in wass2s.was\_mme}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_RF_GB_Ridge}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_mme.}}\sphinxbfcode{\sphinxupquote{WAS\_mme\_Stack\_RF\_GB\_Ridge}}}
{\sphinxparam{\DUrole{n}{n\_estimators\_rf}\DUrole{o}{=}\DUrole{default_value}{100}}\sphinxparamcomma \sphinxparam{\DUrole{n}{max\_depth\_rf}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{n\_estimators\_gb}\DUrole{o}{=}\DUrole{default_value}{100}}\sphinxparamcomma \sphinxparam{\DUrole{n}{learning\_rate\_gb}\DUrole{o}{=}\DUrole{default_value}{0.1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{ridge\_alpha}\DUrole{o}{=}\DUrole{default_value}{1.0}}\sphinxparamcomma \sphinxparam{\DUrole{n}{random\_state}\DUrole{o}{=}\DUrole{default_value}{42}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dist\_method}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}gamma\textquotesingle{}}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
Stacking ensemble with Random Forest and Gradient Boosting base models, and Ridge meta\sphinxhyphen{}model for Multi\sphinxhyphen{}Model Ensemble (MME) forecasting.

\sphinxAtStartPar
This class implements a stacking ensemble using RandomForestRegressor and GradientBoostingRegressor as base models,
with a Ridge meta\sphinxhyphen{}model, for deterministic forecasting and optional tercile probability calculations.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{n\_estimators\_rf}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Number of trees in the Random Forest base model. Default is 100.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{max\_depth\_rf}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{None}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Maximum depth for Random Forest trees (None for no limit). Default is None.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{n\_estimators\_gb}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Number of boosting iterations for Gradient Boosting. Default is 100.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{learning\_rate\_gb}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Learning rate for Gradient Boosting. Default is 0.1.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{ridge\_alpha}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Regularization strength for the Ridge meta\sphinxhyphen{}model. Default is 1.0.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{random\_state}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Seed for random number generation for reproducibility. Default is 42.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dist\_method}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Distribution method for tercile probability calculations
(‘t’, ‘gamma’, ‘nonparam’, ‘normal’, ‘lognormal’, ‘weibull\_min’). Default is ‘gamma’.

\end{itemize}

\end{description}\end{quote}
\index{calculate\_tercile\_probabilities() (wass2s.was\_mme.WAS\_mme\_Stack\_RF\_GB\_Ridge static method)@\spxentry{calculate\_tercile\_probabilities()}\spxextra{wass2s.was\_mme.WAS\_mme\_Stack\_RF\_GB\_Ridge static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_RF_GB_Ridge.calculate_tercile_probabilities}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Student’s t\sphinxhyphen{}based method

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_gamma() (wass2s.was\_mme.WAS\_mme\_Stack\_RF\_GB\_Ridge static method)@\spxentry{calculate\_tercile\_probabilities\_gamma()}\spxextra{wass2s.was\_mme.WAS\_mme\_Stack\_RF\_GB\_Ridge static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_RF_GB_Ridge.calculate_tercile_probabilities_gamma}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_gamma}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T2}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Gamma\sphinxhyphen{}distribution based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_lognormal() (wass2s.was\_mme.WAS\_mme\_Stack\_RF\_GB\_Ridge static method)@\spxentry{calculate\_tercile\_probabilities\_lognormal()}\spxextra{wass2s.was\_mme.WAS\_mme\_Stack\_RF\_GB\_Ridge static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_RF_GB_Ridge.calculate_tercile_probabilities_lognormal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_lognormal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Lognormal\sphinxhyphen{}distribution based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_nonparametric() (wass2s.was\_mme.WAS\_mme\_Stack\_RF\_GB\_Ridge static method)@\spxentry{calculate\_tercile\_probabilities\_nonparametric()}\spxextra{wass2s.was\_mme.WAS\_mme\_Stack\_RF\_GB\_Ridge static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_RF_GB_Ridge.calculate_tercile_probabilities_nonparametric}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_nonparametric}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_samples}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Non\sphinxhyphen{}parametric method using historical error samples.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_normal() (wass2s.was\_mme.WAS\_mme\_Stack\_RF\_GB\_Ridge static method)@\spxentry{calculate\_tercile\_probabilities\_normal()}\spxextra{wass2s.was\_mme.WAS\_mme\_Stack\_RF\_GB\_Ridge static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_RF_GB_Ridge.calculate_tercile_probabilities_normal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_normal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Normal\sphinxhyphen{}distribution based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_weibull\_min() (wass2s.was\_mme.WAS\_mme\_Stack\_RF\_GB\_Ridge static method)@\spxentry{calculate\_tercile\_probabilities\_weibull\_min()}\spxextra{wass2s.was\_mme.WAS\_mme\_Stack\_RF\_GB\_Ridge static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_RF_GB_Ridge.calculate_tercile_probabilities_weibull_min}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_weibull\_min}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Weibull minimum\sphinxhyphen{}based method.
\begin{description}
\sphinxlineitem{Here, we assume:}\begin{itemize}
\item {} 
\sphinxAtStartPar
best\_guess is used as the location,

\item {} 
\sphinxAtStartPar
error\_std (sqrt(error\_variance)) as the scale, and

\item {} 
\sphinxAtStartPar
dof (degrees of freedom) as the shape parameter.

\end{itemize}

\end{description}
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{best\_guess}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Forecast or best guess values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{error\_variance}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Variance associated with forecast errors.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{first\_tercile}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} First tercile threshold values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{second\_tercile}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Second tercile threshold values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dof}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Shape parameter for the Weibull minimum distribution.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{pred\_prob} \textendash{} A 3 x n\_time array with probabilities for being below the first tercile,
between the first and second tercile, and above the second tercile.

\sphinxlineitem{Return type}
\sphinxAtStartPar
np.ndarray

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_model() (wass2s.was\_mme.WAS\_mme\_Stack\_RF\_GB\_Ridge method)@\spxentry{compute\_model()}\spxextra{wass2s.was\_mme.WAS\_mme\_Stack\_RF\_GB\_Ridge method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_RF_GB_Ridge.compute_model}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_model}}}
{\sphinxparam{\DUrole{n}{X\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{X\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute deterministic hindcast using the stacking ensemble of Random Forest and Gradient Boosting with a Ridge meta\sphinxhyphen{}model.

\sphinxAtStartPar
Fits the stacking ensemble (Random Forest and Gradient Boosting base models with a Ridge meta\sphinxhyphen{}model)
on training data and predicts deterministic values for the test data.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Training predictor data with dimensions (T, M, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Training predictand data with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Testing predictor data with dimensions (T, M, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Testing predictand data with dimensions (T, Y, X).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{predicted\_da} \textendash{} Deterministic hindcast with dimensions (T, Y, X).

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_prob() (wass2s.was\_mme.WAS\_mme\_Stack\_RF\_GB\_Ridge method)@\spxentry{compute\_prob()}\spxextra{wass2s.was\_mme.WAS\_mme\_Stack\_RF\_GB\_Ridge method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_RF_GB_Ridge.compute_prob}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_prob}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute tercile probabilities for hindcasts based on the chosen distribution.
Predictant is an xarray DataArray with dims (T, Y, X).

\end{fulllineitems}

\index{forecast() (wass2s.was\_mme.WAS\_mme\_Stack\_RF\_GB\_Ridge method)@\spxentry{forecast()}\spxextra{wass2s.was\_mme.WAS\_mme\_Stack\_RF\_GB\_Ridge method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Stack_RF_GB_Ridge.forecast}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{forecast}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det\_cross}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor\_for\_year}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Generate deterministic and probabilistic forecast for a target year using the stacking ensemble.

\sphinxAtStartPar
Fits the stacking ensemble (Random Forest and Gradient Boosting base models with a Ridge meta\sphinxhyphen{}model)
on standardized hindcast data, predicts deterministic values for the target year,
reverses standardization, and computes tercile probabilities.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Observed predictand data with dimensions (T, Y, X) or (T, M, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} Start year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} End year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Deterministic hindcast data for training with dimensions (T, M, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det\_cross}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Deterministic hindcast data for error estimation with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictor\_for\_year}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Predictor data for the target year with dimensions (T, M, Y, X).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{result\_da} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} Deterministic forecast with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{hindcast\_prob} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} Tercile probabilities with dimensions (probability, T, Y, X), where probability
includes {[}‘PB’, ‘PN’, ‘PA’{]} (below\sphinxhyphen{}normal, normal, above\sphinxhyphen{}normal).

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{WAS\_mme\_Weighted (class in wass2s.was\_mme)@\spxentry{WAS\_mme\_Weighted}\spxextra{class in wass2s.was\_mme}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Weighted}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_mme.}}\sphinxbfcode{\sphinxupquote{WAS\_mme\_Weighted}}}
{\sphinxparam{\DUrole{n}{equal\_weighted}\DUrole{o}{=}\DUrole{default_value}{False}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dist\_method}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}gamma\textquotesingle{}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{metric}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}GROC\textquotesingle{}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{threshold}\DUrole{o}{=}\DUrole{default_value}{0.5}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
Weighted Multi\sphinxhyphen{}Model Ensemble (MME) for climate forecasting.

\sphinxAtStartPar
This class implements a weighted ensemble approach for combining multiple climate models,
supporting both equal weighting and score\sphinxhyphen{}based weighting. It also provides methods for
computing tercile probabilities using various statistical distributions.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{equal\_weighted}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} If True, use equal weights for all models; otherwise, use score\sphinxhyphen{}based weights. Default is False.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dist\_method}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Statistical distribution for probability calculations (‘t’, ‘gamma’, ‘normal’, ‘lognormal’,
‘weibull\_min’, ‘nonparam’). Default is ‘gamma’.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{metric}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Performance metric for weighting (‘MAE’, ‘Pearson’, ‘GROC’). Default is ‘GROC’.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{threshold}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Threshold for score transformation. Default is 0.5.

\end{itemize}

\end{description}\end{quote}
\index{calculate\_tercile\_probabilities() (wass2s.was\_mme.WAS\_mme\_Weighted static method)@\spxentry{calculate\_tercile\_probabilities()}\spxextra{wass2s.was\_mme.WAS\_mme\_Weighted static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Weighted.calculate_tercile_probabilities}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Student’s t\sphinxhyphen{}based method

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_gamma() (wass2s.was\_mme.WAS\_mme\_Weighted static method)@\spxentry{calculate\_tercile\_probabilities\_gamma()}\spxextra{wass2s.was\_mme.WAS\_mme\_Weighted static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Weighted.calculate_tercile_probabilities_gamma}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_gamma}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T2}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Gamma\sphinxhyphen{}distribution based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_lognormal() (wass2s.was\_mme.WAS\_mme\_Weighted static method)@\spxentry{calculate\_tercile\_probabilities\_lognormal()}\spxextra{wass2s.was\_mme.WAS\_mme\_Weighted static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Weighted.calculate_tercile_probabilities_lognormal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_lognormal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Lognormal\sphinxhyphen{}distribution based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_nonparametric() (wass2s.was\_mme.WAS\_mme\_Weighted static method)@\spxentry{calculate\_tercile\_probabilities\_nonparametric()}\spxextra{wass2s.was\_mme.WAS\_mme\_Weighted static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Weighted.calculate_tercile_probabilities_nonparametric}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_nonparametric}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_samples}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Non\sphinxhyphen{}parametric method using historical error samples.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_normal() (wass2s.was\_mme.WAS\_mme\_Weighted static method)@\spxentry{calculate\_tercile\_probabilities\_normal()}\spxextra{wass2s.was\_mme.WAS\_mme\_Weighted static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Weighted.calculate_tercile_probabilities_normal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_normal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Normal\sphinxhyphen{}distribution based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_weibull\_min() (wass2s.was\_mme.WAS\_mme\_Weighted static method)@\spxentry{calculate\_tercile\_probabilities\_weibull\_min()}\spxextra{wass2s.was\_mme.WAS\_mme\_Weighted static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Weighted.calculate_tercile_probabilities_weibull_min}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_weibull\_min}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Weibull minimum\sphinxhyphen{}based method.
\begin{description}
\sphinxlineitem{Here, we assume:}\begin{itemize}
\item {} 
\sphinxAtStartPar
best\_guess is used as the location,

\item {} 
\sphinxAtStartPar
error\_std (sqrt(error\_variance)) as the scale, and

\item {} 
\sphinxAtStartPar
dof (degrees of freedom) as the shape parameter.

\end{itemize}

\end{description}
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{best\_guess}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Forecast or best guess values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{error\_variance}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Variance associated with forecast errors.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{first\_tercile}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} First tercile threshold values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{second\_tercile}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Second tercile threshold values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dof}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Shape parameter for the Weibull minimum distribution.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{pred\_prob} \textendash{} A 3 x n\_time array with probabilities for being below the first tercile,
between the first and second tercile, and above the second tercile.

\sphinxlineitem{Return type}
\sphinxAtStartPar
np.ndarray

\end{description}\end{quote}

\end{fulllineitems}

\index{compute() (wass2s.was\_mme.WAS\_mme\_Weighted method)@\spxentry{compute()}\spxextra{wass2s.was\_mme.WAS\_mme\_Weighted method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Weighted.compute}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute}}}
{\sphinxparam{\DUrole{n}{rainfall}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hdcst}}\sphinxparamcomma \sphinxparam{\DUrole{n}{fcst}}\sphinxparamcomma \sphinxparam{\DUrole{n}{scores}}\sphinxparamcomma \sphinxparam{\DUrole{n}{complete}\DUrole{o}{=}\DUrole{default_value}{False}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute weighted hindcast and forecast using model scores.

\sphinxAtStartPar
This method calculates weighted averages of hindcast and forecast data based on model scores.
If \sphinxtitleref{complete} is True, missing values are filled with unweighted averages.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{rainfall}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Observed rainfall data with dimensions (T, Y, X, M).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hdcst}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Hindcast data with dimensions (T, M, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{fcst}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Forecast data with dimensions (T, M, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{scores}} (\sphinxstyleliteralemphasis{\sphinxupquote{dict}}) \textendash{} Dictionary mapping model names to score arrays.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{complete}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} If True, fill missing values with unweighted averages. Default is False.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{hindcast\_det} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} Weighted hindcast data with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{forecast\_det} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} Weighted forecast data with dimensions (T, Y, X).

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_prob() (wass2s.was\_mme.WAS\_mme\_Weighted method)@\spxentry{compute\_prob()}\spxextra{wass2s.was\_mme.WAS\_mme\_Weighted method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Weighted.compute_prob}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_prob}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute tercile probabilities for hindcast data.

\sphinxAtStartPar
Calculates tercile probabilities based on the specified distribution method, using
climatological terciles derived from the predictand data.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Observed predictand data with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} Start year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} End year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Deterministic hindcast data with dimensions (T, Y, X).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{hindcast\_prob} \textendash{} Tercile probabilities with dimensions (probability, T, Y, X).

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{forecast() (wass2s.was\_mme.WAS\_mme\_Weighted method)@\spxentry{forecast()}\spxextra{wass2s.was\_mme.WAS\_mme\_Weighted method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Weighted.forecast}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{forecast}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}\sphinxparamcomma \sphinxparam{\DUrole{n}{forecast\_det}}}
{}
\pysigstopsignatures
\end{fulllineitems}

\index{transform\_score() (wass2s.was\_mme.WAS\_mme\_Weighted method)@\spxentry{transform\_score()}\spxextra{wass2s.was\_mme.WAS\_mme\_Weighted method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_Weighted.transform_score}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{transform\_score}}}
{\sphinxparam{\DUrole{n}{score\_array}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Transform score array based on the chosen metric and threshold.

\sphinxAtStartPar
For ‘MAE’, scores below the threshold are set to 1, others to 0. For ‘Pearson’ or ‘GROC’,
scores above the threshold are set to 1, others to 0.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{score\_array}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Score array to transform.

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{transformed\_score} \textendash{} Transformed score array with binary weights.

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{WAS\_mme\_XGBoosting (class in wass2s.was\_mme)@\spxentry{WAS\_mme\_XGBoosting}\spxextra{class in wass2s.was\_mme}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_XGBoosting}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{class}\DUrole{w}{ }}}\sphinxcode{\sphinxupquote{wass2s.was\_mme.}}\sphinxbfcode{\sphinxupquote{WAS\_mme\_XGBoosting}}}
{\sphinxparam{\DUrole{n}{n\_estimators}\DUrole{o}{=}\DUrole{default_value}{100}}\sphinxparamcomma \sphinxparam{\DUrole{n}{learning\_rate}\DUrole{o}{=}\DUrole{default_value}{0.1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{max\_depth}\DUrole{o}{=}\DUrole{default_value}{3}}\sphinxparamcomma \sphinxparam{\DUrole{n}{random\_state}\DUrole{o}{=}\DUrole{default_value}{42}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dist\_method}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}gamma\textquotesingle{}}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Bases: \sphinxcode{\sphinxupquote{object}}

\sphinxAtStartPar
XGBoost\sphinxhyphen{}based Multi\sphinxhyphen{}Model Ensemble (MME) forecasting.

\sphinxAtStartPar
This class implements a single\sphinxhyphen{}model forecasting approach using XGBoost’s XGBRegressor
for deterministic predictions, with optional tercile probability calculations using
various statistical distributions.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{n\_estimators}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Number of boosting rounds. Default is 100.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{learning\_rate}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Learning rate for boosting. Default is 0.1.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{max\_depth}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Maximum tree depth for base learners. Default is 3.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{random\_state}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Seed for random number generation for reproducibility. Default is 42.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dist\_method}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Distribution method for tercile probability calculations
(‘t’, ‘gamma’, ‘nonparam’, ‘normal’, ‘lognormal’, ‘weibull\_min’).
Default is ‘gamma’.

\end{itemize}

\end{description}\end{quote}
\index{calculate\_tercile\_probabilities() (wass2s.was\_mme.WAS\_mme\_XGBoosting static method)@\spxentry{calculate\_tercile\_probabilities()}\spxextra{wass2s.was\_mme.WAS\_mme\_XGBoosting static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_XGBoosting.calculate_tercile_probabilities}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Student’s t\sphinxhyphen{}based method

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_gamma() (wass2s.was\_mme.WAS\_mme\_XGBoosting static method)@\spxentry{calculate\_tercile\_probabilities\_gamma()}\spxextra{wass2s.was\_mme.WAS\_mme\_XGBoosting static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_XGBoosting.calculate_tercile_probabilities_gamma}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_gamma}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T1}}\sphinxparamcomma \sphinxparam{\DUrole{n}{T2}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Gamma\sphinxhyphen{}distribution based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_lognormal() (wass2s.was\_mme.WAS\_mme\_XGBoosting static method)@\spxentry{calculate\_tercile\_probabilities\_lognormal()}\spxextra{wass2s.was\_mme.WAS\_mme\_XGBoosting static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_XGBoosting.calculate_tercile_probabilities_lognormal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_lognormal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Lognormal\sphinxhyphen{}distribution based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_nonparametric() (wass2s.was\_mme.WAS\_mme\_XGBoosting static method)@\spxentry{calculate\_tercile\_probabilities\_nonparametric()}\spxextra{wass2s.was\_mme.WAS\_mme\_XGBoosting static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_XGBoosting.calculate_tercile_probabilities_nonparametric}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_nonparametric}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_samples}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Non\sphinxhyphen{}parametric method using historical error samples.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_normal() (wass2s.was\_mme.WAS\_mme\_XGBoosting static method)@\spxentry{calculate\_tercile\_probabilities\_normal()}\spxextra{wass2s.was\_mme.WAS\_mme\_XGBoosting static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_XGBoosting.calculate_tercile_probabilities_normal}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_normal}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Normal\sphinxhyphen{}distribution based method.

\end{fulllineitems}

\index{calculate\_tercile\_probabilities\_weibull\_min() (wass2s.was\_mme.WAS\_mme\_XGBoosting static method)@\spxentry{calculate\_tercile\_probabilities\_weibull\_min()}\spxextra{wass2s.was\_mme.WAS\_mme\_XGBoosting static method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_XGBoosting.calculate_tercile_probabilities_weibull_min}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{\DUrole{k}{static}\DUrole{w}{ }}}\sphinxbfcode{\sphinxupquote{calculate\_tercile\_probabilities\_weibull\_min}}}
{\sphinxparam{\DUrole{n}{best\_guess}}\sphinxparamcomma \sphinxparam{\DUrole{n}{error\_variance}}\sphinxparamcomma \sphinxparam{\DUrole{n}{first\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{second\_tercile}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dof}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Weibull minimum\sphinxhyphen{}based method.
\begin{description}
\sphinxlineitem{Here, we assume:}\begin{itemize}
\item {} 
\sphinxAtStartPar
best\_guess is used as the location,

\item {} 
\sphinxAtStartPar
error\_std (sqrt(error\_variance)) as the scale, and

\item {} 
\sphinxAtStartPar
dof (degrees of freedom) as the shape parameter.

\end{itemize}

\end{description}
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{best\_guess}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Forecast or best guess values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{error\_variance}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Variance associated with forecast errors.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{first\_tercile}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} First tercile threshold values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{second\_tercile}} (\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Second tercile threshold values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dof}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{array\sphinxhyphen{}like}}) \textendash{} Shape parameter for the Weibull minimum distribution.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{pred\_prob} \textendash{} A 3 x n\_time array with probabilities for being below the first tercile,
between the first and second tercile, and above the second tercile.

\sphinxlineitem{Return type}
\sphinxAtStartPar
np.ndarray

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_model() (wass2s.was\_mme.WAS\_mme\_XGBoosting method)@\spxentry{compute\_model()}\spxextra{wass2s.was\_mme.WAS\_mme\_XGBoosting method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_XGBoosting.compute_model}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_model}}}
{\sphinxparam{\DUrole{n}{X\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_train}}\sphinxparamcomma \sphinxparam{\DUrole{n}{X\_test}}\sphinxparamcomma \sphinxparam{\DUrole{n}{y\_test}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute deterministic hindcast using the XGBoost model.

\sphinxAtStartPar
Fits the XGBRegressor on training data and predicts deterministic values for the test data.
Handles data stacking and NaN removal to ensure robust predictions.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Training predictor data with dimensions (T, M, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_train}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Training predictand data with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{X\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Testing predictor data with dimensions (T, M, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{y\_test}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Testing predictand data with dimensions (T, Y, X).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{predicted\_da} \textendash{} Deterministic hindcast with dimensions (T, Y, X).

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{compute\_prob() (wass2s.was\_mme.WAS\_mme\_XGBoosting method)@\spxentry{compute\_prob()}\spxextra{wass2s.was\_mme.WAS\_mme\_XGBoosting method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_XGBoosting.compute_prob}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{compute\_prob}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute tercile probabilities for hindcast data.

\sphinxAtStartPar
Calculates probabilities for below\sphinxhyphen{}normal, normal, and above\sphinxhyphen{}normal categories using
the specified distribution method, based on climatological terciles.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Observed predictand data with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} Start year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} End year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Deterministic hindcast data with dimensions (T, Y, X).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{hindcast\_prob} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} Tercile probabilities with dimensions (probability, T, Y, X), where probability
includes {[}‘PB’, ‘PN’, ‘PA’{]} (below\sphinxhyphen{}normal, normal, above\sphinxhyphen{}normal).

\item {} 
\sphinxAtStartPar
\sphinxstyleemphasis{Compute tercile probabilities using the chosen distribution method.}

\item {} 
\sphinxAtStartPar
\sphinxstyleemphasis{Predictant is expected to be an xarray DataArray with dims (T, Y, X).}

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{forecast() (wass2s.was\_mme.WAS\_mme\_XGBoosting method)@\spxentry{forecast()}\spxextra{wass2s.was\_mme.WAS\_mme\_XGBoosting method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.WAS_mme_XGBoosting.forecast}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxbfcode{\sphinxupquote{forecast}}}
{\sphinxparam{\DUrole{n}{Predictant}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hindcast\_det\_cross}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Predictor\_for\_year}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Generate deterministic and probabilistic forecast for a target year using the XGBoost model.

\sphinxAtStartPar
Fits the XGBRegressor on standardized hindcast data, predicts deterministic values for the target year,
reverses standardization, and computes tercile probabilities.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictant}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Observed predictand data with dimensions (T, Y, X) or (T, M, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} Start year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{clim\_year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{ or }}\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} End year of the climatology period.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Deterministic hindcast data for training with dimensions (T, M, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hindcast\_det\_cross}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Deterministic hindcast data for error estimation with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Predictor\_for\_year}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Predictor data for the target year with dimensions (T, M, Y, X).

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{result\_da} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} Deterministic forecast with dimensions (T, Y, X).

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{hindcast\_prob} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} Tercile probabilities with dimensions (probability, T, Y, X), where probability
includes {[}‘PB’, ‘PN’, ‘PA’{]} (below\sphinxhyphen{}normal, normal, above\sphinxhyphen{}normal).

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}

\index{myfill() (in module wass2s.was\_mme)@\spxentry{myfill()}\spxextra{in module wass2s.was\_mme}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.myfill}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{wass2s.was\_mme.}}\sphinxbfcode{\sphinxupquote{myfill}}}
{\sphinxparam{\DUrole{n}{all\_model\_fcst}}\sphinxparamcomma \sphinxparam{\DUrole{n}{obs}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Fill missing values in forecast data using random samples from observations.

\sphinxAtStartPar
This function fills NaN values in the forecast data by randomly sampling values from the observed
rainfall data along the time dimension.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{all\_model\_fcst}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Forecast data with dimensions (T, M, Y, X) containing possible NaN values.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{obs}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Observed rainfall data with dimensions (T, Y, X) used for filling NaNs.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{da\_filled\_random} \textendash{} Forecast data with NaN values filled using random samples from observations.

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{process\_datasets\_for\_mme() (in module wass2s.was\_mme)@\spxentry{process\_datasets\_for\_mme()}\spxextra{in module wass2s.was\_mme}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.process_datasets_for_mme}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{wass2s.was\_mme.}}\sphinxbfcode{\sphinxupquote{process\_datasets\_for\_mme}}}
{\sphinxparam{\DUrole{n}{rainfall}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hdcsted}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{fcsted}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{gcm}\DUrole{o}{=}\DUrole{default_value}{True}}\sphinxparamcomma \sphinxparam{\DUrole{n}{agroparam}\DUrole{o}{=}\DUrole{default_value}{False}}\sphinxparamcomma \sphinxparam{\DUrole{n}{Prob}\DUrole{o}{=}\DUrole{default_value}{False}}\sphinxparamcomma \sphinxparam{\DUrole{n}{ELM\_ELR}\DUrole{o}{=}\DUrole{default_value}{False}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dir\_to\_save\_model}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{best\_models}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{scores}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year\_start}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year\_end}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{model}\DUrole{o}{=}\DUrole{default_value}{True}}\sphinxparamcomma \sphinxparam{\DUrole{n}{month\_of\_initialization}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{lead\_time}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year\_forecast}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{score\_metric}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}GROC\textquotesingle{}}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Process hindcast and forecast datasets for a multi\sphinxhyphen{}model ensemble.

\sphinxAtStartPar
This function loads, interpolates, and concatenates hindcast and forecast datasets from various sources
(GCMs, agroparameters, or others) to prepare them for a multi\sphinxhyphen{}model ensemble. It supports different score
metrics and configurations for probabilistic or deterministic outputs.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{rainfall}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Observed rainfall data used for interpolation and masking.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hdcsted}} (\sphinxstyleliteralemphasis{\sphinxupquote{dict}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Dictionary of hindcast datasets for different models.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{fcsted}} (\sphinxstyleliteralemphasis{\sphinxupquote{dict}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Dictionary of forecast datasets for different models.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{gcm}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} If True, process data as GCM data. Default is True.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{agroparam}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} If True, process data as agroparameter data. Default is False.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{Prob}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} If True, process data as probabilistic forecasts. Default is False.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{ELM\_ELR}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} If True, use ELM\_ELR configuration for dimension renaming. Default is False.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dir\_to\_save\_model}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Directory path to load model data.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{best\_models}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} List of model names to include in the ensemble.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{scores}} (\sphinxstyleliteralemphasis{\sphinxupquote{dict}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Dictionary containing model scores, with the key specified by \sphinxtitleref{score\_metric}.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{year\_start}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Starting year for the data range.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{year\_end}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Ending year for the data range.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{model}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} If True, treat data as model\sphinxhyphen{}based. Default is True.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{month\_of\_initialization}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Month when the forecast is initialized.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{lead\_time}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Forecast lead time in months.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{year\_forecast}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Year for which the forecast is generated.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{score\_metric}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Metric used to organize scores (e.g., ‘Pearson’, ‘MAE’, ‘GROC’). Default is ‘GROC’.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{all\_model\_hdcst} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} Concatenated hindcast data across models.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{all\_model\_fcst} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} Concatenated forecast data across models.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{obs} (\sphinxstyleemphasis{xarray.DataArray}) \textendash{} Observed rainfall data expanded with a model dimension and masked.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{scores\_organized} (\sphinxstyleemphasis{dict}) \textendash{} Dictionary of organized scores for selected models.

\end{itemize}


\end{description}\end{quote}

\end{fulllineitems}

\index{process\_datasets\_for\_mme\_() (in module wass2s.was\_mme)@\spxentry{process\_datasets\_for\_mme\_()}\spxextra{in module wass2s.was\_mme}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.was_mme.process_datasets_for_mme_}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{wass2s.was\_mme.}}\sphinxbfcode{\sphinxupquote{process\_datasets\_for\_mme\_}}}
{\sphinxparam{\DUrole{n}{rainfall}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hdcsted}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{fcsted}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{gcm}\DUrole{o}{=}\DUrole{default_value}{True}}\sphinxparamcomma \sphinxparam{\DUrole{n}{agroparam}\DUrole{o}{=}\DUrole{default_value}{False}}\sphinxparamcomma \sphinxparam{\DUrole{n}{ELM\_ELR}\DUrole{o}{=}\DUrole{default_value}{False}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dir\_to\_save\_model}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{best\_models}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{scores}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year\_start}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year\_end}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{model}\DUrole{o}{=}\DUrole{default_value}{True}}\sphinxparamcomma \sphinxparam{\DUrole{n}{month\_of\_initialization}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{lead\_time}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year\_forecast}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\end{fulllineitems}



\subsection{wass2s.utils module}
\label{\detokenize{api:module-wass2s.utils}}\label{\detokenize{api:wass2s-utils-module}}\index{module@\spxentry{module}!wass2s.utils@\spxentry{wass2s.utils}}\index{wass2s.utils@\spxentry{wass2s.utils}!module@\spxentry{module}}\index{anomalize\_timeseries() (in module wass2s.utils)@\spxentry{anomalize\_timeseries()}\spxextra{in module wass2s.utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.utils.anomalize_timeseries}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{wass2s.utils.}}\sphinxbfcode{\sphinxupquote{anomalize\_timeseries}}}
{\sphinxparam{\DUrole{n}{ds}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\end{fulllineitems}

\index{build\_iridl\_url\_ersst() (in module wass2s.utils)@\spxentry{build\_iridl\_url\_ersst()}\spxextra{in module wass2s.utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.utils.build_iridl_url_ersst}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{wass2s.utils.}}\sphinxbfcode{\sphinxupquote{build\_iridl\_url\_ersst}}}
{\sphinxparam{\DUrole{n}{year\_start}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{int}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year\_end}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{int}}\sphinxparamcomma \sphinxparam{\DUrole{n}{bbox}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{list}}\sphinxparamcomma \sphinxparam{\DUrole{n}{run\_avg}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{int}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{3}}\sphinxparamcomma \sphinxparam{\DUrole{n}{month\_start}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{str}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{\textquotesingle{}Jan\textquotesingle{}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{month\_end}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{str}\DUrole{w}{ }\DUrole{o}{=}\DUrole{w}{ }\DUrole{default_value}{\textquotesingle{}Dec\textquotesingle{}}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Build a parameterized IRIDL URL for NOAA/ERSST, using a numeric bounding box
of the form {[}North, West, South, East{]}.
\begin{quote}

\sphinxAtStartPar
e.g. area = {[}10, \sphinxhyphen{}15, \sphinxhyphen{}5, 15{]}.
\end{quote}
\begin{description}
\sphinxlineitem{IRIDL wants Y/(south)/(north)/…, X/(west)/(east)/…, so we reorder:}\begin{itemize}
\item {} 
\sphinxAtStartPar
south = area{[}2{]}

\item {} 
\sphinxAtStartPar
north = area{[}0{]}

\item {} 
\sphinxAtStartPar
west  = area{[}1{]}

\item {} 
\sphinxAtStartPar
east  = area{[}3{]}

\end{itemize}

\end{description}

\sphinxAtStartPar
If run\_avg is provided, we’ll append T/\textless{}run\_avg\textgreater{}/runningAverage/.

\end{fulllineitems}

\index{compute\_other\_indices() (in module wass2s.utils)@\spxentry{compute\_other\_indices()}\spxextra{in module wass2s.utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.utils.compute_other_indices}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{wass2s.utils.}}\sphinxbfcode{\sphinxupquote{compute\_other\_indices}}}
{\sphinxparam{\DUrole{n}{dir\_to\_data}}\sphinxparamcomma \sphinxparam{\DUrole{n}{indices\_dict}}\sphinxparamcomma \sphinxparam{\DUrole{n}{variables\_list}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{season}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{model}\DUrole{o}{=}\DUrole{default_value}{False}}\sphinxparamcomma \sphinxparam{\DUrole{n}{month\_of\_initialization}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{lead\_time}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year\_forecast}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute indices for other variables.

\end{fulllineitems}

\index{compute\_sst\_indices() (in module wass2s.utils)@\spxentry{compute\_sst\_indices()}\spxextra{in module wass2s.utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.utils.compute_sst_indices}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{wass2s.utils.}}\sphinxbfcode{\sphinxupquote{compute\_sst\_indices}}}
{\sphinxparam{\DUrole{n}{dir\_to\_data}}\sphinxparamcomma \sphinxparam{\DUrole{n}{indices}}\sphinxparamcomma \sphinxparam{\DUrole{n}{variables\_list}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{season}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{others\_zone}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{model}\DUrole{o}{=}\DUrole{default_value}{False}}\sphinxparamcomma \sphinxparam{\DUrole{n}{month\_of\_initialization}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{lead\_time}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year\_forecast}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute SST indices for reanalysis or model data.

\end{fulllineitems}

\index{decode\_cf() (in module wass2s.utils)@\spxentry{decode\_cf()}\spxextra{in module wass2s.utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.utils.decode_cf}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{wass2s.utils.}}\sphinxbfcode{\sphinxupquote{decode\_cf}}}
{\sphinxparam{\DUrole{n}{ds}}\sphinxparamcomma \sphinxparam{\DUrole{n}{time\_var}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Decodes time dimension to CFTime standards.

\end{fulllineitems}

\index{download\_file() (in module wass2s.utils)@\spxentry{download\_file()}\spxextra{in module wass2s.utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.utils.download_file}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{wass2s.utils.}}\sphinxbfcode{\sphinxupquote{download\_file}}}
{\sphinxparam{\DUrole{n}{url}}\sphinxparamcomma \sphinxparam{\DUrole{n}{local\_path}}\sphinxparamcomma \sphinxparam{\DUrole{n}{force\_download}\DUrole{o}{=}\DUrole{default_value}{False}}\sphinxparamcomma \sphinxparam{\DUrole{n}{chunk\_size}\DUrole{o}{=}\DUrole{default_value}{8192}}\sphinxparamcomma \sphinxparam{\DUrole{n}{timeout}\DUrole{o}{=}\DUrole{default_value}{120}}}
{}
\pysigstopsignatures
\end{fulllineitems}

\index{find\_best\_distribution\_grid() (in module wass2s.utils)@\spxentry{find\_best\_distribution\_grid()}\spxextra{in module wass2s.utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.utils.find_best_distribution_grid}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{wass2s.utils.}}\sphinxbfcode{\sphinxupquote{find\_best\_distribution\_grid}}}
{\sphinxparam{\DUrole{n}{rainfall}}\sphinxparamcomma \sphinxparam{\DUrole{n}{distribution\_map}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Apply a function across the rainfall DataArray (assumed to have a ‘T’ dimension)
to determine the best\sphinxhyphen{}fitting distribution, returning a grid of numeric codes.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{rainfall}} (\sphinxstyleliteralemphasis{\sphinxupquote{xarray.DataArray}}) \textendash{} Precipitation data with a time dimension ‘T’ and additional spatial dimensions.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{distribution\_map}} (\sphinxstyleliteralemphasis{\sphinxupquote{dict}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} \begin{description}
\sphinxlineitem{A mapping of distribution names to numeric codes. Defaults to:}\begin{description}
\sphinxlineitem{\{}
\sphinxAtStartPar
‘norm’: 1,
‘lognorm’: 2,
‘expon’: 3,
‘gamma’: 4,
‘weibull\_min’: 5

\end{description}

\sphinxAtStartPar
\}

\end{description}


\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\sphinxstylestrong{best\_fit\_da} \textendash{} An array of the same spatial dimensions as rainfall with the best\sphinxhyphen{}fitting
distribution’s numeric code at each grid cell.

\sphinxlineitem{Return type}
\sphinxAtStartPar
xarray.DataArray

\end{description}\end{quote}

\end{fulllineitems}

\index{fix\_time\_coord() (in module wass2s.utils)@\spxentry{fix\_time\_coord()}\spxextra{in module wass2s.utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.utils.fix_time_coord}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{wass2s.utils.}}\sphinxbfcode{\sphinxupquote{fix\_time\_coord}}}
{\sphinxparam{\DUrole{n}{ds}}\sphinxparamcomma \sphinxparam{\DUrole{n}{seas}}}
{}
\pysigstopsignatures
\end{fulllineitems}

\index{get\_best\_models() (in module wass2s.utils)@\spxentry{get\_best\_models()}\spxextra{in module wass2s.utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.utils.get_best_models}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{wass2s.utils.}}\sphinxbfcode{\sphinxupquote{get\_best\_models}}}
{\sphinxparam{\DUrole{n}{center\_variable}}\sphinxparamcomma \sphinxparam{\DUrole{n}{scores}}\sphinxparamcomma \sphinxparam{\DUrole{n}{metric}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}MAE\textquotesingle{}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{threshold}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{top\_n}\DUrole{o}{=}\DUrole{default_value}{6}}\sphinxparamcomma \sphinxparam{\DUrole{n}{gcm}\DUrole{o}{=}\DUrole{default_value}{False}}\sphinxparamcomma \sphinxparam{\DUrole{n}{agroparam}\DUrole{o}{=}\DUrole{default_value}{False}}}
{}
\pysigstopsignatures
\end{fulllineitems}

\index{load\_gridded\_predictor() (in module wass2s.utils)@\spxentry{load\_gridded\_predictor()}\spxextra{in module wass2s.utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.utils.load_gridded_predictor}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{wass2s.utils.}}\sphinxbfcode{\sphinxupquote{load\_gridded\_predictor}}}
{\sphinxparam{\DUrole{n}{dir\_to\_data}}\sphinxparamcomma \sphinxparam{\DUrole{n}{variables\_list}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{season}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{model}\DUrole{o}{=}\DUrole{default_value}{False}}\sphinxparamcomma \sphinxparam{\DUrole{n}{month\_of\_initialization}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{lead\_time}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year\_forecast}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Load gridded predictor data for reanalysis or model.

\end{fulllineitems}

\index{parse\_variable() (in module wass2s.utils)@\spxentry{parse\_variable()}\spxextra{in module wass2s.utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.utils.parse_variable}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{wass2s.utils.}}\sphinxbfcode{\sphinxupquote{parse\_variable}}}
{\sphinxparam{\DUrole{n}{variables\_list}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Extract center and variable names from the variables list.

\end{fulllineitems}

\index{plot\_date() (in module wass2s.utils)@\spxentry{plot\_date()}\spxextra{in module wass2s.utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.utils.plot_date}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{wass2s.utils.}}\sphinxbfcode{\sphinxupquote{plot\_date}}}
{\sphinxparam{\DUrole{n}{A}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Plots ‘A’ on a map, interpreting the data values as
offsets from 2024\sphinxhyphen{}01\sphinxhyphen{}01. The colorbar ticks are then
converted to calendar dates.

\end{fulllineitems}

\index{plot\_map() (in module wass2s.utils)@\spxentry{plot\_map()}\spxextra{in module wass2s.utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.utils.plot_map}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{wass2s.utils.}}\sphinxbfcode{\sphinxupquote{plot\_map}}}
{\sphinxparam{\DUrole{n}{extent}}\sphinxparamcomma \sphinxparam{\DUrole{n}{title}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}Map\textquotesingle{}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{sst\_indices}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{fig\_size}\DUrole{o}{=}\DUrole{default_value}{(10, 8)}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Plots a map with specified geographic extent and optionally adds SST index boxes.

\sphinxAtStartPar
Parameters:
\sphinxhyphen{} extent: list of float, specifying {[}west, east, south, north{]}
\sphinxhyphen{} title: str, title of the map
\sphinxhyphen{} sst\_indices: dict, optional dictionary containing SST index information

\end{fulllineitems}

\index{plot\_prob\_forecasts() (in module wass2s.utils)@\spxentry{plot\_prob\_forecasts()}\spxextra{in module wass2s.utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.utils.plot_prob_forecasts}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{wass2s.utils.}}\sphinxbfcode{\sphinxupquote{plot\_prob\_forecasts}}}
{\sphinxparam{\DUrole{n}{dir\_to\_save}}\sphinxparamcomma \sphinxparam{\DUrole{n}{forecast\_prob}}\sphinxparamcomma \sphinxparam{\DUrole{n}{model\_name}}\sphinxparamcomma \sphinxparam{\DUrole{n}{labels}\DUrole{o}{=}\DUrole{default_value}{{[}\textquotesingle{}Below\sphinxhyphen{}Normal\textquotesingle{}, \textquotesingle{}Near\sphinxhyphen{}Normal\textquotesingle{}, \textquotesingle{}Above\sphinxhyphen{}Normal\textquotesingle{}{]}}}\sphinxparamcomma \sphinxparam{\DUrole{n}{reverse\_cmap}\DUrole{o}{=}\DUrole{default_value}{True}}}
{}
\pysigstopsignatures
\end{fulllineitems}

\index{plot\_prob\_forecasts\_() (in module wass2s.utils)@\spxentry{plot\_prob\_forecasts\_()}\spxextra{in module wass2s.utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.utils.plot_prob_forecasts_}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{wass2s.utils.}}\sphinxbfcode{\sphinxupquote{plot\_prob\_forecasts\_}}}
{\sphinxparam{\DUrole{n}{dir\_to\_save}}\sphinxparamcomma \sphinxparam{\DUrole{n}{forecast\_prob}}\sphinxparamcomma \sphinxparam{\DUrole{n}{model\_name}}}
{}
\pysigstopsignatures
\end{fulllineitems}

\index{plot\_tercile() (in module wass2s.utils)@\spxentry{plot\_tercile()}\spxextra{in module wass2s.utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.utils.plot_tercile}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{wass2s.utils.}}\sphinxbfcode{\sphinxupquote{plot\_tercile}}}
{\sphinxparam{\DUrole{n}{A}}}
{}
\pysigstopsignatures
\end{fulllineitems}

\index{predictant\_mask() (in module wass2s.utils)@\spxentry{predictant\_mask()}\spxextra{in module wass2s.utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.utils.predictant_mask}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{wass2s.utils.}}\sphinxbfcode{\sphinxupquote{predictant\_mask}}}
{\sphinxparam{\DUrole{n}{data}}}
{}
\pysigstopsignatures
\end{fulllineitems}

\index{prepare\_predictand() (in module wass2s.utils)@\spxentry{prepare\_predictand()}\spxextra{in module wass2s.utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.utils.prepare_predictand}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{wass2s.utils.}}\sphinxbfcode{\sphinxupquote{prepare\_predictand}}}
{\sphinxparam{\DUrole{n}{dir\_to\_save\_Obs}}\sphinxparamcomma \sphinxparam{\DUrole{n}{variables\_obs}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{season}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{ds}\DUrole{o}{=}\DUrole{default_value}{True}}\sphinxparamcomma \sphinxparam{\DUrole{n}{daily}\DUrole{o}{=}\DUrole{default_value}{False}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Prepare the predictand dataset.

\end{fulllineitems}

\index{process\_model\_for\_other\_params() (in module wass2s.utils)@\spxentry{process\_model\_for\_other\_params()}\spxextra{in module wass2s.utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.utils.process_model_for_other_params}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{wass2s.utils.}}\sphinxbfcode{\sphinxupquote{process\_model\_for\_other\_params}}}
{\sphinxparam{\DUrole{n}{agmParamModel}}\sphinxparamcomma \sphinxparam{\DUrole{n}{dir\_to\_save}}\sphinxparamcomma \sphinxparam{\DUrole{n}{hdcst\_file\_path}}\sphinxparamcomma \sphinxparam{\DUrole{n}{fcst\_file\_path}}\sphinxparamcomma \sphinxparam{\DUrole{n}{obs\_hdcst}}\sphinxparamcomma \sphinxparam{\DUrole{n}{obs\_fcst\_year}}\sphinxparamcomma \sphinxparam{\DUrole{n}{month\_of\_initialization}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year\_forecast}}\sphinxparamcomma \sphinxparam{\DUrole{n}{nb\_cores}\DUrole{o}{=}\DUrole{default_value}{2}}\sphinxparamcomma \sphinxparam{\DUrole{n}{agrometparam}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}Onset\textquotesingle{}}}}
{}
\pysigstopsignatures
\end{fulllineitems}

\index{retrieve\_several\_zones\_for\_PCR() (in module wass2s.utils)@\spxentry{retrieve\_several\_zones\_for\_PCR()}\spxextra{in module wass2s.utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.utils.retrieve_several_zones_for_PCR}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{wass2s.utils.}}\sphinxbfcode{\sphinxupquote{retrieve\_several\_zones\_for\_PCR}}}
{\sphinxparam{\DUrole{n}{dir\_to\_data}}\sphinxparamcomma \sphinxparam{\DUrole{n}{indices\_dict}}\sphinxparamcomma \sphinxparam{\DUrole{n}{variables\_list}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{season}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{model}\DUrole{o}{=}\DUrole{default_value}{False}}\sphinxparamcomma \sphinxparam{\DUrole{n}{month\_of\_initialization}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{lead\_time}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year\_forecast}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute indices for other variables.

\end{fulllineitems}

\index{retrieve\_single\_zone\_for\_PCR() (in module wass2s.utils)@\spxentry{retrieve\_single\_zone\_for\_PCR()}\spxextra{in module wass2s.utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.utils.retrieve_single_zone_for_PCR}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{wass2s.utils.}}\sphinxbfcode{\sphinxupquote{retrieve\_single\_zone\_for\_PCR}}}
{\sphinxparam{\DUrole{n}{dir\_to\_data}}\sphinxparamcomma \sphinxparam{\DUrole{n}{indices\_dict}}\sphinxparamcomma \sphinxparam{\DUrole{n}{variables\_list}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year\_start}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year\_end}}\sphinxparamcomma \sphinxparam{\DUrole{n}{season}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{model}\DUrole{o}{=}\DUrole{default_value}{False}}\sphinxparamcomma \sphinxparam{\DUrole{n}{month\_of\_initialization}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{lead\_time}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{year\_forecast}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Compute indices for other variables.

\end{fulllineitems}

\index{reverse\_standardize() (in module wass2s.utils)@\spxentry{reverse\_standardize()}\spxextra{in module wass2s.utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.utils.reverse_standardize}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{wass2s.utils.}}\sphinxbfcode{\sphinxupquote{reverse\_standardize}}}
{\sphinxparam{\DUrole{n}{ds\_st}}\sphinxparamcomma \sphinxparam{\DUrole{n}{ds}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\end{fulllineitems}

\index{save\_hindcast\_and\_forecasts() (in module wass2s.utils)@\spxentry{save\_hindcast\_and\_forecasts()}\spxextra{in module wass2s.utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.utils.save_hindcast_and_forecasts}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{wass2s.utils.}}\sphinxbfcode{\sphinxupquote{save\_hindcast\_and\_forecasts}}}
{\sphinxparam{\DUrole{n}{dir\_to\_save}}\sphinxparamcomma \sphinxparam{\DUrole{n}{data}}\sphinxparamcomma \sphinxparam{\DUrole{n}{variable}}\sphinxparamcomma \sphinxparam{\DUrole{n}{forecast}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{deterministic}\DUrole{o}{=}\DUrole{default_value}{True}}}
{}
\pysigstopsignatures
\end{fulllineitems}

\index{save\_validation\_score() (in module wass2s.utils)@\spxentry{save\_validation\_score()}\spxextra{in module wass2s.utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.utils.save_validation_score}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{wass2s.utils.}}\sphinxbfcode{\sphinxupquote{save\_validation\_score}}}
{\sphinxparam{\DUrole{n}{dir\_to\_save}}\sphinxparamcomma \sphinxparam{\DUrole{n}{data}}\sphinxparamcomma \sphinxparam{\DUrole{n}{metric}}\sphinxparamcomma \sphinxparam{\DUrole{n}{model\_name}}}
{}
\pysigstopsignatures
\end{fulllineitems}

\index{standardize\_timeseries() (in module wass2s.utils)@\spxentry{standardize\_timeseries()}\spxextra{in module wass2s.utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.utils.standardize_timeseries}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{wass2s.utils.}}\sphinxbfcode{\sphinxupquote{standardize\_timeseries}}}
{\sphinxparam{\DUrole{n}{ds}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_start}\DUrole{o}{=}\DUrole{default_value}{None}}\sphinxparamcomma \sphinxparam{\DUrole{n}{clim\_year\_end}\DUrole{o}{=}\DUrole{default_value}{None}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Standardize the dataset over a specified climatology period.

\end{fulllineitems}

\index{to\_iridl\_lat() (in module wass2s.utils)@\spxentry{to\_iridl\_lat()}\spxextra{in module wass2s.utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.utils.to_iridl_lat}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{wass2s.utils.}}\sphinxbfcode{\sphinxupquote{to\_iridl\_lat}}}
{\sphinxparam{\DUrole{n}{lat}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{float}}}
{{ $\rightarrow$ str}}
\pysigstopsignatures
\sphinxAtStartPar
Convert numeric latitude to IRIDL lat string: +10 \sphinxhyphen{}\textgreater{} ‘10N’, \sphinxhyphen{}5 \sphinxhyphen{}\textgreater{} ‘5S’.

\end{fulllineitems}

\index{to\_iridl\_lon() (in module wass2s.utils)@\spxentry{to\_iridl\_lon()}\spxextra{in module wass2s.utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.utils.to_iridl_lon}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{wass2s.utils.}}\sphinxbfcode{\sphinxupquote{to\_iridl\_lon}}}
{\sphinxparam{\DUrole{n}{lon}\DUrole{p}{:}\DUrole{w}{ }\DUrole{n}{float}}}
{{ $\rightarrow$ str}}
\pysigstopsignatures
\sphinxAtStartPar
Convert numeric longitude to IRIDL lon string: +15 \sphinxhyphen{}\textgreater{} ‘15E’, \sphinxhyphen{}15 \sphinxhyphen{}\textgreater{} ‘15W’.

\end{fulllineitems}

\index{trend\_data() (in module wass2s.utils)@\spxentry{trend\_data()}\spxextra{in module wass2s.utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.utils.trend_data}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{wass2s.utils.}}\sphinxbfcode{\sphinxupquote{trend\_data}}}
{\sphinxparam{\DUrole{n}{data}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
trend the data using ExtendedEOF if detrending is enabled.

\sphinxAtStartPar
Parameters:
\sphinxhyphen{} data: xarray DataArray we want to know trend.

\sphinxAtStartPar
Returns:
\sphinxhyphen{} data\_trended: trended xarray DataArray.

\end{fulllineitems}

\index{verify\_station\_network() (in module wass2s.utils)@\spxentry{verify\_station\_network()}\spxextra{in module wass2s.utils}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{api:wass2s.utils.verify_station_network}}
\pysigstartsignatures
\pysiglinewithargsret
{\sphinxcode{\sphinxupquote{wass2s.utils.}}\sphinxbfcode{\sphinxupquote{verify\_station\_network}}}
{\sphinxparam{\DUrole{n}{df\_filtered}}\sphinxparamcomma \sphinxparam{\DUrole{n}{extent}}\sphinxparamcomma \sphinxparam{\DUrole{n}{map\_name}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}Rain\sphinxhyphen{}gauge network\textquotesingle{}}}}
{}
\pysigstopsignatures
\sphinxAtStartPar
Verify the station network by plotting the locations of the stations
on a map.

\end{fulllineitems}



\renewcommand{\indexname}{Python Module Index}
\begin{sphinxtheindex}
\let\bigletter\sphinxstyleindexlettergroup
\bigletter{w}
\item\relax\sphinxstyleindexentry{wass2s.utils}\sphinxstyleindexpageref{api:\detokenize{module-wass2s.utils}}
\item\relax\sphinxstyleindexentry{wass2s.was\_analog}\sphinxstyleindexpageref{api:\detokenize{module-wass2s.was_analog}}
\item\relax\sphinxstyleindexentry{wass2s.was\_cca}\sphinxstyleindexpageref{api:\detokenize{module-wass2s.was_cca}}
\item\relax\sphinxstyleindexentry{wass2s.was\_compute\_predictand}\sphinxstyleindexpageref{api:\detokenize{module-wass2s.was_compute_predictand}}
\item\relax\sphinxstyleindexentry{wass2s.was\_cross\_validate}\sphinxstyleindexpageref{api:\detokenize{module-wass2s.was_cross_validate}}
\item\relax\sphinxstyleindexentry{wass2s.was\_download}\sphinxstyleindexpageref{api:\detokenize{module-wass2s.was_download}}
\item\relax\sphinxstyleindexentry{wass2s.was\_eof}\sphinxstyleindexpageref{api:\detokenize{module-wass2s.was_eof}}
\item\relax\sphinxstyleindexentry{wass2s.was\_linear\_models}\sphinxstyleindexpageref{api:\detokenize{module-wass2s.was_linear_models}}
\item\relax\sphinxstyleindexentry{wass2s.was\_machine\_learning}\sphinxstyleindexpageref{api:\detokenize{module-wass2s.was_machine_learning}}
\item\relax\sphinxstyleindexentry{wass2s.was\_merge\_predictand}\sphinxstyleindexpageref{api:\detokenize{module-wass2s.was_merge_predictand}}
\item\relax\sphinxstyleindexentry{wass2s.was\_mme}\sphinxstyleindexpageref{api:\detokenize{module-wass2s.was_mme}}
\item\relax\sphinxstyleindexentry{wass2s.was\_pcr}\sphinxstyleindexpageref{api:\detokenize{module-wass2s.was_pcr}}
\item\relax\sphinxstyleindexentry{wass2s.was\_verification}\sphinxstyleindexpageref{api:\detokenize{module-wass2s.was_verification}}
\end{sphinxtheindex}

\renewcommand{\indexname}{Index}
\printindex
\end{document}