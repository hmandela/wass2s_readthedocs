

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>wass2s api &mdash; wass2s 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=01f34227"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Multi-Model Ensemble (MME) Techniques" href="mme.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            wass2s
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Usage.html">Usage</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">wass2s api</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-wass2s.was_download">wass2s.was_download module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_download.WAS_Download"><code class="docutils literal notranslate"><span class="pre">WAS_Download</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_download.WAS_Download.AgroObsName"><code class="docutils literal notranslate"><span class="pre">WAS_Download.AgroObsName()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_download.WAS_Download.ModelsName"><code class="docutils literal notranslate"><span class="pre">WAS_Download.ModelsName()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_download.WAS_Download.ReanalysisName"><code class="docutils literal notranslate"><span class="pre">WAS_Download.ReanalysisName()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_download.WAS_Download.WAS_Download_AgroIndicators"><code class="docutils literal notranslate"><span class="pre">WAS_Download.WAS_Download_AgroIndicators()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_download.WAS_Download.WAS_Download_AgroIndicators_"><code class="docutils literal notranslate"><span class="pre">WAS_Download.WAS_Download_AgroIndicators_()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_download.WAS_Download.WAS_Download_AgroIndicators_daily"><code class="docutils literal notranslate"><span class="pre">WAS_Download.WAS_Download_AgroIndicators_daily()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_download.WAS_Download.WAS_Download_CHIRPSv3"><code class="docutils literal notranslate"><span class="pre">WAS_Download.WAS_Download_CHIRPSv3()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_download.WAS_Download.WAS_Download_Models"><code class="docutils literal notranslate"><span class="pre">WAS_Download.WAS_Download_Models()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_download.WAS_Download.WAS_Download_Models_Daily"><code class="docutils literal notranslate"><span class="pre">WAS_Download.WAS_Download_Models_Daily()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_download.WAS_Download.WAS_Download_Reanalysis"><code class="docutils literal notranslate"><span class="pre">WAS_Download.WAS_Download_Reanalysis()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_download.WAS_Download.WAS_Download_Reanalysis_"><code class="docutils literal notranslate"><span class="pre">WAS_Download.WAS_Download_Reanalysis_()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_download.WAS_Download.days_in_month"><code class="docutils literal notranslate"><span class="pre">WAS_Download.days_in_month()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_download.WAS_Download.download_nmme_txt_with_progress"><code class="docutils literal notranslate"><span class="pre">WAS_Download.download_nmme_txt_with_progress()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_download.WAS_Download.parse_cpt_data_optimized"><code class="docutils literal notranslate"><span class="pre">WAS_Download.parse_cpt_data_optimized()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_download.plot_map"><code class="docutils literal notranslate"><span class="pre">plot_map()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-wass2s.was_compute_predictand">wass2s.was_compute_predictand module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_compute_HWSDI"><code class="docutils literal notranslate"><span class="pre">WAS_compute_HWSDI</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_compute_HWSDI.calculate_TXin90"><code class="docutils literal notranslate"><span class="pre">WAS_compute_HWSDI.calculate_TXin90()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_compute_HWSDI.compute"><code class="docutils literal notranslate"><span class="pre">WAS_compute_HWSDI.compute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_compute_HWSDI.count_hot_days"><code class="docutils literal notranslate"><span class="pre">WAS_compute_HWSDI.count_hot_days()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_compute_HWSDI_Seasonal"><code class="docutils literal notranslate"><span class="pre">WAS_compute_HWSDI_Seasonal</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_compute_HWSDI_Seasonal.calculate_TXin90"><code class="docutils literal notranslate"><span class="pre">WAS_compute_HWSDI_Seasonal.calculate_TXin90()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_compute_HWSDI_Seasonal.compute"><code class="docutils literal notranslate"><span class="pre">WAS_compute_HWSDI_Seasonal.compute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_compute_HWSDI_Seasonal.count_hot_days"><code class="docutils literal notranslate"><span class="pre">WAS_compute_HWSDI_Seasonal.count_hot_days()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_compute_HWSDI_monthly"><code class="docutils literal notranslate"><span class="pre">WAS_compute_HWSDI_monthly</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_compute_HWSDI_monthly.calculate_TXin90"><code class="docutils literal notranslate"><span class="pre">WAS_compute_HWSDI_monthly.calculate_TXin90()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_compute_HWSDI_monthly.compute"><code class="docutils literal notranslate"><span class="pre">WAS_compute_HWSDI_monthly.compute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_compute_HWSDI_monthly.count_hot_days"><code class="docutils literal notranslate"><span class="pre">WAS_compute_HWSDI_monthly.count_hot_days()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_compute_cessation"><code class="docutils literal notranslate"><span class="pre">WAS_compute_cessation</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_compute_cessation.adjust_duplicates"><code class="docutils literal notranslate"><span class="pre">WAS_compute_cessation.adjust_duplicates()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_compute_cessation.cessation_function"><code class="docutils literal notranslate"><span class="pre">WAS_compute_cessation.cessation_function()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_compute_cessation.compute"><code class="docutils literal notranslate"><span class="pre">WAS_compute_cessation.compute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_compute_cessation.compute_insitu"><code class="docutils literal notranslate"><span class="pre">WAS_compute_cessation.compute_insitu()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_compute_cessation.day_of_year"><code class="docutils literal notranslate"><span class="pre">WAS_compute_cessation.day_of_year()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_compute_cessation.default_criteria"><code class="docutils literal notranslate"><span class="pre">WAS_compute_cessation.default_criteria</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_compute_cessation.rainf_zone"><code class="docutils literal notranslate"><span class="pre">WAS_compute_cessation.rainf_zone()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_compute_cessation.transform_cdt"><code class="docutils literal notranslate"><span class="pre">WAS_compute_cessation.transform_cdt()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_compute_cessation_dry_spell"><code class="docutils literal notranslate"><span class="pre">WAS_compute_cessation_dry_spell</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_compute_cessation_dry_spell.adjust_duplicates"><code class="docutils literal notranslate"><span class="pre">WAS_compute_cessation_dry_spell.adjust_duplicates()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_compute_cessation_dry_spell.compute"><code class="docutils literal notranslate"><span class="pre">WAS_compute_cessation_dry_spell.compute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_compute_cessation_dry_spell.compute_insitu"><code class="docutils literal notranslate"><span class="pre">WAS_compute_cessation_dry_spell.compute_insitu()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_compute_cessation_dry_spell.day_of_year"><code class="docutils literal notranslate"><span class="pre">WAS_compute_cessation_dry_spell.day_of_year()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_compute_cessation_dry_spell.default_criteria"><code class="docutils literal notranslate"><span class="pre">WAS_compute_cessation_dry_spell.default_criteria</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_compute_cessation_dry_spell.dry_spell_cessation_function"><code class="docutils literal notranslate"><span class="pre">WAS_compute_cessation_dry_spell.dry_spell_cessation_function()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_compute_cessation_dry_spell.rainf_zone"><code class="docutils literal notranslate"><span class="pre">WAS_compute_cessation_dry_spell.rainf_zone()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_compute_cessation_dry_spell.transform_cdt"><code class="docutils literal notranslate"><span class="pre">WAS_compute_cessation_dry_spell.transform_cdt()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_compute_onset"><code class="docutils literal notranslate"><span class="pre">WAS_compute_onset</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_compute_onset.adjust_duplicates"><code class="docutils literal notranslate"><span class="pre">WAS_compute_onset.adjust_duplicates()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_compute_onset.compute"><code class="docutils literal notranslate"><span class="pre">WAS_compute_onset.compute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_compute_onset.compute_insitu"><code class="docutils literal notranslate"><span class="pre">WAS_compute_onset.compute_insitu()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_compute_onset.day_of_year"><code class="docutils literal notranslate"><span class="pre">WAS_compute_onset.day_of_year()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_compute_onset.default_criteria"><code class="docutils literal notranslate"><span class="pre">WAS_compute_onset.default_criteria</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_compute_onset.onset_function"><code class="docutils literal notranslate"><span class="pre">WAS_compute_onset.onset_function()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_compute_onset.rainf_zone"><code class="docutils literal notranslate"><span class="pre">WAS_compute_onset.rainf_zone()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_compute_onset.transform_cdt"><code class="docutils literal notranslate"><span class="pre">WAS_compute_onset.transform_cdt()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_compute_onset_dry_spell"><code class="docutils literal notranslate"><span class="pre">WAS_compute_onset_dry_spell</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_compute_onset_dry_spell.adjust_duplicates"><code class="docutils literal notranslate"><span class="pre">WAS_compute_onset_dry_spell.adjust_duplicates()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_compute_onset_dry_spell.compute"><code class="docutils literal notranslate"><span class="pre">WAS_compute_onset_dry_spell.compute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_compute_onset_dry_spell.compute_insitu"><code class="docutils literal notranslate"><span class="pre">WAS_compute_onset_dry_spell.compute_insitu()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_compute_onset_dry_spell.day_of_year"><code class="docutils literal notranslate"><span class="pre">WAS_compute_onset_dry_spell.day_of_year()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_compute_onset_dry_spell.default_criteria"><code class="docutils literal notranslate"><span class="pre">WAS_compute_onset_dry_spell.default_criteria</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_compute_onset_dry_spell.dry_spell_onset_function"><code class="docutils literal notranslate"><span class="pre">WAS_compute_onset_dry_spell.dry_spell_onset_function()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_compute_onset_dry_spell.dry_spell_onset_function_"><code class="docutils literal notranslate"><span class="pre">WAS_compute_onset_dry_spell.dry_spell_onset_function_()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_compute_onset_dry_spell.rainf_zone"><code class="docutils literal notranslate"><span class="pre">WAS_compute_onset_dry_spell.rainf_zone()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_compute_onset_dry_spell.transform_cdt"><code class="docutils literal notranslate"><span class="pre">WAS_compute_onset_dry_spell.transform_cdt()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_count_dry_spells"><code class="docutils literal notranslate"><span class="pre">WAS_count_dry_spells</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_count_dry_spells.adjust_duplicates"><code class="docutils literal notranslate"><span class="pre">WAS_count_dry_spells.adjust_duplicates()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_count_dry_spells.compute"><code class="docutils literal notranslate"><span class="pre">WAS_count_dry_spells.compute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_count_dry_spells.compute_insitu"><code class="docutils literal notranslate"><span class="pre">WAS_count_dry_spells.compute_insitu()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_count_dry_spells.count_dry_spells"><code class="docutils literal notranslate"><span class="pre">WAS_count_dry_spells.count_dry_spells()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_count_dry_spells.transform_cdt"><code class="docutils literal notranslate"><span class="pre">WAS_count_dry_spells.transform_cdt()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_count_dry_spells.transform_cpt"><code class="docutils literal notranslate"><span class="pre">WAS_count_dry_spells.transform_cpt()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_count_rainy_days"><code class="docutils literal notranslate"><span class="pre">WAS_count_rainy_days</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_count_rainy_days.compute"><code class="docutils literal notranslate"><span class="pre">WAS_count_rainy_days.compute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_count_rainy_days.compute_insitu"><code class="docutils literal notranslate"><span class="pre">WAS_count_rainy_days.compute_insitu()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_count_rainy_days.count_rainy_days"><code class="docutils literal notranslate"><span class="pre">WAS_count_rainy_days.count_rainy_days()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_count_rainy_days.transform_cdt"><code class="docutils literal notranslate"><span class="pre">WAS_count_rainy_days.transform_cdt()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_count_wet_spells"><code class="docutils literal notranslate"><span class="pre">WAS_count_wet_spells</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_count_wet_spells.compute"><code class="docutils literal notranslate"><span class="pre">WAS_count_wet_spells.compute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_count_wet_spells.compute_insitu"><code class="docutils literal notranslate"><span class="pre">WAS_count_wet_spells.compute_insitu()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_count_wet_spells.count_wet_spells"><code class="docutils literal notranslate"><span class="pre">WAS_count_wet_spells.count_wet_spells()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_count_wet_spells.transform_cdt"><code class="docutils literal notranslate"><span class="pre">WAS_count_wet_spells.transform_cdt()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_r95_99p"><code class="docutils literal notranslate"><span class="pre">WAS_r95_99p</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_r95_99p.compute_insitu_r95p"><code class="docutils literal notranslate"><span class="pre">WAS_r95_99p.compute_insitu_r95p()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_r95_99p.compute_insitu_r99p"><code class="docutils literal notranslate"><span class="pre">WAS_r95_99p.compute_insitu_r99p()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_r95_99p.compute_r95p"><code class="docutils literal notranslate"><span class="pre">WAS_r95_99p.compute_r95p()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_r95_99p.compute_r99p"><code class="docutils literal notranslate"><span class="pre">WAS_r95_99p.compute_r99p()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_compute_predictand.WAS_r95_99p.transform_cdt"><code class="docutils literal notranslate"><span class="pre">WAS_r95_99p.transform_cdt()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-wass2s.was_merge_predictand">wass2s.was_merge_predictand module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_merge_predictand.WAS_Merging"><code class="docutils literal notranslate"><span class="pre">WAS_Merging</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_merge_predictand.WAS_Merging.adjust_duplicates"><code class="docutils literal notranslate"><span class="pre">WAS_Merging.adjust_duplicates()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_merge_predictand.WAS_Merging.auto_select_kriging_parameters"><code class="docutils literal notranslate"><span class="pre">WAS_Merging.auto_select_kriging_parameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_merge_predictand.WAS_Merging.multiplicative_bias"><code class="docutils literal notranslate"><span class="pre">WAS_Merging.multiplicative_bias()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_merge_predictand.WAS_Merging.neural_network_kriging"><code class="docutils literal notranslate"><span class="pre">WAS_Merging.neural_network_kriging()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_merge_predictand.WAS_Merging.neural_network_kriging_"><code class="docutils literal notranslate"><span class="pre">WAS_Merging.neural_network_kriging_()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_merge_predictand.WAS_Merging.plot_merging_comparaison"><code class="docutils literal notranslate"><span class="pre">WAS_Merging.plot_merging_comparaison()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_merge_predictand.WAS_Merging.regression_kriging"><code class="docutils literal notranslate"><span class="pre">WAS_Merging.regression_kriging()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_merge_predictand.WAS_Merging.simple_bias_adjustment"><code class="docutils literal notranslate"><span class="pre">WAS_Merging.simple_bias_adjustment()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_merge_predictand.WAS_Merging.transform_cdt"><code class="docutils literal notranslate"><span class="pre">WAS_Merging.transform_cdt()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_merge_predictand.WAS_Merging.transform_cpt"><code class="docutils literal notranslate"><span class="pre">WAS_Merging.transform_cpt()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-wass2s.was_cross_validate">wass2s.was_cross_validate module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_cross_validate.CustomTimeSeriesSplit"><code class="docutils literal notranslate"><span class="pre">CustomTimeSeriesSplit</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_cross_validate.CustomTimeSeriesSplit.get_n_splits"><code class="docutils literal notranslate"><span class="pre">CustomTimeSeriesSplit.get_n_splits()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_cross_validate.CustomTimeSeriesSplit.split"><code class="docutils literal notranslate"><span class="pre">CustomTimeSeriesSplit.split()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_cross_validate.WAS_Cross_Validator"><code class="docutils literal notranslate"><span class="pre">WAS_Cross_Validator</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_cross_validate.WAS_Cross_Validator.cross_validate"><code class="docutils literal notranslate"><span class="pre">WAS_Cross_Validator.cross_validate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_cross_validate.WAS_Cross_Validator.get_model_params"><code class="docutils literal notranslate"><span class="pre">WAS_Cross_Validator.get_model_params()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-wass2s.was_linear_models">wass2s.was_linear_models module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_linear_models.WAS_ElasticNet_Model"><code class="docutils literal notranslate"><span class="pre">WAS_ElasticNet_Model</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_ElasticNet_Model.calculate_tercile_probabilities"><code class="docutils literal notranslate"><span class="pre">WAS_ElasticNet_Model.calculate_tercile_probabilities()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_ElasticNet_Model.calculate_tercile_probabilities_gamma"><code class="docutils literal notranslate"><span class="pre">WAS_ElasticNet_Model.calculate_tercile_probabilities_gamma()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_ElasticNet_Model.calculate_tercile_probabilities_lognormal"><code class="docutils literal notranslate"><span class="pre">WAS_ElasticNet_Model.calculate_tercile_probabilities_lognormal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_ElasticNet_Model.calculate_tercile_probabilities_nonparametric"><code class="docutils literal notranslate"><span class="pre">WAS_ElasticNet_Model.calculate_tercile_probabilities_nonparametric()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_ElasticNet_Model.calculate_tercile_probabilities_normal"><code class="docutils literal notranslate"><span class="pre">WAS_ElasticNet_Model.calculate_tercile_probabilities_normal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_ElasticNet_Model.compute_hyperparameters"><code class="docutils literal notranslate"><span class="pre">WAS_ElasticNet_Model.compute_hyperparameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_ElasticNet_Model.compute_model"><code class="docutils literal notranslate"><span class="pre">WAS_ElasticNet_Model.compute_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_ElasticNet_Model.compute_prob"><code class="docutils literal notranslate"><span class="pre">WAS_ElasticNet_Model.compute_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_ElasticNet_Model.fit_predict"><code class="docutils literal notranslate"><span class="pre">WAS_ElasticNet_Model.fit_predict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_ElasticNet_Model.forecast"><code class="docutils literal notranslate"><span class="pre">WAS_ElasticNet_Model.forecast()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_linear_models.WAS_LassoLars_Model"><code class="docutils literal notranslate"><span class="pre">WAS_LassoLars_Model</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_LassoLars_Model.fit_predict"><code class="docutils literal notranslate"><span class="pre">WAS_LassoLars_Model.fit_predict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_LassoLars_Model.compute_hyperparameters"><code class="docutils literal notranslate"><span class="pre">WAS_LassoLars_Model.compute_hyperparameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_LassoLars_Model.compute_model"><code class="docutils literal notranslate"><span class="pre">WAS_LassoLars_Model.compute_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_LassoLars_Model.calculate_tercile_probabilities"><code class="docutils literal notranslate"><span class="pre">WAS_LassoLars_Model.calculate_tercile_probabilities()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_LassoLars_Model.compute_prob"><code class="docutils literal notranslate"><span class="pre">WAS_LassoLars_Model.compute_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_LassoLars_Model.forecast"><code class="docutils literal notranslate"><span class="pre">WAS_LassoLars_Model.forecast()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id0"><code class="docutils literal notranslate"><span class="pre">WAS_LassoLars_Model.calculate_tercile_probabilities()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_LassoLars_Model.calculate_tercile_probabilities_gamma"><code class="docutils literal notranslate"><span class="pre">WAS_LassoLars_Model.calculate_tercile_probabilities_gamma()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_LassoLars_Model.calculate_tercile_probabilities_lognormal"><code class="docutils literal notranslate"><span class="pre">WAS_LassoLars_Model.calculate_tercile_probabilities_lognormal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_LassoLars_Model.calculate_tercile_probabilities_nonparametric"><code class="docutils literal notranslate"><span class="pre">WAS_LassoLars_Model.calculate_tercile_probabilities_nonparametric()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_LassoLars_Model.calculate_tercile_probabilities_normal"><code class="docutils literal notranslate"><span class="pre">WAS_LassoLars_Model.calculate_tercile_probabilities_normal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2"><code class="docutils literal notranslate"><span class="pre">WAS_LassoLars_Model.compute_hyperparameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3"><code class="docutils literal notranslate"><span class="pre">WAS_LassoLars_Model.compute_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id4"><code class="docutils literal notranslate"><span class="pre">WAS_LassoLars_Model.compute_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5"><code class="docutils literal notranslate"><span class="pre">WAS_LassoLars_Model.fit_predict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6"><code class="docutils literal notranslate"><span class="pre">WAS_LassoLars_Model.forecast()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_linear_models.WAS_Lasso_Model"><code class="docutils literal notranslate"><span class="pre">WAS_Lasso_Model</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_Lasso_Model.calculate_tercile_probabilities"><code class="docutils literal notranslate"><span class="pre">WAS_Lasso_Model.calculate_tercile_probabilities()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_Lasso_Model.calculate_tercile_probabilities_gamma"><code class="docutils literal notranslate"><span class="pre">WAS_Lasso_Model.calculate_tercile_probabilities_gamma()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_Lasso_Model.calculate_tercile_probabilities_lognormal"><code class="docutils literal notranslate"><span class="pre">WAS_Lasso_Model.calculate_tercile_probabilities_lognormal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_Lasso_Model.calculate_tercile_probabilities_nonparametric"><code class="docutils literal notranslate"><span class="pre">WAS_Lasso_Model.calculate_tercile_probabilities_nonparametric()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_Lasso_Model.calculate_tercile_probabilities_normal"><code class="docutils literal notranslate"><span class="pre">WAS_Lasso_Model.calculate_tercile_probabilities_normal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_Lasso_Model.compute_hyperparameters"><code class="docutils literal notranslate"><span class="pre">WAS_Lasso_Model.compute_hyperparameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_Lasso_Model.compute_model"><code class="docutils literal notranslate"><span class="pre">WAS_Lasso_Model.compute_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_Lasso_Model.compute_prob"><code class="docutils literal notranslate"><span class="pre">WAS_Lasso_Model.compute_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_Lasso_Model.fit_predict"><code class="docutils literal notranslate"><span class="pre">WAS_Lasso_Model.fit_predict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_Lasso_Model.forecast"><code class="docutils literal notranslate"><span class="pre">WAS_Lasso_Model.forecast()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_linear_models.WAS_LinearRegression_Model"><code class="docutils literal notranslate"><span class="pre">WAS_LinearRegression_Model</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_LinearRegression_Model.nb_cores"><code class="docutils literal notranslate"><span class="pre">WAS_LinearRegression_Model.nb_cores</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_LinearRegression_Model.dist_method"><code class="docutils literal notranslate"><span class="pre">WAS_LinearRegression_Model.dist_method</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_LinearRegression_Model.fit_predict"><code class="docutils literal notranslate"><span class="pre">WAS_LinearRegression_Model.fit_predict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_LinearRegression_Model.compute_model"><code class="docutils literal notranslate"><span class="pre">WAS_LinearRegression_Model.compute_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_LinearRegression_Model.compute_prob"><code class="docutils literal notranslate"><span class="pre">WAS_LinearRegression_Model.compute_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_LinearRegression_Model.forecast"><code class="docutils literal notranslate"><span class="pre">WAS_LinearRegression_Model.forecast()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_LinearRegression_Model.calculate_tercile_probabilities"><code class="docutils literal notranslate"><span class="pre">WAS_LinearRegression_Model.calculate_tercile_probabilities()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_LinearRegression_Model.calculate_tercile_probabilities_gamma"><code class="docutils literal notranslate"><span class="pre">WAS_LinearRegression_Model.calculate_tercile_probabilities_gamma()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_LinearRegression_Model.calculate_tercile_probabilities_lognormal"><code class="docutils literal notranslate"><span class="pre">WAS_LinearRegression_Model.calculate_tercile_probabilities_lognormal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_LinearRegression_Model.calculate_tercile_probabilities_nonparametric"><code class="docutils literal notranslate"><span class="pre">WAS_LinearRegression_Model.calculate_tercile_probabilities_nonparametric()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_LinearRegression_Model.calculate_tercile_probabilities_normal"><code class="docutils literal notranslate"><span class="pre">WAS_LinearRegression_Model.calculate_tercile_probabilities_normal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id9"><code class="docutils literal notranslate"><span class="pre">WAS_LinearRegression_Model.compute_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id10"><code class="docutils literal notranslate"><span class="pre">WAS_LinearRegression_Model.compute_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id11"><code class="docutils literal notranslate"><span class="pre">WAS_LinearRegression_Model.fit_predict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id12"><code class="docutils literal notranslate"><span class="pre">WAS_LinearRegression_Model.forecast()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_linear_models.WAS_Ridge_Model"><code class="docutils literal notranslate"><span class="pre">WAS_Ridge_Model</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_Ridge_Model.alpha_range"><code class="docutils literal notranslate"><span class="pre">WAS_Ridge_Model.alpha_range</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_Ridge_Model.n_clusters"><code class="docutils literal notranslate"><span class="pre">WAS_Ridge_Model.n_clusters</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_Ridge_Model.nb_cores"><code class="docutils literal notranslate"><span class="pre">WAS_Ridge_Model.nb_cores</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_Ridge_Model.dist_method"><code class="docutils literal notranslate"><span class="pre">WAS_Ridge_Model.dist_method</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_Ridge_Model.fit_predict"><code class="docutils literal notranslate"><span class="pre">WAS_Ridge_Model.fit_predict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_Ridge_Model.compute_hyperparameters"><code class="docutils literal notranslate"><span class="pre">WAS_Ridge_Model.compute_hyperparameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_Ridge_Model.compute_model"><code class="docutils literal notranslate"><span class="pre">WAS_Ridge_Model.compute_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_Ridge_Model.compute_prob"><code class="docutils literal notranslate"><span class="pre">WAS_Ridge_Model.compute_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_Ridge_Model.forecast"><code class="docutils literal notranslate"><span class="pre">WAS_Ridge_Model.forecast()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_Ridge_Model.calculate_tercile_probabilities"><code class="docutils literal notranslate"><span class="pre">WAS_Ridge_Model.calculate_tercile_probabilities()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_Ridge_Model.calculate_tercile_probabilities_gamma"><code class="docutils literal notranslate"><span class="pre">WAS_Ridge_Model.calculate_tercile_probabilities_gamma()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_Ridge_Model.calculate_tercile_probabilities_lognormal"><code class="docutils literal notranslate"><span class="pre">WAS_Ridge_Model.calculate_tercile_probabilities_lognormal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_Ridge_Model.calculate_tercile_probabilities_nonparametric"><code class="docutils literal notranslate"><span class="pre">WAS_Ridge_Model.calculate_tercile_probabilities_nonparametric()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_linear_models.WAS_Ridge_Model.calculate_tercile_probabilities_normal"><code class="docutils literal notranslate"><span class="pre">WAS_Ridge_Model.calculate_tercile_probabilities_normal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id13"><code class="docutils literal notranslate"><span class="pre">WAS_Ridge_Model.compute_hyperparameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id14"><code class="docutils literal notranslate"><span class="pre">WAS_Ridge_Model.compute_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id15"><code class="docutils literal notranslate"><span class="pre">WAS_Ridge_Model.compute_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id16"><code class="docutils literal notranslate"><span class="pre">WAS_Ridge_Model.fit_predict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id17"><code class="docutils literal notranslate"><span class="pre">WAS_Ridge_Model.forecast()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-wass2s.was_eof">wass2s.was_eof module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_eof.WAS_EOF"><code class="docutils literal notranslate"><span class="pre">WAS_EOF</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_eof.WAS_EOF.model"><code class="docutils literal notranslate"><span class="pre">WAS_EOF.model</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_eof.WAS_EOF.fit"><code class="docutils literal notranslate"><span class="pre">WAS_EOF.fit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_eof.WAS_EOF.inverse_transform"><code class="docutils literal notranslate"><span class="pre">WAS_EOF.inverse_transform()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_eof.WAS_EOF.plot_EOF"><code class="docutils literal notranslate"><span class="pre">WAS_EOF.plot_EOF()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_eof.WAS_EOF.transform"><code class="docutils literal notranslate"><span class="pre">WAS_EOF.transform()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-wass2s.was_pcr">wass2s.was_pcr module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_pcr.WAS_PCR"><code class="docutils literal notranslate"><span class="pre">WAS_PCR</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_pcr.WAS_PCR.eof_model"><code class="docutils literal notranslate"><span class="pre">WAS_PCR.eof_model</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_pcr.WAS_PCR.reg_model"><code class="docutils literal notranslate"><span class="pre">WAS_PCR.reg_model</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_pcr.WAS_PCR.compute_model"><code class="docutils literal notranslate"><span class="pre">WAS_PCR.compute_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_pcr.WAS_PCR.compute_prob"><code class="docutils literal notranslate"><span class="pre">WAS_PCR.compute_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_pcr.WAS_PCR.forecast"><code class="docutils literal notranslate"><span class="pre">WAS_PCR.forecast()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-wass2s.was_cca">wass2s.was_cca module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_cca.WAS_CCA"><code class="docutils literal notranslate"><span class="pre">WAS_CCA</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_cca.WAS_CCA.calculate_tercile_probabilities"><code class="docutils literal notranslate"><span class="pre">WAS_CCA.calculate_tercile_probabilities()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_cca.WAS_CCA.calculate_tercile_probabilities_gamma"><code class="docutils literal notranslate"><span class="pre">WAS_CCA.calculate_tercile_probabilities_gamma()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_cca.WAS_CCA.calculate_tercile_probabilities_lognormal"><code class="docutils literal notranslate"><span class="pre">WAS_CCA.calculate_tercile_probabilities_lognormal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_cca.WAS_CCA.calculate_tercile_probabilities_nonparametric"><code class="docutils literal notranslate"><span class="pre">WAS_CCA.calculate_tercile_probabilities_nonparametric()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_cca.WAS_CCA.calculate_tercile_probabilities_normal"><code class="docutils literal notranslate"><span class="pre">WAS_CCA.calculate_tercile_probabilities_normal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_cca.WAS_CCA.compute_model"><code class="docutils literal notranslate"><span class="pre">WAS_CCA.compute_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_cca.WAS_CCA.compute_prob"><code class="docutils literal notranslate"><span class="pre">WAS_CCA.compute_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_cca.WAS_CCA.fit_cca"><code class="docutils literal notranslate"><span class="pre">WAS_CCA.fit_cca()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_cca.WAS_CCA.forecast"><code class="docutils literal notranslate"><span class="pre">WAS_CCA.forecast()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_cca.WAS_CCA.plot_cca_results"><code class="docutils literal notranslate"><span class="pre">WAS_CCA.plot_cca_results()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_cca.WAS_CCA.preprocess_data"><code class="docutils literal notranslate"><span class="pre">WAS_CCA.preprocess_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_cca.WAS_CCA.preprocess_test_data"><code class="docutils literal notranslate"><span class="pre">WAS_CCA.preprocess_test_data()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_cca.WAS_CCA_"><code class="docutils literal notranslate"><span class="pre">WAS_CCA_</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_cca.WAS_CCA_.calculate_tercile_probabilities"><code class="docutils literal notranslate"><span class="pre">WAS_CCA_.calculate_tercile_probabilities()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_cca.WAS_CCA_.calculate_tercile_probabilities_gamma"><code class="docutils literal notranslate"><span class="pre">WAS_CCA_.calculate_tercile_probabilities_gamma()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_cca.WAS_CCA_.compute_model"><code class="docutils literal notranslate"><span class="pre">WAS_CCA_.compute_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_cca.WAS_CCA_.compute_prob"><code class="docutils literal notranslate"><span class="pre">WAS_CCA_.compute_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_cca.WAS_CCA_.fit_cca"><code class="docutils literal notranslate"><span class="pre">WAS_CCA_.fit_cca()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_cca.WAS_CCA_.forecast"><code class="docutils literal notranslate"><span class="pre">WAS_CCA_.forecast()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_cca.WAS_CCA_.plot_cca_results"><code class="docutils literal notranslate"><span class="pre">WAS_CCA_.plot_cca_results()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_cca.WAS_CCA_.preprocess_data"><code class="docutils literal notranslate"><span class="pre">WAS_CCA_.preprocess_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_cca.WAS_CCA_.preprocess_test_data"><code class="docutils literal notranslate"><span class="pre">WAS_CCA_.preprocess_test_data()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-wass2s.was_machine_learning">wass2s.was_machine_learning module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_LogisticRegression_Model"><code class="docutils literal notranslate"><span class="pre">WAS_LogisticRegression_Model</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_LogisticRegression_Model.classify"><code class="docutils literal notranslate"><span class="pre">WAS_LogisticRegression_Model.classify()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_LogisticRegression_Model.compute_class"><code class="docutils literal notranslate"><span class="pre">WAS_LogisticRegression_Model.compute_class()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_LogisticRegression_Model.compute_model"><code class="docutils literal notranslate"><span class="pre">WAS_LogisticRegression_Model.compute_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_LogisticRegression_Model.fit_predict"><code class="docutils literal notranslate"><span class="pre">WAS_LogisticRegression_Model.fit_predict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_LogisticRegression_Model.forecast"><code class="docutils literal notranslate"><span class="pre">WAS_LogisticRegression_Model.forecast()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_MLP"><code class="docutils literal notranslate"><span class="pre">WAS_MLP</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_MLP.calculate_tercile_probabilities"><code class="docutils literal notranslate"><span class="pre">WAS_MLP.calculate_tercile_probabilities()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_MLP.calculate_tercile_probabilities_gamma"><code class="docutils literal notranslate"><span class="pre">WAS_MLP.calculate_tercile_probabilities_gamma()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_MLP.calculate_tercile_probabilities_lognormal"><code class="docutils literal notranslate"><span class="pre">WAS_MLP.calculate_tercile_probabilities_lognormal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_MLP.calculate_tercile_probabilities_nonparametric"><code class="docutils literal notranslate"><span class="pre">WAS_MLP.calculate_tercile_probabilities_nonparametric()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_MLP.calculate_tercile_probabilities_normal"><code class="docutils literal notranslate"><span class="pre">WAS_MLP.calculate_tercile_probabilities_normal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_MLP.compute_hyperparameters"><code class="docutils literal notranslate"><span class="pre">WAS_MLP.compute_hyperparameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_MLP.compute_model"><code class="docutils literal notranslate"><span class="pre">WAS_MLP.compute_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_MLP.compute_prob"><code class="docutils literal notranslate"><span class="pre">WAS_MLP.compute_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_MLP.fit_predict"><code class="docutils literal notranslate"><span class="pre">WAS_MLP.fit_predict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_MLP.forecast"><code class="docutils literal notranslate"><span class="pre">WAS_MLP.forecast()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_PoissonRegression"><code class="docutils literal notranslate"><span class="pre">WAS_PoissonRegression</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_PoissonRegression.nb_cores"><code class="docutils literal notranslate"><span class="pre">WAS_PoissonRegression.nb_cores</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_PoissonRegression.dist_method"><code class="docutils literal notranslate"><span class="pre">WAS_PoissonRegression.dist_method</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_PoissonRegression.fit_predict"><code class="docutils literal notranslate"><span class="pre">WAS_PoissonRegression.fit_predict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_PoissonRegression.compute_model"><code class="docutils literal notranslate"><span class="pre">WAS_PoissonRegression.compute_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_PoissonRegression.compute_prob"><code class="docutils literal notranslate"><span class="pre">WAS_PoissonRegression.compute_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_PoissonRegression.calculate_tercile_probabilities"><code class="docutils literal notranslate"><span class="pre">WAS_PoissonRegression.calculate_tercile_probabilities()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_PoissonRegression.calculate_tercile_probabilities_gamma"><code class="docutils literal notranslate"><span class="pre">WAS_PoissonRegression.calculate_tercile_probabilities_gamma()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_PoissonRegression.calculate_tercile_probabilities_lognormal"><code class="docutils literal notranslate"><span class="pre">WAS_PoissonRegression.calculate_tercile_probabilities_lognormal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_PoissonRegression.calculate_tercile_probabilities_nonparametric"><code class="docutils literal notranslate"><span class="pre">WAS_PoissonRegression.calculate_tercile_probabilities_nonparametric()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_PoissonRegression.calculate_tercile_probabilities_normal"><code class="docutils literal notranslate"><span class="pre">WAS_PoissonRegression.calculate_tercile_probabilities_normal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id18"><code class="docutils literal notranslate"><span class="pre">WAS_PoissonRegression.compute_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id19"><code class="docutils literal notranslate"><span class="pre">WAS_PoissonRegression.compute_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id20"><code class="docutils literal notranslate"><span class="pre">WAS_PoissonRegression.fit_predict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_PoissonRegression.forecast"><code class="docutils literal notranslate"><span class="pre">WAS_PoissonRegression.forecast()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_PolynomialRegression"><code class="docutils literal notranslate"><span class="pre">WAS_PolynomialRegression</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_PolynomialRegression.nb_cores"><code class="docutils literal notranslate"><span class="pre">WAS_PolynomialRegression.nb_cores</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_PolynomialRegression.degree"><code class="docutils literal notranslate"><span class="pre">WAS_PolynomialRegression.degree</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_PolynomialRegression.dist_method"><code class="docutils literal notranslate"><span class="pre">WAS_PolynomialRegression.dist_method</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_PolynomialRegression.fit_predict"><code class="docutils literal notranslate"><span class="pre">WAS_PolynomialRegression.fit_predict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_PolynomialRegression.compute_model"><code class="docutils literal notranslate"><span class="pre">WAS_PolynomialRegression.compute_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_PolynomialRegression.compute_prob"><code class="docutils literal notranslate"><span class="pre">WAS_PolynomialRegression.compute_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_PolynomialRegression.forecast"><code class="docutils literal notranslate"><span class="pre">WAS_PolynomialRegression.forecast()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_PolynomialRegression.calculate_tercile_probabilities_gamma"><code class="docutils literal notranslate"><span class="pre">WAS_PolynomialRegression.calculate_tercile_probabilities_gamma()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_PolynomialRegression.calculate_tercile_probabilities_lognormal"><code class="docutils literal notranslate"><span class="pre">WAS_PolynomialRegression.calculate_tercile_probabilities_lognormal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_PolynomialRegression.calculate_tercile_probabilities_nonparametric"><code class="docutils literal notranslate"><span class="pre">WAS_PolynomialRegression.calculate_tercile_probabilities_nonparametric()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_PolynomialRegression.calculate_tercile_probabilities_normal"><code class="docutils literal notranslate"><span class="pre">WAS_PolynomialRegression.calculate_tercile_probabilities_normal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_PolynomialRegression.calculate_tercile_probabilities_t"><code class="docutils literal notranslate"><span class="pre">WAS_PolynomialRegression.calculate_tercile_probabilities_t()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id21"><code class="docutils literal notranslate"><span class="pre">WAS_PolynomialRegression.compute_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id22"><code class="docutils literal notranslate"><span class="pre">WAS_PolynomialRegression.compute_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id23"><code class="docutils literal notranslate"><span class="pre">WAS_PolynomialRegression.fit_predict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id24"><code class="docutils literal notranslate"><span class="pre">WAS_PolynomialRegression.forecast()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_RandomForest_XGBoost_ML_Stacking"><code class="docutils literal notranslate"><span class="pre">WAS_RandomForest_XGBoost_ML_Stacking</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_RandomForest_XGBoost_ML_Stacking.calculate_tercile_probabilities"><code class="docutils literal notranslate"><span class="pre">WAS_RandomForest_XGBoost_ML_Stacking.calculate_tercile_probabilities()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_RandomForest_XGBoost_ML_Stacking.calculate_tercile_probabilities_gamma"><code class="docutils literal notranslate"><span class="pre">WAS_RandomForest_XGBoost_ML_Stacking.calculate_tercile_probabilities_gamma()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_RandomForest_XGBoost_ML_Stacking.calculate_tercile_probabilities_lognormal"><code class="docutils literal notranslate"><span class="pre">WAS_RandomForest_XGBoost_ML_Stacking.calculate_tercile_probabilities_lognormal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_RandomForest_XGBoost_ML_Stacking.calculate_tercile_probabilities_nonparametric"><code class="docutils literal notranslate"><span class="pre">WAS_RandomForest_XGBoost_ML_Stacking.calculate_tercile_probabilities_nonparametric()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_RandomForest_XGBoost_ML_Stacking.calculate_tercile_probabilities_normal"><code class="docutils literal notranslate"><span class="pre">WAS_RandomForest_XGBoost_ML_Stacking.calculate_tercile_probabilities_normal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_RandomForest_XGBoost_ML_Stacking.compute_hyperparameters"><code class="docutils literal notranslate"><span class="pre">WAS_RandomForest_XGBoost_ML_Stacking.compute_hyperparameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_RandomForest_XGBoost_ML_Stacking.compute_model"><code class="docutils literal notranslate"><span class="pre">WAS_RandomForest_XGBoost_ML_Stacking.compute_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_RandomForest_XGBoost_ML_Stacking.compute_prob"><code class="docutils literal notranslate"><span class="pre">WAS_RandomForest_XGBoost_ML_Stacking.compute_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_RandomForest_XGBoost_ML_Stacking.fit_predict"><code class="docutils literal notranslate"><span class="pre">WAS_RandomForest_XGBoost_ML_Stacking.fit_predict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_RandomForest_XGBoost_ML_Stacking.forecast"><code class="docutils literal notranslate"><span class="pre">WAS_RandomForest_XGBoost_ML_Stacking.forecast()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_RandomForest_XGBoost_Stacking_MLP"><code class="docutils literal notranslate"><span class="pre">WAS_RandomForest_XGBoost_Stacking_MLP</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_RandomForest_XGBoost_Stacking_MLP.calculate_tercile_probabilities"><code class="docutils literal notranslate"><span class="pre">WAS_RandomForest_XGBoost_Stacking_MLP.calculate_tercile_probabilities()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_RandomForest_XGBoost_Stacking_MLP.calculate_tercile_probabilities_gamma"><code class="docutils literal notranslate"><span class="pre">WAS_RandomForest_XGBoost_Stacking_MLP.calculate_tercile_probabilities_gamma()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_RandomForest_XGBoost_Stacking_MLP.calculate_tercile_probabilities_lognormal"><code class="docutils literal notranslate"><span class="pre">WAS_RandomForest_XGBoost_Stacking_MLP.calculate_tercile_probabilities_lognormal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_RandomForest_XGBoost_Stacking_MLP.calculate_tercile_probabilities_nonparametric"><code class="docutils literal notranslate"><span class="pre">WAS_RandomForest_XGBoost_Stacking_MLP.calculate_tercile_probabilities_nonparametric()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_RandomForest_XGBoost_Stacking_MLP.calculate_tercile_probabilities_normal"><code class="docutils literal notranslate"><span class="pre">WAS_RandomForest_XGBoost_Stacking_MLP.calculate_tercile_probabilities_normal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_RandomForest_XGBoost_Stacking_MLP.compute_hyperparameters"><code class="docutils literal notranslate"><span class="pre">WAS_RandomForest_XGBoost_Stacking_MLP.compute_hyperparameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_RandomForest_XGBoost_Stacking_MLP.compute_model"><code class="docutils literal notranslate"><span class="pre">WAS_RandomForest_XGBoost_Stacking_MLP.compute_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_RandomForest_XGBoost_Stacking_MLP.compute_prob"><code class="docutils literal notranslate"><span class="pre">WAS_RandomForest_XGBoost_Stacking_MLP.compute_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_RandomForest_XGBoost_Stacking_MLP.fit_predict"><code class="docutils literal notranslate"><span class="pre">WAS_RandomForest_XGBoost_Stacking_MLP.fit_predict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_RandomForest_XGBoost_Stacking_MLP.forecast"><code class="docutils literal notranslate"><span class="pre">WAS_RandomForest_XGBoost_Stacking_MLP.forecast()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_SVR"><code class="docutils literal notranslate"><span class="pre">WAS_SVR</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_SVR.nb_cores"><code class="docutils literal notranslate"><span class="pre">WAS_SVR.nb_cores</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_SVR.n_clusters"><code class="docutils literal notranslate"><span class="pre">WAS_SVR.n_clusters</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_SVR.kernel"><code class="docutils literal notranslate"><span class="pre">WAS_SVR.kernel</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_SVR.gamma"><code class="docutils literal notranslate"><span class="pre">WAS_SVR.gamma</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_SVR.C_range"><code class="docutils literal notranslate"><span class="pre">WAS_SVR.C_range</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_SVR.epsilon_range"><code class="docutils literal notranslate"><span class="pre">WAS_SVR.epsilon_range</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_SVR.degree_range"><code class="docutils literal notranslate"><span class="pre">WAS_SVR.degree_range</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_SVR.dist_method"><code class="docutils literal notranslate"><span class="pre">WAS_SVR.dist_method</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_SVR.calculate_tercile_probabilities"><code class="docutils literal notranslate"><span class="pre">WAS_SVR.calculate_tercile_probabilities()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_SVR.calculate_tercile_probabilities_gamma"><code class="docutils literal notranslate"><span class="pre">WAS_SVR.calculate_tercile_probabilities_gamma()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_SVR.calculate_tercile_probabilities_lognormal"><code class="docutils literal notranslate"><span class="pre">WAS_SVR.calculate_tercile_probabilities_lognormal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_SVR.calculate_tercile_probabilities_nonparametric"><code class="docutils literal notranslate"><span class="pre">WAS_SVR.calculate_tercile_probabilities_nonparametric()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_SVR.calculate_tercile_probabilities_normal"><code class="docutils literal notranslate"><span class="pre">WAS_SVR.calculate_tercile_probabilities_normal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_SVR.compute_hyperparameters"><code class="docutils literal notranslate"><span class="pre">WAS_SVR.compute_hyperparameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_SVR.compute_model"><code class="docutils literal notranslate"><span class="pre">WAS_SVR.compute_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_SVR.compute_prob"><code class="docutils literal notranslate"><span class="pre">WAS_SVR.compute_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_SVR.fit_predict"><code class="docutils literal notranslate"><span class="pre">WAS_SVR.fit_predict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_SVR.forecast"><code class="docutils literal notranslate"><span class="pre">WAS_SVR.forecast()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_Stacking_Ridge"><code class="docutils literal notranslate"><span class="pre">WAS_Stacking_Ridge</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_Stacking_Ridge.compute_hyperparameters"><code class="docutils literal notranslate"><span class="pre">WAS_Stacking_Ridge.compute_hyperparameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_Stacking_Ridge.fit_predict"><code class="docutils literal notranslate"><span class="pre">WAS_Stacking_Ridge.fit_predict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_Stacking_Ridge.compute_model"><code class="docutils literal notranslate"><span class="pre">WAS_Stacking_Ridge.compute_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_Stacking_Ridge.compute_prob"><code class="docutils literal notranslate"><span class="pre">WAS_Stacking_Ridge.compute_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_Stacking_Ridge.forecast"><code class="docutils literal notranslate"><span class="pre">WAS_Stacking_Ridge.forecast()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_Stacking_Ridge.calculate_tercile_probabilities"><code class="docutils literal notranslate"><span class="pre">WAS_Stacking_Ridge.calculate_tercile_probabilities()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_Stacking_Ridge.calculate_tercile_probabilities_gamma"><code class="docutils literal notranslate"><span class="pre">WAS_Stacking_Ridge.calculate_tercile_probabilities_gamma()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_Stacking_Ridge.calculate_tercile_probabilities_lognormal"><code class="docutils literal notranslate"><span class="pre">WAS_Stacking_Ridge.calculate_tercile_probabilities_lognormal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_Stacking_Ridge.calculate_tercile_probabilities_nonparametric"><code class="docutils literal notranslate"><span class="pre">WAS_Stacking_Ridge.calculate_tercile_probabilities_nonparametric()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_machine_learning.WAS_Stacking_Ridge.calculate_tercile_probabilities_normal"><code class="docutils literal notranslate"><span class="pre">WAS_Stacking_Ridge.calculate_tercile_probabilities_normal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id25"><code class="docutils literal notranslate"><span class="pre">WAS_Stacking_Ridge.compute_hyperparameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id26"><code class="docutils literal notranslate"><span class="pre">WAS_Stacking_Ridge.compute_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id27"><code class="docutils literal notranslate"><span class="pre">WAS_Stacking_Ridge.compute_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id28"><code class="docutils literal notranslate"><span class="pre">WAS_Stacking_Ridge.fit_predict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#id29"><code class="docutils literal notranslate"><span class="pre">WAS_Stacking_Ridge.forecast()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-wass2s.was_analog">wass2s.was_analog module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_analog.WAS_Analog"><code class="docutils literal notranslate"><span class="pre">WAS_Analog</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_analog.WAS_Analog.Corr_Based"><code class="docutils literal notranslate"><span class="pre">WAS_Analog.Corr_Based()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_analog.WAS_Analog.Pca_Based"><code class="docutils literal notranslate"><span class="pre">WAS_Analog.Pca_Based()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_analog.WAS_Analog.SOM"><code class="docutils literal notranslate"><span class="pre">WAS_Analog.SOM()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_analog.WAS_Analog.calc_index"><code class="docutils literal notranslate"><span class="pre">WAS_Analog.calc_index()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_analog.WAS_Analog.calculate_tercile_probabilities"><code class="docutils literal notranslate"><span class="pre">WAS_Analog.calculate_tercile_probabilities()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_analog.WAS_Analog.calculate_tercile_probabilities_gamma"><code class="docutils literal notranslate"><span class="pre">WAS_Analog.calculate_tercile_probabilities_gamma()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_analog.WAS_Analog.calculate_tercile_probabilities_lognormal"><code class="docutils literal notranslate"><span class="pre">WAS_Analog.calculate_tercile_probabilities_lognormal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_analog.WAS_Analog.calculate_tercile_probabilities_nonparametric"><code class="docutils literal notranslate"><span class="pre">WAS_Analog.calculate_tercile_probabilities_nonparametric()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_analog.WAS_Analog.calculate_tercile_probabilities_normal"><code class="docutils literal notranslate"><span class="pre">WAS_Analog.calculate_tercile_probabilities_normal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_analog.WAS_Analog.composite_plot"><code class="docutils literal notranslate"><span class="pre">WAS_Analog.composite_plot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_analog.WAS_Analog.compute_model"><code class="docutils literal notranslate"><span class="pre">WAS_Analog.compute_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_analog.WAS_Analog.compute_prob"><code class="docutils literal notranslate"><span class="pre">WAS_Analog.compute_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_analog.WAS_Analog.download_and_process"><code class="docutils literal notranslate"><span class="pre">WAS_Analog.download_and_process()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_analog.WAS_Analog.download_models"><code class="docutils literal notranslate"><span class="pre">WAS_Analog.download_models()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_analog.WAS_Analog.download_sst_reanalysis"><code class="docutils literal notranslate"><span class="pre">WAS_Analog.download_sst_reanalysis()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_analog.WAS_Analog.forecast"><code class="docutils literal notranslate"><span class="pre">WAS_Analog.forecast()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_analog.WAS_Analog.plot_indices"><code class="docutils literal notranslate"><span class="pre">WAS_Analog.plot_indices()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_analog.WAS_Analog.standardize_timeseries"><code class="docutils literal notranslate"><span class="pre">WAS_Analog.standardize_timeseries()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-wass2s.was_mme">wass2s.was_mme module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_mme.BMA"><code class="docutils literal notranslate"><span class="pre">BMA</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.BMA.compute_error_based_prior"><code class="docutils literal notranslate"><span class="pre">BMA.compute_error_based_prior()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.BMA.compute_model_posterior_probs"><code class="docutils literal notranslate"><span class="pre">BMA.compute_model_posterior_probs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.BMA.fit_models_pymc"><code class="docutils literal notranslate"><span class="pre">BMA.fit_models_pymc()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.BMA.predict"><code class="docutils literal notranslate"><span class="pre">BMA.predict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.BMA.predict_in_sample"><code class="docutils literal notranslate"><span class="pre">BMA.predict_in_sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.BMA.summary"><code class="docutils literal notranslate"><span class="pre">BMA.summary()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_mme.NonHomogeneousGaussianRegression"><code class="docutils literal notranslate"><span class="pre">NonHomogeneousGaussianRegression</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_mme.WAS_Min2009_ProbWeighted"><code class="docutils literal notranslate"><span class="pre">WAS_Min2009_ProbWeighted</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_Min2009_ProbWeighted.compute"><code class="docutils literal notranslate"><span class="pre">WAS_Min2009_ProbWeighted.compute()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_AdaBoost"><code class="docutils literal notranslate"><span class="pre">WAS_mme_AdaBoost</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_AdaBoost.calculate_tercile_probabilities"><code class="docutils literal notranslate"><span class="pre">WAS_mme_AdaBoost.calculate_tercile_probabilities()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_AdaBoost.calculate_tercile_probabilities_gamma"><code class="docutils literal notranslate"><span class="pre">WAS_mme_AdaBoost.calculate_tercile_probabilities_gamma()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_AdaBoost.calculate_tercile_probabilities_lognormal"><code class="docutils literal notranslate"><span class="pre">WAS_mme_AdaBoost.calculate_tercile_probabilities_lognormal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_AdaBoost.calculate_tercile_probabilities_nonparametric"><code class="docutils literal notranslate"><span class="pre">WAS_mme_AdaBoost.calculate_tercile_probabilities_nonparametric()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_AdaBoost.calculate_tercile_probabilities_normal"><code class="docutils literal notranslate"><span class="pre">WAS_mme_AdaBoost.calculate_tercile_probabilities_normal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_AdaBoost.calculate_tercile_probabilities_weibull_min"><code class="docutils literal notranslate"><span class="pre">WAS_mme_AdaBoost.calculate_tercile_probabilities_weibull_min()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_AdaBoost.compute_model"><code class="docutils literal notranslate"><span class="pre">WAS_mme_AdaBoost.compute_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_AdaBoost.compute_prob"><code class="docutils literal notranslate"><span class="pre">WAS_mme_AdaBoost.compute_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_AdaBoost.forecast"><code class="docutils literal notranslate"><span class="pre">WAS_mme_AdaBoost.forecast()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_BMA"><code class="docutils literal notranslate"><span class="pre">WAS_mme_BMA</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_BMA.calculate_tercile_probabilities"><code class="docutils literal notranslate"><span class="pre">WAS_mme_BMA.calculate_tercile_probabilities()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_BMA.calculate_tercile_probabilities_gamma"><code class="docutils literal notranslate"><span class="pre">WAS_mme_BMA.calculate_tercile_probabilities_gamma()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_BMA.calculate_tercile_probabilities_lognormal"><code class="docutils literal notranslate"><span class="pre">WAS_mme_BMA.calculate_tercile_probabilities_lognormal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_BMA.calculate_tercile_probabilities_nonparametric"><code class="docutils literal notranslate"><span class="pre">WAS_mme_BMA.calculate_tercile_probabilities_nonparametric()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_BMA.calculate_tercile_probabilities_normal"><code class="docutils literal notranslate"><span class="pre">WAS_mme_BMA.calculate_tercile_probabilities_normal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_BMA.calculate_tercile_probabilities_weibull_min"><code class="docutils literal notranslate"><span class="pre">WAS_mme_BMA.calculate_tercile_probabilities_weibull_min()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_BMA.compute"><code class="docutils literal notranslate"><span class="pre">WAS_mme_BMA.compute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_BMA.compute_prob"><code class="docutils literal notranslate"><span class="pre">WAS_mme_BMA.compute_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_BMA.forecast"><code class="docutils literal notranslate"><span class="pre">WAS_mme_BMA.forecast()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_BMA.summary"><code class="docutils literal notranslate"><span class="pre">WAS_mme_BMA.summary()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_ELM"><code class="docutils literal notranslate"><span class="pre">WAS_mme_ELM</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_ELM.calculate_tercile_probabilities"><code class="docutils literal notranslate"><span class="pre">WAS_mme_ELM.calculate_tercile_probabilities()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_ELM.calculate_tercile_probabilities_gamma"><code class="docutils literal notranslate"><span class="pre">WAS_mme_ELM.calculate_tercile_probabilities_gamma()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_ELM.calculate_tercile_probabilities_lognormal"><code class="docutils literal notranslate"><span class="pre">WAS_mme_ELM.calculate_tercile_probabilities_lognormal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_ELM.calculate_tercile_probabilities_nonparametric"><code class="docutils literal notranslate"><span class="pre">WAS_mme_ELM.calculate_tercile_probabilities_nonparametric()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_ELM.calculate_tercile_probabilities_normal"><code class="docutils literal notranslate"><span class="pre">WAS_mme_ELM.calculate_tercile_probabilities_normal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_ELM.calculate_tercile_probabilities_weibull_min"><code class="docutils literal notranslate"><span class="pre">WAS_mme_ELM.calculate_tercile_probabilities_weibull_min()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_ELM.compute_model"><code class="docutils literal notranslate"><span class="pre">WAS_mme_ELM.compute_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_ELM.compute_prob"><code class="docutils literal notranslate"><span class="pre">WAS_mme_ELM.compute_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_ELM.forecast"><code class="docutils literal notranslate"><span class="pre">WAS_mme_ELM.forecast()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_ELR"><code class="docutils literal notranslate"><span class="pre">WAS_mme_ELR</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_ELR.compute_model"><code class="docutils literal notranslate"><span class="pre">WAS_mme_ELR.compute_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_ELR.forecast"><code class="docutils literal notranslate"><span class="pre">WAS_mme_ELR.forecast()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_GA"><code class="docutils literal notranslate"><span class="pre">WAS_mme_GA</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_GA.calculate_tercile_probabilities"><code class="docutils literal notranslate"><span class="pre">WAS_mme_GA.calculate_tercile_probabilities()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_GA.calculate_tercile_probabilities_gamma"><code class="docutils literal notranslate"><span class="pre">WAS_mme_GA.calculate_tercile_probabilities_gamma()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_GA.calculate_tercile_probabilities_lognormal"><code class="docutils literal notranslate"><span class="pre">WAS_mme_GA.calculate_tercile_probabilities_lognormal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_GA.calculate_tercile_probabilities_nonparametric"><code class="docutils literal notranslate"><span class="pre">WAS_mme_GA.calculate_tercile_probabilities_nonparametric()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_GA.calculate_tercile_probabilities_normal"><code class="docutils literal notranslate"><span class="pre">WAS_mme_GA.calculate_tercile_probabilities_normal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_GA.calculate_tercile_probabilities_weibull_min"><code class="docutils literal notranslate"><span class="pre">WAS_mme_GA.calculate_tercile_probabilities_weibull_min()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_GA.compute_model"><code class="docutils literal notranslate"><span class="pre">WAS_mme_GA.compute_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_GA.compute_prob"><code class="docutils literal notranslate"><span class="pre">WAS_mme_GA.compute_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_GA.forecast"><code class="docutils literal notranslate"><span class="pre">WAS_mme_GA.forecast()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_GradientBoosting"><code class="docutils literal notranslate"><span class="pre">WAS_mme_GradientBoosting</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_GradientBoosting.calculate_tercile_probabilities"><code class="docutils literal notranslate"><span class="pre">WAS_mme_GradientBoosting.calculate_tercile_probabilities()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_GradientBoosting.calculate_tercile_probabilities_gamma"><code class="docutils literal notranslate"><span class="pre">WAS_mme_GradientBoosting.calculate_tercile_probabilities_gamma()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_GradientBoosting.calculate_tercile_probabilities_lognormal"><code class="docutils literal notranslate"><span class="pre">WAS_mme_GradientBoosting.calculate_tercile_probabilities_lognormal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_GradientBoosting.calculate_tercile_probabilities_nonparametric"><code class="docutils literal notranslate"><span class="pre">WAS_mme_GradientBoosting.calculate_tercile_probabilities_nonparametric()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_GradientBoosting.calculate_tercile_probabilities_normal"><code class="docutils literal notranslate"><span class="pre">WAS_mme_GradientBoosting.calculate_tercile_probabilities_normal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_GradientBoosting.calculate_tercile_probabilities_weibull_min"><code class="docutils literal notranslate"><span class="pre">WAS_mme_GradientBoosting.calculate_tercile_probabilities_weibull_min()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_GradientBoosting.compute_model"><code class="docutils literal notranslate"><span class="pre">WAS_mme_GradientBoosting.compute_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_GradientBoosting.compute_prob"><code class="docutils literal notranslate"><span class="pre">WAS_mme_GradientBoosting.compute_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_GradientBoosting.forecast"><code class="docutils literal notranslate"><span class="pre">WAS_mme_GradientBoosting.forecast()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_LGBM_Boosting"><code class="docutils literal notranslate"><span class="pre">WAS_mme_LGBM_Boosting</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_LGBM_Boosting.calculate_tercile_probabilities"><code class="docutils literal notranslate"><span class="pre">WAS_mme_LGBM_Boosting.calculate_tercile_probabilities()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_LGBM_Boosting.calculate_tercile_probabilities_gamma"><code class="docutils literal notranslate"><span class="pre">WAS_mme_LGBM_Boosting.calculate_tercile_probabilities_gamma()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_LGBM_Boosting.calculate_tercile_probabilities_lognormal"><code class="docutils literal notranslate"><span class="pre">WAS_mme_LGBM_Boosting.calculate_tercile_probabilities_lognormal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_LGBM_Boosting.calculate_tercile_probabilities_nonparametric"><code class="docutils literal notranslate"><span class="pre">WAS_mme_LGBM_Boosting.calculate_tercile_probabilities_nonparametric()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_LGBM_Boosting.calculate_tercile_probabilities_normal"><code class="docutils literal notranslate"><span class="pre">WAS_mme_LGBM_Boosting.calculate_tercile_probabilities_normal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_LGBM_Boosting.calculate_tercile_probabilities_weibull_min"><code class="docutils literal notranslate"><span class="pre">WAS_mme_LGBM_Boosting.calculate_tercile_probabilities_weibull_min()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_LGBM_Boosting.compute_model"><code class="docutils literal notranslate"><span class="pre">WAS_mme_LGBM_Boosting.compute_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_LGBM_Boosting.compute_prob"><code class="docutils literal notranslate"><span class="pre">WAS_mme_LGBM_Boosting.compute_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_LGBM_Boosting.forecast"><code class="docutils literal notranslate"><span class="pre">WAS_mme_LGBM_Boosting.forecast()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_MLP"><code class="docutils literal notranslate"><span class="pre">WAS_mme_MLP</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_MLP.calculate_tercile_probabilities"><code class="docutils literal notranslate"><span class="pre">WAS_mme_MLP.calculate_tercile_probabilities()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_MLP.calculate_tercile_probabilities_gamma"><code class="docutils literal notranslate"><span class="pre">WAS_mme_MLP.calculate_tercile_probabilities_gamma()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_MLP.calculate_tercile_probabilities_lognormal"><code class="docutils literal notranslate"><span class="pre">WAS_mme_MLP.calculate_tercile_probabilities_lognormal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_MLP.calculate_tercile_probabilities_nonparametric"><code class="docutils literal notranslate"><span class="pre">WAS_mme_MLP.calculate_tercile_probabilities_nonparametric()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_MLP.calculate_tercile_probabilities_normal"><code class="docutils literal notranslate"><span class="pre">WAS_mme_MLP.calculate_tercile_probabilities_normal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_MLP.calculate_tercile_probabilities_weibull_min"><code class="docutils literal notranslate"><span class="pre">WAS_mme_MLP.calculate_tercile_probabilities_weibull_min()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_MLP.compute_model"><code class="docutils literal notranslate"><span class="pre">WAS_mme_MLP.compute_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_MLP.compute_prob"><code class="docutils literal notranslate"><span class="pre">WAS_mme_MLP.compute_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_MLP.forecast"><code class="docutils literal notranslate"><span class="pre">WAS_mme_MLP.forecast()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_StackXGboost_Ml"><code class="docutils literal notranslate"><span class="pre">WAS_mme_StackXGboost_Ml</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_StackXGboost_Ml.calculate_tercile_probabilities"><code class="docutils literal notranslate"><span class="pre">WAS_mme_StackXGboost_Ml.calculate_tercile_probabilities()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_StackXGboost_Ml.calculate_tercile_probabilities_gamma"><code class="docutils literal notranslate"><span class="pre">WAS_mme_StackXGboost_Ml.calculate_tercile_probabilities_gamma()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_StackXGboost_Ml.calculate_tercile_probabilities_lognormal"><code class="docutils literal notranslate"><span class="pre">WAS_mme_StackXGboost_Ml.calculate_tercile_probabilities_lognormal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_StackXGboost_Ml.calculate_tercile_probabilities_nonparametric"><code class="docutils literal notranslate"><span class="pre">WAS_mme_StackXGboost_Ml.calculate_tercile_probabilities_nonparametric()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_StackXGboost_Ml.calculate_tercile_probabilities_normal"><code class="docutils literal notranslate"><span class="pre">WAS_mme_StackXGboost_Ml.calculate_tercile_probabilities_normal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_StackXGboost_Ml.calculate_tercile_probabilities_weibull_min"><code class="docutils literal notranslate"><span class="pre">WAS_mme_StackXGboost_Ml.calculate_tercile_probabilities_weibull_min()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_StackXGboost_Ml.compute_model"><code class="docutils literal notranslate"><span class="pre">WAS_mme_StackXGboost_Ml.compute_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_StackXGboost_Ml.compute_prob"><code class="docutils literal notranslate"><span class="pre">WAS_mme_StackXGboost_Ml.compute_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_StackXGboost_Ml.forecast"><code class="docutils literal notranslate"><span class="pre">WAS_mme_StackXGboost_Ml.forecast()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_KNN_Tree_SVR"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_KNN_Tree_SVR</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_KNN_Tree_SVR.calculate_tercile_probabilities"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_KNN_Tree_SVR.calculate_tercile_probabilities()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_KNN_Tree_SVR.calculate_tercile_probabilities_gamma"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_KNN_Tree_SVR.calculate_tercile_probabilities_gamma()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_KNN_Tree_SVR.calculate_tercile_probabilities_lognormal"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_KNN_Tree_SVR.calculate_tercile_probabilities_lognormal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_KNN_Tree_SVR.calculate_tercile_probabilities_nonparametric"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_KNN_Tree_SVR.calculate_tercile_probabilities_nonparametric()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_KNN_Tree_SVR.calculate_tercile_probabilities_normal"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_KNN_Tree_SVR.calculate_tercile_probabilities_normal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_KNN_Tree_SVR.calculate_tercile_probabilities_weibull_min"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_KNN_Tree_SVR.calculate_tercile_probabilities_weibull_min()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_KNN_Tree_SVR.compute_model"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_KNN_Tree_SVR.compute_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_KNN_Tree_SVR.compute_prob"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_KNN_Tree_SVR.compute_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_KNN_Tree_SVR.forecast"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_KNN_Tree_SVR.forecast()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_Lasso_RF_MLP"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_Lasso_RF_MLP</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_Lasso_RF_MLP.calculate_tercile_probabilities"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_Lasso_RF_MLP.calculate_tercile_probabilities()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_Lasso_RF_MLP.calculate_tercile_probabilities_gamma"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_Lasso_RF_MLP.calculate_tercile_probabilities_gamma()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_Lasso_RF_MLP.calculate_tercile_probabilities_lognormal"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_Lasso_RF_MLP.calculate_tercile_probabilities_lognormal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_Lasso_RF_MLP.calculate_tercile_probabilities_nonparametric"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_Lasso_RF_MLP.calculate_tercile_probabilities_nonparametric()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_Lasso_RF_MLP.calculate_tercile_probabilities_normal"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_Lasso_RF_MLP.calculate_tercile_probabilities_normal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_Lasso_RF_MLP.calculate_tercile_probabilities_weibull_min"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_Lasso_RF_MLP.calculate_tercile_probabilities_weibull_min()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_Lasso_RF_MLP.compute_model"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_Lasso_RF_MLP.compute_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_Lasso_RF_MLP.compute_prob"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_Lasso_RF_MLP.compute_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_Lasso_RF_MLP.forecast"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_Lasso_RF_MLP.forecast()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_MLP_Ada_Ridge"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_MLP_Ada_Ridge</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_MLP_Ada_Ridge.calculate_tercile_probabilities"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_MLP_Ada_Ridge.calculate_tercile_probabilities()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_MLP_Ada_Ridge.calculate_tercile_probabilities_gamma"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_MLP_Ada_Ridge.calculate_tercile_probabilities_gamma()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_MLP_Ada_Ridge.calculate_tercile_probabilities_lognormal"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_MLP_Ada_Ridge.calculate_tercile_probabilities_lognormal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_MLP_Ada_Ridge.calculate_tercile_probabilities_nonparametric"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_MLP_Ada_Ridge.calculate_tercile_probabilities_nonparametric()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_MLP_Ada_Ridge.calculate_tercile_probabilities_normal"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_MLP_Ada_Ridge.calculate_tercile_probabilities_normal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_MLP_Ada_Ridge.calculate_tercile_probabilities_weibull_min"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_MLP_Ada_Ridge.calculate_tercile_probabilities_weibull_min()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_MLP_Ada_Ridge.compute_model"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_MLP_Ada_Ridge.compute_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_MLP_Ada_Ridge.compute_prob"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_MLP_Ada_Ridge.compute_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_MLP_Ada_Ridge.forecast"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_MLP_Ada_Ridge.forecast()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_MLP_RF"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_MLP_RF</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_MLP_RF.calculate_tercile_probabilities"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_MLP_RF.calculate_tercile_probabilities()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_MLP_RF.calculate_tercile_probabilities_gamma"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_MLP_RF.calculate_tercile_probabilities_gamma()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_MLP_RF.calculate_tercile_probabilities_lognormal"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_MLP_RF.calculate_tercile_probabilities_lognormal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_MLP_RF.calculate_tercile_probabilities_nonparametric"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_MLP_RF.calculate_tercile_probabilities_nonparametric()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_MLP_RF.calculate_tercile_probabilities_normal"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_MLP_RF.calculate_tercile_probabilities_normal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_MLP_RF.calculate_tercile_probabilities_weibull_min"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_MLP_RF.calculate_tercile_probabilities_weibull_min()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_MLP_RF.compute_model"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_MLP_RF.compute_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_MLP_RF.compute_prob"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_MLP_RF.compute_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_MLP_RF.forecast"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_MLP_RF.forecast()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_RF_GB_Ridge"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_RF_GB_Ridge</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_RF_GB_Ridge.calculate_tercile_probabilities"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_RF_GB_Ridge.calculate_tercile_probabilities()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_RF_GB_Ridge.calculate_tercile_probabilities_gamma"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_RF_GB_Ridge.calculate_tercile_probabilities_gamma()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_RF_GB_Ridge.calculate_tercile_probabilities_lognormal"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_RF_GB_Ridge.calculate_tercile_probabilities_lognormal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_RF_GB_Ridge.calculate_tercile_probabilities_nonparametric"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_RF_GB_Ridge.calculate_tercile_probabilities_nonparametric()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_RF_GB_Ridge.calculate_tercile_probabilities_normal"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_RF_GB_Ridge.calculate_tercile_probabilities_normal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_RF_GB_Ridge.calculate_tercile_probabilities_weibull_min"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_RF_GB_Ridge.calculate_tercile_probabilities_weibull_min()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_RF_GB_Ridge.compute_model"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_RF_GB_Ridge.compute_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_RF_GB_Ridge.compute_prob"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_RF_GB_Ridge.compute_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Stack_RF_GB_Ridge.forecast"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Stack_RF_GB_Ridge.forecast()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Weighted"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Weighted</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Weighted.calculate_tercile_probabilities"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Weighted.calculate_tercile_probabilities()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Weighted.calculate_tercile_probabilities_gamma"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Weighted.calculate_tercile_probabilities_gamma()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Weighted.calculate_tercile_probabilities_lognormal"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Weighted.calculate_tercile_probabilities_lognormal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Weighted.calculate_tercile_probabilities_nonparametric"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Weighted.calculate_tercile_probabilities_nonparametric()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Weighted.calculate_tercile_probabilities_normal"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Weighted.calculate_tercile_probabilities_normal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Weighted.calculate_tercile_probabilities_weibull_min"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Weighted.calculate_tercile_probabilities_weibull_min()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Weighted.compute"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Weighted.compute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Weighted.compute_prob"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Weighted.compute_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Weighted.forecast"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Weighted.forecast()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_Weighted.transform_score"><code class="docutils literal notranslate"><span class="pre">WAS_mme_Weighted.transform_score()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_XGBoosting"><code class="docutils literal notranslate"><span class="pre">WAS_mme_XGBoosting</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_XGBoosting.calculate_tercile_probabilities"><code class="docutils literal notranslate"><span class="pre">WAS_mme_XGBoosting.calculate_tercile_probabilities()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_XGBoosting.calculate_tercile_probabilities_gamma"><code class="docutils literal notranslate"><span class="pre">WAS_mme_XGBoosting.calculate_tercile_probabilities_gamma()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_XGBoosting.calculate_tercile_probabilities_lognormal"><code class="docutils literal notranslate"><span class="pre">WAS_mme_XGBoosting.calculate_tercile_probabilities_lognormal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_XGBoosting.calculate_tercile_probabilities_nonparametric"><code class="docutils literal notranslate"><span class="pre">WAS_mme_XGBoosting.calculate_tercile_probabilities_nonparametric()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_XGBoosting.calculate_tercile_probabilities_normal"><code class="docutils literal notranslate"><span class="pre">WAS_mme_XGBoosting.calculate_tercile_probabilities_normal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_XGBoosting.calculate_tercile_probabilities_weibull_min"><code class="docutils literal notranslate"><span class="pre">WAS_mme_XGBoosting.calculate_tercile_probabilities_weibull_min()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_XGBoosting.compute_model"><code class="docutils literal notranslate"><span class="pre">WAS_mme_XGBoosting.compute_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_XGBoosting.compute_prob"><code class="docutils literal notranslate"><span class="pre">WAS_mme_XGBoosting.compute_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_mme.WAS_mme_XGBoosting.forecast"><code class="docutils literal notranslate"><span class="pre">WAS_mme_XGBoosting.forecast()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_mme.myfill"><code class="docutils literal notranslate"><span class="pre">myfill()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_mme.process_datasets_for_mme"><code class="docutils literal notranslate"><span class="pre">process_datasets_for_mme()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_mme.process_datasets_for_mme_"><code class="docutils literal notranslate"><span class="pre">process_datasets_for_mme_()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-wass2s.was_verification">wass2s.was_verification module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.was_verification.WAS_Verification"><code class="docutils literal notranslate"><span class="pre">WAS_Verification</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_verification.WAS_Verification.calculate_groc"><code class="docutils literal notranslate"><span class="pre">WAS_Verification.calculate_groc()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_verification.WAS_Verification.calculate_rpss"><code class="docutils literal notranslate"><span class="pre">WAS_Verification.calculate_rpss()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_verification.WAS_Verification.calculate_rpss_"><code class="docutils literal notranslate"><span class="pre">WAS_Verification.calculate_rpss_()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_verification.WAS_Verification.calculate_tercile_probabilities"><code class="docutils literal notranslate"><span class="pre">WAS_Verification.calculate_tercile_probabilities()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_verification.WAS_Verification.calculate_tercile_probabilities_gamma"><code class="docutils literal notranslate"><span class="pre">WAS_Verification.calculate_tercile_probabilities_gamma()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_verification.WAS_Verification.calculate_tercile_probabilities_lognormal"><code class="docutils literal notranslate"><span class="pre">WAS_Verification.calculate_tercile_probabilities_lognormal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_verification.WAS_Verification.calculate_tercile_probabilities_nonparametric"><code class="docutils literal notranslate"><span class="pre">WAS_Verification.calculate_tercile_probabilities_nonparametric()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_verification.WAS_Verification.calculate_tercile_probabilities_normal"><code class="docutils literal notranslate"><span class="pre">WAS_Verification.calculate_tercile_probabilities_normal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_verification.WAS_Verification.calculate_tercile_probabilities_weibull_min"><code class="docutils literal notranslate"><span class="pre">WAS_Verification.calculate_tercile_probabilities_weibull_min()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_verification.WAS_Verification.classify"><code class="docutils literal notranslate"><span class="pre">WAS_Verification.classify()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_verification.WAS_Verification.classify_data_into_terciles"><code class="docutils literal notranslate"><span class="pre">WAS_Verification.classify_data_into_terciles()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_verification.WAS_Verification.classify_percent"><code class="docutils literal notranslate"><span class="pre">WAS_Verification.classify_percent()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_verification.WAS_Verification.compute_class"><code class="docutils literal notranslate"><span class="pre">WAS_Verification.compute_class()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_verification.WAS_Verification.compute_crps"><code class="docutils literal notranslate"><span class="pre">WAS_Verification.compute_crps()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_verification.WAS_Verification.compute_deterministic_score"><code class="docutils literal notranslate"><span class="pre">WAS_Verification.compute_deterministic_score()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_verification.WAS_Verification.compute_one_year_rpss"><code class="docutils literal notranslate"><span class="pre">WAS_Verification.compute_one_year_rpss()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_verification.WAS_Verification.compute_probabilistic_score"><code class="docutils literal notranslate"><span class="pre">WAS_Verification.compute_probabilistic_score()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_verification.WAS_Verification.gcm_compute_prob"><code class="docutils literal notranslate"><span class="pre">WAS_Verification.gcm_compute_prob()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_verification.WAS_Verification.gcm_compute_prob_ensemble_method"><code class="docutils literal notranslate"><span class="pre">WAS_Verification.gcm_compute_prob_ensemble_method()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_verification.WAS_Verification.gcm_validation_compute"><code class="docutils literal notranslate"><span class="pre">WAS_Verification.gcm_validation_compute()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_verification.WAS_Verification.gcm_validation_compute_"><code class="docutils literal notranslate"><span class="pre">WAS_Verification.gcm_validation_compute_()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_verification.WAS_Verification.get_scores_metadata"><code class="docutils literal notranslate"><span class="pre">WAS_Verification.get_scores_metadata()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_verification.WAS_Verification.ignorance_score"><code class="docutils literal notranslate"><span class="pre">WAS_Verification.ignorance_score()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_verification.WAS_Verification.index_of_agreement"><code class="docutils literal notranslate"><span class="pre">WAS_Verification.index_of_agreement()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_verification.WAS_Verification.kling_gupta_efficiency"><code class="docutils literal notranslate"><span class="pre">WAS_Verification.kling_gupta_efficiency()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_verification.WAS_Verification.mean_absolute_error"><code class="docutils literal notranslate"><span class="pre">WAS_Verification.mean_absolute_error()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_verification.WAS_Verification.nash_sutcliffe_efficiency"><code class="docutils literal notranslate"><span class="pre">WAS_Verification.nash_sutcliffe_efficiency()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_verification.WAS_Verification.pearson_corr"><code class="docutils literal notranslate"><span class="pre">WAS_Verification.pearson_corr()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_verification.WAS_Verification.plot_model_score"><code class="docutils literal notranslate"><span class="pre">WAS_Verification.plot_model_score()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_verification.WAS_Verification.plot_models_score"><code class="docutils literal notranslate"><span class="pre">WAS_Verification.plot_models_score()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_verification.WAS_Verification.plot_roc_curves"><code class="docutils literal notranslate"><span class="pre">WAS_Verification.plot_roc_curves()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_verification.WAS_Verification.ratio_to_average"><code class="docutils literal notranslate"><span class="pre">WAS_Verification.ratio_to_average()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_verification.WAS_Verification.reliability_diagram"><code class="docutils literal notranslate"><span class="pre">WAS_Verification.reliability_diagram()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_verification.WAS_Verification.reliability_score_grid"><code class="docutils literal notranslate"><span class="pre">WAS_Verification.reliability_score_grid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_verification.WAS_Verification.resolution_and_reliability_over_all_grid"><code class="docutils literal notranslate"><span class="pre">WAS_Verification.resolution_and_reliability_over_all_grid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_verification.WAS_Verification.resolution_score_grid"><code class="docutils literal notranslate"><span class="pre">WAS_Verification.resolution_score_grid()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_verification.WAS_Verification.root_mean_square_error"><code class="docutils literal notranslate"><span class="pre">WAS_Verification.root_mean_square_error()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_verification.WAS_Verification.taylor_diagram"><code class="docutils literal notranslate"><span class="pre">WAS_Verification.taylor_diagram()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#wass2s.was_verification.WAS_Verification.weighted_gcm_forecasts"><code class="docutils literal notranslate"><span class="pre">WAS_Verification.weighted_gcm_forecasts()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-wass2s.utils">wass2s.utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.utils.anomalize_timeseries"><code class="docutils literal notranslate"><span class="pre">anomalize_timeseries()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.utils.build_iridl_url_ersst"><code class="docutils literal notranslate"><span class="pre">build_iridl_url_ersst()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.utils.compute_other_indices"><code class="docutils literal notranslate"><span class="pre">compute_other_indices()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.utils.compute_sst_indices"><code class="docutils literal notranslate"><span class="pre">compute_sst_indices()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.utils.decode_cf"><code class="docutils literal notranslate"><span class="pre">decode_cf()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.utils.download_file"><code class="docutils literal notranslate"><span class="pre">download_file()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.utils.find_best_distribution_grid"><code class="docutils literal notranslate"><span class="pre">find_best_distribution_grid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.utils.fix_time_coord"><code class="docutils literal notranslate"><span class="pre">fix_time_coord()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.utils.get_best_models"><code class="docutils literal notranslate"><span class="pre">get_best_models()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.utils.load_gridded_predictor"><code class="docutils literal notranslate"><span class="pre">load_gridded_predictor()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.utils.parse_variable"><code class="docutils literal notranslate"><span class="pre">parse_variable()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.utils.plot_date"><code class="docutils literal notranslate"><span class="pre">plot_date()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.utils.plot_map"><code class="docutils literal notranslate"><span class="pre">plot_map()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.utils.plot_prob_forecasts"><code class="docutils literal notranslate"><span class="pre">plot_prob_forecasts()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.utils.plot_prob_forecasts_"><code class="docutils literal notranslate"><span class="pre">plot_prob_forecasts_()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.utils.plot_tercile"><code class="docutils literal notranslate"><span class="pre">plot_tercile()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.utils.predictant_mask"><code class="docutils literal notranslate"><span class="pre">predictant_mask()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.utils.prepare_predictand"><code class="docutils literal notranslate"><span class="pre">prepare_predictand()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.utils.process_model_for_other_params"><code class="docutils literal notranslate"><span class="pre">process_model_for_other_params()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.utils.retrieve_several_zones_for_PCR"><code class="docutils literal notranslate"><span class="pre">retrieve_several_zones_for_PCR()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.utils.retrieve_single_zone_for_PCR"><code class="docutils literal notranslate"><span class="pre">retrieve_single_zone_for_PCR()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.utils.reverse_standardize"><code class="docutils literal notranslate"><span class="pre">reverse_standardize()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.utils.save_hindcast_and_forecasts"><code class="docutils literal notranslate"><span class="pre">save_hindcast_and_forecasts()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.utils.save_validation_score"><code class="docutils literal notranslate"><span class="pre">save_validation_score()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.utils.standardize_timeseries"><code class="docutils literal notranslate"><span class="pre">standardize_timeseries()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.utils.to_iridl_lat"><code class="docutils literal notranslate"><span class="pre">to_iridl_lat()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.utils.to_iridl_lon"><code class="docutils literal notranslate"><span class="pre">to_iridl_lon()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.utils.trend_data"><code class="docutils literal notranslate"><span class="pre">trend_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#wass2s.utils.verify_station_network"><code class="docutils literal notranslate"><span class="pre">verify_station_network()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">wass2s</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">wass2s api</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/api.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="wass2s-api">
<h1>wass2s api<a class="headerlink" href="#wass2s-api" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-wass2s.was_download">
<span id="wass2s-was-download-module"></span><h2>wass2s.was_download module<a class="headerlink" href="#module-wass2s.was_download" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_download.WAS_Download">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_download.</span></span><span class="sig-name descname"><span class="pre">WAS_Download</span></span><a class="reference internal" href="_modules/wass2s/was_download.html#WAS_Download"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_download.WAS_Download" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_download.WAS_Download.AgroObsName">
<span class="sig-name descname"><span class="pre">AgroObsName</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variables</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'AGRO.PRCP':</span> <span class="pre">('precipitation_flux',</span> <span class="pre">None),</span> <span class="pre">'AGRO.TEMP':</span> <span class="pre">('2m_temperature',</span> <span class="pre">'24_hour_mean'),</span> <span class="pre">'AGRO.TMAX':</span> <span class="pre">('2m_temperature',</span> <span class="pre">'24_hour_maximum'),</span> <span class="pre">'AGRO.TMIN':</span> <span class="pre">('2m_temperature',</span> <span class="pre">'24_hour_minimum')}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_download.html#WAS_Download.AgroObsName"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_download.WAS_Download.AgroObsName" title="Link to this definition"></a></dt>
<dd><p>Generate a dictionary for agro-meteorological observation variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>variables</strong> (<em>dict</em>) – Mapping of agro variable short names to full names.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary mapping agro variables to their corresponding full names.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_download.WAS_Download.ModelsName">
<span class="sig-name descname"><span class="pre">ModelsName</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">centre</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'CFSV2_1':</span> <span class="pre">'cfsv2',</span> <span class="pre">'CMC1_1':</span> <span class="pre">'cmc1',</span> <span class="pre">'CMC2_1':</span> <span class="pre">'cmc2',</span> <span class="pre">'CMCC_35':</span> <span class="pre">'cmcc',</span> <span class="pre">'DWD_21':</span> <span class="pre">'dwd',</span> <span class="pre">'DWD_22':</span> <span class="pre">'dwd',</span> <span class="pre">'ECCC_4':</span> <span class="pre">'eccc',</span> <span class="pre">'ECCC_5':</span> <span class="pre">'eccc',</span> <span class="pre">'ECMWF_51':</span> <span class="pre">'ecmwf',</span> <span class="pre">'GFDL_1':</span> <span class="pre">'gfdl',</span> <span class="pre">'JMA_3':</span> <span class="pre">'jma',</span> <span class="pre">'METEOFRANCE_8':</span> <span class="pre">'meteo_france',</span> <span class="pre">'NASA_1':</span> <span class="pre">'nasa',</span> <span class="pre">'NCAR_CCSM4_1':</span> <span class="pre">'ncar_ccsm4',</span> <span class="pre">'NCEP_2':</span> <span class="pre">'ncep',</span> <span class="pre">'NMME_1':</span> <span class="pre">'nmme',</span> <span class="pre">'UKMO_603':</span> <span class="pre">'ukmo',</span> <span class="pre">'UKMO_604':</span> <span class="pre">'ukmo'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variables_1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'DLWR':</span> <span class="pre">'surface_thermal_radiation_downwards',</span> <span class="pre">'DSWR':</span> <span class="pre">'surface_solar_radiation_downwards',</span> <span class="pre">'PRCP':</span> <span class="pre">'total_precipitation',</span> <span class="pre">'SLP':</span> <span class="pre">'mean_sea_level_pressure',</span> <span class="pre">'SST':</span> <span class="pre">'sea_surface_temperature',</span> <span class="pre">'TEMP':</span> <span class="pre">'2m_temperature',</span> <span class="pre">'UGRD10':</span> <span class="pre">'10m_u_component_of_wind',</span> <span class="pre">'VGRD10':</span> <span class="pre">'10m_v_component_of_wind'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variables_2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'HUSS_1000':</span> <span class="pre">'specific_humidity',</span> <span class="pre">'HUSS_850':</span> <span class="pre">'specific_humidity',</span> <span class="pre">'HUSS_925':</span> <span class="pre">'specific_humidity',</span> <span class="pre">'UGRD_1000':</span> <span class="pre">'u_component_of_wind',</span> <span class="pre">'UGRD_850':</span> <span class="pre">'u_component_of_wind',</span> <span class="pre">'UGRD_925':</span> <span class="pre">'u_component_of_wind',</span> <span class="pre">'VGRD_1000':</span> <span class="pre">'v_component_of_wind',</span> <span class="pre">'VGRD_850':</span> <span class="pre">'v_component_of_wind',</span> <span class="pre">'VGRD_925':</span> <span class="pre">'v_component_of_wind'}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_download.html#WAS_Download.ModelsName"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_download.WAS_Download.ModelsName" title="Link to this definition"></a></dt>
<dd><p>Generate a combined dictionary of model names and variables.
For more information on C3S, browse the <a class="reference external" href="https://confluence.ecmwf.int/display/CKB/Description+of+the+C3S+seasonal+multi-system">MetaData</a>.
For more information on NMME, browse the <a class="reference external" href="https://confluence.ecmwf.int/display/CKB/Description+of+the+C3S+seasonal+multi-system">MetaData</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>centre</strong> (<em>dict</em>) – Mapping of model identifiers to model names.</p></li>
<li><p><strong>variables_1</strong> (<em>dict</em>) – Mapping of variable short names to full names for category 1.</p></li>
<li><p><strong>variables_2</strong> (<em>dict</em>) – Mapping of variable short names to full names for category 2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A combined dictionary with keys as model.variable combinations and values as tuples (model name, variable name).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_download.WAS_Download.ReanalysisName">
<span class="sig-name descname"><span class="pre">ReanalysisName</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">centre</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'ERA5':</span> <span class="pre">'reanalysis</span> <span class="pre">ERA5',</span> <span class="pre">'NOAA':</span> <span class="pre">'NOAA</span> <span class="pre">ERSST'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variables_1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'DLWR':</span> <span class="pre">'surface_thermal_radiation_downwards',</span> <span class="pre">'DSWR':</span> <span class="pre">'surface_solar_radiation_downwards',</span> <span class="pre">'PRCP':</span> <span class="pre">'total_precipitation',</span> <span class="pre">'SLP':</span> <span class="pre">'mean_sea_level_pressure',</span> <span class="pre">'SST':</span> <span class="pre">'sea_surface_temperature',</span> <span class="pre">'TEMP':</span> <span class="pre">'2m_temperature',</span> <span class="pre">'UGRD10':</span> <span class="pre">'10m_u_component_of_wind',</span> <span class="pre">'VGRD10':</span> <span class="pre">'10m_v_component_of_wind'}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variables_2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{'HUSS_1000':</span> <span class="pre">'specific_humidity',</span> <span class="pre">'HUSS_850':</span> <span class="pre">'specific_humidity',</span> <span class="pre">'HUSS_925':</span> <span class="pre">'specific_humidity',</span> <span class="pre">'UGRD_1000':</span> <span class="pre">'u_component_of_wind',</span> <span class="pre">'UGRD_850':</span> <span class="pre">'u_component_of_wind',</span> <span class="pre">'UGRD_925':</span> <span class="pre">'u_component_of_wind',</span> <span class="pre">'VGRD_1000':</span> <span class="pre">'v_component_of_wind',</span> <span class="pre">'VGRD_850':</span> <span class="pre">'v_component_of_wind',</span> <span class="pre">'VGRD_925':</span> <span class="pre">'v_component_of_wind'}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_download.html#WAS_Download.ReanalysisName"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_download.WAS_Download.ReanalysisName" title="Link to this definition"></a></dt>
<dd><p>Generate a combined dictionary of reanalysis names and variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>centre</strong> (<em>dict</em>) – Mapping of reanalysis identifiers to reanalysis names.</p></li>
<li><p><strong>variables_1</strong> (<em>dict</em>) – Mapping of variable short names to full names for category 1.</p></li>
<li><p><strong>variables_2</strong> (<em>dict</em>) – Mapping of variable short names to full names for category 2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A combined dictionary with keys as reanalysis.variable combinations and values as tuples (reanalysis name, variable name).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_download.WAS_Download.WAS_Download_AgroIndicators">
<span class="sig-name descname"><span class="pre">WAS_Download_AgroIndicators</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_to_save</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variables</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['01',</span> <span class="pre">'02',</span> <span class="pre">'03']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_download</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_download.html#WAS_Download.WAS_Download_AgroIndicators"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_download.WAS_Download.WAS_Download_AgroIndicators" title="Link to this definition"></a></dt>
<dd><p>Download agro-meteorological indicators for specified variables, years, and months,
handling cross-year seasons (e.g., NDJ).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_download.WAS_Download.WAS_Download_AgroIndicators_">
<span class="sig-name descname"><span class="pre">WAS_Download_AgroIndicators_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_to_save</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variables</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['01',</span> <span class="pre">'02',</span> <span class="pre">'03']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_download</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_download.html#WAS_Download.WAS_Download_AgroIndicators_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_download.WAS_Download.WAS_Download_AgroIndicators_" title="Link to this definition"></a></dt>
<dd><p>Download agro-meteorological indicators for specified variables, years, and months.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dir_to_save</strong> (<em>str</em>) – Directory to save the downloaded files.</p></li>
<li><p><strong>variables</strong> (<em>list</em>) – List of shorthand variables to download (e.g., [“AGRO.PRCP”, “AGRO.TMAX”]).</p></li>
<li><p><strong>year_start</strong> (<em>int</em>) – Start year for the data to download.</p></li>
<li><p><strong>year_end</strong> (<em>int</em>) – End year for the data to download.</p></li>
<li><p><strong>area</strong> (<em>list</em>) – Bounding box as [North, West, South, East] for clipping.</p></li>
<li><p><strong>seas</strong> (<em>list</em>) – List of month strings representing the season (e.g., [“01”, “02”, “03”]- for JanFebMar).</p></li>
<li><p><strong>force_download</strong> (<em>bool</em>) – If True, forces download even if file exists.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_download.WAS_Download.WAS_Download_AgroIndicators_daily">
<span class="sig-name descname"><span class="pre">WAS_Download_AgroIndicators_daily</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_to_save</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variables</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_download</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_download.html#WAS_Download.WAS_Download_AgroIndicators_daily"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_download.WAS_Download.WAS_Download_AgroIndicators_daily" title="Link to this definition"></a></dt>
<dd><p>Download daily agro-meteorological indicators for specified variables and years.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dir_to_save</strong> (<em>str</em>) – Directory to save the downloaded files.</p></li>
<li><p><strong>variables</strong> (<em>list</em>) – List of shorthand variables to download (e.g., [“AGRO.PRCP”, “AGRO.TMAX”]).</p></li>
<li><p><strong>year_start</strong> (<em>int</em>) – Start year for the data to download.</p></li>
<li><p><strong>year_end</strong> (<em>int</em>) – End year for the data to download.</p></li>
<li><p><strong>area</strong> (<em>list</em>) – Bounding box as [North, West, South, East] for clipping.</p></li>
<li><p><strong>force_download</strong> (<em>bool</em>) – If True, forces download even if file exists.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_download.WAS_Download.WAS_Download_CHIRPSv3">
<span class="sig-name descname"><span class="pre">WAS_Download_CHIRPSv3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_to_save</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variables</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">season_months</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['03',</span> <span class="pre">'04',</span> <span class="pre">'05']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_download</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_download.html#WAS_Download.WAS_Download_CHIRPSv3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_download.WAS_Download.WAS_Download_CHIRPSv3" title="Link to this definition"></a></dt>
<dd><p>Download CHIRPS v3.0 monthly precipitation for a specified cross-year season
from year_start to year_end, optionally clipped to ‘area’,
and aggregate them into a single NetCDF file.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_download.WAS_Download.WAS_Download_Models">
<span class="sig-name descname"><span class="pre">WAS_Download_Models</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_to_save</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_variable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">month_of_initialization</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lead_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_start_hindcast</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_end_hindcast</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_forecast</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ensemble_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_download</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_download.html#WAS_Download.WAS_Download_Models"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_download.WAS_Download.WAS_Download_Models" title="Link to this definition"></a></dt>
<dd><p>Download seasonal forecast model data for specified center-variable combinations, initialization month, lead times, and years.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dir_to_save</strong> (<em>str</em>) – Directory to save the downloaded files.</p></li>
<li><p><strong>center_variable</strong> (<em>list</em>) – List of center-variable identifiers (e.g., [“ECMWF_51.PRCP”, “UKMO_602.TEMP”]).</p></li>
<li><p><strong>month_of_initialization</strong> (<em>int</em>) – Initialization month as an integer (1-12).</p></li>
<li><p><strong>lead_time</strong> (<em>list</em>) – List of lead times in months.</p></li>
<li><p><strong>year_start_hindcast</strong> (<em>int</em>) – Start year for hindcast data.</p></li>
<li><p><strong>year_end_hindcast</strong> (<em>int</em>) – End year for hindcast data.</p></li>
<li><p><strong>area</strong> (<em>list</em>) – Bounding box as [North, West, South, East] for clipping.</p></li>
<li><p><strong>year_forecast</strong> (<em>int</em><em>, </em><em>optional</em>) – Forecast year if downloading forecast data. Defaults to None.</p></li>
<li><p><strong>mean</strong> (<em>ensemble</em>) – it’s can be median, mean or None. Defaults to None.</p></li>
<li><p><strong>force_download</strong> (<em>bool</em>) – If True, forces download even if file exists.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_download.WAS_Download.WAS_Download_Models_Daily">
<span class="sig-name descname"><span class="pre">WAS_Download_Models_Daily</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_to_save</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_variable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">month_of_initialization</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">day_of_initialization</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">leadtime_hour</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_start_hindcast</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_end_hindcast</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_forecast</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ensemble_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_download</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_download.html#WAS_Download.WAS_Download_Models_Daily"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_download.WAS_Download.WAS_Download_Models_Daily" title="Link to this definition"></a></dt>
<dd><p>Download daily/sub-daily seasonal forecast model data (original)
using ‘seasonal-original-single-levels’ from the CDS.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dir_to_save</strong> (<em>str</em><em> or </em><em>Path</em>) – Directory to save the downloaded files.</p></li>
<li><p><strong>center_variable</strong> (<em>list</em>) – Each element e.g. “ECMWF_51.PRCP”
- left side of ‘.’ is model (ECMWF_51),
- right side is variable short code (PRCP).</p></li>
<li><p><strong>month_of_initialization</strong> (<em>int</em>) – Initialization month (1-12).</p></li>
<li><p><strong>day_of_initialization</strong> (<em>int</em>) – Initialization day (1-31).</p></li>
<li><p><strong>leadtime_hour</strong> (<em>list</em><em> of </em><em>str</em>) – e.g. [“24”, “48”, …, “5160”].</p></li>
<li><p><strong>year_start_hindcast</strong> (<em>int</em>) – Start year for hindcast data.</p></li>
<li><p><strong>year_end_hindcast</strong> (<em>int</em>) – End year for hindcast data.</p></li>
<li><p><strong>area</strong> (<em>list</em>) – Bounding box as [North, West, South, East].</p></li>
<li><p><strong>year_forecast</strong> (<em>int</em><em>, </em><em>optional</em>) – If provided, downloads that single
forecast year. Otherwise downloads hindcast for the specified range.</p></li>
<li><p><strong>ensemble_mean</strong> (<em>str</em><em>, </em><em>optional</em>) – e.g. “mean”, “median”, or None.</p></li>
<li><p><strong>force_download</strong> (<em>bool</em>) – Force download if True, even if file exists.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_download.WAS_Download.WAS_Download_Reanalysis">
<span class="sig-name descname"><span class="pre">WAS_Download_Reanalysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_to_save</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_variable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['01',</span> <span class="pre">'02',</span> <span class="pre">'03']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_download</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_avg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_download.html#WAS_Download.WAS_Download_Reanalysis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_download.WAS_Download.WAS_Download_Reanalysis" title="Link to this definition"></a></dt>
<dd><p>Download reanalysis data for specified center-variable combinations, years, and months,
handling cross-year seasons (e.g., NDJ).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_download.WAS_Download.WAS_Download_Reanalysis_">
<span class="sig-name descname"><span class="pre">WAS_Download_Reanalysis_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_to_save</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center_variable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['01',</span> <span class="pre">'02',</span> <span class="pre">'03']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_download</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_download.html#WAS_Download.WAS_Download_Reanalysis_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_download.WAS_Download.WAS_Download_Reanalysis_" title="Link to this definition"></a></dt>
<dd><p>Download reanalysis data for specified center-variable combinations, years, and months.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dir_to_save</strong> (<em>str</em>) – Directory to save the downloaded files.</p></li>
<li><p><strong>center_variable</strong> (<em>list</em>) – List of center-variable identifiers (e.g., [“ERA5.PRCP”, “MERRA2.TEMP”]).</p></li>
<li><p><strong>year_start</strong> (<em>int</em>) – Start year for the data to download.</p></li>
<li><p><strong>year_end</strong> (<em>int</em>) – End year for the data to download.</p></li>
<li><p><strong>area</strong> (<em>list</em>) – Bounding box as [North, West, South, East] for clipping.</p></li>
<li><p><strong>seas</strong> (<em>list</em>) – List of month strings representing the season (e.g., [“01”, “02”, “03”] for JanFebMar).</p></li>
<li><p><strong>force_download</strong> (<em>bool</em>) – If True, forces download even if file exists.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_download.WAS_Download.days_in_month">
<span class="sig-name descname"><span class="pre">days_in_month</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">month</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_download.html#WAS_Download.days_in_month"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_download.WAS_Download.days_in_month" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_download.WAS_Download.download_nmme_txt_with_progress">
<span class="sig-name descname"><span class="pre">download_nmme_txt_with_progress</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">url</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunk_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1024</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_download.html#WAS_Download.download_nmme_txt_with_progress"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_download.WAS_Download.download_nmme_txt_with_progress" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_download.WAS_Download.parse_cpt_data_optimized">
<span class="sig-name descname"><span class="pre">parse_cpt_data_optimized</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_download.html#WAS_Download.parse_cpt_data_optimized"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_download.WAS_Download.parse_cpt_data_optimized" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wass2s.was_download.plot_map">
<span class="sig-prename descclassname"><span class="pre">wass2s.was_download.</span></span><span class="sig-name descname"><span class="pre">plot_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Map'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_download.html#plot_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_download.plot_map" title="Link to this definition"></a></dt>
<dd><p>Plots a map with specified geographic extent.</p>
<p>Parameters:
- extent: list of float, specifying [west, east, south, north]
- title: str, title of the map</p>
</dd></dl>

</section>
<section id="module-wass2s.was_compute_predictand">
<span id="wass2s-was-compute-predictand-module"></span><h2>wass2s.was_compute_predictand module<a class="headerlink" href="#module-wass2s.was_compute_predictand" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_compute_HWSDI">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_compute_predictand.</span></span><span class="sig-name descname"><span class="pre">WAS_compute_HWSDI</span></span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_compute_HWSDI"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_compute_HWSDI" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class to compute the Heat Wave Severity Duration Index (HWSDI),
including calculating TXin90 (90th percentile of daily max temperature)
and annual counts of heatwave days with at least 6 consecutive hot days.</p>
<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_compute_HWSDI.calculate_TXin90">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_TXin90</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temperature_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_period_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'1961'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_period_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'1990'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_compute_HWSDI.calculate_TXin90"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_compute_HWSDI.calculate_TXin90" title="Link to this definition"></a></dt>
<dd><p>Calculate the daily 90th percentile temperature (TXin90) centered on a 5-day window
for each calendar day based on the base period.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temperature_data</strong> (<em>xarray.DataArray</em>) – Daily maximum temperature with time dimension.</p></li>
<li><p><strong>base_period_start</strong> (<em>str</em><em>, </em><em>optional</em>) – Start year of the base period (default is ‘1961’).</p></li>
<li><p><strong>base_period_end</strong> (<em>str</em><em>, </em><em>optional</em>) – End year of the base period (default is ‘1990’).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>TXin90 for each day of the year.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_compute_HWSDI.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temperature_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_period_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'1961'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_period_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'1990'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_cores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_compute_HWSDI.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_compute_HWSDI.compute" title="Link to this definition"></a></dt>
<dd><p>Compute the Heat Wave Severity Duration Index (HWSDI) for each pixel
in a given daily temperature DataArray.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temperature_data</strong> (<em>xarray.DataArray</em>) – Daily maximum temperature data, coords = (T, Y, X).</p></li>
<li><p><strong>base_period_start</strong> (<em>str</em><em>, </em><em>optional</em>) – Start year of the base period for TXin90 calculation (default is ‘1961’).</p></li>
<li><p><strong>base_period_end</strong> (<em>str</em><em>, </em><em>optional</em>) – End year of the base period for TXin90 calculation (default is ‘1990’).</p></li>
<li><p><strong>nb_cores</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of parallel processes to use (default is 4).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>HWSDI computed for each pixel.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_compute_HWSDI.count_hot_days">
<span class="sig-name descname"><span class="pre">count_hot_days</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temperature_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TXin90</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_compute_HWSDI.count_hot_days"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_compute_HWSDI.count_hot_days" title="Link to this definition"></a></dt>
<dd><p>Count the number of days per year with at least 6 consecutive days
where daily maximum temperature is above the 90th percentile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temperature_data</strong> (<em>xarray.DataArray</em>) – Daily maximum temperature with time dimension.</p></li>
<li><p><strong>TXin90</strong> (<em>xarray.DataArray</em>) – 90th percentile temperature for each day of the year.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Annual count of hot days.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_compute_HWSDI_Seasonal">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_compute_predictand.</span></span><span class="sig-name descname"><span class="pre">WAS_compute_HWSDI_Seasonal</span></span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_compute_HWSDI_Seasonal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_compute_HWSDI_Seasonal" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class to compute the Heat Wave Severity Duration Index (HWSDI) for a given season.</p>
<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_compute_HWSDI_Seasonal.calculate_TXin90">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_TXin90</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temperature_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_period_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'1961'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_period_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'1990'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">season</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[6,</span> <span class="pre">7,</span> <span class="pre">8]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_compute_HWSDI_Seasonal.calculate_TXin90"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_compute_HWSDI_Seasonal.calculate_TXin90" title="Link to this definition"></a></dt>
<dd><p>Calculate the daily 90th percentile temperature (TXin90) for each calendar day
based on the base period, but only considering the specified season.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temperature_data</strong> (<em>xarray.DataArray</em>) – Daily maximum temperature with time dimension.</p></li>
<li><p><strong>base_period_start</strong> (<em>str</em><em>, </em><em>optional</em>) – Start year of the base period (default is ‘1961’).</p></li>
<li><p><strong>base_period_end</strong> (<em>str</em><em>, </em><em>optional</em>) – End year of the base period (default is ‘1990’).</p></li>
<li><p><strong>season</strong> (<em>list</em><em>, </em><em>optional</em>) – List of months to include in the calculation (default is [6, 7, 8] for JJA).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>TXin90 for each day of the selected season.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_compute_HWSDI_Seasonal.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temperature_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_period_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'1961'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_period_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'1990'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_cores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">season</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[6,</span> <span class="pre">7,</span> <span class="pre">8]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_compute_HWSDI_Seasonal.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_compute_HWSDI_Seasonal.compute" title="Link to this definition"></a></dt>
<dd><p>Compute the HWSDI for each pixel in a given daily temperature DataArray for a specific season.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temperature_data</strong> (<em>xarray.DataArray</em>) – Daily maximum temperature data, coords = (T, Y, X).</p></li>
<li><p><strong>base_period_start</strong> (<em>str</em><em>, </em><em>optional</em>) – Start year of the base period for TXin90 calculation (default is ‘1961’).</p></li>
<li><p><strong>base_period_end</strong> (<em>str</em><em>, </em><em>optional</em>) – End year of the base period for TXin90 calculation (default is ‘1990’).</p></li>
<li><p><strong>nb_cores</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of parallel processes to use (default is 4).</p></li>
<li><p><strong>season</strong> (<em>list</em><em>, </em><em>optional</em>) – List of months to include in the calculation (default is [6, 7, 8] for JJA).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>HWSDI computed for each pixel for the given season.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_compute_HWSDI_Seasonal.count_hot_days">
<span class="sig-name descname"><span class="pre">count_hot_days</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temperature_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TXin90</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_compute_HWSDI_Seasonal.count_hot_days"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_compute_HWSDI_Seasonal.count_hot_days" title="Link to this definition"></a></dt>
<dd><p>Count the number of days per season with at least 6 consecutive days
where daily maximum temperature is above the 90th percentile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temperature_data</strong> (<em>xarray.DataArray</em>) – Daily maximum temperature with time dimension.</p></li>
<li><p><strong>TXin90</strong> (<em>xarray.DataArray</em>) – 90th percentile temperature for each day of the year.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Seasonal count of hot days.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_compute_HWSDI_monthly">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_compute_predictand.</span></span><span class="sig-name descname"><span class="pre">WAS_compute_HWSDI_monthly</span></span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_compute_HWSDI_monthly"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_compute_HWSDI_monthly" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class to compute the Heat Wave Severity Duration Index (HWSDI) <strong>monthly</strong>,
calculating TXin90 (90th percentile of daily max temperature) and counting heatwave days
for each month with at least 6 consecutive hot days.</p>
<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_compute_HWSDI_monthly.calculate_TXin90">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_TXin90</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temperature_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_period_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'1961'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_period_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'1990'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_compute_HWSDI_monthly.calculate_TXin90"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_compute_HWSDI_monthly.calculate_TXin90" title="Link to this definition"></a></dt>
<dd><p>Calculate the monthly 90th percentile temperature (TXin90) centered on a 5-day window
for each calendar day based on the base period.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temperature_data</strong> (<em>xarray.DataArray</em>) – Daily maximum temperature with time dimension.</p></li>
<li><p><strong>base_period_start</strong> (<em>str</em><em>, </em><em>optional</em>) – Start year of the base period (default is ‘1961’).</p></li>
<li><p><strong>base_period_end</strong> (<em>str</em><em>, </em><em>optional</em>) – End year of the base period (default is ‘1990’).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>TXin90 for each month of the year.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_compute_HWSDI_monthly.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temperature_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_period_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'1961'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_period_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'1990'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_cores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_compute_HWSDI_monthly.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_compute_HWSDI_monthly.compute" title="Link to this definition"></a></dt>
<dd><p>Compute the Monthly Heat Wave Severity Duration Index (HWSDI)
for each pixel in a given daily temperature DataArray.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temperature_data</strong> (<em>xarray.DataArray</em>) – Daily maximum temperature data, coords = (T, Y, X).</p></li>
<li><p><strong>base_period_start</strong> (<em>str</em><em>, </em><em>optional</em>) – Start year of the base period for TXin90 calculation (default is ‘1961’).</p></li>
<li><p><strong>base_period_end</strong> (<em>str</em><em>, </em><em>optional</em>) – End year of the base period for TXin90 calculation (default is ‘1990’).</p></li>
<li><p><strong>nb_cores</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of parallel processes to use (default is 4).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>HWSDI computed for each pixel per month.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_compute_HWSDI_monthly.count_hot_days">
<span class="sig-name descname"><span class="pre">count_hot_days</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temperature_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TXin90</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_compute_HWSDI_monthly.count_hot_days"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_compute_HWSDI_monthly.count_hot_days" title="Link to this definition"></a></dt>
<dd><p>Count the number of days per month with at least 6 consecutive days
where daily maximum temperature is above the 90th percentile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temperature_data</strong> (<em>xarray.DataArray</em>) – Daily maximum temperature with time dimension.</p></li>
<li><p><strong>TXin90</strong> (<em>xarray.DataArray</em>) – 90th percentile temperature for each month.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Monthly count of hot days.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_compute_cessation">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_compute_predictand.</span></span><span class="sig-name descname"><span class="pre">WAS_compute_cessation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user_criteria</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_compute_cessation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_compute_cessation" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class to compute cessation dates based on soil moisture balance for different
regions and criteria, leveraging parallel computation for efficiency.</p>
<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_compute_cessation.adjust_duplicates">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">adjust_duplicates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">increment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_compute_cessation.adjust_duplicates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_compute_cessation.adjust_duplicates" title="Link to this definition"></a></dt>
<dd><p>If any values in the Series repeat, nudge them by a tiny increment
so that all are unique (to avoid indexing collisions).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_compute_cessation.cessation_function">
<span class="sig-name descname"><span class="pre">cessation_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ijour_dem_cal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idebut</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ETP</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Cap_ret_maxi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irch_fin</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_compute_cessation.cessation_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_compute_cessation.cessation_function" title="Link to this definition"></a></dt>
<dd><p>Compute cessation date using soil moisture balance criteria.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_compute_cessation.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">daily_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_cores</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_compute_cessation.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_compute_cessation.compute" title="Link to this definition"></a></dt>
<dd><p>Compute cessation dates for each pixel using criteria based on regions.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_compute_cessation.compute_insitu">
<span class="sig-name descname"><span class="pre">compute_insitu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">daily_df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_compute_cessation.compute_insitu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_compute_cessation.compute_insitu" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_compute_cessation.day_of_year">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">day_of_year</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dem_rech1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_compute_cessation.day_of_year"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_compute_cessation.day_of_year" title="Link to this definition"></a></dt>
<dd><p>Given a year ‘i’ and a month-day string ‘dem_rech1’ (e.g., ‘07-23’),
return the 1-based day of the year.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_compute_cessation.default_criteria">
<span class="sig-name descname"><span class="pre">default_criteria</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{0:</span> <span class="pre">{'Cap_ret_maxi':</span> <span class="pre">70,</span> <span class="pre">'ETP':</span> <span class="pre">5.0,</span> <span class="pre">'date_dry_soil':</span> <span class="pre">'01-01',</span> <span class="pre">'end_search':</span> <span class="pre">'09-30',</span> <span class="pre">'start_search':</span> <span class="pre">'09-01',</span> <span class="pre">'zone_name':</span> <span class="pre">'Sahel100_0mm'},</span> <span class="pre">1:</span> <span class="pre">{'Cap_ret_maxi':</span> <span class="pre">70,</span> <span class="pre">'ETP':</span> <span class="pre">5.0,</span> <span class="pre">'date_dry_soil':</span> <span class="pre">'01-01',</span> <span class="pre">'end_search':</span> <span class="pre">'10-05',</span> <span class="pre">'start_search':</span> <span class="pre">'09-01',</span> <span class="pre">'zone_name':</span> <span class="pre">'Sahel200_100mm'},</span> <span class="pre">2:</span> <span class="pre">{'Cap_ret_maxi':</span> <span class="pre">70,</span> <span class="pre">'ETP':</span> <span class="pre">5.0,</span> <span class="pre">'date_dry_soil':</span> <span class="pre">'01-01',</span> <span class="pre">'end_search':</span> <span class="pre">'11-10',</span> <span class="pre">'start_search':</span> <span class="pre">'09-01',</span> <span class="pre">'zone_name':</span> <span class="pre">'Sahel400_200mm'},</span> <span class="pre">3:</span> <span class="pre">{'Cap_ret_maxi':</span> <span class="pre">70,</span> <span class="pre">'ETP':</span> <span class="pre">5.0,</span> <span class="pre">'date_dry_soil':</span> <span class="pre">'01-01',</span> <span class="pre">'end_search':</span> <span class="pre">'11-15',</span> <span class="pre">'start_search':</span> <span class="pre">'09-15',</span> <span class="pre">'zone_name':</span> <span class="pre">'Sahel600_400mm'},</span> <span class="pre">4:</span> <span class="pre">{'Cap_ret_maxi':</span> <span class="pre">70,</span> <span class="pre">'ETP':</span> <span class="pre">4.5,</span> <span class="pre">'date_dry_soil':</span> <span class="pre">'01-01',</span> <span class="pre">'end_search':</span> <span class="pre">'11-30',</span> <span class="pre">'start_search':</span> <span class="pre">'10-01',</span> <span class="pre">'zone_name':</span> <span class="pre">'Soudan'},</span> <span class="pre">5:</span> <span class="pre">{'Cap_ret_maxi':</span> <span class="pre">70,</span> <span class="pre">'ETP':</span> <span class="pre">4.0,</span> <span class="pre">'date_dry_soil':</span> <span class="pre">'01-01',</span> <span class="pre">'end_search':</span> <span class="pre">'12-01',</span> <span class="pre">'start_search':</span> <span class="pre">'10-15',</span> <span class="pre">'zone_name':</span> <span class="pre">'Golfe_Of_Guinea'}}</span></em><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_compute_cessation.default_criteria" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_compute_cessation.rainf_zone">
<span class="sig-name descname"><span class="pre">rainf_zone</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">daily_data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_compute_cessation.rainf_zone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_compute_cessation.rainf_zone" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_compute_cessation.transform_cdt">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">transform_cdt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_compute_cessation.transform_cdt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_compute_cessation.transform_cdt" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>Transform a DataFrame with:</dt><dd><ul class="simple">
<li><p>Row 0 = LON</p></li>
<li><p>Row 1 = LAT</p></li>
<li><p>Row 2 = ELEV</p></li>
<li><p>Rows 3+ = daily data (or any date) with ‘ID’ column containing dates.</p></li>
</ul>
</dd>
</dl>
<p>Returns an xarray DataArray with coords = (T, Y, X), variable = ‘Observation’.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_compute_cessation_dry_spell">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_compute_predictand.</span></span><span class="sig-name descname"><span class="pre">WAS_compute_cessation_dry_spell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user_criteria</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_compute_cessation_dry_spell"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_compute_cessation_dry_spell" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class for computing the longest dry spell length
after the onset of a rainy season, based on user-defined criteria.</p>
<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_compute_cessation_dry_spell.adjust_duplicates">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">adjust_duplicates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">increment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_compute_cessation_dry_spell.adjust_duplicates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_compute_cessation_dry_spell.adjust_duplicates" title="Link to this definition"></a></dt>
<dd><p>If any values in the Series repeat, nudge them by a tiny increment
so that all are unique (to avoid indexing collisions).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_compute_cessation_dry_spell.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">daily_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_cores</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_compute_cessation_dry_spell.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_compute_cessation_dry_spell.compute" title="Link to this definition"></a></dt>
<dd><p>Compute the longest dry spell length after the rainy season onset
for each pixel in the given daily rainfall DataArray, using different
criteria (both for onset and cessation) based on isohyet zones.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>daily_data</strong> (<em>xarray.DataArray</em>) – Daily rainfall data, coords = (T, Y, X).</p></li>
<li><p><strong>nb_cores</strong> (<em>int</em>) – Number of parallel processes (workers) to use.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array with the longest dry spell length per pixel.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_compute_cessation_dry_spell.compute_insitu">
<span class="sig-name descname"><span class="pre">compute_insitu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">daily_df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_compute_cessation_dry_spell.compute_insitu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_compute_cessation_dry_spell.compute_insitu" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_compute_cessation_dry_spell.day_of_year">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">day_of_year</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dem_rech1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_compute_cessation_dry_spell.day_of_year"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_compute_cessation_dry_spell.day_of_year" title="Link to this definition"></a></dt>
<dd><p>Convert year i and MM-DD string dem_rech1 (e.g., ‘07-23’)
into a 1-based day of the year.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_compute_cessation_dry_spell.default_criteria">
<span class="sig-name descname"><span class="pre">default_criteria</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{0:</span> <span class="pre">{'Cap_ret_maxi':</span> <span class="pre">70,</span> <span class="pre">'ETP':</span> <span class="pre">5.0,</span> <span class="pre">'cumulative':</span> <span class="pre">10,</span> <span class="pre">'date_dry_soil':</span> <span class="pre">'01-01',</span> <span class="pre">'end_search1':</span> <span class="pre">'08-15',</span> <span class="pre">'end_search2':</span> <span class="pre">'09-30',</span> <span class="pre">'nbjour':</span> <span class="pre">40,</span> <span class="pre">'number_dry_days':</span> <span class="pre">25,</span> <span class="pre">'start_search1':</span> <span class="pre">'05-01',</span> <span class="pre">'start_search2':</span> <span class="pre">'09-01',</span> <span class="pre">'thrd_rain_day':</span> <span class="pre">0.85,</span> <span class="pre">'zone_name':</span> <span class="pre">'Sahel100_0mm'},</span> <span class="pre">1:</span> <span class="pre">{'Cap_ret_maxi':</span> <span class="pre">70,</span> <span class="pre">'ETP':</span> <span class="pre">5.0,</span> <span class="pre">'cumulative':</span> <span class="pre">15,</span> <span class="pre">'date_dry_soil':</span> <span class="pre">'01-01',</span> <span class="pre">'end_search1':</span> <span class="pre">'08-15',</span> <span class="pre">'end_search2':</span> <span class="pre">'10-05',</span> <span class="pre">'nbjour':</span> <span class="pre">40,</span> <span class="pre">'number_dry_days':</span> <span class="pre">25,</span> <span class="pre">'start_search1':</span> <span class="pre">'05-15',</span> <span class="pre">'start_search2':</span> <span class="pre">'09-01',</span> <span class="pre">'thrd_rain_day':</span> <span class="pre">0.85,</span> <span class="pre">'zone_name':</span> <span class="pre">'Sahel200_100mm'},</span> <span class="pre">2:</span> <span class="pre">{'Cap_ret_maxi':</span> <span class="pre">70,</span> <span class="pre">'ETP':</span> <span class="pre">5.0,</span> <span class="pre">'cumulative':</span> <span class="pre">15,</span> <span class="pre">'date_dry_soil':</span> <span class="pre">'01-01',</span> <span class="pre">'end_search1':</span> <span class="pre">'07-31',</span> <span class="pre">'end_search2':</span> <span class="pre">'11-10',</span> <span class="pre">'nbjour':</span> <span class="pre">40,</span> <span class="pre">'number_dry_days':</span> <span class="pre">20,</span> <span class="pre">'start_search1':</span> <span class="pre">'05-01',</span> <span class="pre">'start_search2':</span> <span class="pre">'09-01',</span> <span class="pre">'thrd_rain_day':</span> <span class="pre">0.85,</span> <span class="pre">'zone_name':</span> <span class="pre">'Sahel400_200mm'},</span> <span class="pre">3:</span> <span class="pre">{'Cap_ret_maxi':</span> <span class="pre">70,</span> <span class="pre">'ETP':</span> <span class="pre">5.0,</span> <span class="pre">'cumulative':</span> <span class="pre">20,</span> <span class="pre">'date_dry_soil':</span> <span class="pre">'01-01',</span> <span class="pre">'end_search1':</span> <span class="pre">'07-31',</span> <span class="pre">'end_search2':</span> <span class="pre">'11-15',</span> <span class="pre">'nbjour':</span> <span class="pre">45,</span> <span class="pre">'number_dry_days':</span> <span class="pre">20,</span> <span class="pre">'start_search1':</span> <span class="pre">'03-15',</span> <span class="pre">'start_search2':</span> <span class="pre">'09-15',</span> <span class="pre">'thrd_rain_day':</span> <span class="pre">0.85,</span> <span class="pre">'zone_name':</span> <span class="pre">'Sahel600_400mm'},</span> <span class="pre">4:</span> <span class="pre">{'Cap_ret_maxi':</span> <span class="pre">70,</span> <span class="pre">'ETP':</span> <span class="pre">4.5,</span> <span class="pre">'cumulative':</span> <span class="pre">20,</span> <span class="pre">'date_dry_soil':</span> <span class="pre">'01-01',</span> <span class="pre">'end_search1':</span> <span class="pre">'07-31',</span> <span class="pre">'end_search2':</span> <span class="pre">'11-30',</span> <span class="pre">'nbjour':</span> <span class="pre">50,</span> <span class="pre">'number_dry_days':</span> <span class="pre">10,</span> <span class="pre">'start_search1':</span> <span class="pre">'03-15',</span> <span class="pre">'start_search2':</span> <span class="pre">'10-01',</span> <span class="pre">'thrd_rain_day':</span> <span class="pre">0.85,</span> <span class="pre">'zone_name':</span> <span class="pre">'Soudan'},</span> <span class="pre">5:</span> <span class="pre">{'Cap_ret_maxi':</span> <span class="pre">70,</span> <span class="pre">'ETP':</span> <span class="pre">4.0,</span> <span class="pre">'cumulative':</span> <span class="pre">20,</span> <span class="pre">'date_dry_soil':</span> <span class="pre">'01-01',</span> <span class="pre">'end_search1':</span> <span class="pre">'06-15',</span> <span class="pre">'end_search2':</span> <span class="pre">'12-01',</span> <span class="pre">'nbjour':</span> <span class="pre">50,</span> <span class="pre">'number_dry_days':</span> <span class="pre">10,</span> <span class="pre">'start_search1':</span> <span class="pre">'02-01',</span> <span class="pre">'start_search2':</span> <span class="pre">'10-15',</span> <span class="pre">'thrd_rain_day':</span> <span class="pre">0.85,</span> <span class="pre">'zone_name':</span> <span class="pre">'Golfe_Of_Guinea'}}</span></em><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_compute_cessation_dry_spell.default_criteria" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_compute_cessation_dry_spell.dry_spell_cessation_function">
<span class="sig-name descname"><span class="pre">dry_spell_cessation_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idebut1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cumul</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbsec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jour_pluvieux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irch_fin1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idebut2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ijour_dem_cal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ETP</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Cap_ret_maxi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irch_fin2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbjour</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_compute_cessation_dry_spell.dry_spell_cessation_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_compute_cessation_dry_spell.dry_spell_cessation_function" title="Link to this definition"></a></dt>
<dd><p>Computes the longest dry spell length after the onset and
determines the cessation date (when soil water returns to 0)
based on water balance, then checks for a dry spell.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array-like</em>) – Daily rainfall or similar values.</p></li>
<li><p><strong>idebut1</strong> (<em>int</em>) – Start index to begin searching for the onset.</p></li>
<li><p><strong>cumul</strong> (<em>float</em>) – Cumulative rainfall threshold to trigger onset.</p></li>
<li><p><strong>nbsec</strong> (<em>int</em>) – Maximum number of dry days allowed in the sequence.</p></li>
<li><p><strong>jour_pluvieux</strong> (<em>float</em>) – Minimum rainfall to consider a day as rainy.</p></li>
<li><p><strong>irch_fin1</strong> (<em>int</em>) – Maximum index limit for the onset search.</p></li>
<li><p><strong>idebut2</strong> (<em>int</em>) – Start index for the cessation search.</p></li>
<li><p><strong>ijour_dem_cal</strong> (<em>int</em>) – Start index from which the water balance is calculated.</p></li>
<li><p><strong>ETP</strong> (<em>float</em>) – Daily evapotranspiration (mm).</p></li>
<li><p><strong>Cap_ret_maxi</strong> (<em>float</em>) – Maximum soil water retention capacity (mm).</p></li>
<li><p><strong>irch_fin2</strong> (<em>int</em>) – Maximum index limit for the cessation search.</p></li>
<li><p><strong>nbjour</strong> (<em>int</em>) – Number of days after onset to check for the dry spell.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Length of the longest dry spell sequence after onset and before soil water
returns to zero, or NaN if not found.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_compute_cessation_dry_spell.rainf_zone">
<span class="sig-name descname"><span class="pre">rainf_zone</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">daily_data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_compute_cessation_dry_spell.rainf_zone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_compute_cessation_dry_spell.rainf_zone" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_compute_cessation_dry_spell.transform_cdt">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">transform_cdt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_compute_cessation_dry_spell.transform_cdt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_compute_cessation_dry_spell.transform_cdt" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>Transform a DataFrame with:</dt><dd><ul class="simple">
<li><p>Row 0 = LON</p></li>
<li><p>Row 1 = LAT</p></li>
<li><p>Row 2 = ELEV</p></li>
<li><p>Rows 3+ = daily data (or any date) with ‘ID’ column containing dates.</p></li>
</ul>
</dd>
</dl>
<p>Returns an xarray DataArray with coords = (T, Y, X), variable = ‘Observation’.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_compute_onset">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_compute_predictand.</span></span><span class="sig-name descname"><span class="pre">WAS_compute_onset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user_criteria</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_compute_onset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_compute_onset" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class that encapsulates methods for transforming precipitation data
from different formats (CPT, CDT) and computing onset dates based on
rainfall criteria.</p>
<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_compute_onset.adjust_duplicates">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">adjust_duplicates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">increment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_compute_onset.adjust_duplicates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_compute_onset.adjust_duplicates" title="Link to this definition"></a></dt>
<dd><p>If any values in the Series repeat, nudge them by a tiny increment
so that all are unique (to avoid indexing collisions).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_compute_onset.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">daily_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_cores</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_compute_onset.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_compute_onset.compute" title="Link to this definition"></a></dt>
<dd><p>Compute onset dates for each pixel in a given daily rainfall DataArray
using different criteria based on isohyet zones.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>daily_data</strong> (<em>xarray.DataArray</em>) – Daily rainfall data, coords = (T, Y, X).</p></li>
<li><p><strong>nb_cores</strong> (<em>int</em>) – Number of parallel processes to use.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array with onset dates computed per pixel.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_compute_onset.compute_insitu">
<span class="sig-name descname"><span class="pre">compute_insitu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">daily_df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_compute_onset.compute_insitu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_compute_onset.compute_insitu" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_compute_onset.day_of_year">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">day_of_year</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dem_rech1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_compute_onset.day_of_year"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_compute_onset.day_of_year" title="Link to this definition"></a></dt>
<dd><p>Given a year ‘i’ and a month-day string ‘dem_rech1’ (e.g., ‘07-23’),
return the day of the year (1-based).</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_compute_onset.default_criteria">
<span class="sig-name descname"><span class="pre">default_criteria</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{0:</span> <span class="pre">{'cumulative':</span> <span class="pre">10,</span> <span class="pre">'end_search':</span> <span class="pre">'08-30',</span> <span class="pre">'number_dry_days':</span> <span class="pre">25,</span> <span class="pre">'start_search':</span> <span class="pre">'06-01',</span> <span class="pre">'thrd_rain_day':</span> <span class="pre">0.85,</span> <span class="pre">'zone_name':</span> <span class="pre">'Sahel100_0mm'},</span> <span class="pre">1:</span> <span class="pre">{'cumulative':</span> <span class="pre">15,</span> <span class="pre">'end_search':</span> <span class="pre">'08-15',</span> <span class="pre">'number_dry_days':</span> <span class="pre">25,</span> <span class="pre">'start_search':</span> <span class="pre">'05-15',</span> <span class="pre">'thrd_rain_day':</span> <span class="pre">0.85,</span> <span class="pre">'zone_name':</span> <span class="pre">'Sahel200_100mm'},</span> <span class="pre">2:</span> <span class="pre">{'cumulative':</span> <span class="pre">15,</span> <span class="pre">'end_search':</span> <span class="pre">'07-31',</span> <span class="pre">'number_dry_days':</span> <span class="pre">20,</span> <span class="pre">'start_search':</span> <span class="pre">'05-01',</span> <span class="pre">'thrd_rain_day':</span> <span class="pre">0.85,</span> <span class="pre">'zone_name':</span> <span class="pre">'Sahel400_200mm'},</span> <span class="pre">3:</span> <span class="pre">{'cumulative':</span> <span class="pre">20,</span> <span class="pre">'end_search':</span> <span class="pre">'07-31',</span> <span class="pre">'number_dry_days':</span> <span class="pre">20,</span> <span class="pre">'start_search':</span> <span class="pre">'03-15',</span> <span class="pre">'thrd_rain_day':</span> <span class="pre">0.85,</span> <span class="pre">'zone_name':</span> <span class="pre">'Sahel600_400mm'},</span> <span class="pre">4:</span> <span class="pre">{'cumulative':</span> <span class="pre">20,</span> <span class="pre">'end_search':</span> <span class="pre">'07-31',</span> <span class="pre">'number_dry_days':</span> <span class="pre">10,</span> <span class="pre">'start_search':</span> <span class="pre">'03-15',</span> <span class="pre">'thrd_rain_day':</span> <span class="pre">0.85,</span> <span class="pre">'zone_name':</span> <span class="pre">'Soudan'},</span> <span class="pre">5:</span> <span class="pre">{'cumulative':</span> <span class="pre">20,</span> <span class="pre">'end_search':</span> <span class="pre">'06-15',</span> <span class="pre">'number_dry_days':</span> <span class="pre">10,</span> <span class="pre">'start_search':</span> <span class="pre">'02-01',</span> <span class="pre">'thrd_rain_day':</span> <span class="pre">0.85,</span> <span class="pre">'zone_name':</span> <span class="pre">'Golfe_Of_Guinea'}}</span></em><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_compute_onset.default_criteria" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_compute_onset.onset_function">
<span class="sig-name descname"><span class="pre">onset_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idebut</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cumul</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbsec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jour_pluvieux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irch_fin</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_compute_onset.onset_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_compute_onset.onset_function" title="Link to this definition"></a></dt>
<dd><p>Calculate the onset date of a season based on cumulative rainfall criteria.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array-like</em>) – Daily rainfall or similar values.</p></li>
<li><p><strong>idebut</strong> (<em>int</em>) – Start index to begin searching for the onset.</p></li>
<li><p><strong>cumul</strong> (<em>float</em>) – Cumulative rainfall threshold to trigger onset.</p></li>
<li><p><strong>nbsec</strong> (<em>int</em>) – Maximum number of dry days allowed in the sequence.</p></li>
<li><p><strong>jour_pluvieux</strong> (<em>float</em>) – Minimum rainfall to consider a day as rainy.</p></li>
<li><p><strong>irch_fin</strong> (<em>int</em>) – Maximum index limit for the onset.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Index of the onset date or NaN if onset not found.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int or float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_compute_onset.rainf_zone">
<span class="sig-name descname"><span class="pre">rainf_zone</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">daily_data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_compute_onset.rainf_zone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_compute_onset.rainf_zone" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_compute_onset.transform_cdt">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">transform_cdt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_compute_onset.transform_cdt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_compute_onset.transform_cdt" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>Transform a DataFrame with:</dt><dd><ul class="simple">
<li><p>Row 0 = LON</p></li>
<li><p>Row 1 = LAT</p></li>
<li><p>Row 2 = ELEV</p></li>
<li><p>Rows 3+ = daily data (or any date) with ‘ID’ column containing dates.</p></li>
</ul>
</dd>
</dl>
<p>Returns an xarray DataArray with coords = (T, Y, X), variable = ‘Observation’.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_compute_onset_dry_spell">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_compute_predictand.</span></span><span class="sig-name descname"><span class="pre">WAS_compute_onset_dry_spell</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user_criteria</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_compute_onset_dry_spell"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_compute_onset_dry_spell" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class for computing the longest dry spell length
after the onset of a rainy season, based on user-defined criteria.</p>
<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_compute_onset_dry_spell.adjust_duplicates">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">adjust_duplicates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">increment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_compute_onset_dry_spell.adjust_duplicates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_compute_onset_dry_spell.adjust_duplicates" title="Link to this definition"></a></dt>
<dd><p>If any values in the Series repeat, nudge them by a tiny increment
so that all are unique (to avoid indexing collisions).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_compute_onset_dry_spell.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">daily_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_cores</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_compute_onset_dry_spell.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_compute_onset_dry_spell.compute" title="Link to this definition"></a></dt>
<dd><p>Compute the longest dry spell length after the onset for each pixel in a
given daily rainfall DataArray, using different criteria based on isohyet zones.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>daily_data</strong> (<em>xarray.DataArray</em>) – Daily rainfall data, coords = (T, Y, X).</p></li>
<li><p><strong>nb_cores</strong> (<em>int</em>) – Number of parallel processes to use.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array with the longest dry spell length per pixel.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_compute_onset_dry_spell.compute_insitu">
<span class="sig-name descname"><span class="pre">compute_insitu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">daily_df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_compute_onset_dry_spell.compute_insitu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_compute_onset_dry_spell.compute_insitu" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_compute_onset_dry_spell.day_of_year">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">day_of_year</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dem_rech1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_compute_onset_dry_spell.day_of_year"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_compute_onset_dry_spell.day_of_year" title="Link to this definition"></a></dt>
<dd><p>Given a year ‘i’ and a month-day string ‘dem_rech1’ (e.g., ‘07-23’),
return the 1-based day of the year.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_compute_onset_dry_spell.default_criteria">
<span class="sig-name descname"><span class="pre">default_criteria</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{0:</span> <span class="pre">{'cumulative':</span> <span class="pre">10,</span> <span class="pre">'end_search':</span> <span class="pre">'08-30',</span> <span class="pre">'nbjour':</span> <span class="pre">40,</span> <span class="pre">'number_dry_days':</span> <span class="pre">25,</span> <span class="pre">'start_search':</span> <span class="pre">'06-01',</span> <span class="pre">'thrd_rain_day':</span> <span class="pre">0.85,</span> <span class="pre">'zone_name':</span> <span class="pre">'Sahel100_0mm'},</span> <span class="pre">1:</span> <span class="pre">{'cumulative':</span> <span class="pre">15,</span> <span class="pre">'end_search':</span> <span class="pre">'08-15',</span> <span class="pre">'nbjour':</span> <span class="pre">40,</span> <span class="pre">'number_dry_days':</span> <span class="pre">25,</span> <span class="pre">'start_search':</span> <span class="pre">'05-15',</span> <span class="pre">'thrd_rain_day':</span> <span class="pre">0.85,</span> <span class="pre">'zone_name':</span> <span class="pre">'Sahel200_100mm'},</span> <span class="pre">2:</span> <span class="pre">{'cumulative':</span> <span class="pre">15,</span> <span class="pre">'end_search':</span> <span class="pre">'07-31',</span> <span class="pre">'nbjour':</span> <span class="pre">40,</span> <span class="pre">'number_dry_days':</span> <span class="pre">20,</span> <span class="pre">'start_search':</span> <span class="pre">'05-01',</span> <span class="pre">'thrd_rain_day':</span> <span class="pre">0.85,</span> <span class="pre">'zone_name':</span> <span class="pre">'Sahel400_200mm'},</span> <span class="pre">3:</span> <span class="pre">{'cumulative':</span> <span class="pre">20,</span> <span class="pre">'end_search':</span> <span class="pre">'07-31',</span> <span class="pre">'nbjour':</span> <span class="pre">45,</span> <span class="pre">'number_dry_days':</span> <span class="pre">20,</span> <span class="pre">'start_search':</span> <span class="pre">'03-15',</span> <span class="pre">'thrd_rain_day':</span> <span class="pre">0.85,</span> <span class="pre">'zone_name':</span> <span class="pre">'Sahel600_400mm'},</span> <span class="pre">4:</span> <span class="pre">{'cumulative':</span> <span class="pre">20,</span> <span class="pre">'end_search':</span> <span class="pre">'07-31',</span> <span class="pre">'nbjour':</span> <span class="pre">50,</span> <span class="pre">'number_dry_days':</span> <span class="pre">10,</span> <span class="pre">'start_search':</span> <span class="pre">'03-15',</span> <span class="pre">'thrd_rain_day':</span> <span class="pre">0.85,</span> <span class="pre">'zone_name':</span> <span class="pre">'Soudan'},</span> <span class="pre">5:</span> <span class="pre">{'cumulative':</span> <span class="pre">20,</span> <span class="pre">'end_search':</span> <span class="pre">'06-15',</span> <span class="pre">'nbjour':</span> <span class="pre">50,</span> <span class="pre">'number_dry_days':</span> <span class="pre">10,</span> <span class="pre">'start_search':</span> <span class="pre">'02-01',</span> <span class="pre">'thrd_rain_day':</span> <span class="pre">0.85,</span> <span class="pre">'zone_name':</span> <span class="pre">'Golfe_Of_Guinea'}}</span></em><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_compute_onset_dry_spell.default_criteria" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_compute_onset_dry_spell.dry_spell_onset_function">
<span class="sig-name descname"><span class="pre">dry_spell_onset_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idebut</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cumul</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbsec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jour_pluvieux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irch_fin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbjour</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_compute_onset_dry_spell.dry_spell_onset_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_compute_onset_dry_spell.dry_spell_onset_function" title="Link to this definition"></a></dt>
<dd><p>Calculate the onset date of a season based on cumulative rainfall criteria, and
determine the longest dry spell sequence within a specified period after the onset.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_compute_onset_dry_spell.dry_spell_onset_function_">
<span class="sig-name descname"><span class="pre">dry_spell_onset_function_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idebut</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cumul</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbsec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jour_pluvieux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">irch_fin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbjour</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_compute_onset_dry_spell.dry_spell_onset_function_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_compute_onset_dry_spell.dry_spell_onset_function_" title="Link to this definition"></a></dt>
<dd><p>Calculate the onset date of a season based on cumulative rainfall criteria, and
determine the longest dry spell sequence within a specified period after the onset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array-like</em>) – Daily rainfall or similar values.</p></li>
<li><p><strong>idebut</strong> (<em>int</em>) – Start index to begin searching for the onset.</p></li>
<li><p><strong>cumul</strong> (<em>float</em>) – Cumulative rainfall threshold to trigger onset.</p></li>
<li><p><strong>nbsec</strong> (<em>int</em>) – Maximum number of dry days allowed in the sequence.</p></li>
<li><p><strong>jour_pluvieux</strong> (<em>float</em>) – Minimum rainfall to consider a day as rainy.</p></li>
<li><p><strong>irch_fin</strong> (<em>int</em>) – Maximum index limit for the onset.</p></li>
<li><p><strong>nbjour</strong> (<em>int</em>) – Number of days to check for the longest dry spell after onset.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Length of the longest dry spell sequence after onset or NaN if onset not found.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_compute_onset_dry_spell.rainf_zone">
<span class="sig-name descname"><span class="pre">rainf_zone</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">daily_data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_compute_onset_dry_spell.rainf_zone"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_compute_onset_dry_spell.rainf_zone" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_compute_onset_dry_spell.transform_cdt">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">transform_cdt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_compute_onset_dry_spell.transform_cdt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_compute_onset_dry_spell.transform_cdt" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>Transform a DataFrame with:</dt><dd><ul class="simple">
<li><p>Row 0 = LON</p></li>
<li><p>Row 1 = LAT</p></li>
<li><p>Row 2 = ELEV</p></li>
<li><p>Rows 3+ = daily data (or any date) with ‘ID’ column containing dates.</p></li>
</ul>
</dd>
</dl>
<p>Returns an xarray DataArray with coords = (T, Y, X), variable = ‘Observation’.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_count_dry_spells">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_compute_predictand.</span></span><span class="sig-name descname"><span class="pre">WAS_count_dry_spells</span></span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_count_dry_spells"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_count_dry_spells" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class to compute the number of dry spells within a specified period
(onset to cessation) for each pixel or station in a daily rainfall dataset.</p>
<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_count_dry_spells.adjust_duplicates">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">adjust_duplicates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">increment</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_count_dry_spells.adjust_duplicates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_count_dry_spells.adjust_duplicates" title="Link to this definition"></a></dt>
<dd><p>If any values in the Series repeat, nudge them by a tiny increment
so that all are unique (to avoid indexing collisions).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_count_dry_spells.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">daily_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onset_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cessation_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dry_spell_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dry_threshold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_cores</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_count_dry_spells.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_count_dry_spells.compute" title="Link to this definition"></a></dt>
<dd><p>Compute the number of dry spells for each pixel within the onset and cessation period
in a daily xarray DataArray.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>daily_data</strong> (<em>xarray.DataArray</em>) – Daily rainfall data, coords = (T, Y, X).</p></li>
<li><p><strong>onset_date</strong> (<em>xarray.DataArray</em>) – DataArray containing onset dates for each pixel.</p></li>
<li><p><strong>cessation_date</strong> (<em>xarray.DataArray</em>) – DataArray containing cessation dates for each pixel.</p></li>
<li><p><strong>dry_spell_length</strong> (<em>int</em>) – The length of a dry spell to count.</p></li>
<li><p><strong>dry_threshold</strong> (<em>float</em>) – Rainfall threshold to classify a day as “dry.”</p></li>
<li><p><strong>nb_cores</strong> (<em>int</em>) – Number of parallel processes to use.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An array with the count of dry spells per pixel.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_count_dry_spells.compute_insitu">
<span class="sig-name descname"><span class="pre">compute_insitu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">daily_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onset_df_cpt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cessation_df_cpt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dry_spell_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dry_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_count_dry_spells.compute_insitu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_count_dry_spells.compute_insitu" title="Link to this definition"></a></dt>
<dd><p>Compute the number of dry spells (of length = dry_spell_length) between the
onset and cessation dates for in-situ stations (CDT format).</p>
<dl class="simple">
<dt>Returns a DataFrame in CPT format:</dt><dd><ul class="simple">
<li><p>Row 0: [“LAT”, lat_stn1, lat_stn2, …]</p></li>
<li><p>Row 1: [“LON”, lon_stn1, lon_stn2, …]</p></li>
<li><p>Subsequent rows: [year, station1_value, station2_value, …]</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>daily_df</strong> (<em>pd.DataFrame</em>) – CDT rainfall data (ID column = date, station columns).</p></li>
<li><p><strong>onset_df_cpt</strong> (<em>pd.DataFrame</em>) – CPT-format DataFrame containing onset dates (as returned by some method).</p></li>
<li><p><strong>cessation_df_cpt</strong> (<em>pd.DataFrame</em>) – CPT-format DataFrame containing cessation dates.</p></li>
<li><p><strong>dry_spell_length</strong> (<em>int</em>) – The length of the dry spell to look for.</p></li>
<li><p><strong>dry_threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – Rainfall threshold below which a day is considered “dry.” Defaults to 1.0 mm.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Final dry-spell counts in CPT pivot format.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_count_dry_spells.count_dry_spells">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">count_dry_spells</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cessation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dry_spell_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dry_threshold</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_count_dry_spells.count_dry_spells"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_count_dry_spells.count_dry_spells" title="Link to this definition"></a></dt>
<dd><p>Count the number of dry spells of a specific length between onset and cessation dates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array-like</em>) – Daily rainfall values.</p></li>
<li><p><strong>onset</strong> (<em>int</em>) – Start index for the calculation (onset date).</p></li>
<li><p><strong>cessation</strong> (<em>int</em>) – End index for the calculation (cessation date).</p></li>
<li><p><strong>dry_spell_length</strong> (<em>int</em>) – The length of a dry spell to count.</p></li>
<li><p><strong>dry_threshold</strong> (<em>float</em>) – Rainfall threshold to classify a day as “dry.”</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The number of dry spells of the specified length (NaN if invalid).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int or float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_count_dry_spells.transform_cdt">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">transform_cdt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_count_dry_spells.transform_cdt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_count_dry_spells.transform_cdt" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>Transform a DataFrame with:</dt><dd><ul class="simple">
<li><p>Row 0 = LON</p></li>
<li><p>Row 1 = LAT</p></li>
<li><p>Row 2 = ELEV</p></li>
<li><p>Rows 3+ = daily data with ‘ID’ column containing dates.</p></li>
</ul>
</dd>
<dt>Returns a DataFrame with columns like:</dt><dd><p>DATE | STATION | VALUE | LON | LAT | ELEV | MEAN_ANNUAL_RAINFALL | zonename</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_count_dry_spells.transform_cpt">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">transform_cpt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">missing_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_count_dry_spells.transform_cpt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_count_dry_spells.transform_cpt" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>Transform a DataFrame in CPT format with:</dt><dd><ul class="simple">
<li><p>Row 0 = LAT</p></li>
<li><p>Row 1 = LON</p></li>
<li><p>Rows 2+ = numeric year data in wide format (stations in columns).</p></li>
</ul>
</dd>
<dt>Returns a DataFrame with columns like:</dt><dd><p>YEAR | STATION | VALUE | LAT | LON</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_count_rainy_days">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_compute_predictand.</span></span><span class="sig-name descname"><span class="pre">WAS_count_rainy_days</span></span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_count_rainy_days"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_count_rainy_days" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class to compute the number of rainy days between onset and cessation dates
for each pixel or station in a daily rainfall dataset.</p>
<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_count_rainy_days.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">daily_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onset_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cessation_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rain_threshold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_cores</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_count_rainy_days.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_count_rainy_days.compute" title="Link to this definition"></a></dt>
<dd><p>Compute the number of rainy days for each pixel between onset and cessation dates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>daily_data</strong> (<em>xarray.DataArray</em>) – Daily rainfall data, coords = (T, Y, X).</p></li>
<li><p><strong>onset_date</strong> (<em>xarray.DataArray</em>) – DataArray containing onset dates for each pixel.</p></li>
<li><p><strong>cessation_date</strong> (<em>xarray.DataArray</em>) – DataArray containing cessation dates for each pixel.</p></li>
<li><p><strong>rain_threshold</strong> (<em>float</em>) – Rainfall threshold to classify a day as “rainy.”</p></li>
<li><p><strong>nb_cores</strong> (<em>int</em>) – Number of parallel processes to use.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array with the count of rainy days per pixel.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_count_rainy_days.compute_insitu">
<span class="sig-name descname"><span class="pre">compute_insitu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">daily_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onset_df_cpt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cessation_df_cpt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rain_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.85</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_count_rainy_days.compute_insitu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_count_rainy_days.compute_insitu" title="Link to this definition"></a></dt>
<dd><p>Compute, for in-situ stations (CDT data), the number of rainy days between
onset and cessation, for each station and year.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>daily_df</strong> (<em>pd.DataFrame</em>) – CDT precipitation data (ID column = date; columns = stations).
Follows the standard CDT format.</p></li>
<li><p><strong>onset_df_cpt</strong> (<em>pd.DataFrame</em>) – Result of <cite>WAS_compute_onset.compute_insitu(…)</cite> for onset (CPT format).</p></li>
<li><p><strong>cessation_df_cpt</strong> (<em>pd.DataFrame</em>) – Same format for cessation (CPT format).</p></li>
<li><p><strong>rain_threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – Precipitation threshold for counting a day as “rainy,” by default 0.85 mm.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>df_final</strong> – The count of rainy days in CPT pivot format.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_count_rainy_days.count_rainy_days">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">count_rainy_days</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onset_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cessation_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rain_threshold</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_count_rainy_days.count_rainy_days"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_count_rainy_days.count_rainy_days" title="Link to this definition"></a></dt>
<dd><p>Count the number of rainy days between onset and cessation dates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array-like</em>) – Daily rainfall values.</p></li>
<li><p><strong>onset_date</strong> (<em>int</em>) – Start index for the calculation (onset date).</p></li>
<li><p><strong>cessation_date</strong> (<em>int</em>) – End index for the calculation (cessation date).</p></li>
<li><p><strong>rain_threshold</strong> (<em>float</em>) – Rainfall threshold to classify a day as “rainy.”</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Number of rainy days (returns NaN if data is invalid).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int or float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_count_rainy_days.transform_cdt">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">transform_cdt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_count_rainy_days.transform_cdt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_count_rainy_days.transform_cdt" title="Link to this definition"></a></dt>
<dd><p>Transform a DataFrame in CDT format into a standardized long DataFrame.</p>
<dl class="simple">
<dt>CDT format assumptions:</dt><dd><ul class="simple">
<li><p>Row 0 = LON</p></li>
<li><p>Row 1 = LAT</p></li>
<li><p>Row 2 = ELEV</p></li>
<li><p>Rows 3+ = daily data with ‘ID’ column holding dates in YYYYMMDD format.</p></li>
</ul>
</dd>
<dt>This method returns a DataFrame with columns:</dt><dd><p>DATE, STATION, VALUE, LON, LAT, ELEV, (optional) MEAN_ANNUAL_RAINFALL, zonename</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_count_wet_spells">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_compute_predictand.</span></span><span class="sig-name descname"><span class="pre">WAS_count_wet_spells</span></span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_count_wet_spells"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_count_wet_spells" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class to compute the number of wet spells within a specified period
(onset to cessation) for each pixel or station in a daily rainfall dataset.</p>
<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_count_wet_spells.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">daily_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onset_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cessation_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wet_spell_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wet_threshold</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_cores</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_count_wet_spells.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_count_wet_spells.compute" title="Link to this definition"></a></dt>
<dd><p>Compute the number of wet spells for each pixel within the onset and cessation period
in a daily xarray DataArray.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>daily_data</strong> (<em>xarray.DataArray</em>) – Daily rainfall data, coords = (T, Y, X).</p></li>
<li><p><strong>onset_date</strong> (<em>xarray.DataArray</em>) – DataArray containing onset dates for each pixel.</p></li>
<li><p><strong>cessation_date</strong> (<em>xarray.DataArray</em>) – DataArray containing cessation dates for each pixel.</p></li>
<li><p><strong>wet_spell_length</strong> (<em>int</em>) – The length of a wet spell to count.</p></li>
<li><p><strong>wet_threshold</strong> (<em>float</em>) – Rainfall threshold to classify a day as “wet.”</p></li>
<li><p><strong>nb_cores</strong> (<em>int</em>) – Number of parallel processes to use.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array with the count of wet spells per pixel.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_count_wet_spells.compute_insitu">
<span class="sig-name descname"><span class="pre">compute_insitu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">daily_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onset_df_cpt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cessation_df_cpt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wet_spell_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wet_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_count_wet_spells.compute_insitu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_count_wet_spells.compute_insitu" title="Link to this definition"></a></dt>
<dd><p>Compute the number of wet spells (of length = wet_spell_length) between
onset and cessation for in-situ stations (CDT data).</p>
<dl class="simple">
<dt>Returns a DataFrame in CPT format:</dt><dd><ul class="simple">
<li><p>Row 0: [“LAT”, lat_station1, lat_station2, …]</p></li>
<li><p>Row 1: [“LON”, lon_station1, lon_station2, …]</p></li>
<li><p>Then one row per year: [year, station1_value, station2_value, …]</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>daily_df</strong> (<em>pd.DataFrame</em>) – CDT rainfall data (ID column = date, station columns).</p></li>
<li><p><strong>onset_df_cpt</strong> (<em>pd.DataFrame</em>) – CPT-format DataFrame with onset dates (same station columns).</p></li>
<li><p><strong>cessation_df_cpt</strong> (<em>pd.DataFrame</em>) – CPT-format DataFrame with cessation dates (same station columns).</p></li>
<li><p><strong>wet_spell_length</strong> (<em>int</em>) – The length of a wet spell to count.</p></li>
<li><p><strong>wet_threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – Rainfall threshold classifying a day as “wet.” Defaults to 1.0 mm.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Final wet-spell counts in CPT pivot format.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_count_wet_spells.count_wet_spells">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">count_wet_spells</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onset_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cessation_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wet_spell_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wet_threshold</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_count_wet_spells.count_wet_spells"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_count_wet_spells.count_wet_spells" title="Link to this definition"></a></dt>
<dd><p>Count the number of wet spells of a specific length between onset and cessation dates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array-like</em>) – Daily rainfall values.</p></li>
<li><p><strong>onset_date</strong> (<em>int</em>) – Start index for the calculation (onset date).</p></li>
<li><p><strong>cessation_date</strong> (<em>int</em>) – End index for the calculation (cessation date).</p></li>
<li><p><strong>wet_spell_length</strong> (<em>int</em>) – The length of a wet spell to count.</p></li>
<li><p><strong>wet_threshold</strong> (<em>float</em>) – Rainfall threshold to classify a day as “wet.”</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The number of wet spells of the specified length (NaN if data is invalid).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int or float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_count_wet_spells.transform_cdt">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">transform_cdt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_count_wet_spells.transform_cdt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_count_wet_spells.transform_cdt" title="Link to this definition"></a></dt>
<dd><p>Transform a CDT-format DataFrame into a standard table.</p>
<dl class="simple">
<dt>CDT format assumptions:</dt><dd><ul class="simple">
<li><p>Row 0 = LON</p></li>
<li><p>Row 1 = LAT</p></li>
<li><p>Row 2 = ELEV</p></li>
<li><p>Rows 3+ = daily data, ‘ID’ column has dates in YYYYMMDD.</p></li>
</ul>
</dd>
<dt>Returns a DataFrame with columns:</dt><dd><p>[DATE, STATION, VALUE, LON, LAT, ELEV, MEAN_ANNUAL_RAINFALL, zonename]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_r95_99p">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_compute_predictand.</span></span><span class="sig-name descname"><span class="pre">WAS_r95_99p</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_period</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">slice</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">season</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_r95_99p"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_r95_99p" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class to compute the R95p and R99p climate indices using either:
- Dask-enabled xarray for large raster/time-series
- An “insitu” method for station-based (CDT) data.</p>
<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_r95_99p.compute_insitu_r95p">
<span class="sig-name descname"><span class="pre">compute_insitu_r95p</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_cdt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_r95_99p.compute_insitu_r95p"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_r95_99p.compute_insitu_r95p" title="Link to this definition"></a></dt>
<dd><p>Compute R95p index (total precipitation on days above the daily 95th percentile)
for station-based data in CDT format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df_cdt</strong> (<em>pd.DataFrame</em>) – CDT-format DataFrame (rows 0..2 = LON/LAT/ELEV, row 3+ = daily data).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>df_final</strong> – A DataFrame in CPT format with the R95p values pivoted by station vs. year.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_r95_99p.compute_insitu_r99p">
<span class="sig-name descname"><span class="pre">compute_insitu_r99p</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_cdt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_r95_99p.compute_insitu_r99p"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_r95_99p.compute_insitu_r99p" title="Link to this definition"></a></dt>
<dd><p>Compute R99p index (total precipitation on days above the daily 99th percentile)
for station-based data in CDT format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df_cdt</strong> (<em>pd.DataFrame</em>) – CDT-format DataFrame.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>df_final</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame (CPT format)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_r95_99p.compute_r95p">
<span class="sig-name descname"><span class="pre">compute_r95p</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataArray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataArray</span></span></span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_r95_99p.compute_r95p"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_r95_99p.compute_r95p" title="Link to this definition"></a></dt>
<dd><p>Existing method for xarray-based data (unchanged).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_r95_99p.compute_r99p">
<span class="sig-name descname"><span class="pre">compute_r99p</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataArray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataArray</span></span></span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_r95_99p.compute_r99p"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_r95_99p.compute_r99p" title="Link to this definition"></a></dt>
<dd><p>Existing method for xarray-based data (unchanged).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_compute_predictand.WAS_r95_99p.transform_cdt">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">transform_cdt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_compute_predictand.html#WAS_r95_99p.transform_cdt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_compute_predictand.WAS_r95_99p.transform_cdt" title="Link to this definition"></a></dt>
<dd><p>Transform a DataFrame in CDT format into a standardized long DataFrame.</p>
<dl class="simple">
<dt>CDT format assumptions:</dt><dd><ul class="simple">
<li><p>Row 0 = LON</p></li>
<li><p>Row 1 = LAT</p></li>
<li><p>Row 2 = ELEV</p></li>
<li><p>Rows 3+ = daily data with ‘ID’ column holding dates in YYYYMMDD format.</p></li>
</ul>
</dd>
<dt>Returns a DataFrame with columns:</dt><dd><p>[DATE, STATION, VALUE, LON, LAT, ELEV]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-wass2s.was_merge_predictand">
<span id="wass2s-was-merge-predictand-module"></span><h2>wass2s.was_merge_predictand module<a class="headerlink" href="#module-wass2s.was_merge_predictand" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_merge_predictand.WAS_Merging">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_merge_predictand.</span></span><span class="sig-name descname"><span class="pre">WAS_Merging</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">da</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">date_month_day</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'08-01'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_merge_predictand.html#WAS_Merging"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_merge_predictand.WAS_Merging" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_merge_predictand.WAS_Merging.adjust_duplicates">
<span class="sig-name descname"><span class="pre">adjust_duplicates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">increment</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-05</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Series</span></span></span><a class="reference internal" href="_modules/wass2s/was_merge_predictand.html#WAS_Merging.adjust_duplicates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_merge_predictand.WAS_Merging.adjust_duplicates" title="Link to this definition"></a></dt>
<dd><p>If any values in the Series repeat, nudge them by a tiny increment
so that all are unique (to avoid indexing collisions).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_merge_predictand.WAS_Merging.auto_select_kriging_parameters">
<span class="sig-name descname"><span class="pre">auto_select_kriging_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'X'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Y'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'residuals'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variogram_models</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nlags_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">range(3,</span> <span class="pre">10)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_splits</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_plotting</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_merge_predictand.html#WAS_Merging.auto_select_kriging_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_merge_predictand.WAS_Merging.auto_select_kriging_parameters" title="Link to this definition"></a></dt>
<dd><p>Automatically selects the best variogram_model and nlags for Ordinary Kriging
using cross-validation.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>best_model (str)</p></li>
<li><p>best_nlags (int)</p></li>
<li><p>ok_best (OrdinaryKriging object)</p></li>
<li><p>results_df (pd.DataFrame)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_merge_predictand.WAS_Merging.multiplicative_bias">
<span class="sig-name descname"><span class="pre">multiplicative_bias</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">missing_value:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">-999.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_cross_validation:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False)</span> <span class="pre">-&gt;</span> <span class="pre">(&lt;class</span> <span class="pre">'xarray.core.dataarray.DataArray'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'pandas.core.frame.DataFrame'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_merge_predictand.html#WAS_Merging.multiplicative_bias"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_merge_predictand.WAS_Merging.multiplicative_bias" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_merge_predictand.WAS_Merging.neural_network_kriging">
<span class="sig-name descname"><span class="pre">neural_network_kriging</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">missing_value:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">-999.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_cross_validation:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False)</span> <span class="pre">-&gt;</span> <span class="pre">(&lt;class</span> <span class="pre">'xarray.core.dataarray.DataArray'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pandas.core.frame.DataFrame</span> <span class="pre">|</span> <span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_merge_predictand.html#WAS_Merging.neural_network_kriging"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_merge_predictand.WAS_Merging.neural_network_kriging" title="Link to this definition"></a></dt>
<dd><p>Performs a two-step spatial bias adjustment for each time slice, leveraging:</p>
<ol class="arabic simple">
<li><p><strong>Neural Network</strong> (MLPRegressor) to capture non-linear relationships between
the large-scale estimations (predictors) and in-situ observations (predictands).</p></li>
<li><p><strong>Kriging</strong> of the residuals (observation - NN_prediction) to spatially interpolate
the remaining error structure under the assumption that these residuals are
stationary and exhibit spatial autocorrelation.</p></li>
</ol>
<section id="theoretical-rationale">
<h3><strong>Theoretical Rationale</strong>:<a class="headerlink" href="#theoretical-rationale" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>Neural Network Step</strong>:
We use a Multi-Layer Perceptron (MLP) to learn non-linear mappings from model estimates
(e.g., from a climate or weather model) to station observations. The NN effectively
captures large-scale, non-linear bias patterns that linear methods may miss.</p></li>
<li><p><strong>Kriging (Geostatistics) Step</strong>:
After removing the large-scale bias via NN, the residual field often still contains
spatially correlated local biases or errors. We assume these residuals follow a
stationary random field. Ordinary Kriging then interpolates these residuals across
the domain, leveraging a semi-variogram fitted to station residuals. By adding the
kriged residual field back to the NN predictions, we account for both large-scale
and local spatial biases.</p></li>
</ul>
<dl>
<dt><strong>Procedure</strong>:</dt><dd><ol class="arabic">
<li><p>Transform station data (df_seas) and gridded estimates (estim) into a standardized
space if needed (optional).</p></li>
<li><p>For each time slice:
a. Align station and grid data, dropping NaNs.
b. Train a Neural Network model (MLPRegressor) on (X=NN_inputs, y=station_obs).
c. Compute station residuals = (station_obs - nn_prediction).
d. Fit a variogram to station residuals, then perform Ordinary Kriging on the</p>
<blockquote>
<div><p>entire domain.</p>
</div></blockquote>
<ol class="loweralpha simple" start="5">
<li><p>Combine (NN grid prediction) + (kriged residuals) for final bias-adjusted field.</p></li>
</ol>
</li>
</ol>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">param missing_value<span class="colon">:</span></dt>
<dd class="field-odd"><p>Value used to fill missing data in the input station dataset, by default -999.0</p>
</dd>
<dt class="field-even">type missing_value<span class="colon">:</span></dt>
<dd class="field-even"><p>float, optional</p>
</dd>
<dt class="field-odd">param do_cross_validation<span class="colon">:</span></dt>
<dd class="field-odd"><p>Whether or not to perform cross-validation (e.g., leave-one-out or k-fold)
during kriging parameter selection, by default False.</p>
</dd>
<dt class="field-even">type do_cross_validation<span class="colon">:</span></dt>
<dd class="field-even"><p>bool, optional</p>
</dd>
<dt class="field-odd">returns<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><em>xr.DataArray</em> – Bias-adjusted field over the domain, with the same spatial dimensions as the
original input (and time dimension if applicable).</p></li>
<li><p><em>pd.DataFrame or None</em> – If <cite>do_cross_validation=True</cite>, returns a DataFrame with RMSE records from CV;
otherwise, None.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The hyperparameter search for the MLP uses GridSearchCV with MSE-based scoring.</p></li>
<li><p>Kriging assumes the residuals are reasonably stationary and spatially correlated.</p></li>
<li><p>Negative predictions are clamped to zero, assuming a non-negative variable
(e.g., precipitation).</p></li>
</ul>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_merge_predictand.WAS_Merging.neural_network_kriging_">
<span class="sig-name descname"><span class="pre">neural_network_kriging_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">missing_value:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">-999.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_cross_validation:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False)</span> <span class="pre">-&gt;</span> <span class="pre">(&lt;class</span> <span class="pre">'xarray.core.dataarray.DataArray'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'pandas.core.frame.DataFrame'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_merge_predictand.html#WAS_Merging.neural_network_kriging_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_merge_predictand.WAS_Merging.neural_network_kriging_" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>Performs spatial bias adjustment for each time slice using:</dt><dd><ol class="arabic simple">
<li><p>Neural Network</p></li>
<li><p>Kriging of residuals</p></li>
</ol>
</dd>
</dl>
<p>Optionally performs LOO cross-validation for each time.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_merge_predictand.WAS_Merging.plot_merging_comparaison">
<span class="sig-name descname"><span class="pre">plot_merging_comparaison</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_Obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">da_estimated</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">da_corrected</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">missing_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-999.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_merge_predictand.html#WAS_Merging.plot_merging_comparaison"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_merge_predictand.WAS_Merging.plot_merging_comparaison" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_merge_predictand.WAS_Merging.regression_kriging">
<span class="sig-name descname"><span class="pre">regression_kriging</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">missing_value:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">-999.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_cross_validation:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False)</span> <span class="pre">-&gt;</span> <span class="pre">(&lt;class</span> <span class="pre">'xarray.core.dataarray.DataArray'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'pandas.core.frame.DataFrame'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_merge_predictand.html#WAS_Merging.regression_kriging"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_merge_predictand.WAS_Merging.regression_kriging" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>Performs spatial bias adjustment for each time slice using:</dt><dd><ol class="arabic simple">
<li><p>Linear Regression</p></li>
<li><p>Kriging of residuals</p></li>
</ol>
</dd>
</dl>
<p>Optionally performs LOO cross-validation for each time.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_merge_predictand.WAS_Merging.simple_bias_adjustment">
<span class="sig-name descname"><span class="pre">simple_bias_adjustment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">missing_value:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">-999.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_cross_validation:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False)</span> <span class="pre">-&gt;</span> <span class="pre">(&lt;class</span> <span class="pre">'xarray.core.dataarray.DataArray'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">&lt;class</span> <span class="pre">'pandas.core.frame.DataFrame'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_merge_predictand.html#WAS_Merging.simple_bias_adjustment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_merge_predictand.WAS_Merging.simple_bias_adjustment" title="Link to this definition"></a></dt>
<dd><p>Performs spatial bias adjustment for each time slice. Optionally does
leave-one-out (LOO) cross-validation to compute RMSE at each time.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>xr.DataArray</em> – Concatenated bias-adjusted values along the time dimension.</p></li>
<li><p><em>pd.DataFrame or None</em> – A DataFrame containing the LOO RMSE for each time if do_cross_validation=True.
Otherwise, returns None.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_merge_predictand.WAS_Merging.transform_cdt">
<span class="sig-name descname"><span class="pre">transform_cdt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataArray</span></span></span><a class="reference internal" href="_modules/wass2s/was_merge_predictand.html#WAS_Merging.transform_cdt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_merge_predictand.WAS_Merging.transform_cdt" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_merge_predictand.WAS_Merging.transform_cpt">
<span class="sig-name descname"><span class="pre">transform_cpt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">missing_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-999.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataArray</span></span></span><a class="reference internal" href="_modules/wass2s/was_merge_predictand.html#WAS_Merging.transform_cpt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_merge_predictand.WAS_Merging.transform_cpt" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-wass2s.was_cross_validate">
<span id="wass2s-was-cross-validate-module"></span><h2>wass2s.was_cross_validate module<a class="headerlink" href="#module-wass2s.was_cross_validate" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_cross_validate.CustomTimeSeriesSplit">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_cross_validate.</span></span><span class="sig-name descname"><span class="pre">CustomTimeSeriesSplit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_splits</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_cross_validate.html#CustomTimeSeriesSplit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_cross_validate.CustomTimeSeriesSplit" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Custom time series cross-validator for splitting data into training and test sets.</p>
<p>Ensures temporal ordering is maintained by generating training and test indices
suitable for time series data, with an option to omit samples after the test index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n_splits</strong> (<em>int</em>) – Number of splits for the cross-validation.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_cross_validate.CustomTimeSeriesSplit.get_n_splits">
<span class="sig-name descname"><span class="pre">get_n_splits</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_cross_validate.html#CustomTimeSeriesSplit.get_n_splits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_cross_validate.CustomTimeSeriesSplit.get_n_splits" title="Link to this definition"></a></dt>
<dd><p>Return the number of splits for the cross-validation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em><em>, </em><em>optional</em>) – The data to be split (ignored in this implementation).</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>optional</em>) – The target variable (ignored in this implementation).</p></li>
<li><p><strong>groups</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Group labels for the samples (ignored in this implementation).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The number of splits configured for the cross-validator.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_cross_validate.CustomTimeSeriesSplit.split">
<span class="sig-name descname"><span class="pre">split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_omit</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_cross_validate.html#CustomTimeSeriesSplit.split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_cross_validate.CustomTimeSeriesSplit.split" title="Link to this definition"></a></dt>
<dd><p>Generate indices to split data into training and test sets.</p>
<p>Yields training indices before the test index (excluding a specified number of samples
after the test index) and test indices for each split.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array-like</em>) – The data to be split, typically time series data.</p></li>
<li><p><strong>nb_omit</strong> (<em>int</em>) – Number of samples to omit from training after the test index to avoid data leakage.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>optional</em>) – The target variable (ignored in this implementation).</p></li>
<li><p><strong>groups</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Group labels for the samples (ignored in this implementation).</p></li>
</ul>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>train_indices</strong> (<em>ndarray</em>) – The training set indices for the current split.</p></li>
<li><p><strong>test_indices</strong> (<em>list</em>) – The test set indices for the current split.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_cross_validate.WAS_Cross_Validator">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_cross_validate.</span></span><span class="sig-name descname"><span class="pre">WAS_Cross_Validator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_splits</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_omit</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_cross_validate.html#WAS_Cross_Validator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_cross_validate.WAS_Cross_Validator" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Performs cross-validation for time series forecasting models using a custom time series split.</p>
<p>This class wraps a custom time series cross-validator to evaluate forecasting models,
handling both deterministic hindcasts and probabilistic (tercile) predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_splits</strong> (<em>int</em>) – Number of splits for the cross-validation.</p></li>
<li><p><strong>nb_omit</strong> (<em>int</em>) – Number of samples to omit from training after the test index to prevent data leakage.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_cross_validate.WAS_Cross_Validator.cross_validate">
<span class="sig-name descname"><span class="pre">cross_validate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">model_params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_cross_validate.html#WAS_Cross_Validator.cross_validate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_cross_validate.WAS_Cross_Validator.cross_validate" title="Link to this definition"></a></dt>
<dd><p>Perform cross-validation to compute deterministic hindcasts and tercile probabilities.</p>
<p>Iterates over time series splits, trains the model on training data, and generates
predictions for test data. Supports special handling for specific model types
(e.g., CCA, Analog, ELM, ELR, and various machine learning models).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>object</em>) – The forecasting model instance to evaluate.</p></li>
<li><p><strong>Predictant</strong> (<em>xarray.DataArray</em>) – Target dataset with dimensions (‘T’, ‘Y’, ‘X’) or (‘T’, ‘M’, ‘Y’, ‘X’).</p></li>
<li><p><strong>Predictor</strong> (<em>xarray.DataArray</em><em>, </em><em>optional</em>) – Predictor dataset with dimensions (‘T’, ‘M’, ‘Y’, ‘X’) or (‘T’, ‘features’).
Required for most models except specific cases like WAS_Analog.</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em><em> or </em><em>str</em><em>, </em><em>optional</em>) – Start year of the climatology period for standardization and probability calculations.</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em><em> or </em><em>str</em><em>, </em><em>optional</em>) – End year of the climatology period for standardization and probability calculations.</p></li>
<li><p><strong>**model_params</strong> (<em>dict</em>) – Additional keyword arguments to pass to the model’s compute_model method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>If the model supports probability calculations (has compute_prob method):</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>hindcast_det<span class="classifier">xarray.DataArray</span></dt><dd><p>Deterministic hindcast results with dimensions (‘T’, ‘Y’, ‘X’) or
(‘probability’, ‘T’, ‘Y’, ‘X’) for specific models.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>hindcast_prob<span class="classifier">xarray.DataArray</span></dt><dd><p>Tercile probabilities with dimensions (‘probability’, ‘T’, ‘Y’, ‘X’),
where ‘probability’ includes [‘PB’, ‘PN’, ‘PA’] (below-normal, normal, above-normal).</p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>If the model does not support probability calculations (e.g., WAS_mme_ELR):</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>hindcast_det<span class="classifier">xarray.DataArray</span></dt><dd><p>Deterministic hindcast results with dimensions (‘T’, ‘Y’, ‘X’).</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple or xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_cross_validate.WAS_Cross_Validator.get_model_params">
<span class="sig-name descname"><span class="pre">get_model_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_cross_validate.html#WAS_Cross_Validator.get_model_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_cross_validate.WAS_Cross_Validator.get_model_params" title="Link to this definition"></a></dt>
<dd><p>Retrieve parameters required for the model’s compute_model method.</p>
<p>Extracts parameters dynamically from the model’s attributes that match the
argument names of its compute_model method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model</strong> (<em>object</em>) – The forecasting model instance to inspect.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary of parameter names and values to pass to the model’s compute_model method.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-wass2s.was_linear_models">
<span id="wass2s-was-linear-models-module"></span><h2>wass2s.was_linear_models module<a class="headerlink" href="#module-wass2s.was_linear_models" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_ElasticNet_Model">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_linear_models.</span></span><span class="sig-name descname"><span class="pre">WAS_ElasticNet_Model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l1_ratio_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_clusters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_cores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gamma'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_ElasticNet_Model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_ElasticNet_Model" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class to implement the ElasticNet model for spatiotemporal regression with clustering,
cross-validation, and probabilistic predictions.</p>
<section id="attributes">
<h3>Attributes:<a class="headerlink" href="#attributes" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>alpha_range<span class="classifier">numpy.ndarray</span></dt><dd><p>Range of alpha values (regularization strength) to explore.
Default is from 10^-6 to 10^2.</p>
</dd>
<dt>l1_ratio_range<span class="classifier">list</span></dt><dd><p>Range of l1 ratio values (mixing between L1 and L2 penalties).
Default is [0.1, 0.5, 0.7, 0.9, 0.95, 0.99, 1].</p>
</dd>
<dt>n_clusters<span class="classifier">int</span></dt><dd><p>Number of clusters for KMeans-based spatial grouping. Default is 5.</p>
</dd>
<dt>nb_cores<span class="classifier">int</span></dt><dd><p>Number of CPU cores for parallel computations. Default is 1.</p>
</dd>
<dt>dist_method<span class="classifier">str</span></dt><dd><p>Distribution method for tercile probability calculations
(e.g. ‘gamma’,’t’,’normal’,’lognormal’,’nonparam’). Default = “gamma”.</p>
</dd>
</dl>
</section>
<section id="methods">
<h3>Methods:<a class="headerlink" href="#methods" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>fit_predict(x, y, x_test, y_test=None, alpha=None, l1_ratio=None)</dt><dd><p>Fits an ElasticNet model to training data and predicts values for test data.</p>
</dd>
<dt>compute_hyperparameters(predictand, predictor)</dt><dd><p>Computes the optimal alpha and l1 ratio for each cluster using cross-validation.</p>
</dd>
<dt>compute_model(X_train, y_train, X_test, y_test, alpha, l1_ratio)</dt><dd><p>Performs parallelized ElasticNet modeling for spatiotemporal data.</p>
</dd>
<dt>calculate_tercile_probabilities(…)</dt><dd><p>Various static methods for computing tercile probabilities (t, gamma, normal, etc.).</p>
</dd>
<dt>compute_prob(Predictant, clim_year_start, clim_year_end, Predictor, hindcast_det)</dt><dd><p>Computes probabilistic hindcasts for tercile categories based on climatological terciles.</p>
</dd>
<dt>forecast(Predictant, clim_year_start, clim_year_end, Predictor, hindcast_det, Predictor_for_year, alpha, l1_ratio)</dt><dd><p>Generates a single-year forecast using ElasticNet with alpha + l1_ratio,
and computes tercile probabilities based on the chosen method.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_ElasticNet_Model.calculate_tercile_probabilities">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_ElasticNet_Model.calculate_tercile_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_ElasticNet_Model.calculate_tercile_probabilities" title="Link to this definition"></a></dt>
<dd><p>Student’s t-based method for tercile probabilities.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_ElasticNet_Model.calculate_tercile_probabilities_gamma">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_ElasticNet_Model.calculate_tercile_probabilities_gamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_ElasticNet_Model.calculate_tercile_probabilities_gamma" title="Link to this definition"></a></dt>
<dd><p>Gamma-based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_ElasticNet_Model.calculate_tercile_probabilities_lognormal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_lognormal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_ElasticNet_Model.calculate_tercile_probabilities_lognormal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_ElasticNet_Model.calculate_tercile_probabilities_lognormal" title="Link to this definition"></a></dt>
<dd><p>Lognormal-based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_ElasticNet_Model.calculate_tercile_probabilities_nonparametric">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_nonparametric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_ElasticNet_Model.calculate_tercile_probabilities_nonparametric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_ElasticNet_Model.calculate_tercile_probabilities_nonparametric" title="Link to this definition"></a></dt>
<dd><p>Non-parametric method (requires historical errors).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_ElasticNet_Model.calculate_tercile_probabilities_normal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_normal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_ElasticNet_Model.calculate_tercile_probabilities_normal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_ElasticNet_Model.calculate_tercile_probabilities_normal" title="Link to this definition"></a></dt>
<dd><p>Normal-based method using the Gaussian CDF.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_ElasticNet_Model.compute_hyperparameters">
<span class="sig-name descname"><span class="pre">compute_hyperparameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictand</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predictor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_ElasticNet_Model.compute_hyperparameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_ElasticNet_Model.compute_hyperparameters" title="Link to this definition"></a></dt>
<dd><p>Computes the optimal alpha and l1 ratio for each cluster using cross-validation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_ElasticNet_Model.compute_model">
<span class="sig-name descname"><span class="pre">compute_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l1_ratio</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_ElasticNet_Model.compute_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_ElasticNet_Model.compute_model" title="Link to this definition"></a></dt>
<dd><p>Performs parallelized ElasticNet modeling for spatiotemporal data.
Returns [error, prediction] per grid cell.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_ElasticNet_Model.compute_prob">
<span class="sig-name descname"><span class="pre">compute_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_ElasticNet_Model.compute_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_ElasticNet_Model.compute_prob" title="Link to this definition"></a></dt>
<dd><p>Compute tercile probabilities using self.dist_method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Predictant</strong> (<em>xarray.DataArray</em><em> (</em><em>T</em><em>, </em><em>Y</em><em>, </em><em>X</em><em>)</em>) – Observed data.</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em>)</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em>) – The start and end years for the climatology.</p></li>
<li><p><strong>hindcast_det</strong> (<em>xarray.DataArray</em>) – Deterministic forecast with dims (output=2, T, Y, X).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>hindcast_prob</strong> – dims (probability=3, T, Y, X) =&gt; [PB, PN, PA].</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_ElasticNet_Model.fit_predict">
<span class="sig-name descname"><span class="pre">fit_predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l1_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_ElasticNet_Model.fit_predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_ElasticNet_Model.fit_predict" title="Link to this definition"></a></dt>
<dd><p>Fits an ElasticNet model to training data and predicts on test data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>ndarray</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>)</p></li>
<li><p><strong>y</strong> (<em>ndarray</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em>)</p></li>
<li><p><strong>x_test</strong> (<em>ndarray</em><em>, </em><em>shape</em><em> (</em><em>n_features</em><em>,</em><em>) or </em><em>(</em><em>1</em><em>, </em><em>n_features</em><em>)</em>)</p></li>
<li><p><strong>y_test</strong> (<em>float</em><em> or </em><em>None</em>)</p></li>
<li><p><strong>alpha</strong> (<em>float</em>)</p></li>
<li><p><strong>l1_ratio</strong> (<em>float</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[error, prediction] if y_test is provided;
[prediction] if y_test is None.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_ElasticNet_Model.forecast">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor_for_year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l1_ratio</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_ElasticNet_Model.forecast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_ElasticNet_Model.forecast" title="Link to this definition"></a></dt>
<dd><p>Generates a single-year forecast using ElasticNet with (alpha, l1_ratio),
and computes tercile probabilities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Predictant</strong> (<em>xarray.DataArray</em>) – Observed data (T, Y, X).</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em>) – Climatology reference period.</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em>) – Climatology reference period.</p></li>
<li><p><strong>Predictor</strong> (<em>xarray.DataArray</em>) – Historical predictor data (T, features).</p></li>
<li><p><strong>hindcast_det</strong> (<em>xarray.DataArray</em>) – Historical deterministic forecast with dims (output=2, T, Y, X).</p></li>
<li><p><strong>Predictor_for_year</strong> (<em>xarray.DataArray</em>) – Single-year predictor data (features,).</p></li>
<li><p><strong>alpha</strong> (<em>xarray.DataArray</em>) – Spatial map of alpha values (Y, X).</p></li>
<li><p><strong>l1_ratio</strong> (<em>xarray.DataArray</em>) – Spatial map of l1_ratio values (Y, X).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>result_</strong> (<em>xarray.DataArray</em>) – dims (output=2, Y, X) =&gt; [error, forecast].
For a real forecast scenario, ‘error’ is NaN.</p></li>
<li><p><strong>hindcast_prob</strong> (<em>xarray.DataArray</em>) – dims (probability=3, Y, X) =&gt; [PB, PN, PA].</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_LassoLars_Model">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_linear_models.</span></span><span class="sig-name descname"><span class="pre">WAS_LassoLars_Model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_clusters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_cores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gamma'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_LassoLars_Model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_LassoLars_Model" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class to implement the Lasso Least Angle Regression (LassoLars) model for spatiotemporal
climate prediction.</p>
<p>This model is designed to work with climate data by clustering spatial regions, computing
hyperparameters for each cluster, and fitting a LassoLars model for predictions. The model
is optimized for parallel execution using Dask.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alpha_range</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Range of alpha values for the LassoLars model.
Default is np.array([10**i for i in range(-6, 6)]).</p></li>
<li><p><strong>n_clusters</strong> (<em>int</em><em>, </em><em>default=5</em>) – Number of clusters to partition the spatial data.</p></li>
<li><p><strong>nb_cores</strong> (<em>int</em><em>, </em><em>default=1</em>) – Number of cores for parallel processing.</p></li>
<li><p><strong>dist_method</strong> (<em>str</em><em>, </em><em>default='gamma'</em>) – Distribution method for calculating tercile probabilities.
One of {‘gamma’,’t’,’normal’,’lognormal’,’nonparam’}.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_LassoLars_Model.fit_predict">
<span class="sig-name descname"><span class="pre">fit_predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_LassoLars_Model.fit_predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_LassoLars_Model.fit_predict" title="Link to this definition"></a></dt>
<dd><p>Fits the LassoLars model to the training data and predicts values for the test data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_LassoLars_Model.compute_hyperparameters">
<span class="sig-name descname"><span class="pre">compute_hyperparameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictand</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predictor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_LassoLars_Model.compute_hyperparameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_LassoLars_Model.compute_hyperparameters" title="Link to this definition"></a></dt>
<dd><p>Computes cluster-wise optimal alpha values for LassoLars using cross-validation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_LassoLars_Model.compute_model">
<span class="sig-name descname"><span class="pre">compute_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_LassoLars_Model.compute_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_LassoLars_Model.compute_model" title="Link to this definition"></a></dt>
<dd><p>Fits and predicts the LassoLars model using Dask for parallel execution.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_LassoLars_Model.calculate_tercile_probabilities">
<span class="sig-name descname"><span class="pre">calculate_tercile_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">...</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_LassoLars_Model.calculate_tercile_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_LassoLars_Model.calculate_tercile_probabilities" title="Link to this definition"></a></dt>
<dd><p>Calculates tercile probabilities using the chosen distribution method (Student’s t, gamma, etc.).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_LassoLars_Model.compute_prob">
<span class="sig-name descname"><span class="pre">compute_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_LassoLars_Model.compute_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_LassoLars_Model.compute_prob" title="Link to this definition"></a></dt>
<dd><p>Computes the tercile probabilities for hindcast predictions using a climatological period.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_LassoLars_Model.forecast">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor_for_year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_LassoLars_Model.forecast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_LassoLars_Model.forecast" title="Link to this definition"></a></dt>
<dd><p>Generates a forecast for a single time step and computes tercile probabilities.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id0">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_LassoLars_Model.calculate_tercile_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id0" title="Link to this definition"></a></dt>
<dd><p>Student’s t-based method</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_LassoLars_Model.calculate_tercile_probabilities_gamma">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_LassoLars_Model.calculate_tercile_probabilities_gamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_LassoLars_Model.calculate_tercile_probabilities_gamma" title="Link to this definition"></a></dt>
<dd><p>Gamma-based method</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_LassoLars_Model.calculate_tercile_probabilities_lognormal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_lognormal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_LassoLars_Model.calculate_tercile_probabilities_lognormal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_LassoLars_Model.calculate_tercile_probabilities_lognormal" title="Link to this definition"></a></dt>
<dd><p>Lognormal-based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_LassoLars_Model.calculate_tercile_probabilities_nonparametric">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_nonparametric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_LassoLars_Model.calculate_tercile_probabilities_nonparametric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_LassoLars_Model.calculate_tercile_probabilities_nonparametric" title="Link to this definition"></a></dt>
<dd><p>Non-parametric method (requires historical errors).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_LassoLars_Model.calculate_tercile_probabilities_normal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_normal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_LassoLars_Model.calculate_tercile_probabilities_normal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_LassoLars_Model.calculate_tercile_probabilities_normal" title="Link to this definition"></a></dt>
<dd><p>Normal-based method using the Gaussian CDF.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id2">
<span class="sig-name descname"><span class="pre">compute_hyperparameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictand</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predictor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_LassoLars_Model.compute_hyperparameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id2" title="Link to this definition"></a></dt>
<dd><p>Computes cluster-wise optimal alpha values for LassoLars using cross-validation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>predictand</strong> (<em>xarray.DataArray</em>) – The response variable for clustering and training (dims: T, Y, X).</p></li>
<li><p><strong>predictor</strong> (<em>array-like</em>) – Predictor variables used for fitting the model (dims: T, features).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>alpha_array</strong> (<em>xarray.DataArray</em>) – Cluster-wise optimal alpha values.</p></li>
<li><p><strong>Cluster</strong> (<em>xarray.DataArray</em>) – Cluster assignment for each spatial point.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id3">
<span class="sig-name descname"><span class="pre">compute_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_LassoLars_Model.compute_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id3" title="Link to this definition"></a></dt>
<dd><p>Fits and predicts the LassoLars model using Dask for parallel execution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X_train</strong> (<em>xarray.DataArray</em>) – Training predictor data (dims: T, features).</p></li>
<li><p><strong>y_train</strong> (<em>xarray.DataArray</em>) – Training response variable (dims: T, Y, X).</p></li>
<li><p><strong>X_test</strong> (<em>xarray.DataArray</em>) – Test predictor data (dims: features,) or broadcastable to (Y, X).</p></li>
<li><p><strong>y_test</strong> (<em>xarray.DataArray</em>) – Test response variable (dims: Y, X).</p></li>
<li><p><strong>alpha</strong> (<em>xarray.DataArray</em>) – Cluster-wise optimal alpha values (dims: Y, X).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dims (output=2, Y, X) =&gt; [error, prediction].</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id4">
<span class="sig-name descname"><span class="pre">compute_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_LassoLars_Model.compute_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id4" title="Link to this definition"></a></dt>
<dd><p>Compute tercile probabilities using self.dist_method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Predictant</strong> (<em>xarray.DataArray</em><em> (</em><em>T</em><em>, </em><em>Y</em><em>, </em><em>X</em><em>)</em>) – Observed data.</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em>)</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em>) – The start and end years for the climatology.</p></li>
<li><p><strong>hindcast_det</strong> (<em>xarray.DataArray</em>) – Deterministic forecast with dims (output=2, T, Y, X).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>hindcast_prob</strong> – dims (probability=3, T, Y, X) =&gt; [PB, PN, PA].</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id5">
<span class="sig-name descname"><span class="pre">fit_predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_LassoLars_Model.fit_predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id5" title="Link to this definition"></a></dt>
<dd><p>Fits the LassoLars model to the training data and predicts values for the test data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array-like</em>) – Training predictors (shape: [n_samples, n_features]).</p></li>
<li><p><strong>y</strong> (<em>array-like</em>) – Training response variable (shape: [n_samples,]).</p></li>
<li><p><strong>x_test</strong> (<em>array-like</em>) – Test predictors (shape: [n_features,] or [1, n_features]).</p></li>
<li><p><strong>y_test</strong> (<em>float</em>) – Test response (scalar or shape [1,]) for test data.</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – Regularization strength parameter for LassoLars.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[error, prediction], or [np.nan, np.nan] if no valid data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray of shape (2,)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id6">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor_for_year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_LassoLars_Model.forecast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id6" title="Link to this definition"></a></dt>
<dd><p>Generates a forecast for a single time step using LassoLars with alpha,
then computes tercile probabilities based on the chosen distribution method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Predictant</strong> (<em>xarray.DataArray</em>) – Observed data (T, Y, X).</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em>) – Start year for the climatological reference period.</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em>) – End year for the climatological reference period.</p></li>
<li><p><strong>Predictor</strong> (<em>xarray.DataArray</em>) – Historical predictor data (T, features).</p></li>
<li><p><strong>hindcast_det</strong> (<em>xarray.DataArray</em>) – Historical deterministic forecast with dims (output=2, T, Y, X).</p></li>
<li><p><strong>Predictor_for_year</strong> (<em>xarray.DataArray</em>) – Single-year predictor data (features,) or shape (1, features).</p></li>
<li><p><strong>alpha</strong> (<em>xarray.DataArray</em>) – Spatial map of alpha values (Y, X) for LassoLars.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>result_</strong> (<em>xarray.DataArray</em>) – dims (output=2, Y, X) =&gt; [error, prediction].
For a true forecast scenario, the error is typically NaN.</p></li>
<li><p><strong>hindcast_prob</strong> (<em>xarray.DataArray</em>) – dims (probability=3, Y, X) =&gt; [PB, PN, PA] for tercile categories.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_Lasso_Model">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_linear_models.</span></span><span class="sig-name descname"><span class="pre">WAS_Lasso_Model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_clusters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_cores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gamma'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_Lasso_Model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_Lasso_Model" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>WAS_Lasso_Model is a class that implements Lasso regression with hyperparameter tuning,
clustering-based regional optimization, and calculation of tercile probabilities for
climate prediction.</p>
<section id="id7">
<h3>Attributes:<a class="headerlink" href="#id7" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>alpha_range<span class="classifier">numpy.array</span></dt><dd><p>Range of alpha values for Lasso regularization parameter.</p>
</dd>
<dt>n_clusters<span class="classifier">int</span></dt><dd><p>Number of clusters to use for regional optimization.</p>
</dd>
<dt>nb_cores<span class="classifier">int</span></dt><dd><p>Number of cores to use for parallel computation.</p>
</dd>
<dt>dist_method<span class="classifier">str</span></dt><dd><p>Distribution method for tercile probability calculations:
one of {‘gamma’,’t’,’normal’,’lognormal’,’nonparam’}.</p>
</dd>
</dl>
</section>
<section id="id8">
<h3>Methods:<a class="headerlink" href="#id8" title="Link to this heading"></a></h3>
<dl>
<dt>fit_predict(x, y, x_test, y_test, alpha):</dt><dd><p>Fits the Lasso model to the provided training data and predicts values
for the test set. Returns [error, prediction].</p>
</dd>
<dt>compute_hyperparameters(predictand, predictor):</dt><dd><p>Performs clustering of the spatial grid and computes optimal alpha values
for each cluster. Returns the alpha values as an xarray and the cluster assignments.</p>
</dd>
<dt>compute_model(X_train, y_train, X_test, y_test, alpha):</dt><dd><p>Computes the Lasso model prediction for the training/test datasets
using the given alpha values. Utilizes Dask for parallelized processing.</p>
</dd>
<dt>calculate_tercile_probabilities(…):</dt><dd><p>Calculates tercile probabilities for a given forecast using the chosen
distribution method.</p>
</dd>
<dt>compute_prob(Predictant, clim_year_start, clim_year_end, Predictor, hindcast_det):</dt><dd><p>Computes probabilistic forecasts for rainfall terciles based on
climatological terciles, utilizing a hindcast and Lasso regression output.</p>
</dd>
<dt>forecast(Predictant, clim_year_start, clim_year_end, Predictor, hindcast_det,</dt><dd><blockquote>
<div><p>Predictor_for_year, alpha):</p>
</div></blockquote>
<p>Generates a forecast for a single time step using Lasso with alpha,
then computes tercile probabilities based on the chosen distribution method.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_Lasso_Model.calculate_tercile_probabilities">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_Lasso_Model.calculate_tercile_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_Lasso_Model.calculate_tercile_probabilities" title="Link to this definition"></a></dt>
<dd><p>Student’s t-based method</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_Lasso_Model.calculate_tercile_probabilities_gamma">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_Lasso_Model.calculate_tercile_probabilities_gamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_Lasso_Model.calculate_tercile_probabilities_gamma" title="Link to this definition"></a></dt>
<dd><p>Gamma-based method</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_Lasso_Model.calculate_tercile_probabilities_lognormal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_lognormal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_Lasso_Model.calculate_tercile_probabilities_lognormal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_Lasso_Model.calculate_tercile_probabilities_lognormal" title="Link to this definition"></a></dt>
<dd><p>Lognormal-based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_Lasso_Model.calculate_tercile_probabilities_nonparametric">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_nonparametric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_Lasso_Model.calculate_tercile_probabilities_nonparametric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_Lasso_Model.calculate_tercile_probabilities_nonparametric" title="Link to this definition"></a></dt>
<dd><p>Non-parametric method (requires historical errors).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_Lasso_Model.calculate_tercile_probabilities_normal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_normal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_Lasso_Model.calculate_tercile_probabilities_normal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_Lasso_Model.calculate_tercile_probabilities_normal" title="Link to this definition"></a></dt>
<dd><p>Normal-based method using the Gaussian CDF.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_Lasso_Model.compute_hyperparameters">
<span class="sig-name descname"><span class="pre">compute_hyperparameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictand</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predictor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_Lasso_Model.compute_hyperparameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_Lasso_Model.compute_hyperparameters" title="Link to this definition"></a></dt>
<dd><p>Clusters the spatial domain and finds the best alpha for each cluster by mean time series.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>alpha_array</strong> (<em>xarray.DataArray</em>) – Spatial map of best alpha values.</p></li>
<li><p><strong>Cluster</strong> (<em>xarray.DataArray</em>) – Cluster assignments for each grid cell.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_Lasso_Model.compute_model">
<span class="sig-name descname"><span class="pre">compute_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_Lasso_Model.compute_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_Lasso_Model.compute_model" title="Link to this definition"></a></dt>
<dd><p>Computes Lasso predictions for spatiotemporal data using provided alpha values.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>dims (output=2, Y, X) =&gt; [error, prediction].</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_Lasso_Model.compute_prob">
<span class="sig-name descname"><span class="pre">compute_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_Lasso_Model.compute_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_Lasso_Model.compute_prob" title="Link to this definition"></a></dt>
<dd><p>Compute tercile probabilities using self.dist_method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Predictant</strong> (<em>xarray.DataArray</em><em> (</em><em>T</em><em>, </em><em>Y</em><em>, </em><em>X</em><em>)</em>) – Observed data.</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em>)</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em>) – The start and end years for the climatology.</p></li>
<li><p><strong>hindcast_det</strong> (<em>xarray.DataArray</em>) – Deterministic forecast with dims (output=2, T, Y, X).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>hindcast_prob</strong> – dims (probability=3, T, Y, X) =&gt; [PB, PN, PA].</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_Lasso_Model.fit_predict">
<span class="sig-name descname"><span class="pre">fit_predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_Lasso_Model.fit_predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_Lasso_Model.fit_predict" title="Link to this definition"></a></dt>
<dd><p>Fit a Lasso model and make predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>ndarray</em>) – Training data (shape: [n_samples, n_features]).</p></li>
<li><p><strong>y</strong> (<em>ndarray</em>) – Training targets (shape: [n_samples,]).</p></li>
<li><p><strong>x_test</strong> (<em>ndarray</em>) – Test data (shape: [n_features,] or [1, n_features]).</p></li>
<li><p><strong>y_test</strong> (<em>float</em>) – Target value(s) for test data.</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – Regularization parameter for Lasso.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[error, prediction], each of shape (1,) or scalar,
or [np.nan, np.nan] if no valid data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_Lasso_Model.forecast">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor_for_year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_Lasso_Model.forecast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_Lasso_Model.forecast" title="Link to this definition"></a></dt>
<dd><p>Generate a forecast for a single time (year) using Lasso with alpha,
then compute tercile probabilities from the chosen distribution method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Predictant</strong> (<em>xarray.DataArray</em>) – Observed data (T, Y, X).</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em>) – Start year of the climatology period.</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em>) – End year of the climatology period.</p></li>
<li><p><strong>Predictor</strong> (<em>xarray.DataArray</em>) – Historical predictor data (T, features).</p></li>
<li><p><strong>hindcast_det</strong> (<em>xarray.DataArray</em>) – Historical deterministic forecast with dims (output=2, T, Y, X).</p></li>
<li><p><strong>Predictor_for_year</strong> (<em>xarray.DataArray</em>) – Single-year predictor data (features,).</p></li>
<li><p><strong>alpha</strong> (<em>xarray.DataArray</em>) – Spatial map of alpha values (Y, X).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>result_</strong> (<em>xarray.DataArray</em>) – dims (output=2, Y, X) =&gt; [error, prediction].
For a real forecast scenario, the error is typically NaN.</p></li>
<li><p><strong>hindcast_prob</strong> (<em>xarray.DataArray</em>) – dims (probability=3, Y, X) =&gt; [PB, PN, PA].</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_LinearRegression_Model">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_linear_models.</span></span><span class="sig-name descname"><span class="pre">WAS_LinearRegression_Model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nb_cores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gamma'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_LinearRegression_Model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_LinearRegression_Model" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class to perform linear regression modeling on spatiotemporal datasets for climate prediction.</p>
<p>This class is designed to work with Dask and Xarray for parallelized, high-performance
regression computations across large datasets with spatial and temporal dimensions. The primary
methods are for fitting the model, making predictions, and calculating probabilistic predictions
for climate terciles.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_LinearRegression_Model.nb_cores">
<span class="sig-name descname"><span class="pre">nb_cores</span></span><a class="headerlink" href="#wass2s.was_linear_models.WAS_LinearRegression_Model.nb_cores" title="Link to this definition"></a></dt>
<dd><p>The number of CPU cores to use for parallel computation (default is 1).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_LinearRegression_Model.dist_method">
<span class="sig-name descname"><span class="pre">dist_method</span></span><a class="headerlink" href="#wass2s.was_linear_models.WAS_LinearRegression_Model.dist_method" title="Link to this definition"></a></dt>
<dd><p>Distribution method for tercile probability calculations. One of
{“t”,”gamma”,”normal”,”lognormal”,”nonparam”}. Default = “gamma”.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_LinearRegression_Model.fit_predict">
<span class="sig-name descname"><span class="pre">fit_predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_LinearRegression_Model.fit_predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_LinearRegression_Model.fit_predict" title="Link to this definition"></a></dt>
<dd><p>Fits a linear regression model, makes predictions, and calculates error if y_test is provided.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_LinearRegression_Model.compute_model">
<span class="sig-name descname"><span class="pre">compute_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_LinearRegression_Model.compute_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_LinearRegression_Model.compute_model" title="Link to this definition"></a></dt>
<dd><p>Applies the linear regression model across a dataset using parallel computation with Dask.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_LinearRegression_Model.compute_prob">
<span class="sig-name descname"><span class="pre">compute_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_LinearRegression_Model.compute_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_LinearRegression_Model.compute_prob" title="Link to this definition"></a></dt>
<dd><p>Computes tercile probabilities for hindcast predictions over specified years.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_LinearRegression_Model.forecast">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor_for_year</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_LinearRegression_Model.forecast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_LinearRegression_Model.forecast" title="Link to this definition"></a></dt>
<dd><p>Generates a single-year forecast and computes tercile probabilities.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_LinearRegression_Model.calculate_tercile_probabilities">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_LinearRegression_Model.calculate_tercile_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_LinearRegression_Model.calculate_tercile_probabilities" title="Link to this definition"></a></dt>
<dd><p>Student’s t-based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_LinearRegression_Model.calculate_tercile_probabilities_gamma">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_LinearRegression_Model.calculate_tercile_probabilities_gamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_LinearRegression_Model.calculate_tercile_probabilities_gamma" title="Link to this definition"></a></dt>
<dd><p>Gamma-based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_LinearRegression_Model.calculate_tercile_probabilities_lognormal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_lognormal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_LinearRegression_Model.calculate_tercile_probabilities_lognormal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_LinearRegression_Model.calculate_tercile_probabilities_lognormal" title="Link to this definition"></a></dt>
<dd><p>Lognormal-based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_LinearRegression_Model.calculate_tercile_probabilities_nonparametric">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_nonparametric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_LinearRegression_Model.calculate_tercile_probabilities_nonparametric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_LinearRegression_Model.calculate_tercile_probabilities_nonparametric" title="Link to this definition"></a></dt>
<dd><p>Non-parametric method (requires historical errors).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_LinearRegression_Model.calculate_tercile_probabilities_normal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_normal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_LinearRegression_Model.calculate_tercile_probabilities_normal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_LinearRegression_Model.calculate_tercile_probabilities_normal" title="Link to this definition"></a></dt>
<dd><p>Normal-based method using the Gaussian CDF.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id9">
<span class="sig-name descname"><span class="pre">compute_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_LinearRegression_Model.compute_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id9" title="Link to this definition"></a></dt>
<dd><p>Applies linear regression across a spatiotemporal dataset in parallel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X_train</strong> (<em>xarray.DataArray</em>) – Training predictors with dims (‘T’,’features’).</p></li>
<li><p><strong>y_train</strong> (<em>xarray.DataArray</em>) – Training targets with dims (‘T’,’Y’,’X’).</p></li>
<li><p><strong>X_test</strong> (<em>xarray.DataArray</em>) – Test predictors, shape (‘features’,) or (T, features).</p></li>
<li><p><strong>y_test</strong> (<em>xarray.DataArray</em>) – Test targets with dims (‘Y’,’X’), or broadcastable.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dims (‘output’,’Y’,’X’), where ‘output’=[error, prediction].</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id10">
<span class="sig-name descname"><span class="pre">compute_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_LinearRegression_Model.compute_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id10" title="Link to this definition"></a></dt>
<dd><p>Compute tercile probabilities using self.dist_method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Predictant</strong> (<em>xarray.DataArray</em><em> (</em><em>T</em><em>, </em><em>Y</em><em>, </em><em>X</em><em>)</em>) – Observed data.</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em>)</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em>) – The start and end years for the climatology.</p></li>
<li><p><strong>hindcast_det</strong> (<em>xarray.DataArray</em>) – Deterministic forecast with dims (output=2, T, Y, X).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>hindcast_prob</strong> – dims (probability=3, T, Y, X) =&gt; [PB, PN, PA].</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id11">
<span class="sig-name descname"><span class="pre">fit_predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_LinearRegression_Model.fit_predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id11" title="Link to this definition"></a></dt>
<dd><p>Fits a linear regression model to the provided training data, makes predictions
on the test data, and calculates the prediction error (if y_test is provided).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – Training data (predictors).</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em>) – Training targets.</p></li>
<li><p><strong>x_test</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_features</em><em>,</em><em>) or </em><em>(</em><em>1</em><em>, </em><em>n_features</em><em>)</em>) – Test data (predictors).</p></li>
<li><p><strong>y_test</strong> (<em>float</em><em> or </em><em>None</em>) – Test target value. If None, no error is computed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>If y_test is not None, returns [error, prediction].
If y_test is None, returns [prediction].</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id12">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor_for_year</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_LinearRegression_Model.forecast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id12" title="Link to this definition"></a></dt>
<dd><p>Generates a single-year forecast using linear regression, then computes
tercile probabilities using self.dist_method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Predictant</strong> (<em>xarray.DataArray</em>) – Observed data with dims (T, Y, X).</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em>) – Start year for climatology</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em>) – End year for climatology</p></li>
<li><p><strong>Predictor</strong> (<em>xarray.DataArray</em>) – Historical predictor data with dims (T, features).</p></li>
<li><p><strong>hindcast_det</strong> (<em>xarray.DataArray</em>) – Historical deterministic forecast with dims (output=[error,prediction], T, Y, X).</p></li>
<li><p><strong>Predictor_for_year</strong> (<em>xarray.DataArray</em>) – Single-year predictor with shape (features,) or (1, features).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>result_</strong> (<em>xarray.DataArray</em>) – dims (output=2, Y, X) =&gt; [error, prediction].
For a true forecast, error is typically NaN.</p></li>
<li><p><strong>hindcast_prob</strong> (<em>xarray.DataArray</em>) – dims (probability=3, Y, X) =&gt; [PB, PN, PA].</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_Ridge_Model">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_linear_models.</span></span><span class="sig-name descname"><span class="pre">WAS_Ridge_Model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_clusters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_cores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gamma'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_Ridge_Model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_Ridge_Model" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class to perform ridge regression modeling for rainfall prediction with spatial clustering
and hyperparameter optimization. By Mandela HOUNGNIBO.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_Ridge_Model.alpha_range">
<span class="sig-name descname"><span class="pre">alpha_range</span></span><a class="headerlink" href="#wass2s.was_linear_models.WAS_Ridge_Model.alpha_range" title="Link to this definition"></a></dt>
<dd><p>Range of alpha values to explore for ridge regression.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array-like</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_Ridge_Model.n_clusters">
<span class="sig-name descname"><span class="pre">n_clusters</span></span><a class="headerlink" href="#wass2s.was_linear_models.WAS_Ridge_Model.n_clusters" title="Link to this definition"></a></dt>
<dd><p>Number of clusters for KMeans clustering.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_Ridge_Model.nb_cores">
<span class="sig-name descname"><span class="pre">nb_cores</span></span><a class="headerlink" href="#wass2s.was_linear_models.WAS_Ridge_Model.nb_cores" title="Link to this definition"></a></dt>
<dd><p>Number of cores to use for parallel computation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_Ridge_Model.dist_method">
<span class="sig-name descname"><span class="pre">dist_method</span></span><a class="headerlink" href="#wass2s.was_linear_models.WAS_Ridge_Model.dist_method" title="Link to this definition"></a></dt>
<dd><p>Distribution method for tercile probability calculations:
One of {‘gamma’, ‘t’, ‘normal’, ‘lognormal’, ‘nonparam’} (default = ‘gamma’).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_Ridge_Model.fit_predict">
<span class="sig-name descname"><span class="pre">fit_predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_Ridge_Model.fit_predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_Ridge_Model.fit_predict" title="Link to this definition"></a></dt>
<dd><p>Fits a Ridge regression model using the provided data and makes predictions.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_Ridge_Model.compute_hyperparameters">
<span class="sig-name descname"><span class="pre">compute_hyperparameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictand</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predictor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_Ridge_Model.compute_hyperparameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_Ridge_Model.compute_hyperparameters" title="Link to this definition"></a></dt>
<dd><p>Computes optimal ridge hyperparameters (alpha values) for different clusters.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_Ridge_Model.compute_model">
<span class="sig-name descname"><span class="pre">compute_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_Ridge_Model.compute_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_Ridge_Model.compute_model" title="Link to this definition"></a></dt>
<dd><p>Fits and predicts a Ridge model for spatiotemporal data using Dask for parallel computation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_Ridge_Model.compute_prob">
<span class="sig-name descname"><span class="pre">compute_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_Ridge_Model.compute_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_Ridge_Model.compute_prob" title="Link to this definition"></a></dt>
<dd><p>Computes the probabilities of tercile categories for rainfall prediction using the chosen
distribution method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_Ridge_Model.forecast">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor_for_year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_Ridge_Model.forecast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_Ridge_Model.forecast" title="Link to this definition"></a></dt>
<dd><p>Generates a forecast for a single future time (e.g., year) and computes tercile probabilities.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_Ridge_Model.calculate_tercile_probabilities">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_Ridge_Model.calculate_tercile_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_Ridge_Model.calculate_tercile_probabilities" title="Link to this definition"></a></dt>
<dd><p>Student’s t-based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_Ridge_Model.calculate_tercile_probabilities_gamma">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_Ridge_Model.calculate_tercile_probabilities_gamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_Ridge_Model.calculate_tercile_probabilities_gamma" title="Link to this definition"></a></dt>
<dd><p>Gamma-based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_Ridge_Model.calculate_tercile_probabilities_lognormal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_lognormal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_Ridge_Model.calculate_tercile_probabilities_lognormal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_Ridge_Model.calculate_tercile_probabilities_lognormal" title="Link to this definition"></a></dt>
<dd><p>Lognormal-based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_Ridge_Model.calculate_tercile_probabilities_nonparametric">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_nonparametric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_Ridge_Model.calculate_tercile_probabilities_nonparametric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_Ridge_Model.calculate_tercile_probabilities_nonparametric" title="Link to this definition"></a></dt>
<dd><p>Non-parametric method (requires historical errors).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_linear_models.WAS_Ridge_Model.calculate_tercile_probabilities_normal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_normal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_Ridge_Model.calculate_tercile_probabilities_normal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_linear_models.WAS_Ridge_Model.calculate_tercile_probabilities_normal" title="Link to this definition"></a></dt>
<dd><p>Normal-based method using the Gaussian CDF.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id13">
<span class="sig-name descname"><span class="pre">compute_hyperparameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictand</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predictor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_Ridge_Model.compute_hyperparameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id13" title="Link to this definition"></a></dt>
<dd><p>Compute optimal hyperparameters (alpha) for ridge regression for different clusters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>predictand</strong> (<em>xarray.DataArray</em>) – Predictand data for clustering (dims: T, Y, X).</p></li>
<li><p><strong>predictor</strong> (<em>xarray.DataArray</em><em> or </em><em>ndarray</em>) – Predictor data for model fitting (dims: T, features).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>alpha_array</strong> (<em>xarray.DataArray</em>) – Spatial map of alpha values for each grid cell.</p></li>
<li><p><strong>cluster_da</strong> (<em>xarray.DataArray</em>) – Cluster assignment for each (Y,X).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id14">
<span class="sig-name descname"><span class="pre">compute_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_Ridge_Model.compute_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id14" title="Link to this definition"></a></dt>
<dd><p>Fit and predict ridge regression model for spatiotemporal data using Dask for parallel computation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X_train</strong> (<em>xarray.DataArray</em>) – Training predictor data (dims: T, features).</p></li>
<li><p><strong>y_train</strong> (<em>xarray.DataArray</em>) – Training predictand data (dims: T, Y, X).</p></li>
<li><p><strong>X_test</strong> (<em>xarray.DataArray</em>) – Test predictor data (dims: features) or broadcastable.</p></li>
<li><p><strong>y_test</strong> (<em>xarray.DataArray</em>) – Test predictand data (dims: Y, X).</p></li>
<li><p><strong>alpha</strong> (<em>xarray.DataArray</em>) – Spatial map of alpha values for each grid cell.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dims (output=2, Y, X) =&gt; [error, prediction].</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id15">
<span class="sig-name descname"><span class="pre">compute_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_Ridge_Model.compute_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id15" title="Link to this definition"></a></dt>
<dd><p>Compute tercile probabilities using either ‘t’, ‘gamma’, ‘normal’, ‘lognormal’, or ‘nonparam’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Predictant</strong> (<em>xarray.DataArray</em>) – Observed data array (T, Y, X).</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em>) – Start year for climatology.</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em>) – End year for climatology.</p></li>
<li><p><strong>hindcast_det</strong> (<em>xarray.DataArray</em>) – Deterministic forecast with shape (output=2, T, Y, X),
where output=[error, prediction].</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>hindcast_prob</strong> – dims (probability=3, T, Y, X) =&gt; [PB, PN, PA].</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id16">
<span class="sig-name descname"><span class="pre">fit_predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_Ridge_Model.fit_predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id16" title="Link to this definition"></a></dt>
<dd><p>Fit a ridge regression model and make predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>ndarray</em>) – Training data (shape = [n_samples, n_features]).</p></li>
<li><p><strong>y</strong> (<em>ndarray</em>) – Target values for training data (shape = [n_samples,]).</p></li>
<li><p><strong>x_test</strong> (<em>ndarray</em>) – Test data (shape = [n_features,] or [1, n_features]).</p></li>
<li><p><strong>y_test</strong> (<em>float</em>) – Target value for test data.</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – Regularization strength for Ridge regression.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[error, prediction].</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id17">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor_for_year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_linear_models.html#WAS_Ridge_Model.forecast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id17" title="Link to this definition"></a></dt>
<dd><p>Generates a ridge-based forecast for a single future time (year)
using alpha values and returns both forecast + tercile probabilities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Predictant</strong> (<em>xarray.DataArray</em>) – Observed data (T, Y, X).</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em>) – Start year of climatology.</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em>) – End year of climatology.</p></li>
<li><p><strong>Predictor</strong> (<em>xarray.DataArray</em>) – Historical predictor data (T, features).</p></li>
<li><p><strong>hindcast_det</strong> (<em>xarray.DataArray</em>) – Historical deterministic forecast with dims (output=2, T, Y, X).</p></li>
<li><p><strong>Predictor_for_year</strong> (<em>xarray.DataArray</em>) – Single-year predictor data (features,).</p></li>
<li><p><strong>alpha</strong> (<em>xarray.DataArray</em>) – Spatial map of alpha values (Y, X).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>result_</strong> (<em>xarray.DataArray</em>) – dims (output=2, Y, X) =&gt; [error, prediction].
The “error” is NaN in a real forecast scenario.</p></li>
<li><p><strong>hindcast_prob</strong> (<em>xarray.DataArray</em>) – dims (probability=3, Y, X) =&gt; [PB, PN, PA].</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-wass2s.was_eof">
<span id="wass2s-was-eof-module"></span><h2>wass2s.was_eof module<a class="headerlink" href="#module-wass2s.was_eof" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_eof.WAS_EOF">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_eof.</span></span><span class="sig-name descname"><span class="pre">WAS_EOF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_modes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_coslat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">standardize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opti_explained_variance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L2norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_eof.html#WAS_EOF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_eof.WAS_EOF" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class for performing Empirical Orthogonal Function (EOF) analysis using the xeofs package,
with additional options for detrending and cosine latitude weighting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_modes</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of EOF modes to retain. If None, the number of modes is determined by
explained variance.</p></li>
<li><p><strong>use_coslat</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, applies cosine latitude weighting to account for the Earth’s spherical geometry.</p></li>
<li><p><strong>standardize</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, standardizes the input data by removing the mean and dividing by the standard deviation.</p></li>
<li><p><strong>detrend</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, detrends the input data along the time dimension before performing EOF analysis.</p></li>
<li><p><strong>opti_explained_variance</strong> (<em>float</em><em>, </em><em>optional</em>) – The target cumulative explained variance (in percent) to determine the optimal number of EOF modes.</p></li>
<li><p><strong>L2norm</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, normalizes the components and scores to have L2 norm.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="wass2s.was_eof.WAS_EOF.model">
<span class="sig-name descname"><span class="pre">model</span></span><a class="headerlink" href="#wass2s.was_eof.WAS_EOF.model" title="Link to this definition"></a></dt>
<dd><p>The EOF model fitted to the predictor data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xeofs.models.EOF</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_eof.WAS_EOF.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'T'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_eof.html#WAS_EOF.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_eof.WAS_EOF.fit" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_eof.WAS_EOF.inverse_transform">
<span class="sig-name descname"><span class="pre">inverse_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pcs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_eof.html#WAS_EOF.inverse_transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_eof.WAS_EOF.inverse_transform" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_eof.WAS_EOF.plot_EOF">
<span class="sig-name descname"><span class="pre">plot_EOF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s_eofs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_expvar</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_eof.html#WAS_EOF.plot_EOF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_eof.WAS_EOF.plot_EOF" title="Link to this definition"></a></dt>
<dd><p>Plot the EOF spatial patterns and their explained variance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>s_eofs</strong> (<em>xarray.DataArray</em>) – The EOF spatial patterns to plot.</p></li>
<li><p><strong>s_expvar</strong> (<em>numpy.ndarray</em>) – The explained variance for each EOF mode.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_eof.WAS_EOF.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_eof.html#WAS_EOF.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_eof.WAS_EOF.transform" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-wass2s.was_pcr">
<span id="wass2s-was-pcr-module"></span><h2>wass2s.was_pcr module<a class="headerlink" href="#module-wass2s.was_pcr" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_pcr.WAS_PCR">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_pcr.</span></span><span class="sig-name descname"><span class="pre">WAS_PCR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">regression_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_modes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_coslat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">standardize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opti_explained_variance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L2norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_pcr.html#WAS_PCR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_pcr.WAS_PCR" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class for performing Principal Component Regression (PCR) using EOF analysis and variable regression models.</p>
<p>This class integrates the WAS_EOF for dimensionality reduction through Empirical Orthogonal Function (EOF)
analysis and allows the use of different regression models for predicting a target variable based on the
principal components.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="wass2s.was_pcr.WAS_PCR.eof_model">
<span class="sig-name descname"><span class="pre">eof_model</span></span><a class="headerlink" href="#wass2s.was_pcr.WAS_PCR.eof_model" title="Link to this definition"></a></dt>
<dd><p>The EOF analysis model used for dimensionality reduction.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#wass2s.was_eof.WAS_EOF" title="wass2s.was_eof.WAS_EOF">WAS_EOF</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="wass2s.was_pcr.WAS_PCR.reg_model">
<span class="sig-name descname"><span class="pre">reg_model</span></span><a class="headerlink" href="#wass2s.was_pcr.WAS_PCR.reg_model" title="Link to this definition"></a></dt>
<dd><p>A regression model (e.g., WAS_LinearRegression_Model, WAS_Ridge_Model, etc.) used for regression on the PCs.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_pcr.WAS_PCR.compute_model">
<span class="sig-name descname"><span class="pre">compute_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l1_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_pcr.html#WAS_PCR.compute_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_pcr.WAS_PCR.compute_model" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_pcr.WAS_PCR.compute_prob">
<span class="sig-name descname"><span class="pre">compute_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_pcr.html#WAS_PCR.compute_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_pcr.WAS_PCR.compute_prob" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_pcr.WAS_PCR.forecast">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor_for_year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">l1_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_pcr.html#WAS_PCR.forecast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_pcr.WAS_PCR.forecast" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-wass2s.was_cca">
<span id="wass2s-was-cca-module"></span><h2>wass2s.was_cca module<a class="headerlink" href="#module-wass2s.was_cca" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_cca.WAS_CCA">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_cca.</span></span><span class="sig-name descname"><span class="pre">WAS_CCA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_modes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_pca_modes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">standardize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_coslat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_pca</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gamma'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_cca.html#WAS_CCA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_cca.WAS_CCA" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_cca.WAS_CCA.calculate_tercile_probabilities">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_cca.html#WAS_CCA.calculate_tercile_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_cca.WAS_CCA.calculate_tercile_probabilities" title="Link to this definition"></a></dt>
<dd><p>Student’s t-based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_cca.WAS_CCA.calculate_tercile_probabilities_gamma">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_cca.html#WAS_CCA.calculate_tercile_probabilities_gamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_cca.WAS_CCA.calculate_tercile_probabilities_gamma" title="Link to this definition"></a></dt>
<dd><p>Gamma-based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_cca.WAS_CCA.calculate_tercile_probabilities_lognormal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_lognormal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_cca.html#WAS_CCA.calculate_tercile_probabilities_lognormal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_cca.WAS_CCA.calculate_tercile_probabilities_lognormal" title="Link to this definition"></a></dt>
<dd><p>Lognormal-based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_cca.WAS_CCA.calculate_tercile_probabilities_nonparametric">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_nonparametric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_cca.html#WAS_CCA.calculate_tercile_probabilities_nonparametric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_cca.WAS_CCA.calculate_tercile_probabilities_nonparametric" title="Link to this definition"></a></dt>
<dd><p>Non-parametric method (requires historical errors).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_cca.WAS_CCA.calculate_tercile_probabilities_normal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_normal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_cca.html#WAS_CCA.calculate_tercile_probabilities_normal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_cca.WAS_CCA.calculate_tercile_probabilities_normal" title="Link to this definition"></a></dt>
<dd><p>Normal-based method using the Gaussian CDF.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_cca.WAS_CCA.compute_model">
<span class="sig-name descname"><span class="pre">compute_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_cca.html#WAS_CCA.compute_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_cca.WAS_CCA.compute_model" title="Link to this definition"></a></dt>
<dd><p>Compute the CCA model and generate hindcasts.</p>
<p>Parameters:
- X_train: xarray DataArray for predictor training data.
- y_train: xarray DataArray for predictand training data.
- X_test: xarray DataArray for predictor testing data.
- y_test: xarray DataArray for predictand testing data.</p>
<p>Returns:
- hindcast: xarray DataArray containing predictions and errors.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_cca.WAS_CCA.compute_prob">
<span class="sig-name descname"><span class="pre">compute_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_cca.html#WAS_CCA.compute_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_cca.WAS_CCA.compute_prob" title="Link to this definition"></a></dt>
<dd><p>Compute tercile probabilities using self.dist_method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Predictant</strong> (<em>xarray.DataArray</em><em> (</em><em>T</em><em>, </em><em>Y</em><em>, </em><em>X</em><em>)</em>) – Observed data.</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em>)</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em>) – The start and end years for the climatology.</p></li>
<li><p><strong>hindcast_det</strong> (<em>xarray.DataArray</em>) – Deterministic forecast with dims (output=2, T, Y, X).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>hindcast_prob</strong> – dims (probability=3, T, Y, X) =&gt; [PB, PN, PA].</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_cca.WAS_CCA.fit_cca">
<span class="sig-name descname"><span class="pre">fit_cca</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_cca.html#WAS_CCA.fit_cca"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_cca.WAS_CCA.fit_cca" title="Link to this definition"></a></dt>
<dd><p>Fit the CCA model using the training data.</p>
<p>Parameters:
- X_train: xarray DataArray for predictor training data.
- y_train: xarray DataArray for predictand training data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_cca.WAS_CCA.forecast">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor_for_year</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_cca.html#WAS_CCA.forecast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_cca.WAS_CCA.forecast" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_cca.WAS_CCA.plot_cca_results">
<span class="sig-name descname"><span class="pre">plot_cca_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_modes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_cca.html#WAS_CCA.plot_cca_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_cca.WAS_CCA.plot_cca_results" title="Link to this definition"></a></dt>
<dd><p>Plots the CCA modes and scores.</p>
<p>Parameters:
- X: Optional xarray DataArray for predictors. If provided, the model will be fitted using X and Y.
- Y: Optional xarray DataArray for predictands.
- n_modes: Number of modes to plot. If None, plots all modes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_cca.WAS_CCA.preprocess_data">
<span class="sig-name descname"><span class="pre">preprocess_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_cca.html#WAS_CCA.preprocess_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_cca.WAS_CCA.preprocess_data" title="Link to this definition"></a></dt>
<dd><p>Preprocess the data by detrending, masking, and filling missing values.</p>
<p>Parameters:
- X: xarray DataArray for predictors.
- Y: xarray DataArray for predictands.</p>
<p>Returns:
- X_final: Preprocessed X data.
- Y_final: Preprocessed Y data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_cca.WAS_CCA.preprocess_test_data">
<span class="sig-name descname"><span class="pre">preprocess_test_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_cca.html#WAS_CCA.preprocess_test_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_cca.WAS_CCA.preprocess_test_data" title="Link to this definition"></a></dt>
<dd><p>Preprocess the test data.</p>
<p>Parameters:
- X_test: xarray DataArray for predictor testing data.
- y_test: xarray DataArray for predictand testing data.
- X_train: xarray DataArray for predictor training data.
- y_train: xarray DataArray for predictand training data.</p>
<p>Returns:
- X_test_prepared: Preprocessed X test data.
- y_test_prepared: Preprocessed Y test data.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_cca.WAS_CCA_">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_cca.</span></span><span class="sig-name descname"><span class="pre">WAS_CCA_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_modes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_pca_modes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">standardize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_coslat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_pca</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_cca.html#WAS_CCA_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_cca.WAS_CCA_" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_cca.WAS_CCA_.calculate_tercile_probabilities">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_cca.html#WAS_CCA_.calculate_tercile_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_cca.WAS_CCA_.calculate_tercile_probabilities" title="Link to this definition"></a></dt>
<dd><p>Calculates the probability of each tercile category.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_cca.WAS_CCA_.calculate_tercile_probabilities_gamma">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_cca.html#WAS_CCA_.calculate_tercile_probabilities_gamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_cca.WAS_CCA_.calculate_tercile_probabilities_gamma" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_cca.WAS_CCA_.compute_model">
<span class="sig-name descname"><span class="pre">compute_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_cca.html#WAS_CCA_.compute_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_cca.WAS_CCA_.compute_model" title="Link to this definition"></a></dt>
<dd><p>Compute the CCA model and generate hindcasts.</p>
<p>Parameters:
- X_train: xarray DataArray for predictor training data.
- y_train: xarray DataArray for predictand training data.
- X_test: xarray DataArray for predictor testing data.
- y_test: xarray DataArray for predictand testing data.</p>
<p>Returns:
- hindcast: xarray DataArray containing predictions and errors.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_cca.WAS_CCA_.compute_prob">
<span class="sig-name descname"><span class="pre">compute_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_cca.html#WAS_CCA_.compute_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_cca.WAS_CCA_.compute_prob" title="Link to this definition"></a></dt>
<dd><p>Computes tercile category probabilities for hindcasts over a climatological period.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_cca.WAS_CCA_.fit_cca">
<span class="sig-name descname"><span class="pre">fit_cca</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_cca.html#WAS_CCA_.fit_cca"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_cca.WAS_CCA_.fit_cca" title="Link to this definition"></a></dt>
<dd><p>Fit the CCA model using the training data.</p>
<p>Parameters:
- X_train: xarray DataArray for predictor training data.
- y_train: xarray DataArray for predictand training data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_cca.WAS_CCA_.forecast">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor_for_year</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_cca.html#WAS_CCA_.forecast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_cca.WAS_CCA_.forecast" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_cca.WAS_CCA_.plot_cca_results">
<span class="sig-name descname"><span class="pre">plot_cca_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_modes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_cca.html#WAS_CCA_.plot_cca_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_cca.WAS_CCA_.plot_cca_results" title="Link to this definition"></a></dt>
<dd><p>Plots the CCA modes and scores.</p>
<p>Parameters:
- X: Optional xarray DataArray for predictors. If provided, the model will be fitted using X and Y.
- Y: Optional xarray DataArray for predictands.
- n_modes: Number of modes to plot. If None, plots all modes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_cca.WAS_CCA_.preprocess_data">
<span class="sig-name descname"><span class="pre">preprocess_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_cca.html#WAS_CCA_.preprocess_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_cca.WAS_CCA_.preprocess_data" title="Link to this definition"></a></dt>
<dd><p>Preprocess the data by detrending, masking, and filling missing values.</p>
<p>Parameters:
- X: xarray DataArray for predictors.
- Y: xarray DataArray for predictands.</p>
<p>Returns:
- X_final: Preprocessed X data.
- Y_final: Preprocessed Y data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_cca.WAS_CCA_.preprocess_test_data">
<span class="sig-name descname"><span class="pre">preprocess_test_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_cca.html#WAS_CCA_.preprocess_test_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_cca.WAS_CCA_.preprocess_test_data" title="Link to this definition"></a></dt>
<dd><p>Preprocess the test data.</p>
<p>Parameters:
- X_test: xarray DataArray for predictor testing data.
- y_test: xarray DataArray for predictand testing data.
- X_train: xarray DataArray for predictor training data.
- y_train: xarray DataArray for predictand training data.</p>
<p>Returns:
- X_test_prepared: Preprocessed X test data.
- y_test_prepared: Preprocessed Y test data.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-wass2s.was_machine_learning">
<span id="wass2s-was-machine-learning-module"></span><h2>wass2s.was_machine_learning module<a class="headerlink" href="#module-wass2s.was_machine_learning" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_LogisticRegression_Model">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_machine_learning.</span></span><span class="sig-name descname"><span class="pre">WAS_LogisticRegression_Model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nb_cores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_LogisticRegression_Model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_LogisticRegression_Model" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A logistic regression-based approach to classifying climate data into terciles and
then predicting the class probabilities for new data.</p>
<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_LogisticRegression_Model.classify">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">classify</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_end</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_LogisticRegression_Model.classify"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_LogisticRegression_Model.classify" title="Link to this definition"></a></dt>
<dd><p>Classifies the values of a 1D array <cite>y</cite> into terciles.
We only use a slice of y for the training/climatology period to define the 33rd and 67th percentiles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em>) – The time series of values we want to classify (e.g., rainfall).</p></li>
<li><p><strong>index_start</strong> (<em>int</em>) – The start and end indices defining the climatology/training window.</p></li>
<li><p><strong>index_end</strong> (<em>int</em>) – The start and end indices defining the climatology/training window.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>y_class</strong> (<em>array, shape (n_samples,)</em>) – The tercile class of each value in <cite>y</cite>, coded as 0 (below), 1 (middle), or 2 (above).</p></li>
<li><p><strong>tercile_33</strong> (<em>float</em>) – The 33rd percentile threshold used to split the data.</p></li>
<li><p><strong>tercile_67</strong> (<em>float</em>) – The 67th percentile threshold used to split the data.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_LogisticRegression_Model.compute_class">
<span class="sig-name descname"><span class="pre">compute_class</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_LogisticRegression_Model.compute_class"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_LogisticRegression_Model.compute_class" title="Link to this definition"></a></dt>
<dd><p>Assigns tercile classes for each point in the <cite>Predictant</cite> array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Predictant</strong> (<em>xarray.DataArray</em>) – The observed variable (e.g., rainfall) with dimensions (T, Y, X).</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em>) – First year of the climatology period.</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em>) – Last year of the climatology period.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Predictant_class</strong> – The tercile class for each grid cell and time, labeled 0, 1, or 2.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_LogisticRegression_Model.compute_model">
<span class="sig-name descname"><span class="pre">compute_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_LogisticRegression_Model.compute_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_LogisticRegression_Model.compute_model" title="Link to this definition"></a></dt>
<dd><p>Computes logistic-regression-based class probabilities for each grid cell in <cite>y_train</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X_train</strong> (<em>xarray.DataArray</em>) – Predictors with dimensions (T, features).</p></li>
<li><p><strong>y_train</strong> (<em>xarray.DataArray</em>) – Tercile class labels with dimensions (T, Y, X).</p></li>
<li><p><strong>X_test</strong> (<em>xarray.DataArray</em>) – Test predictors with dimensions (T, features).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Class probabilities (3) for each grid cell.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_LogisticRegression_Model.fit_predict">
<span class="sig-name descname"><span class="pre">fit_predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_test</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_LogisticRegression_Model.fit_predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_LogisticRegression_Model.fit_predict" title="Link to this definition"></a></dt>
<dd><p>Trains a logistic regression model on (x, y) and predicts class probabilities for x_test.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – Predictor data for training.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em>) – Class labels (0, 1, 2) for training.</p></li>
<li><p><strong>x_test</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_features</em><em>,</em><em>)</em>) – Predictor data for the forecast/unknown scenario.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>preds_proba</strong> – Probability of each of the 3 tercile classes.
If fewer than 3 classes were present in training, the array is padded with NaNs.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray, shape (3,)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_LogisticRegression_Model.forecast">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor_for_year</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_LogisticRegression_Model.forecast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_LogisticRegression_Model.forecast" title="Link to this definition"></a></dt>
<dd><p>Runs the trained logistic model on a single forecast year.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Predictant</strong> (<em>xarray.DataArray</em>) – The observed variable (T, Y, X), used for classification (training).</p></li>
<li><p><strong>Predictor</strong> (<em>xarray.DataArray</em>) – The training predictors (T, features).</p></li>
<li><p><strong>Predictor_for_year</strong> (<em>xarray.DataArray</em>) – Predictors for the forecast period or year, shape (features,).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Probability of each tercile class (PB, PN, PA) for every grid cell,
after removing the time dimension (because it’s just one forecast).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_MLP">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_machine_learning.</span></span><span class="sig-name descname"><span class="pre">WAS_MLP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nb_cores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gamma'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_clusters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_MLP"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_MLP" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class to perform MLP (Multi-Layer Perceptron) regression on spatiotemporal
datasets for climate prediction, with hyperparameter tuning via clustering + grid search.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nb_cores</strong> (<em>int</em>) – Number of CPU cores to use for parallel computation.</p></li>
<li><p><strong>dist_method</strong> (<em>str</em>) – Distribution method for tercile probability calculations.
One of {‘gamma’, ‘t’, ‘normal’, ‘lognormal’, ‘nonparam’}.</p></li>
<li><p><strong>n_clusters</strong> (<em>int</em>) – Number of clusters to use for KMeans.</p></li>
<li><p><strong>param_grid</strong> (<em>dict</em><em> or </em><em>None</em>) – The hyperparameter search grid for MLPRegressor.
If None, a default grid is used.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">nb_cores,</span> <span class="pre">dist_method,</span> <span class="pre">n_clusters,</span> <span class="pre">param_grid</span></span></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_MLP.calculate_tercile_probabilities">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_MLP.calculate_tercile_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_MLP.calculate_tercile_probabilities" title="Link to this definition"></a></dt>
<dd><p>Student’s t-based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_MLP.calculate_tercile_probabilities_gamma">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_MLP.calculate_tercile_probabilities_gamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_MLP.calculate_tercile_probabilities_gamma" title="Link to this definition"></a></dt>
<dd><p>Gamma-based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_MLP.calculate_tercile_probabilities_lognormal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_lognormal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_MLP.calculate_tercile_probabilities_lognormal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_MLP.calculate_tercile_probabilities_lognormal" title="Link to this definition"></a></dt>
<dd><p>Lognormal-based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_MLP.calculate_tercile_probabilities_nonparametric">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_nonparametric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_MLP.calculate_tercile_probabilities_nonparametric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_MLP.calculate_tercile_probabilities_nonparametric" title="Link to this definition"></a></dt>
<dd><p>Non-parametric method (requires historical errors).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_MLP.calculate_tercile_probabilities_normal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_normal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_MLP.calculate_tercile_probabilities_normal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_MLP.calculate_tercile_probabilities_normal" title="Link to this definition"></a></dt>
<dd><p>Normal-based method using the Gaussian CDF.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_MLP.compute_hyperparameters">
<span class="sig-name descname"><span class="pre">compute_hyperparameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictand</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predictor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_MLP.compute_hyperparameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_MLP.compute_hyperparameters" title="Link to this definition"></a></dt>
<dd><p>Performs KMeans clustering on the spatial mean of <cite>predictand</cite>, then for each cluster
runs a cross-validation grid search on MLP hyperparameters using the cluster-mean time series.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>predictand</strong> (<em>xarray.DataArray</em>) – Target variable with dimensions (‘T’, ‘Y’, ‘X’).</p></li>
<li><p><strong>predictor</strong> (<em>xarray.DataArray</em>) – Predictor variables with dimensions (‘T’, ‘features’).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><strong>hl_array, act_array, lr_array, cluster_da</strong> – DataArrays storing the best local hyperparameters for each grid cell
(derived from cluster membership) and the cluster assignments.
Note: We show example outputs for hidden_layer_sizes, activation, learning_rate_init.</p>
<blockquote>
<div><p>You can extend this to all parameters in your <cite>param_grid</cite>.</p>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_MLP.compute_model">
<span class="sig-name descname"><span class="pre">compute_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hl_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter_array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_MLP.compute_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_MLP.compute_model" title="Link to this definition"></a></dt>
<dd><p>Runs MLP fit/predict for each (Y,X) cell in parallel, using cluster-based hyperparams.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X_train</strong> (<em>xarray.DataArray</em>) – Training predictors with dims (‘T’,’features’).</p></li>
<li><p><strong>y_train</strong> (<em>xarray.DataArray</em>) – Training target with dims (‘T’,’Y’,’X’).</p></li>
<li><p><strong>X_test</strong> (<em>xarray.DataArray</em>) – Test predictors, shape (‘features’,) or broadcastable.</p></li>
<li><p><strong>y_test</strong> (<em>xarray.DataArray</em>) – Test target with dims (‘Y’,’X’).</p></li>
<li><p><strong>hl_array</strong> (<em>xarray.DataArray</em>) – Local best hyperparameters from compute_hyperparameters.</p></li>
<li><p><strong>act_array</strong> (<em>xarray.DataArray</em>) – Local best hyperparameters from compute_hyperparameters.</p></li>
<li><p><strong>lr_array</strong> (<em>xarray.DataArray</em>) – Local best hyperparameters from compute_hyperparameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dims (‘output’, ‘Y’, ‘X’), where ‘output’ = [error, prediction].</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_MLP.compute_prob">
<span class="sig-name descname"><span class="pre">compute_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_MLP.compute_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_MLP.compute_prob" title="Link to this definition"></a></dt>
<dd><p>Compute tercile probabilities using self.dist_method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Predictant</strong> (<em>xarray.DataArray</em><em> (</em><em>T</em><em>, </em><em>Y</em><em>, </em><em>X</em><em>)</em>) – Observed data.</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em>)</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em>) – The start and end years for the climatology.</p></li>
<li><p><strong>hindcast_det</strong> (<em>xarray.DataArray</em>) – Deterministic forecast with dims (output=2, T, Y, X).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>hindcast_prob</strong> – dims (probability=3, T, Y, X) =&gt; [PB, PN, PA].</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_MLP.fit_predict">
<span class="sig-name descname"><span class="pre">fit_predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hl_sizes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_init</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_MLP.fit_predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_MLP.fit_predict" title="Link to this definition"></a></dt>
<dd><p>Trains an MLP (with local hyperparams) on the provided training data, then predicts on X_test.
Returns [error, prediction].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X_train</strong> (<em>np.ndarray</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>)</p></li>
<li><p><strong>y_train</strong> (<em>np.ndarray</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em>)</p></li>
<li><p><strong>X_test</strong> (<em>np.ndarray</em><em>, </em><em>shape</em><em> (</em><em>n_features</em><em>,</em><em>) or </em><em>(</em><em>1</em><em>, </em><em>n_features</em><em>)</em>)</p></li>
<li><p><strong>y_test</strong> (<em>float</em><em> or </em><em>np.nan</em>)</p></li>
<li><p><strong>hl_sizes</strong> (<em>str</em><em> (</em><em>stored as string in xarray</em><em>) or </em><em>None</em>)</p></li>
<li><p><strong>activation</strong> (<em>str</em>)</p></li>
<li><p><strong>lr_init</strong> (<em>float</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[error, predicted_value]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray of shape (2,)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_MLP.forecast">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor_for_year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hl_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr_array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_MLP.forecast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_MLP.forecast" title="Link to this definition"></a></dt>
<dd><p>Generate a forecast for a single future time (e.g., future year),
then compute tercile probabilities using the chosen distribution method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Predictant</strong> (<em>xarray.DataArray</em>) – Observed data with dims (T, Y, X), used for computing climatological terciles.</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em>) – Start year of the climatology period.</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em>) – End year of the climatology period.</p></li>
<li><p><strong>Predictor</strong> (<em>xarray.DataArray</em>) – Historical predictor data with dims (T, features).</p></li>
<li><p><strong>hindcast_det</strong> (<em>xarray.DataArray</em>) – Historical deterministic forecast with dims (output=[error,prediction], T, Y, X).
Used to compute error variance or error samples.</p></li>
<li><p><strong>Predictor_for_year</strong> (<em>xarray.DataArray</em>) – Predictor data for the forecast year, shape (features,) or (1, features).</p></li>
<li><p><strong>hl_array</strong> (<em>xarray.DataArray</em>) – Hyperparameters from <cite>compute_hyperparameters</cite>,
each with dims (Y, X) specifying local MLP settings.</p></li>
<li><p><strong>act_array</strong> (<em>xarray.DataArray</em>) – Hyperparameters from <cite>compute_hyperparameters</cite>,
each with dims (Y, X) specifying local MLP settings.</p></li>
<li><p><strong>lr_array</strong> (<em>xarray.DataArray</em>) – Hyperparameters from <cite>compute_hyperparameters</cite>,
each with dims (Y, X) specifying local MLP settings.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>result_</strong> (<em>xarray.DataArray</em>) – dims (‘output’,’Y’,’X’), containing [error, prediction].
For a forecast, the “error” is generally NaN.</p></li>
<li><p><strong>hindcast_prob</strong> (<em>xarray.DataArray</em>) – dims (probability=3, Y, X) =&gt; PB, PN, PA tercile probabilities.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_PoissonRegression">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_machine_learning.</span></span><span class="sig-name descname"><span class="pre">WAS_PoissonRegression</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nb_cores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gamma'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_PoissonRegression"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_PoissonRegression" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class to perform Poisson Regression on spatiotemporal datasets for count data prediction.</p>
<p>This class is designed to work with Dask and Xarray for parallelized, high-performance
regression computations across large datasets with spatial and temporal dimensions. The primary
methods are for fitting the Poisson regression model, making predictions, and calculating
probabilistic predictions for climate terciles.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_PoissonRegression.nb_cores">
<span class="sig-name descname"><span class="pre">nb_cores</span></span><a class="headerlink" href="#wass2s.was_machine_learning.WAS_PoissonRegression.nb_cores" title="Link to this definition"></a></dt>
<dd><p>The number of CPU cores to use for parallel computation (default is 1).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_PoissonRegression.dist_method">
<span class="sig-name descname"><span class="pre">dist_method</span></span><a class="headerlink" href="#wass2s.was_machine_learning.WAS_PoissonRegression.dist_method" title="Link to this definition"></a></dt>
<dd><p>The method to use for tercile probability calculations, e.g. {“t”, “gamma”, “normal”,
“lognormal”, “nonparam”} (default is “gamma”).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_PoissonRegression.fit_predict">
<span class="sig-name descname"><span class="pre">fit_predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_PoissonRegression.fit_predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_PoissonRegression.fit_predict" title="Link to this definition"></a></dt>
<dd><p>Fits a Poisson regression model to the training data, predicts on test data, and computes error.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_PoissonRegression.compute_model">
<span class="sig-name descname"><span class="pre">compute_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_PoissonRegression.compute_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_PoissonRegression.compute_model" title="Link to this definition"></a></dt>
<dd><p>Applies the Poisson regression model across a dataset using parallel computation
with Dask, returning predictions and error metrics.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_PoissonRegression.compute_prob">
<span class="sig-name descname"><span class="pre">compute_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_PoissonRegression.compute_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_PoissonRegression.compute_prob" title="Link to this definition"></a></dt>
<dd><p>Computes tercile probabilities for hindcast rainfall (or count data) predictions
over specified climatological years, using the chosen <cite>dist_method</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_PoissonRegression.calculate_tercile_probabilities">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_PoissonRegression.calculate_tercile_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_PoissonRegression.calculate_tercile_probabilities" title="Link to this definition"></a></dt>
<dd><p>Student’s t-based method for calculating tercile probabilities.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_PoissonRegression.calculate_tercile_probabilities_gamma">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_PoissonRegression.calculate_tercile_probabilities_gamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_PoissonRegression.calculate_tercile_probabilities_gamma" title="Link to this definition"></a></dt>
<dd><p>Gamma-based method for calculating tercile probabilities.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_PoissonRegression.calculate_tercile_probabilities_lognormal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_lognormal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_PoissonRegression.calculate_tercile_probabilities_lognormal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_PoissonRegression.calculate_tercile_probabilities_lognormal" title="Link to this definition"></a></dt>
<dd><p>Lognormal-based method for tercile probabilities.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_PoissonRegression.calculate_tercile_probabilities_nonparametric">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_nonparametric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_PoissonRegression.calculate_tercile_probabilities_nonparametric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_PoissonRegression.calculate_tercile_probabilities_nonparametric" title="Link to this definition"></a></dt>
<dd><p>Non-parametric method (requires historical errors).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_PoissonRegression.calculate_tercile_probabilities_normal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_normal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_PoissonRegression.calculate_tercile_probabilities_normal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_PoissonRegression.calculate_tercile_probabilities_normal" title="Link to this definition"></a></dt>
<dd><p>Normal-based method using the Gaussian CDF.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id18">
<span class="sig-name descname"><span class="pre">compute_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_PoissonRegression.compute_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id18" title="Link to this definition"></a></dt>
<dd><p>Computes predictions for spatiotemporal data using Poisson Regression with parallel processing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X_train</strong> (<em>xarray.DataArray</em>) – Predictor data with dimensions (T, features).</p></li>
<li><p><strong>y_train</strong> (<em>xarray.DataArray</em>) – Training target values (count data) with dimensions (T, Y, X).</p></li>
<li><p><strong>X_test</strong> (<em>xarray.DataArray</em>) – Test data (predictors) with shape (features,) or (T, features), typically squeezed.</p></li>
<li><p><strong>y_test</strong> (<em>xarray.DataArray</em>) – Test target values (count data) with dimensions (Y, X) or broadcastable to (T, Y, X).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An array with a new dimension (‘output’, size=2) capturing [error, prediction].</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id19">
<span class="sig-name descname"><span class="pre">compute_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_PoissonRegression.compute_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id19" title="Link to this definition"></a></dt>
<dd><p>Compute tercile probabilities using self.dist_method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Predictant</strong> (<em>xarray.DataArray</em><em> (</em><em>T</em><em>, </em><em>Y</em><em>, </em><em>X</em><em>)</em>) – Observed data.</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em>)</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em>) – The start and end years for the climatology.</p></li>
<li><p><strong>hindcast_det</strong> (<em>xarray.DataArray</em>) – Deterministic forecast with dims (output=2, T, Y, X).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>hindcast_prob</strong> – dims (probability=3, T, Y, X) =&gt; [PB, PN, PA].</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id20">
<span class="sig-name descname"><span class="pre">fit_predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_PoissonRegression.fit_predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id20" title="Link to this definition"></a></dt>
<dd><p>Fits a Poisson regression model to the provided training data, makes predictions
on the test data, and calculates the prediction error.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – Training data (predictors).</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em>) – Training targets (non-negative count data).</p></li>
<li><p><strong>x_test</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_features</em><em>,</em><em>) or </em><em>(</em><em>1</em><em>, </em><em>n_features</em><em>)</em>) – Test data (predictors).</p></li>
<li><p><strong>y_test</strong> (<em>float</em>) – Test target value (actual counts).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[prediction_error, predicted_value]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray of shape (2,)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_PoissonRegression.forecast">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor_for_year</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_PoissonRegression.forecast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_PoissonRegression.forecast" title="Link to this definition"></a></dt>
<dd><p>Generate forecasts for a single time (e.g., future year) and compute
tercile probabilities based on the chosen distribution method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Predictant</strong> (<em>xarray.DataArray</em>) – Target variable with dimensions (T, Y, X).</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em>) – Start year of climatology period.</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em>) – End year of climatology period.</p></li>
<li><p><strong>Predictor</strong> (<em>xarray.DataArray</em>) – Historical predictor data with dimensions (T, features).</p></li>
<li><p><strong>hindcast_det</strong> (<em>xarray.DataArray</em>) – Deterministic hindcast array that includes ‘error’ and ‘prediction’ over the historical period.</p></li>
<li><p><strong>Predictor_for_year</strong> (<em>xarray.DataArray</em>) – Predictor data for the forecast year, shape (features,) or (1, features).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a href="#id32"><span class="problematic" id="id33">result_</span></a>  : xarray.DataArray or numpy array with the forecast’s [error, prediction].
hindcast_prob : xarray.DataArray of shape (probability=3, Y, X) with PB, PN, and PA.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple (<a href="#id34"><span class="problematic" id="id35">result_</span></a>, hindcast_prob)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_PolynomialRegression">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_machine_learning.</span></span><span class="sig-name descname"><span class="pre">WAS_PolynomialRegression</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nb_cores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gamma'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_PolynomialRegression"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_PolynomialRegression" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class to perform Polynomial Regression on spatiotemporal datasets for climate prediction.</p>
<p>This class is designed to work with Dask and Xarray for parallelized, high-performance
regression computations across large datasets with spatial and temporal dimensions. The primary
methods are for fitting the polynomial regression model, making predictions, and calculating
probabilistic predictions for climate terciles.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_PolynomialRegression.nb_cores">
<span class="sig-name descname"><span class="pre">nb_cores</span></span><a class="headerlink" href="#wass2s.was_machine_learning.WAS_PolynomialRegression.nb_cores" title="Link to this definition"></a></dt>
<dd><p>The number of CPU cores to use for parallel computation (default is 1).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_PolynomialRegression.degree">
<span class="sig-name descname"><span class="pre">degree</span></span><a class="headerlink" href="#wass2s.was_machine_learning.WAS_PolynomialRegression.degree" title="Link to this definition"></a></dt>
<dd><p>The degree of the polynomial (default is 2).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_PolynomialRegression.dist_method">
<span class="sig-name descname"><span class="pre">dist_method</span></span><a class="headerlink" href="#wass2s.was_machine_learning.WAS_PolynomialRegression.dist_method" title="Link to this definition"></a></dt>
<dd><p>The distribution method to compute tercile probabilities. One of
{“t”, “gamma”, “normal”, “lognormal”, “nonparam”} (default is “gamma”).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_PolynomialRegression.fit_predict">
<span class="sig-name descname"><span class="pre">fit_predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_PolynomialRegression.fit_predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_PolynomialRegression.fit_predict" title="Link to this definition"></a></dt>
<dd><p>Fits a Polynomial Regression model to the training data, predicts on test data,
and computes error.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_PolynomialRegression.compute_model">
<span class="sig-name descname"><span class="pre">compute_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_PolynomialRegression.compute_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_PolynomialRegression.compute_model" title="Link to this definition"></a></dt>
<dd><p>Applies the Polynomial Regression model across a dataset using parallel computation
with Dask, returning predictions and error metrics.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_PolynomialRegression.compute_prob">
<span class="sig-name descname"><span class="pre">compute_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_PolynomialRegression.compute_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_PolynomialRegression.compute_prob" title="Link to this definition"></a></dt>
<dd><p>Computes tercile probabilities for hindcast rainfall predictions
over specified climatological years.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_PolynomialRegression.forecast">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor_for_year</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_PolynomialRegression.forecast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_PolynomialRegression.forecast" title="Link to this definition"></a></dt>
<dd><p>Generates a forecast for a single year (or time step) and calculates tercile probabilities
using the chosen distribution method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_PolynomialRegression.calculate_tercile_probabilities_gamma">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_PolynomialRegression.calculate_tercile_probabilities_gamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_PolynomialRegression.calculate_tercile_probabilities_gamma" title="Link to this definition"></a></dt>
<dd><p>Gamma-based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_PolynomialRegression.calculate_tercile_probabilities_lognormal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_lognormal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_PolynomialRegression.calculate_tercile_probabilities_lognormal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_PolynomialRegression.calculate_tercile_probabilities_lognormal" title="Link to this definition"></a></dt>
<dd><p>Lognormal-based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_PolynomialRegression.calculate_tercile_probabilities_nonparametric">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_nonparametric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_PolynomialRegression.calculate_tercile_probabilities_nonparametric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_PolynomialRegression.calculate_tercile_probabilities_nonparametric" title="Link to this definition"></a></dt>
<dd><p>Non-parametric method (requires historical errors).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_PolynomialRegression.calculate_tercile_probabilities_normal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_normal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_PolynomialRegression.calculate_tercile_probabilities_normal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_PolynomialRegression.calculate_tercile_probabilities_normal" title="Link to this definition"></a></dt>
<dd><p>Normal-based method using the Gaussian CDF.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_PolynomialRegression.calculate_tercile_probabilities_t">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_t</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_PolynomialRegression.calculate_tercile_probabilities_t"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_PolynomialRegression.calculate_tercile_probabilities_t" title="Link to this definition"></a></dt>
<dd><p>Calculates the probability of each tercile category using a Student’s t-based approach.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>best_guess</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_time</em><em>,</em><em>)</em>) – Forecasted values.</p></li>
<li><p><strong>error_variance</strong> (<em>float</em><em> or </em><em>array-like</em>) – Error variance associated with the forecasted value.</p></li>
<li><p><strong>first_tercile</strong> (<em>float</em><em> or </em><em>array-like</em>) – Lower tercile threshold.</p></li>
<li><p><strong>second_tercile</strong> (<em>float</em><em> or </em><em>array-like</em>) – Upper tercile threshold.</p></li>
<li><p><strong>dof</strong> (<em>int</em>) – Degrees of freedom for the t-distribution.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>pred_prob</strong> – Probability in each tercile category [Below, Normal, Above].</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray, shape (3, n_time)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id21">
<span class="sig-name descname"><span class="pre">compute_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_PolynomialRegression.compute_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id21" title="Link to this definition"></a></dt>
<dd><p>Computes predictions for spatiotemporal data using Polynomial Regression with parallel processing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X_train</strong> (<em>xarray.DataArray</em>) – Training data (predictors) with dimensions (T, features).
(It must be chunked properly in Dask, or at least be amenable to chunking.)</p></li>
<li><p><strong>y_train</strong> (<em>xarray.DataArray</em>) – Training target values with dimensions (T, Y, X).</p></li>
<li><p><strong>X_test</strong> (<em>xarray.DataArray</em>) – Test data (predictors) with dimensions (features,) or (T, features).
Typically, you’d match time steps or have a single test.</p></li>
<li><p><strong>y_test</strong> (<em>xarray.DataArray</em>) – Test target values with dimensions (Y, X) or broadcastable to (T, Y, X).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An array with shape (2, Y, X) after computing, where the first index
is error and the second is the prediction.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id22">
<span class="sig-name descname"><span class="pre">compute_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_PolynomialRegression.compute_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id22" title="Link to this definition"></a></dt>
<dd><p>Compute tercile probabilities using self.dist_method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Predictant</strong> (<em>xarray.DataArray</em><em> (</em><em>T</em><em>, </em><em>Y</em><em>, </em><em>X</em><em>)</em>) – Observed data.</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em>)</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em>) – The start and end years for the climatology.</p></li>
<li><p><strong>hindcast_det</strong> (<em>xarray.DataArray</em>) – Deterministic forecast with dims (output=2, T, Y, X).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>hindcast_prob</strong> – dims (probability=3, T, Y, X) =&gt; [PB, PN, PA].</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id23">
<span class="sig-name descname"><span class="pre">fit_predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_PolynomialRegression.fit_predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id23" title="Link to this definition"></a></dt>
<dd><p>Fits a Polynomial Regression model to the provided training data, makes predictions
on the test data, and calculates the prediction error.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – Training data (predictors).</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em>) – Training targets.</p></li>
<li><p><strong>x_test</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_features</em><em>,</em><em>) or </em><em>(</em><em>1</em><em>, </em><em>n_features</em><em>)</em>) – Test data (predictors) for which we want predictions.</p></li>
<li><p><strong>y_test</strong> (<em>float</em>) – Test target value (for computing error).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array containing [prediction_error, predicted_value].</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray of shape (2,)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id24">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor_for_year</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_PolynomialRegression.forecast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id24" title="Link to this definition"></a></dt>
<dd><p>Generate forecasts for a single time (e.g., future year) and compute
tercile probabilities based on the chosen distribution method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Predictant</strong> (<em>xarray.DataArray</em>) – Target variable with dimensions (T, Y, X).</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em>) – Start year of climatology period.</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em>) – End year of climatology period.</p></li>
<li><p><strong>Predictor</strong> (<em>xarray.DataArray</em>) – Historical predictor data with dimensions (T, features).</p></li>
<li><p><strong>hindcast_det</strong> (<em>xarray.DataArray</em>) – Deterministic hindcast array that includes ‘error’ and ‘prediction’ over the historical period.</p></li>
<li><p><strong>Predictor_for_year</strong> (<em>xarray.DataArray</em>) – Predictor data for the forecast year, shape (features,) or (1, features).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a href="#id36"><span class="problematic" id="id37">result_</span></a>  : xarray.DataArray or numpy array with the forecast’s [error, prediction].
hindcast_prob : xarray.DataArray of shape (probability=3, Y, X) with PB, PN, and PA.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple (<a href="#id38"><span class="problematic" id="id39">result_</span></a>, hindcast_prob)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_RandomForest_XGBoost_ML_Stacking">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_machine_learning.</span></span><span class="sig-name descname"><span class="pre">WAS_RandomForest_XGBoost_ML_Stacking</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nb_cores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gamma'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_clusters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_RandomForest_XGBoost_ML_Stacking"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_RandomForest_XGBoost_ML_Stacking" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class to perform Stacking Ensemble with RandomForest + XGBoost as base learners
and a LinearRegression as the meta-model. Also supports:</p>
<blockquote>
<div><ul class="simple">
<li><p>Hyperparameter tuning via KMeans + GridSearchCV</p></li>
<li><p>Parallel spatiotemporal training/prediction using xarray + Dask</p></li>
<li><p>Probability computation (terciles) under different distributions.</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nb_cores</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of CPU cores to use for parallel computation (default=1).</p></li>
<li><p><strong>dist_method</strong> (<em>str</em><em>, </em><em>optional</em>) – Distribution method for tercile probability calculations.
One of {‘gamma’, ‘t’, ‘normal’, ‘lognormal’, ‘nonparam’} (default=’gamma’).</p></li>
<li><p><strong>n_clusters</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of clusters for KMeans (default=5).</p></li>
<li><p><strong>param_grid</strong> (<em>dict</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – The hyperparameter grid for GridSearchCV over the StackingRegressor.
If None, uses a default small example grid.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>In scikit-learn, you can reference parameters inside stacking base estimators
with naming like “estimators__rf__n_estimators”, “estimators__xgb__learning_rate”, etc.
The exact syntax can vary by sklearn version.</p>
<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_RandomForest_XGBoost_ML_Stacking.calculate_tercile_probabilities">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_RandomForest_XGBoost_ML_Stacking.calculate_tercile_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_RandomForest_XGBoost_ML_Stacking.calculate_tercile_probabilities" title="Link to this definition"></a></dt>
<dd><p>Student’s t-based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_RandomForest_XGBoost_ML_Stacking.calculate_tercile_probabilities_gamma">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_RandomForest_XGBoost_ML_Stacking.calculate_tercile_probabilities_gamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_RandomForest_XGBoost_ML_Stacking.calculate_tercile_probabilities_gamma" title="Link to this definition"></a></dt>
<dd><p>Gamma-based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_RandomForest_XGBoost_ML_Stacking.calculate_tercile_probabilities_lognormal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_lognormal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_RandomForest_XGBoost_ML_Stacking.calculate_tercile_probabilities_lognormal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_RandomForest_XGBoost_ML_Stacking.calculate_tercile_probabilities_lognormal" title="Link to this definition"></a></dt>
<dd><p>Lognormal-based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_RandomForest_XGBoost_ML_Stacking.calculate_tercile_probabilities_nonparametric">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_nonparametric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_RandomForest_XGBoost_ML_Stacking.calculate_tercile_probabilities_nonparametric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_RandomForest_XGBoost_ML_Stacking.calculate_tercile_probabilities_nonparametric" title="Link to this definition"></a></dt>
<dd><p>Non-parametric method (requires historical errors).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_RandomForest_XGBoost_ML_Stacking.calculate_tercile_probabilities_normal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_normal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_RandomForest_XGBoost_ML_Stacking.calculate_tercile_probabilities_normal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_RandomForest_XGBoost_ML_Stacking.calculate_tercile_probabilities_normal" title="Link to this definition"></a></dt>
<dd><p>Normal-based method using the Gaussian CDF.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_RandomForest_XGBoost_ML_Stacking.compute_hyperparameters">
<span class="sig-name descname"><span class="pre">compute_hyperparameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictand</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predictor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_RandomForest_XGBoost_ML_Stacking.compute_hyperparameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_RandomForest_XGBoost_ML_Stacking.compute_hyperparameters" title="Link to this definition"></a></dt>
<dd><p>Cluster grid cells (Y,X) via KMeans on the mean of <cite>predictand</cite> (over T).
Then for each cluster, run a cross-validation GridSearch over a StackingRegressor
to find best hyperparameters. Store results in DataArrays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>predictand</strong> (<em>xarray.DataArray</em>) – Target variable with dims (‘T’,’Y’,’X’).</p></li>
<li><p><strong>predictor</strong> (<em>xarray.DataArray</em>) – Predictor variables with dims (‘T’,’features’).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>best_param_da</strong> (<em>xarray.DataArray (dtype=object or str)</em>) – A DataArray holding best hyperparameter sets (as strings) for each grid cell.</p></li>
<li><p><strong>cluster_da</strong> (<em>xarray.DataArray</em>) – The integer cluster assignment for each (Y, X).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_RandomForest_XGBoost_ML_Stacking.compute_model">
<span class="sig-name descname"><span class="pre">compute_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_param_da</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_RandomForest_XGBoost_ML_Stacking.compute_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_RandomForest_XGBoost_ML_Stacking.compute_model" title="Link to this definition"></a></dt>
<dd><p>Parallel fit/predict across the entire spatial domain, using cluster-based hyperparams.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X_train</strong> (<em>xarray.DataArray</em>) – Training data (predictors) with dims (‘T’,’features’).</p></li>
<li><p><strong>y_train</strong> (<em>xarray.DataArray</em>) – Training target with dims (‘T’,’Y’,’X’).</p></li>
<li><p><strong>X_test</strong> (<em>xarray.DataArray</em>) – Test data (predictors), shape (features,) or broadcastable across (Y, X).</p></li>
<li><p><strong>y_test</strong> (<em>xarray.DataArray</em>) – Test target with dims (‘Y’,’X’).</p></li>
<li><p><strong>best_param_da</strong> (<em>xarray.DataArray</em>) – The per-grid best_params from compute_hyperparameters (as strings).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dims (‘output’,’Y’,’X’), where ‘output’ = [error, prediction].</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_RandomForest_XGBoost_ML_Stacking.compute_prob">
<span class="sig-name descname"><span class="pre">compute_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_RandomForest_XGBoost_ML_Stacking.compute_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_RandomForest_XGBoost_ML_Stacking.compute_prob" title="Link to this definition"></a></dt>
<dd><p>Compute tercile probabilities using self.dist_method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Predictant</strong> (<em>xarray.DataArray</em><em> (</em><em>T</em><em>, </em><em>Y</em><em>, </em><em>X</em><em>)</em>) – Observed data.</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em>)</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em>) – The start and end years for the climatology.</p></li>
<li><p><strong>hindcast_det</strong> (<em>xarray.DataArray</em>) – Deterministic forecast with dims (output=2, T, Y, X).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>hindcast_prob</strong> – dims (probability=3, T, Y, X) =&gt; [PB, PN, PA].</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_RandomForest_XGBoost_ML_Stacking.fit_predict">
<span class="sig-name descname"><span class="pre">fit_predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_params_str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_RandomForest_XGBoost_ML_Stacking.fit_predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_RandomForest_XGBoost_ML_Stacking.fit_predict" title="Link to this definition"></a></dt>
<dd><p>Fit a local StackingRegressor with the best hyperparams (parsed from best_params_str),
then predict on X_test, returning [error, prediction].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X_train</strong> (<em>np.ndarray</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>)</p></li>
<li><p><strong>y_train</strong> (<em>np.ndarray</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em>)</p></li>
<li><p><strong>X_test</strong> (<em>np.ndarray</em><em>, </em><em>shape</em><em> (</em><em>n_features</em><em>,</em><em>) or </em><em>(</em><em>1</em><em>, </em><em>n_features</em><em>)</em>)</p></li>
<li><p><strong>y_test</strong> (<em>float</em><em> or </em><em>np.nan</em>)</p></li>
<li><p><strong>best_params_str</strong> (<em>str</em>) – String of best_params (e.g. “{‘estimators__rf__n_estimators’:100, …}”)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[error, predicted_value]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray of shape (2,)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_RandomForest_XGBoost_ML_Stacking.forecast">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor_for_year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_param_da</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_RandomForest_XGBoost_ML_Stacking.forecast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_RandomForest_XGBoost_ML_Stacking.forecast" title="Link to this definition"></a></dt>
<dd><p>Generate a forecast for a single time (e.g., future year), then compute
tercile probabilities from the chosen distribution method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Predictant</strong> (<em>xarray.DataArray</em>) – Observed data with dims (T, Y, X), used for climatological terciles.</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em>) – Start year of the climatology.</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em>) – End year of the climatology.</p></li>
<li><p><strong>Predictor</strong> (<em>xarray.DataArray</em>) – Historical predictor data, dims (T, features).</p></li>
<li><p><strong>hindcast_det</strong> (<em>xarray.DataArray</em>) – Historical deterministic forecast, dims (output=[error,prediction], T, Y, X).
Used to compute error variance or error samples.</p></li>
<li><p><strong>Predictor_for_year</strong> (<em>xarray.DataArray</em>) – Predictor data for the forecast year, shape (features,) or (1, features).</p></li>
<li><p><strong>best_param_da</strong> (<em>xarray.DataArray</em>) – Grid-based hyperparameters from compute_hyperparameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>result_</strong> (<em>xarray.DataArray</em>) – dims (‘output’,’Y’,’X’) =&gt; [error, prediction].
For a forecast, the ‘error’ will generally be NaN.</p></li>
<li><p><strong>hindcast_prob</strong> (<em>xarray.DataArray</em>) – dims (probability=3, Y, X) =&gt; tercile probabilities PB, PN, PA.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_RandomForest_XGBoost_Stacking_MLP">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_machine_learning.</span></span><span class="sig-name descname"><span class="pre">WAS_RandomForest_XGBoost_Stacking_MLP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nb_cores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gamma'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_clusters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_RandomForest_XGBoost_Stacking_MLP"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_RandomForest_XGBoost_Stacking_MLP" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class that performs stacking of RandomForest + XGBoost (base learners)
and an MLPRegressor (meta-learner). Features:</p>
<blockquote>
<div><ul class="simple">
<li><p>Hyperparameter tuning via cluster-based GridSearchCV</p></li>
<li><p>Parallel spatiotemporal training/prediction</p></li>
<li><p>Tercile probability calculations with various distributions</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nb_cores</strong> (<em>int</em>) – Number of CPU cores to use for parallel computation.</p></li>
<li><p><strong>dist_method</strong> (<em>str</em>) – Distribution method for tercile probability calculations.
One of {‘gamma’, ‘t’, ‘normal’, ‘lognormal’, ‘nonparam’}.</p></li>
<li><p><strong>n_clusters</strong> (<em>int</em>) – Number of clusters for KMeans.</p></li>
<li><p><strong>param_grid</strong> (<em>dict</em><em> or </em><em>None</em>) – Hyperparameter search grid for GridSearchCV. If None, a minimal default is used.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul>
<li><p>When referencing parameters inside stacking estimators, scikit-learn uses
“estimators__&lt;est_name&gt;__&lt;param_name&gt;” for base models, or
“final_estimator__&lt;param&gt;” for the meta-model. For example:</p>
<blockquote>
<div><ul class="simple">
<li><p>“estimators__rf__n_estimators” =&gt; sets n_estimators for ‘rf’</p></li>
<li><p>“estimators__xgb__max_depth”   =&gt; sets max_depth for ‘xgb’</p></li>
<li><p>“final_estimator__hidden_layer_sizes” =&gt; sets hidden_layer_sizes in MLPRegressor</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_RandomForest_XGBoost_Stacking_MLP.calculate_tercile_probabilities">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_RandomForest_XGBoost_Stacking_MLP.calculate_tercile_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_RandomForest_XGBoost_Stacking_MLP.calculate_tercile_probabilities" title="Link to this definition"></a></dt>
<dd><p>Student’s t-based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_RandomForest_XGBoost_Stacking_MLP.calculate_tercile_probabilities_gamma">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_RandomForest_XGBoost_Stacking_MLP.calculate_tercile_probabilities_gamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_RandomForest_XGBoost_Stacking_MLP.calculate_tercile_probabilities_gamma" title="Link to this definition"></a></dt>
<dd><p>Gamma-based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_RandomForest_XGBoost_Stacking_MLP.calculate_tercile_probabilities_lognormal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_lognormal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_RandomForest_XGBoost_Stacking_MLP.calculate_tercile_probabilities_lognormal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_RandomForest_XGBoost_Stacking_MLP.calculate_tercile_probabilities_lognormal" title="Link to this definition"></a></dt>
<dd><p>Lognormal-based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_RandomForest_XGBoost_Stacking_MLP.calculate_tercile_probabilities_nonparametric">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_nonparametric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_RandomForest_XGBoost_Stacking_MLP.calculate_tercile_probabilities_nonparametric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_RandomForest_XGBoost_Stacking_MLP.calculate_tercile_probabilities_nonparametric" title="Link to this definition"></a></dt>
<dd><p>Non-parametric method (requires historical errors).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_RandomForest_XGBoost_Stacking_MLP.calculate_tercile_probabilities_normal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_normal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_RandomForest_XGBoost_Stacking_MLP.calculate_tercile_probabilities_normal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_RandomForest_XGBoost_Stacking_MLP.calculate_tercile_probabilities_normal" title="Link to this definition"></a></dt>
<dd><p>Normal-based method using the Gaussian CDF.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_RandomForest_XGBoost_Stacking_MLP.compute_hyperparameters">
<span class="sig-name descname"><span class="pre">compute_hyperparameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictand</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predictor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_RandomForest_XGBoost_Stacking_MLP.compute_hyperparameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_RandomForest_XGBoost_Stacking_MLP.compute_hyperparameters" title="Link to this definition"></a></dt>
<dd><p>Cluster grid cells (Y,X) via KMeans on the mean of <cite>predictand</cite>.
For each cluster, run GridSearchCV on a StackingRegressor that has:</p>
<blockquote>
<div><ul class="simple">
<li><p>RandomForest (rf) + XGBoost (xgb) as base learners</p></li>
<li><p>MLPRegressor as meta-learner</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>predictand</strong> (<em>xarray.DataArray</em>) – Target variable with dims (‘T’, ‘Y’, ‘X’).</p></li>
<li><p><strong>predictor</strong> (<em>xarray.DataArray</em>) – Predictor variables with dims (‘T’,’features’).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>best_param_da</strong> (<em>xarray.DataArray</em>) – DataArray storing the best hyperparams (as strings) for each grid cell.</p></li>
<li><p><strong>cluster_da</strong> (<em>xarray.DataArray</em>) – The integer cluster assignment for each (Y,X).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_RandomForest_XGBoost_Stacking_MLP.compute_model">
<span class="sig-name descname"><span class="pre">compute_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_param_da</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_RandomForest_XGBoost_Stacking_MLP.compute_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_RandomForest_XGBoost_Stacking_MLP.compute_model" title="Link to this definition"></a></dt>
<dd><p>Parallel training + prediction across the entire spatial domain,
referencing local best_params for each grid cell.</p>
<p>Returns an xarray.DataArray with dim ‘output’ = [error, prediction].</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_RandomForest_XGBoost_Stacking_MLP.compute_prob">
<span class="sig-name descname"><span class="pre">compute_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_RandomForest_XGBoost_Stacking_MLP.compute_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_RandomForest_XGBoost_Stacking_MLP.compute_prob" title="Link to this definition"></a></dt>
<dd><p>Compute tercile probabilities using self.dist_method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Predictant</strong> (<em>xarray.DataArray</em><em> (</em><em>T</em><em>, </em><em>Y</em><em>, </em><em>X</em><em>)</em>) – Observed data.</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em>)</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em>) – The start and end years for the climatology.</p></li>
<li><p><strong>hindcast_det</strong> (<em>xarray.DataArray</em>) – Deterministic forecast with dims (output=2, T, Y, X).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>hindcast_prob</strong> – dims (probability=3, T, Y, X) =&gt; [PB, PN, PA].</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_RandomForest_XGBoost_Stacking_MLP.fit_predict">
<span class="sig-name descname"><span class="pre">fit_predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_params_str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_RandomForest_XGBoost_Stacking_MLP.fit_predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_RandomForest_XGBoost_Stacking_MLP.fit_predict" title="Link to this definition"></a></dt>
<dd><p>For a single grid cell, parse the local best_params dict, set them on the
StackingRegressor (with RF + XGB base, MLP meta), train and predict.</p>
<p>Returns [error, prediction].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X_train</strong> (<em>np.ndarray</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>)</p></li>
<li><p><strong>y_train</strong> (<em>np.ndarray</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em>)</p></li>
<li><p><strong>X_test</strong> (<em>np.ndarray</em><em>, </em><em>shape</em><em> (</em><em>n_features</em><em>,</em><em>) or </em><em>(</em><em>1</em><em>, </em><em>n_features</em><em>)</em>)</p></li>
<li><p><strong>y_test</strong> (<em>float</em><em> or </em><em>np.nan</em>)</p></li>
<li><p><strong>best_params_str</strong> (<em>str</em>) – Local best hyperparams as a stringified dict.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[error, prediction]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray of shape (2,)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_RandomForest_XGBoost_Stacking_MLP.forecast">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor_for_year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_param_da</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_RandomForest_XGBoost_Stacking_MLP.forecast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_RandomForest_XGBoost_Stacking_MLP.forecast" title="Link to this definition"></a></dt>
<dd><p>Generate a forecast for a single future time (e.g., future year),
then compute tercile probabilities from the chosen distribution method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Predictant</strong> (<em>xarray.DataArray</em>) – Observed data with dims (T, Y, X) used for computing climatological terciles.</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em>) – Start year of the climatology period.</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em>) – End year of the climatology period.</p></li>
<li><p><strong>Predictor</strong> (<em>xarray.DataArray</em>) – Historical predictor data, shape (T, features).</p></li>
<li><p><strong>hindcast_det</strong> (<em>xarray.DataArray</em>) – Historical deterministic forecast with dims (output=[error,prediction], T, Y, X).
Used to estimate error variance or error samples.</p></li>
<li><p><strong>Predictor_for_year</strong> (<em>xarray.DataArray</em>) – Predictor data for the forecast year, shape (features,) or (1, features).</p></li>
<li><p><strong>best_param_da</strong> (<em>xarray.DataArray</em>) – Grid-based best hyperparams from <cite>compute_hyperparameters</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>result_</strong> (<em>xarray.DataArray</em>) – dims (‘output’,’Y’,’X’) =&gt; [error, prediction].
For a true forecast, the ‘error’ is typically NaN.</p></li>
<li><p><strong>hindcast_prob</strong> (<em>xarray.DataArray</em>) – dims (probability=3, Y, X) =&gt; PB, PN, PA tercile probabilities.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_SVR">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_machine_learning.</span></span><span class="sig-name descname"><span class="pre">WAS_SVR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nb_cores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_clusters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.1,</span> <span class="pre">1,</span> <span class="pre">10,</span> <span class="pre">100]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.01,</span> <span class="pre">0.1,</span> <span class="pre">0.5,</span> <span class="pre">1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[2,</span> <span class="pre">3,</span> <span class="pre">4]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gamma'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_SVR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_SVR" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class to perform Support Vector Regression (SVR) on spatiotemporal datasets for climate prediction.</p>
<p>This class is designed to work with Dask and Xarray for parallelized, high-performance
regression computations across large datasets with spatial and temporal dimensions. The primary
methods are for fitting the SVR model, making predictions, and calculating probabilistic predictions
for climate terciles.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_SVR.nb_cores">
<span class="sig-name descname"><span class="pre">nb_cores</span></span><a class="headerlink" href="#wass2s.was_machine_learning.WAS_SVR.nb_cores" title="Link to this definition"></a></dt>
<dd><p>The number of CPU cores to use for parallel computation (default is 1).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_SVR.n_clusters">
<span class="sig-name descname"><span class="pre">n_clusters</span></span><a class="headerlink" href="#wass2s.was_machine_learning.WAS_SVR.n_clusters" title="Link to this definition"></a></dt>
<dd><p>The number of clusters to use in KMeans clustering (default is 5).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_SVR.kernel">
<span class="sig-name descname"><span class="pre">kernel</span></span><a class="headerlink" href="#wass2s.was_machine_learning.WAS_SVR.kernel" title="Link to this definition"></a></dt>
<dd><p>Kernel type to be used in SVR (‘linear’, ‘poly’, ‘rbf’, or ‘all’) (default is ‘linear’).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_SVR.gamma">
<span class="sig-name descname"><span class="pre">gamma</span></span><a class="headerlink" href="#wass2s.was_machine_learning.WAS_SVR.gamma" title="Link to this definition"></a></dt>
<dd><p>gamma of ‘rbf’ kernel function. Ignored by all other kernels, [“auto”, “scale”, None] by default None.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_SVR.C_range">
<span class="sig-name descname"><span class="pre">C_range</span></span><a class="headerlink" href="#wass2s.was_machine_learning.WAS_SVR.C_range" title="Link to this definition"></a></dt>
<dd><p>List of C values to consider during hyperparameter tuning.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_SVR.epsilon_range">
<span class="sig-name descname"><span class="pre">epsilon_range</span></span><a class="headerlink" href="#wass2s.was_machine_learning.WAS_SVR.epsilon_range" title="Link to this definition"></a></dt>
<dd><p>List of epsilon values to consider during hyperparameter tuning.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_SVR.degree_range">
<span class="sig-name descname"><span class="pre">degree_range</span></span><a class="headerlink" href="#wass2s.was_machine_learning.WAS_SVR.degree_range" title="Link to this definition"></a></dt>
<dd><p>List of degrees to consider for the ‘poly’ kernel during hyperparameter tuning.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_SVR.dist_method">
<span class="sig-name descname"><span class="pre">dist_method</span></span><a class="headerlink" href="#wass2s.was_machine_learning.WAS_SVR.dist_method" title="Link to this definition"></a></dt>
<dd><p>Distribution method (“gamma”, “t”, “normal”, “lognormal”, “nonparam”) for probability calculations.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_SVR.calculate_tercile_probabilities">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_SVR.calculate_tercile_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_SVR.calculate_tercile_probabilities" title="Link to this definition"></a></dt>
<dd><p>Calculates tercile probabilities using a Student’s t-based approach.</p>
<dl class="simple">
<dt>best_guess<span class="classifier">array-like</span></dt><dd><p>Model predictions for each time.</p>
</dd>
<dt>error_variance<span class="classifier">float or array-like</span></dt><dd><p>Variance of prediction errors.</p>
</dd>
<dt>first_tercile, second_tercile<span class="classifier">float or array-like</span></dt><dd><p>The lower and upper tercile boundaries.</p>
</dd>
<dt>dof<span class="classifier">int</span></dt><dd><p>Degrees of freedom for the t-distribution.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pred_prob</strong> – Probability in each of the 3 categories (below, normal, above).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_SVR.calculate_tercile_probabilities_gamma">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_SVR.calculate_tercile_probabilities_gamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_SVR.calculate_tercile_probabilities_gamma" title="Link to this definition"></a></dt>
<dd><p>Calculates tercile probabilities assuming Gamma-distributed errors.</p>
<dl class="simple">
<dt>best_guess<span class="classifier">array-like</span></dt><dd><p>Model predictions for each time.</p>
</dd>
<dt>error_variance<span class="classifier">float or array-like</span></dt><dd><p>Variance of prediction errors.</p>
</dd>
<dt>T1, T2<span class="classifier">float or array-like</span></dt><dd><p>The lower (T1) and upper (T2) tercile boundaries.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pred_prob</strong> – 3 rows for probabilities (PB, PN, PA) over time dimension.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_SVR.calculate_tercile_probabilities_lognormal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_lognormal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_SVR.calculate_tercile_probabilities_lognormal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_SVR.calculate_tercile_probabilities_lognormal" title="Link to this definition"></a></dt>
<dd><p>Lognormal-based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_SVR.calculate_tercile_probabilities_nonparametric">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_nonparametric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_SVR.calculate_tercile_probabilities_nonparametric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_SVR.calculate_tercile_probabilities_nonparametric" title="Link to this definition"></a></dt>
<dd><p>Non-parametric method (requires historical errors).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_SVR.calculate_tercile_probabilities_normal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_normal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_SVR.calculate_tercile_probabilities_normal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_SVR.calculate_tercile_probabilities_normal" title="Link to this definition"></a></dt>
<dd><p>Normal-based method using the Gaussian CDF.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_SVR.compute_hyperparameters">
<span class="sig-name descname"><span class="pre">compute_hyperparameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictand</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predictor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_SVR.compute_hyperparameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_SVR.compute_hyperparameters" title="Link to this definition"></a></dt>
<dd><p>Computes optimal SVR hyperparameters (C and epsilon) for each spatial cluster.</p>
<p>We cluster the spatial grid based on the mean values in <cite>predictand</cite>,
then do a grid search for SVR hyperparameters on the average time series of each cluster.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>predictand</strong> (<em>xarray.DataArray</em>) – Target variable with dimensions (‘T’, ‘Y’, ‘X’).</p></li>
<li><p><strong>predictor</strong> (<em>xarray.DataArray</em>) – Predictor variables with dimensions (‘T’, ‘features’).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataArrays containing the best-fitting hyperparameters and cluster labels for each grid cell.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>C_array, epsilon_array, degree_array, Cluster</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_SVR.compute_model">
<span class="sig-name descname"><span class="pre">compute_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree_array</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_SVR.compute_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_SVR.compute_model" title="Link to this definition"></a></dt>
<dd><p>Computes predictions for spatiotemporal data using SVR with parallel processing via Dask.</p>
<p>We break the data into chunks, apply the <cite>fit_predict</cite> function in parallel,
and combine the results into an output DataArray.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X_train</strong> (<em>xarray.DataArray</em>) – Training predictors with dimensions (‘T’, ‘features’).</p></li>
<li><p><strong>y_train</strong> (<em>xarray.DataArray</em>) – Training targets with dimensions (‘T’, ‘Y’, ‘X’).</p></li>
<li><p><strong>X_test</strong> (<em>xarray.DataArray</em>) – Test predictors with dimensions (‘features’,).</p></li>
<li><p><strong>y_test</strong> (<em>xarray.DataArray</em>) – Test target values with dimensions (‘Y’, ‘X’).</p></li>
<li><p><strong>epsilon</strong> (<em>xarray.DataArray</em>) – Epsilon hyperparameters per grid point.</p></li>
<li><p><strong>C</strong> (<em>xarray.DataArray</em>) – C hyperparameters per grid point.</p></li>
<li><p><strong>degree_array</strong> (<em>xarray.DataArray</em><em>, </em><em>optional</em>) – Polynomial degrees per grid point (only used if kernel=’poly’).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Predictions &amp; errors, stacked along a new ‘output’ dimension (size=2).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_SVR.compute_prob">
<span class="sig-name descname"><span class="pre">compute_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_SVR.compute_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_SVR.compute_prob" title="Link to this definition"></a></dt>
<dd><p>Compute tercile probabilities using self.dist_method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Predictant</strong> (<em>xarray.DataArray</em><em> (</em><em>T</em><em>, </em><em>Y</em><em>, </em><em>X</em><em>)</em>) – Observed data.</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em>)</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em>) – The start and end years for the climatology.</p></li>
<li><p><strong>hindcast_det</strong> (<em>xarray.DataArray</em>) – Deterministic forecast with dims (output=2, T, Y, X).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>hindcast_prob</strong> – dims (probability=3, T, Y, X) =&gt; [PB, PN, PA].</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_SVR.fit_predict">
<span class="sig-name descname"><span class="pre">fit_predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_SVR.fit_predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_SVR.fit_predict" title="Link to this definition"></a></dt>
<dd><p>Fits an SVR model to the provided training data, makes predictions on the test data,
and calculates the prediction error.</p>
<p>We handle data-type issues (e.g., bytes input), set up the SVR with the requested
parameters, fit it, and return both the error and the prediction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – Training predictors.</p></li>
<li><p><strong>y</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em>) – Training targets.</p></li>
<li><p><strong>x_test</strong> (<em>array-like</em><em>, </em><em>shape</em><em> (</em><em>n_features</em><em>,</em><em>)</em>) – Test predictors.</p></li>
<li><p><strong>y_test</strong> (<em>float</em><em> or </em><em>None</em>) – Test target value. Used to calculate error if available.</p></li>
<li><p><strong>epsilon</strong> (<em>float</em>) – Epsilon parameter for SVR (defines epsilon-tube).</p></li>
<li><p><strong>C</strong> (<em>float</em>) – Regularization parameter for SVR.</p></li>
<li><p><strong>degree</strong> (<em>int</em><em>, </em><em>optional</em>) – Degree for ‘poly’ kernel. Ignored if kernel != ‘poly’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 2-element array containing [error, prediction].</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_SVR.forecast">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor_for_year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">C</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">degree_array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma_array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_SVR.forecast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_SVR.forecast" title="Link to this definition"></a></dt>
<dd><p>Generates forecasts and computes probabilities for a specific year.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Predictant</strong> (<em>xarray.DataArray</em>) – Target variable (T, Y, X).</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em>) – Start year for climatology.</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em>) – End year for climatology.</p></li>
<li><p><strong>Predictor</strong> (<em>xarray.DataArray</em>) – Historical predictor data (T, features).</p></li>
<li><p><strong>hindcast_det</strong> (<em>xarray.DataArray</em>) – Deterministic hindcasts (includes ‘prediction’ and ‘error’ outputs).</p></li>
<li><p><strong>Predictor_for_year</strong> (<em>xarray.DataArray</em>) – Predictor data for the target forecast year (features).</p></li>
<li><p><strong>epsilon</strong> (<em>xarray.DataArray</em>) – Hyperparameter grids for the model.</p></li>
<li><p><strong>C</strong> (<em>xarray.DataArray</em>) – Hyperparameter grids for the model.</p></li>
<li><p><strong>kernel_array</strong> (<em>xarray.DataArray</em>) – Hyperparameter grids for the model.</p></li>
<li><p><strong>degree_array</strong> (<em>xarray.DataArray</em>) – Hyperparameter grids for the model.</p></li>
<li><p><strong>gamma_array</strong> (<em>xarray.DataArray</em>) – Hyperparameter grids for the model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ol class="arabic simple">
<li><p>The forecast results (error, prediction) for that year.</p></li>
<li><p>The corresponding tercile probabilities (PB, PN, PA).</p></li>
</ol>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_Stacking_Ridge">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_machine_learning.</span></span><span class="sig-name descname"><span class="pre">WAS_Stacking_Ridge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nb_cores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gamma'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_clusters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_grid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_Stacking_Ridge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_Stacking_Ridge" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="simple">
<dt>A class that performs stacking of the following base learners:</dt><dd><ul class="simple">
<li><p>RandomForestRegressor (rf)</p></li>
<li><p>XGBRegressor (xgb)</p></li>
<li><p>MLPRegressor (mlp_base)</p></li>
</ul>
</dd>
</dl>
<p>and uses Ridge as the meta-model.</p>
<dl class="simple">
<dt>Like the previous classes, this supports:</dt><dd><ul class="simple">
<li><p>Cluster-based hyperparameter tuning via KMeans + GridSearchCV</p></li>
<li><p>Parallel spatiotemporal training/prediction with xarray + dask</p></li>
<li><p>Various distribution methods for tercile probability calculations.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nb_cores</strong> (<em>int</em>) – Number of CPU cores to use for parallel computation.</p></li>
<li><p><strong>dist_method</strong> (<em>str</em>) – Distribution method for tercile probability calculations:
One of {‘gamma’, ‘t’, ‘normal’, ‘lognormal’, ‘nonparam’}.</p></li>
<li><p><strong>n_clusters</strong> (<em>int</em>) – Number of clusters for KMeans (used in hyperparameter tuning).</p></li>
<li><p><strong>param_grid</strong> (<em>Example for</em>) – Hyperparameter grid for GridSearchCV. If None, a minimal default is used.</p></li>
<li><p><strong>param_grid</strong> – <dl class="simple">
<dt>{</dt><dd><p>“estimators__rf__n_estimators”: [50, 100],
“estimators__xgb__max_depth”: [3, 6],
“estimators__mlp_base__hidden_layer_sizes”: [(20,), (50, 10)],
“final_estimator__alpha”: [0.1, 0.9, 5.0],</p>
</dd>
</dl>
<p>}</p>
</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_Stacking_Ridge.compute_hyperparameters">
<span class="sig-name descname"><span class="pre">compute_hyperparameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictand</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predictor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_Stacking_Ridge.compute_hyperparameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_Stacking_Ridge.compute_hyperparameters" title="Link to this definition"></a></dt>
<dd><p>Performs cluster-based hyperparam tuning, returns best-param DataArray.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_Stacking_Ridge.fit_predict">
<span class="sig-name descname"><span class="pre">fit_predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_params_str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_Stacking_Ridge.fit_predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_Stacking_Ridge.fit_predict" title="Link to this definition"></a></dt>
<dd><p>Trains a local stacking model with the best hyperparams for that grid cell, then predicts.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_Stacking_Ridge.compute_model">
<span class="sig-name descname"><span class="pre">compute_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_param_da</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_Stacking_Ridge.compute_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_Stacking_Ridge.compute_model" title="Link to this definition"></a></dt>
<dd><p>Calls fit_predict(…) in parallel across all grid cells.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_Stacking_Ridge.compute_prob">
<span class="sig-name descname"><span class="pre">compute_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_Stacking_Ridge.compute_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_Stacking_Ridge.compute_prob" title="Link to this definition"></a></dt>
<dd><p>Computes tercile probabilities using self.dist_method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_Stacking_Ridge.forecast">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor_for_year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_param_da</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_Stacking_Ridge.forecast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_Stacking_Ridge.forecast" title="Link to this definition"></a></dt>
<dd><p>Fits a forecast for a single future year (or time) and calculates tercile probabilities.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_Stacking_Ridge.calculate_tercile_probabilities">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_Stacking_Ridge.calculate_tercile_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_Stacking_Ridge.calculate_tercile_probabilities" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_Stacking_Ridge.calculate_tercile_probabilities_gamma">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_Stacking_Ridge.calculate_tercile_probabilities_gamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_Stacking_Ridge.calculate_tercile_probabilities_gamma" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_Stacking_Ridge.calculate_tercile_probabilities_lognormal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_lognormal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_Stacking_Ridge.calculate_tercile_probabilities_lognormal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_Stacking_Ridge.calculate_tercile_probabilities_lognormal" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_Stacking_Ridge.calculate_tercile_probabilities_nonparametric">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_nonparametric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_Stacking_Ridge.calculate_tercile_probabilities_nonparametric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_Stacking_Ridge.calculate_tercile_probabilities_nonparametric" title="Link to this definition"></a></dt>
<dd><p>Non-parametric method (requires historical errors).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_machine_learning.WAS_Stacking_Ridge.calculate_tercile_probabilities_normal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_normal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_Stacking_Ridge.calculate_tercile_probabilities_normal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_machine_learning.WAS_Stacking_Ridge.calculate_tercile_probabilities_normal" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id25">
<span class="sig-name descname"><span class="pre">compute_hyperparameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictand</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predictor</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_Stacking_Ridge.compute_hyperparameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id25" title="Link to this definition"></a></dt>
<dd><p>Runs KMeans clustering on the mean of <cite>predictand</cite> (over time).
Then, for each cluster, runs a cross-validation GridSearch over a stacking model with:</p>
<blockquote>
<div><ul class="simple">
<li><p>RF, XGB, MLP (as base estimators)</p></li>
<li><p>Ridge (as the meta-estimator).</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>predictand</strong> (<em>xarray.DataArray</em>) – Target variable with dims (‘T’,’Y’,’X’).</p></li>
<li><p><strong>predictor</strong> (<em>xarray.DataArray</em>) – Predictor variables with dims (‘T’,’features’).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>best_param_da</strong> (<em>xarray.DataArray</em>) – DataArray storing best hyperparams (as string) per grid cell.</p></li>
<li><p><strong>cluster_da</strong> (<em>xarray.DataArray</em>) – Cluster assignment for each (Y,X).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id26">
<span class="sig-name descname"><span class="pre">compute_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_param_da</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_Stacking_Ridge.compute_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id26" title="Link to this definition"></a></dt>
<dd><p>Parallel training + prediction across all spatial grid points.
Uses local best hyperparams from best_param_da for each pixel.</p>
<p>Returns an xarray.DataArray with dim (‘output’,’Y’,’X’) =&gt; [error, prediction].</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id27">
<span class="sig-name descname"><span class="pre">compute_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_Stacking_Ridge.compute_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id27" title="Link to this definition"></a></dt>
<dd><p>Compute tercile probabilities using self.dist_method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Predictant</strong> (<em>xarray.DataArray</em><em> (</em><em>T</em><em>, </em><em>Y</em><em>, </em><em>X</em><em>)</em>) – Observed data.</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em>)</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em>) – The start and end years for the climatology.</p></li>
<li><p><strong>hindcast_det</strong> (<em>xarray.DataArray</em>) – Deterministic forecast with dims (output=2, T, Y, X).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>hindcast_prob</strong> – dims (probability=3, T, Y, X) =&gt; [PB, PN, PA].</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id28">
<span class="sig-name descname"><span class="pre">fit_predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_params_str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_Stacking_Ridge.fit_predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id28" title="Link to this definition"></a></dt>
<dd><p>For a single grid cell, parse the best params, instantiate the stacking regressor,
fit to local data, and predict.</p>
<p>Returns [error, prediction].</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id29">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor_for_year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_param_da</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_machine_learning.html#WAS_Stacking_Ridge.forecast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id29" title="Link to this definition"></a></dt>
<dd><p>Forecast for a single future year (or time) and compute tercile probabilities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Predictant</strong> (<em>xarray.DataArray</em>) – Observed data with dims (T, Y, X), used for computing climatology thresholds.</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em>) – Start of climatology period.</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em>) – End of climatology period.</p></li>
<li><p><strong>Predictor</strong> (<em>xarray.DataArray</em>) – Historical predictor data, shape (T, features).</p></li>
<li><p><strong>hindcast_det</strong> (<em>xarray.DataArray</em>) – Historical deterministic forecast with dims (output=[error,prediction], T, Y, X)
for computing error variance or samples.</p></li>
<li><p><strong>Predictor_for_year</strong> (<em>xarray.DataArray</em>) – Predictor data for the forecast year, shape (features,) or (1, features).</p></li>
<li><p><strong>best_param_da</strong> (<em>xarray.DataArray</em>) – Local best hyperparams from compute_hyperparameters, shape (Y, X).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>result_</strong> (<em>xarray.DataArray</em>) – dims (output=2, Y, X) =&gt; [error, prediction].
In a real forecast, “error” is typically NaN since we have no future observation.</p></li>
<li><p><strong>hindcast_prob</strong> (<em>xarray.DataArray</em>) – dims (probability=3, Y, X) =&gt; [PB, PN, PA].</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-wass2s.was_analog">
<span id="wass2s-was-analog-module"></span><h2>wass2s.was_analog module<a class="headerlink" href="#module-wass2s.was_analog" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_analog.WAS_Analog">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_analog.</span></span><span class="sig-name descname"><span class="pre">WAS_Analog</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_to_save</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_forecast</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reanalysis_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method_analog</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'som'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_prcp_models</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">month_of_initialization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lead_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ensemble_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">define_extent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_compute</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">some_grid_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(None,</span> <span class="pre">None)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">some_learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">some_neighborhood_function</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gaussian'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">some_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gamma'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_analog.html#WAS_Analog"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_analog.WAS_Analog" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Analog-based forecasting toolkit for seasonal climate applications.</p>
<p>This class orchestrates the end-to-end workflow required to build
<strong>analog ensembles</strong> for Sea-Surface Temperature (SST) predictors and
to translate them into deterministic and probabilistic rainfall
forecasts over West Africa (or any user-defined domain).  Three
alternative analog-selection strategies are supported:</p>
<ul class="simple">
<li><p><strong>Self-Organising Maps</strong> (<cite>method_analog=”som”</cite>, default)</p></li>
<li><p><strong>Correlation ranking</strong> (<cite>“cor_based”</cite>)</p></li>
<li><p><strong>Principal-Component (EOF) similarity</strong> (<cite>“pca_based”</cite>)</p></li>
</ul>
<p>In addition, the class encapsulates data acquisition (reanalysis +
seasonal hindcasts), preprocessing, EOF/SOM training, tercile-based
probability generation with multiple distributional options
(Student-t, Gamma, Gaussian, Log-normal, non-parametric), and a set of
convenient visualisation helpers.</p>
<section id="parameters">
<h3>Parameters:<a class="headerlink" href="#parameters" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>dir_to_save<span class="classifier">str</span></dt><dd><p>Directory path to save downloaded and processed data files.</p>
</dd>
<dt>year_start<span class="classifier">int</span></dt><dd><p>Starting year for historical data.</p>
</dd>
<dt>year_forecast<span class="classifier">int</span></dt><dd><p>Target forecast year.</p>
</dd>
<dt>reanalysis_name<span class="classifier">str</span></dt><dd><p>Name of the reanalysis dataset (e.g., “ERA5.SST” or “NOAA.SST”).</p>
</dd>
<dt>model_name<span class="classifier">str</span></dt><dd><p>Name of the forecast model (e.g., “ECMWF_51.SST”).</p>
</dd>
<dt>method_analog<span class="classifier">str, optional</span></dt><dd><p>Analog method to use (“som”, “cor_based”, or “pca_based”). Default is “som”.</p>
</dd>
<dt>best_prcp_models<span class="classifier">list, optional</span></dt><dd><p>List of best precipitation models to consider.</p>
</dd>
<dt>month_of_initialization<span class="classifier">int, optional</span></dt><dd><p>Month of initialization for forecasts. If None, uses current month.</p>
</dd>
<dt>lead_time<span class="classifier">list, optional</span></dt><dd><p>List of lead times in months. If None, defaults to [1, 2, 3, 4, 5].</p>
</dd>
<dt>ensemble_mean<span class="classifier">str, optional</span></dt><dd><p>Method for ensemble mean (“mean” or “median”). Default is “mean”.</p>
</dd>
<dt>clim_year_start<span class="classifier">int, optional</span></dt><dd><p>Start year for climatology period.</p>
</dd>
<dt>clim_year_end<span class="classifier">int, optional</span></dt><dd><p>End year for climatology period.</p>
</dd>
<dt>define_extent<span class="classifier">tuple, optional</span></dt><dd><p>Bounding box as (lon_min, lon_max, lat_min, lat_max) for regional analysis.</p>
</dd>
<dt>index_compute<span class="classifier">list, optional</span></dt><dd><p>List of climate indices to compute.</p>
</dd>
<dt>some_grid_size<span class="classifier">tuple, optional</span></dt><dd><p>Grid size for SOM (rows, columns). Default is (None, None) which uses automatic sizing.</p>
</dd>
<dt>some_learning_rate<span class="classifier">float, optional</span></dt><dd><p>Learning rate for SOM training. Default is 0.5.</p>
</dd>
<dt>some_neighborhood_function<span class="classifier">str, optional</span></dt><dd><p>Neighborhood function for SOM (“gaussian”, “mexican_hat”, etc.). Default is “gaussian”.</p>
</dd>
<dt>some_sigma<span class="classifier">float, optional</span></dt><dd><p>Initial neighborhood radius for SOM. Default is 1.0.</p>
</dd>
<dt>dist_method<span class="classifier">str, optional</span></dt><dd><p>Method for probability calculation (“gamma”, “t”, “normal”, “lognormal”, “nonparam”).
Default is “gamma”.</p>
</dd>
</dl>
</section>
<section id="id30">
<h3>Methods:<a class="headerlink" href="#id30" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>download_sst_reanalysis():</dt><dd><p>Downloads sea surface temperature reanalysis data.</p>
</dd>
<dt>download_models():</dt><dd><p>Downloads seasonal forecast model data.</p>
</dd>
<dt>standardize_timeseries():</dt><dd><p>Standardizes time series data.</p>
</dd>
<dt>calc_index():</dt><dd><p>Calculates climate indices from SST data.</p>
</dd>
<dt>compute_model():</dt><dd><p>Computes analog forecasts.</p>
</dd>
<dt>compute_prob():</dt><dd><p>Computes tercile probabilities from forecasts.</p>
</dd>
<dt>forecast():</dt><dd><p>Generates forecasts for a target year.</p>
</dd>
<dt>composite_plot():</dt><dd><p>Creates composite plots of forecast results.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_analog.WAS_Analog.Corr_Based">
<span class="sig-name descname"><span class="pre">Corr_Based</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ddd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itrain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ireference_year</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_analog.html#WAS_Analog.Corr_Based"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_analog.WAS_Analog.Corr_Based" title="Link to this definition"></a></dt>
<dd><p>Identify similar years using correlation-based analog method.</p>
<p>Finds years with high spatial correlation to the reference year’s SST data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>predictant</strong> (<em>xarray.DataArray</em>) – Observed predictand data with dimensions (T, Y, X).</p></li>
<li><p><strong>ddd</strong> (<em>xarray.DataArray</em>) – SST predictor data with dimensions (T, Y, X).</p></li>
<li><p><strong>itrain</strong> (<em>list</em>) – Indices of training years.</p></li>
<li><p><strong>ireference_year</strong> (<em>list</em>) – Indices of the reference year.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>similar_years</strong> – Array of years similar to the reference year.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_analog.WAS_Analog.Pca_Based">
<span class="sig-name descname"><span class="pre">Pca_Based</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ddd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itrain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ireference_year</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_analog.html#WAS_Analog.Pca_Based"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_analog.WAS_Analog.Pca_Based" title="Link to this definition"></a></dt>
<dd><p>Identify similar years using PCA-based analog method.</p>
<p>Uses EOF analysis to compute principal components and finds years with similar scores to the reference year.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>predictant</strong> (<em>xarray.DataArray</em>) – Observed predictand data with dimensions (T, Y, X).</p></li>
<li><p><strong>ddd</strong> (<em>xarray.DataArray</em>) – SST predictor data with dimensions (T, Y, X).</p></li>
<li><p><strong>itrain</strong> (<em>list</em>) – Indices of training years.</p></li>
<li><p><strong>ireference_year</strong> (<em>list</em>) – Indices of the reference year.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>similar_years</strong> – Array of years similar to the reference year.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_analog.WAS_Analog.SOM">
<span class="sig-name descname"><span class="pre">SOM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ddd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itrain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ireference_year</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_analog.html#WAS_Analog.SOM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_analog.WAS_Analog.SOM" title="Link to this definition"></a></dt>
<dd><p>Identify similar years using Self-Organizing Maps (SOM).</p>
<p>Trains a SOM on SST data or climate indices and finds years mapped to the same Best Matching Unit (BMU) as the reference year.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>predictant</strong> (<em>xarray.DataArray</em>) – Observed predictand data with dimensions (T, Y, X).</p></li>
<li><p><strong>ddd</strong> (<em>xarray.DataArray</em>) – SST predictor data with dimensions (T, Y, X).</p></li>
<li><p><strong>itrain</strong> (<em>list</em>) – Indices of training years.</p></li>
<li><p><strong>ireference_year</strong> (<em>list</em>) – Indices of the reference year.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>similar_years</strong> – Array of years similar to the reference year.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_analog.WAS_Analog.calc_index">
<span class="sig-name descname"><span class="pre">calc_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sst</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_analog.html#WAS_Analog.calc_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_analog.WAS_Analog.calc_index" title="Link to this definition"></a></dt>
<dd><p>Calculate climate indices from SST data.</p>
<p>Computes specified climate indices (e.g., NINO34, DMI) from SST data by averaging over predefined regions
or computing differences for derived indices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>indices</strong> (<em>list</em>) – List of climate indices to compute (e.g., [‘NINO34’, ‘DMI’]).</p></li>
<li><p><strong>sst</strong> (<em>xarray.DataArray</em>) – SST data with dimensions (T, Y, X).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>indices_dataset</strong> – Dataset containing computed climate indices as variables.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_analog.WAS_Analog.calculate_tercile_probabilities">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_analog.html#WAS_Analog.calculate_tercile_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_analog.WAS_Analog.calculate_tercile_probabilities" title="Link to this definition"></a></dt>
<dd><p>Student’s t-based method</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_analog.WAS_Analog.calculate_tercile_probabilities_gamma">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_analog.html#WAS_Analog.calculate_tercile_probabilities_gamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_analog.WAS_Analog.calculate_tercile_probabilities_gamma" title="Link to this definition"></a></dt>
<dd><p>Gamma-based method</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_analog.WAS_Analog.calculate_tercile_probabilities_lognormal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_lognormal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_analog.html#WAS_Analog.calculate_tercile_probabilities_lognormal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_analog.WAS_Analog.calculate_tercile_probabilities_lognormal" title="Link to this definition"></a></dt>
<dd><p>Lognormal-based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_analog.WAS_Analog.calculate_tercile_probabilities_nonparametric">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_nonparametric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_analog.html#WAS_Analog.calculate_tercile_probabilities_nonparametric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_analog.WAS_Analog.calculate_tercile_probabilities_nonparametric" title="Link to this definition"></a></dt>
<dd><p>Non-parametric method (require historical errors)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_analog.WAS_Analog.calculate_tercile_probabilities_normal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_normal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_analog.html#WAS_Analog.calculate_tercile_probabilities_normal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_analog.WAS_Analog.calculate_tercile_probabilities_normal" title="Link to this definition"></a></dt>
<dd><p>Normal-based method using the Gaussian CDF.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_analog.WAS_Analog.composite_plot">
<span class="sig-name descname"><span class="pre">composite_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_predictor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_analog.html#WAS_Analog.composite_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_analog.WAS_Analog.composite_plot" title="Link to this definition"></a></dt>
<dd><p>Create composite plots of predictors or predictands.</p>
<p>Plots SST composites for the forecast year and similar years, or precipitation ratios relative to climatology.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>predictant</strong> (<em>xarray.DataArray</em>) – Observed predictand data with dimensions (T, Y, X).</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em><em> or </em><em>str</em>) – Start year for climatology period.</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em><em> or </em><em>str</em>) – End year for climatology period.</p></li>
<li><p><strong>hindcast_det</strong> (<em>xarray.DataArray</em>) – Deterministic hindcast data with dimensions (T, Y, X).</p></li>
<li><p><strong>plot_predictor</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, plot SST predictors; otherwise, plot precipitation ratios. Default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>similar_years</strong> – Array of similar years used in the composite.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_analog.WAS_Analog.compute_model">
<span class="sig-name descname"><span class="pre">compute_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ddd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itrain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itest</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_analog.html#WAS_Analog.compute_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_analog.WAS_Analog.compute_model" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_analog.WAS_Analog.compute_prob">
<span class="sig-name descname"><span class="pre">compute_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_analog.html#WAS_Analog.compute_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_analog.WAS_Analog.compute_prob" title="Link to this definition"></a></dt>
<dd><p>Compute tercile probabilities using either ‘t’, ‘gamma’, ‘normal’, ‘lognormal’, or ‘nonparam’.</p>
<section id="id31">
<h4>Parameters:<a class="headerlink" href="#id31" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>Predictant<span class="classifier">xarray.DataArray</span></dt><dd><p>Observed data array with dimensions (T, Y, X)</p>
</dd>
<dt>clim_year_start<span class="classifier">int</span></dt><dd><p>Start year for climatology</p>
</dd>
<dt>clim_year_end<span class="classifier">int</span></dt><dd><p>End year for climatology</p>
</dd>
<dt>hindcast_det<span class="classifier">xarray.DataArray</span></dt><dd><p>Deterministic forecast (same shape as Predictant, minus M dimension)</p>
</dd>
<dt>method<span class="classifier">str, default = “gamma”</span></dt><dd><p>Method to use for calculating tercile probabilities:
- “t”
- “gamma”
- “normal”
- “lognormal”
- “nonparam”</p>
</dd>
<dt>error_samples<span class="classifier">xarray.DataArray or None</span></dt><dd><p>Only required for non-parametric method, shape (ensemble, T, Y, X) or something similar.</p>
</dd>
</dl>
</section>
<section id="returns">
<h4>Returns:<a class="headerlink" href="#returns" title="Link to this heading"></a></h4>
<dl class="simple">
<dt>hindcast_prob<span class="classifier">xarray.DataArray</span></dt><dd><p>Probability for each tercile category (PB, PN, PA)
with dimensions (probability=3, T, Y, X).</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_analog.WAS_Analog.download_and_process">
<span class="sig-name descname"><span class="pre">download_and_process</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">center_variable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_analog.html#WAS_Analog.download_and_process"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_analog.WAS_Analog.download_and_process" title="Link to this definition"></a></dt>
<dd><p>Download and process SST data for reanalysis and forecast.</p>
<p>Combines reanalysis and forecast SST data, standardizes, and applies a rolling mean.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>center_variable</strong> (<em>str</em><em>, </em><em>optional</em>) – Center-variable identifier (e.g., ‘ECMWF_51.SST’). Default is None (uses class attributes).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>concatenated_ds_st</strong> (<em>xarray.DataArray</em>) – Standardized and processed SST data.</p></li>
<li><p><strong>ds_shifted</strong> (<em>xarray.DataArray</em>) – Time-shifted version of the processed SST data.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_analog.WAS_Analog.download_models">
<span class="sig-name descname"><span class="pre">download_models</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">area</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[60,</span> <span class="pre">-180,</span> <span class="pre">-60,</span> <span class="pre">180]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_download</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_analog.html#WAS_Analog.download_models"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_analog.WAS_Analog.download_models" title="Link to this definition"></a></dt>
<dd><p>Download SST seasonal forecast data.</p>
<p>Downloads forecast data for specified models, initialization month, lead times, and spatial area.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>area</strong> (<em>list</em><em>, </em><em>optional</em>) – Bounding box as [North, West, South, East]. Default is [60, -180, -60, 180].</p></li>
<li><p><strong>force_download</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, forces re-download even if file exists. Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ds_centers</strong> – Combined forecast dataset across models.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_analog.WAS_Analog.download_sst_reanalysis">
<span class="sig-name descname"><span class="pre">download_sst_reanalysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">area</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[60,</span> <span class="pre">-180,</span> <span class="pre">-60,</span> <span class="pre">180]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_download</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_analog.html#WAS_Analog.download_sst_reanalysis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_analog.WAS_Analog.download_sst_reanalysis" title="Link to this definition"></a></dt>
<dd><p>Download Sea Surface Temperature (SST) reanalysis data.</p>
<p>Downloads SST data from the specified reanalysis dataset for the given years and spatial area,
handling both NOAA ERSST and ERA5 datasets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>area</strong> (<em>list</em><em>, </em><em>optional</em>) – Bounding box as [North, West, South, East]. Default is [60, -180, -60, 180].</p></li>
<li><p><strong>force_download</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, forces re-download even if file exists. Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>combined_ds</strong> – Combined SST dataset for the specified years.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.Dataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_analog.WAS_Analog.forecast">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forecast_year</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_analog.html#WAS_Analog.forecast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_analog.WAS_Analog.forecast" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_analog.WAS_Analog.plot_indices">
<span class="sig-name descname"><span class="pre">plot_indices</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_analog.html#WAS_Analog.plot_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_analog.WAS_Analog.plot_indices" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_analog.WAS_Analog.standardize_timeseries">
<span class="sig-name descname"><span class="pre">standardize_timeseries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_analog.html#WAS_Analog.standardize_timeseries"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_analog.WAS_Analog.standardize_timeseries" title="Link to this definition"></a></dt>
<dd><p>Standardize the dataset over a specified climatology period.</p>
</dd></dl>

</section>
</dd></dl>

</section>
<section id="module-wass2s.was_mme">
<span id="wass2s-was-mme-module"></span><h2>wass2s.was_mme module<a class="headerlink" href="#module-wass2s.was_mme" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_mme.BMA">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_mme.</span></span><span class="sig-name descname"><span class="pre">BMA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">observations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_predictions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rmse'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#BMA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.BMA" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.BMA.compute_error_based_prior">
<span class="sig-name descname"><span class="pre">compute_error_based_prior</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#BMA.compute_error_based_prior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.BMA.compute_error_based_prior" title="Link to this definition"></a></dt>
<dd><p>Compute either RMSE or MAE for each model vs. observations,
then use exp(-alpha * error) for priors.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.BMA.compute_model_posterior_probs">
<span class="sig-name descname"><span class="pre">compute_model_posterior_probs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#BMA.compute_model_posterior_probs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.BMA.compute_model_posterior_probs" title="Link to this definition"></a></dt>
<dd><p>Combine model priors and WAIC-based likelihood approximation to get posterior probabilities.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.BMA.fit_models_pymc">
<span class="sig-name descname"><span class="pre">fit_models_pymc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">draws</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tune</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chains</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_accept</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'adapt_diag'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#BMA.fit_models_pymc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.BMA.fit_models_pymc" title="Link to this definition"></a></dt>
<dd><p>Fit a PyMC model for each set of predictions: y ~ offset + scale * preds + noise.
Then compute WAIC and store offset, scale from posterior means.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>draws</strong> (<em>int</em>) – The number of samples (in each chain) to draw from the posterior.</p></li>
<li><p><strong>tune</strong> (<em>int</em>) – The number of tuning (burn-in) steps.</p></li>
<li><p><strong>chains</strong> (<em>int</em>) – The number of chains to run.</p></li>
<li><p><strong>target_accept</strong> (<em>float</em>) – The target acceptance probability for the sampler.</p></li>
<li><p><strong>init</strong> (<em>str</em>) – The initialization method for PyMC’s sampler. E.g., “adapt_diag”, “jitter+adapt_diag”, “advi+adapt_diag”, “adapt_full”, “jitter+adapt_full”, “auto”.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.BMA.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">future_model_preds_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#BMA.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.BMA.predict" title="Link to this definition"></a></dt>
<dd><p>Compute out-of-sample (future) predictions for each model, applying offset+scale,
and then weighting by posterior probabilities.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.BMA.predict_in_sample">
<span class="sig-name descname"><span class="pre">predict_in_sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#BMA.predict_in_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.BMA.predict_in_sample" title="Link to this definition"></a></dt>
<dd><p>Compute in-sample predictions using offset + scale for each model, weighted by posterior_probs.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.BMA.summary">
<span class="sig-name descname"><span class="pre">summary</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#BMA.summary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.BMA.summary" title="Link to this definition"></a></dt>
<dd><p>Print a summary for whichever error metric is used (RMSE or MAE).</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_mme.NonHomogeneousGaussianRegression">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_mme.</span></span><span class="sig-name descname"><span class="pre">NonHomogeneousGaussianRegression</span></span><a class="reference internal" href="_modules/wass2s/was_mme.html#NonHomogeneousGaussianRegression"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.NonHomogeneousGaussianRegression" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Placeholder for Non-Homogeneous Gaussian Regression model.</p>
<p>This class is not implemented in the provided code and serves as a placeholder for future development.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>None</strong></p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_Min2009_ProbWeighted">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_mme.</span></span><span class="sig-name descname"><span class="pre">WAS_Min2009_ProbWeighted</span></span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_Min2009_ProbWeighted"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_Min2009_ProbWeighted" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Probability-Weighted Multi-Model Ensemble based on Min et al. (2009).</p>
<p>Implements a specific weighting scheme for combining multiple climate models,
where weights are derived from model scores with a threshold-based transformation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>None</strong></p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_Min2009_ProbWeighted.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rainfall</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hdcst</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcst</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scores</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">complete</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_Min2009_ProbWeighted.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_Min2009_ProbWeighted.compute" title="Link to this definition"></a></dt>
<dd><p>Compute probability-weighted ensemble estimates for hindcast and forecast datasets.</p>
<p>Applies a weighting scheme where scores below the threshold are set to 0, and others to 1.
Optionally fills missing values with unweighted averages.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rainfall</strong> (<em>xarray.DataArray</em>) – Observed rainfall data with dimensions (T, Y, X, M).</p></li>
<li><p><strong>hdcst</strong> (<em>xarray.DataArray</em>) – Hindcast data with dimensions (T, M, Y, X).</p></li>
<li><p><strong>fcst</strong> (<em>xarray.DataArray</em>) – Forecast data with dimensions (T, M, Y, X).</p></li>
<li><p><strong>scores</strong> (<em>dict</em>) – Dictionary mapping model names to score arrays.</p></li>
<li><p><strong>threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – Threshold below which scores are set to 0. Default is 0.5.</p></li>
<li><p><strong>complete</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, fill missing values with unweighted averages. Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>hindcast_weighted</strong> (<em>xarray.DataArray</em>) – Weighted hindcast ensemble with dimensions (T, Y, X).</p></li>
<li><p><strong>forecast_weighted</strong> (<em>xarray.DataArray</em>) – Weighted forecast ensemble with dimensions (T, Y, X).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_AdaBoost">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_mme.</span></span><span class="sig-name descname"><span class="pre">WAS_mme_AdaBoost</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_estimators</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gamma'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_AdaBoost"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_AdaBoost" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>AdaBoost-based Multi-Model Ensemble (MME) forecasting.</p>
<p>This class implements a single-model forecasting approach using scikit-learn’s AdaBoostRegressor
for deterministic predictions, with optional tercile probability calculations using
various statistical distributions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_estimators</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of boosting iterations. Default is 50.</p></li>
<li><p><strong>learning_rate</strong> (<em>float</em><em>, </em><em>optional</em>) – Learning rate for boosting. Default is 0.1.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>optional</em>) – Seed for random number generation for reproducibility. Default is 42.</p></li>
<li><p><strong>dist_method</strong> (<em>str</em><em>, </em><em>optional</em>) – Distribution method for tercile probability calculations
(‘t’, ‘gamma’, ‘nonparam’, ‘normal’, ‘lognormal’, ‘weibull_min’).
Default is ‘gamma’.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_AdaBoost.calculate_tercile_probabilities">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_AdaBoost.calculate_tercile_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_AdaBoost.calculate_tercile_probabilities" title="Link to this definition"></a></dt>
<dd><p>Student’s t-based method</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_AdaBoost.calculate_tercile_probabilities_gamma">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_AdaBoost.calculate_tercile_probabilities_gamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_AdaBoost.calculate_tercile_probabilities_gamma" title="Link to this definition"></a></dt>
<dd><p>Gamma-distribution based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_AdaBoost.calculate_tercile_probabilities_lognormal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_lognormal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_AdaBoost.calculate_tercile_probabilities_lognormal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_AdaBoost.calculate_tercile_probabilities_lognormal" title="Link to this definition"></a></dt>
<dd><p>Lognormal-distribution based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_AdaBoost.calculate_tercile_probabilities_nonparametric">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_nonparametric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_AdaBoost.calculate_tercile_probabilities_nonparametric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_AdaBoost.calculate_tercile_probabilities_nonparametric" title="Link to this definition"></a></dt>
<dd><p>Non-parametric method using historical error samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_AdaBoost.calculate_tercile_probabilities_normal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_normal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_AdaBoost.calculate_tercile_probabilities_normal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_AdaBoost.calculate_tercile_probabilities_normal" title="Link to this definition"></a></dt>
<dd><p>Normal-distribution based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_AdaBoost.calculate_tercile_probabilities_weibull_min">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_weibull_min</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_AdaBoost.calculate_tercile_probabilities_weibull_min"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_AdaBoost.calculate_tercile_probabilities_weibull_min" title="Link to this definition"></a></dt>
<dd><p>Weibull minimum-based method.</p>
<dl class="simple">
<dt>Here, we assume:</dt><dd><ul class="simple">
<li><p>best_guess is used as the location,</p></li>
<li><p>error_std (sqrt(error_variance)) as the scale, and</p></li>
<li><p>dof (degrees of freedom) as the shape parameter.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>best_guess</strong> (<em>array-like</em>) – Forecast or best guess values.</p></li>
<li><p><strong>error_variance</strong> (<em>array-like</em>) – Variance associated with forecast errors.</p></li>
<li><p><strong>first_tercile</strong> (<em>array-like</em>) – First tercile threshold values.</p></li>
<li><p><strong>second_tercile</strong> (<em>array-like</em>) – Second tercile threshold values.</p></li>
<li><p><strong>dof</strong> (<em>float</em><em> or </em><em>array-like</em>) – Shape parameter for the Weibull minimum distribution.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>pred_prob</strong> – A 3 x n_time array with probabilities for being below the first tercile,
between the first and second tercile, and above the second tercile.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_AdaBoost.compute_model">
<span class="sig-name descname"><span class="pre">compute_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_AdaBoost.compute_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_AdaBoost.compute_model" title="Link to this definition"></a></dt>
<dd><p>Compute deterministic hindcast using the AdaBoost model.</p>
<p>Fits the AdaBoostRegressor on training data and predicts deterministic values for the test data.
Handles data stacking and NaN removal to ensure robust predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X_train</strong> (<em>xarray.DataArray</em>) – Training predictor data with dimensions (T, M, Y, X).</p></li>
<li><p><strong>y_train</strong> (<em>xarray.DataArray</em>) – Training predictand data with dimensions (T, Y, X).</p></li>
<li><p><strong>X_test</strong> (<em>xarray.DataArray</em>) – Testing predictor data with dimensions (T, M, Y, X).</p></li>
<li><p><strong>y_test</strong> (<em>xarray.DataArray</em>) – Testing predictand data with dimensions (T, Y, X).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predicted_da</strong> – Deterministic hindcast with dimensions (T, Y, X).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_AdaBoost.compute_prob">
<span class="sig-name descname"><span class="pre">compute_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_AdaBoost.compute_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_AdaBoost.compute_prob" title="Link to this definition"></a></dt>
<dd><p>Compute tercile probabilities using the chosen distribution method.
Predictant is expected to be an xarray DataArray with dims (T, Y, X).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_AdaBoost.forecast">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det_cross</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor_for_year</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_AdaBoost.forecast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_AdaBoost.forecast" title="Link to this definition"></a></dt>
<dd><p>Generate deterministic and probabilistic forecast for a target year using the AdaBoost model.</p>
<p>Fits the AdaBoostRegressor on standardized hindcast data, predicts deterministic values for the target year,
reverses standardization, and computes tercile probabilities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Predictant</strong> (<em>xarray.DataArray</em>) – Observed predictand data with dimensions (T, Y, X) or (T, M, Y, X).</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em><em> or </em><em>str</em>) – Start year of the climatology period.</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em><em> or </em><em>str</em>) – End year of the climatology period.</p></li>
<li><p><strong>hindcast_det</strong> (<em>xarray.DataArray</em>) – Deterministic hindcast data for training with dimensions (T, M, Y, X).</p></li>
<li><p><strong>hindcast_det_cross</strong> (<em>xarray.DataArray</em>) – Deterministic hindcast data for error estimation with dimensions (T, Y, X).</p></li>
<li><p><strong>Predictor_for_year</strong> (<em>xarray.DataArray</em>) – Predictor data for the target year with dimensions (T, M, Y, X).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>result_da</strong> (<em>xarray.DataArray</em>) – Deterministic forecast with dimensions (T, Y, X).</p></li>
<li><p><strong>hindcast_prob</strong> (<em>xarray.DataArray</em>) – Tercile probabilities with dimensions (probability, T, Y, X), where probability
includes [‘PB’, ‘PN’, ‘PA’] (below-normal, normal, above-normal).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_BMA">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_mme.</span></span><span class="sig-name descname"><span class="pre">WAS_mme_BMA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_hdcst_models</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_fcst_models</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gamma'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_metric_</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rmse'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_BMA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_BMA" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_BMA.calculate_tercile_probabilities">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_BMA.calculate_tercile_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_BMA.calculate_tercile_probabilities" title="Link to this definition"></a></dt>
<dd><p>Student’s t-based method</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_BMA.calculate_tercile_probabilities_gamma">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_BMA.calculate_tercile_probabilities_gamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_BMA.calculate_tercile_probabilities_gamma" title="Link to this definition"></a></dt>
<dd><p>Gamma-distribution based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_BMA.calculate_tercile_probabilities_lognormal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_lognormal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_BMA.calculate_tercile_probabilities_lognormal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_BMA.calculate_tercile_probabilities_lognormal" title="Link to this definition"></a></dt>
<dd><p>Lognormal-distribution based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_BMA.calculate_tercile_probabilities_nonparametric">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_nonparametric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_BMA.calculate_tercile_probabilities_nonparametric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_BMA.calculate_tercile_probabilities_nonparametric" title="Link to this definition"></a></dt>
<dd><p>Non-parametric method using historical error samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_BMA.calculate_tercile_probabilities_normal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_normal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_BMA.calculate_tercile_probabilities_normal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_BMA.calculate_tercile_probabilities_normal" title="Link to this definition"></a></dt>
<dd><p>Normal-distribution based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_BMA.calculate_tercile_probabilities_weibull_min">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_weibull_min</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_BMA.calculate_tercile_probabilities_weibull_min"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_BMA.calculate_tercile_probabilities_weibull_min" title="Link to this definition"></a></dt>
<dd><p>Weibull minimum-based method.</p>
<dl class="simple">
<dt>Here, we assume:</dt><dd><ul class="simple">
<li><p>best_guess is used as the location,</p></li>
<li><p>error_std (sqrt(error_variance)) as the scale, and</p></li>
<li><p>dof (degrees of freedom) as the shape parameter.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>best_guess</strong> (<em>array-like</em>) – Forecast or best guess values.</p></li>
<li><p><strong>error_variance</strong> (<em>array-like</em>) – Variance associated with forecast errors.</p></li>
<li><p><strong>first_tercile</strong> (<em>array-like</em>) – First tercile threshold values.</p></li>
<li><p><strong>second_tercile</strong> (<em>array-like</em>) – Second tercile threshold values.</p></li>
<li><p><strong>dof</strong> (<em>float</em><em> or </em><em>array-like</em>) – Shape parameter for the Weibull minimum distribution.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>pred_prob</strong> – A 3 x n_time array with probabilities for being below the first tercile,
between the first and second tercile, and above the second tercile.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_BMA.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">draws</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tune</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chains</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_accept</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'jitter+adapt_diag'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_BMA.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_BMA.compute" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>draws</strong> (<em>int</em>) – The number of samples (in each chain) to draw from the posterior.</p></li>
<li><p><strong>tune</strong> (<em>int</em>) – The number of tuning (burn-in) steps.</p></li>
<li><p><strong>chains</strong> (<em>int</em>) – The number of chains to run.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – Show progress.</p></li>
<li><p><strong>target_accept</strong> (<em>float</em>) – The target acceptance probability for the sampler.</p></li>
<li><p><strong>init</strong> (<em>str</em>) – The initialization method for PyMC’s sampler. E.g., “adapt_diag”, “jitter+adapt_diag”, “advi+adapt_diag”, “adapt_full”, “jitter+adapt_full”, “auto”.</p></li>
<li><p><strong>hindcasts</strong> (<em>Runs the BMA workflow on</em>) – <ol class="arabic simple">
<li><p>compute_rmse_based_prior</p></li>
<li><p>fit_models_pymc</p></li>
<li><p>compute_model_posterior_probs</p></li>
</ol>
</p></li>
<li><p><strong>(</strong><strong>T</strong> (<em>Returns in-sample predictions as an xarray.DataArray</em>)</p></li>
<li><p><strong>Y</strong></p></li>
<li><p><strong>X</strong><strong>)</strong><strong>.</strong></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_BMA.compute_prob">
<span class="sig-name descname"><span class="pre">compute_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_BMA.compute_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_BMA.compute_prob" title="Link to this definition"></a></dt>
<dd><p>Compute tercile probabilities for the hindcast using the chosen distribution method.
Predictant is an xarray DataArray with dims (T, Y, X).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_BMA.forecast">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_BMA.forecast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_BMA.forecast" title="Link to this definition"></a></dt>
<dd><p>Apply BMA offset+scale weights to future forecasts, returning an xarray.DataArray (T, Y, X).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_BMA.summary">
<span class="sig-name descname"><span class="pre">summary</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_BMA.summary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_BMA.summary" title="Link to this definition"></a></dt>
<dd><p>Print BMA summary information.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_ELM">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_mme.</span></span><span class="sig-name descname"><span class="pre">WAS_mme_ELM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elm_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gamma'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_ELM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_ELM" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Extreme Learning Machine (ELM) for Multi-Model Ensemble (MME) forecasting derived from xcast.</p>
<p>This class implements an Extreme Learning Machine model for deterministic forecasting,
with optional tercile probability calculations using various statistical distributions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>elm_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keyword arguments to pass to the xcast ELM model. If None, default parameters are used:
{‘regularization’: 10, ‘hidden_layer_size’: 5, ‘activation’: ‘lin’, ‘preprocessing’: ‘none’, ‘n_estimators’: 5}.
Default is None.</p></li>
<li><p><strong>dist_method</strong> (<em>str</em><em>, </em><em>optional</em>) – Distribution method for tercile probability calculations (‘t’, ‘gamma’, ‘nonparam’, ‘normal’, ‘lognormal’, ‘weibull_min’).
Default is ‘gamma’.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_ELM.calculate_tercile_probabilities">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_ELM.calculate_tercile_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_ELM.calculate_tercile_probabilities" title="Link to this definition"></a></dt>
<dd><p>Student’s t-based method</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_ELM.calculate_tercile_probabilities_gamma">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_ELM.calculate_tercile_probabilities_gamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_ELM.calculate_tercile_probabilities_gamma" title="Link to this definition"></a></dt>
<dd><p>Gamma-distribution based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_ELM.calculate_tercile_probabilities_lognormal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_lognormal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_ELM.calculate_tercile_probabilities_lognormal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_ELM.calculate_tercile_probabilities_lognormal" title="Link to this definition"></a></dt>
<dd><p>Lognormal-distribution based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_ELM.calculate_tercile_probabilities_nonparametric">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_nonparametric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_ELM.calculate_tercile_probabilities_nonparametric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_ELM.calculate_tercile_probabilities_nonparametric" title="Link to this definition"></a></dt>
<dd><p>Non-parametric method using historical error samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_ELM.calculate_tercile_probabilities_normal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_normal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_ELM.calculate_tercile_probabilities_normal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_ELM.calculate_tercile_probabilities_normal" title="Link to this definition"></a></dt>
<dd><p>Normal-distribution based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_ELM.calculate_tercile_probabilities_weibull_min">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_weibull_min</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_ELM.calculate_tercile_probabilities_weibull_min"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_ELM.calculate_tercile_probabilities_weibull_min" title="Link to this definition"></a></dt>
<dd><p>Weibull minimum-based method.</p>
<dl class="simple">
<dt>Here, we assume:</dt><dd><ul class="simple">
<li><p>best_guess is used as the location,</p></li>
<li><p>error_std (sqrt(error_variance)) as the scale, and</p></li>
<li><p>dof (degrees of freedom) as the shape parameter.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>best_guess</strong> (<em>array-like</em>) – Forecast or best guess values.</p></li>
<li><p><strong>error_variance</strong> (<em>array-like</em>) – Variance associated with forecast errors.</p></li>
<li><p><strong>first_tercile</strong> (<em>array-like</em>) – First tercile threshold values.</p></li>
<li><p><strong>second_tercile</strong> (<em>array-like</em>) – Second tercile threshold values.</p></li>
<li><p><strong>dof</strong> (<em>float</em><em> or </em><em>array-like</em>) – Shape parameter for the Weibull minimum distribution.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>pred_prob</strong> – A 3 x n_time array with probabilities for being below the first tercile,
between the first and second tercile, and above the second tercile.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_ELM.compute_model">
<span class="sig-name descname"><span class="pre">compute_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_ELM.compute_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_ELM.compute_model" title="Link to this definition"></a></dt>
<dd><p>Compute deterministic hindcast using the ELM model.</p>
<p>Fits the ELM model on training data and predicts deterministic values for the test data.
Applies regridding and drymasking to ensure data consistency.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X_train</strong> (<em>xarray.DataArray</em>) – Training predictor data with dimensions (T, M, Y, X).</p></li>
<li><p><strong>y_train</strong> (<em>xarray.DataArray</em>) – Training predictand data with dimensions (T, Y, X).</p></li>
<li><p><strong>X_test</strong> (<em>xarray.DataArray</em>) – Testing predictor data with dimensions (T, M, Y, X).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>result_</strong> – Deterministic hindcast with dimensions (T, Y, X).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_ELM.compute_prob">
<span class="sig-name descname"><span class="pre">compute_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_ELM.compute_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_ELM.compute_prob" title="Link to this definition"></a></dt>
<dd><p>Compute tercile probabilities for hindcast data.</p>
<p>Calculates probabilities for below-normal, normal, and above-normal categories using
the specified distribution method, based on climatological terciles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Predictant</strong> (<em>xarray.DataArray</em>) – Observed predictand data with dimensions (T, Y, X).</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em><em> or </em><em>str</em>) – Start year of the climatology period.</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em><em> or </em><em>str</em>) – End year of the climatology period.</p></li>
<li><p><strong>hindcast_det</strong> (<em>xarray.DataArray</em>) – Deterministic hindcast data with dimensions (T, Y, X).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>hindcast_prob</strong> – Tercile probabilities with dimensions (probability, T, Y, X), where probability
includes [‘PB’, ‘PN’, ‘PA’] (below-normal, normal, above-normal).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_ELM.forecast">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det_cross_val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor_for_year</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_ELM.forecast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_ELM.forecast" title="Link to this definition"></a></dt>
<dd><p>Generate deterministic and probabilistic forecast for a target year using the ELM model.</p>
<p>Fits the ELM model on hindcast data, predicts deterministic values for the target year,
and computes tercile probabilities. Applies regridding, drymasking, and standardization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Predictant</strong> (<em>xarray.DataArray</em>) – Observed predictand data with dimensions (T, Y, X) or (T, M, Y, X).</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em><em> or </em><em>str</em>) – Start year of the climatology period.</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em><em> or </em><em>str</em>) – End year of the climatology period.</p></li>
<li><p><strong>hindcast_det</strong> (<em>xarray.DataArray</em>) – Deterministic hindcast data for training with dimensions (T, M, Y, X).</p></li>
<li><p><strong>hindcast_det_cross_val</strong> (<em>xarray.DataArray</em>) – Deterministic hindcast data for error estimation with dimensions (T, Y, X).</p></li>
<li><p><strong>Predictor_for_year</strong> (<em>xarray.DataArray</em>) – Predictor data for the target year with dimensions (T, M, Y, X).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>result_</strong> (<em>xarray.DataArray</em>) – Deterministic forecast with dimensions (T, Y, X).</p></li>
<li><p><strong>hindcast_prob</strong> (<em>xarray.DataArray</em>) – Tercile probabilities with dimensions (probability, T, Y, X), where probability
includes [‘PB’, ‘PN’, ‘PA’] (below-normal, normal, above-normal).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_ELR">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_mme.</span></span><span class="sig-name descname"><span class="pre">WAS_mme_ELR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elm_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_ELR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_ELR" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Extended Logistic Regression (ELR) for Multi-Model Ensemble (MME) forecasting derived from xcast package.</p>
<p>This class implements an Extended Logistic Regression for probabilistic forecasting,
directly computing tercile probabilities without requiring separate probability calculations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>elm_kwargs</strong> (<em>dict</em><em>, </em><em>optional</em>) – Keyword arguments to pass to the xcast ELR model. If None, an empty dictionary is used.
Default is None.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_ELR.compute_model">
<span class="sig-name descname"><span class="pre">compute_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_ELR.compute_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_ELR.compute_model" title="Link to this definition"></a></dt>
<dd><p>Compute probabilistic hindcast using the ELR model.</p>
<p>Fits the ELR model on training data and predicts tercile probabilities for the test data.
Applies regridding and drymasking to ensure data consistency.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X_train</strong> (<em>xarray.DataArray</em>) – Training predictor data with dimensions (T, M, Y, X).</p></li>
<li><p><strong>y_train</strong> (<em>xarray.DataArray</em>) – Training predictand data with dimensions (T, Y, X).</p></li>
<li><p><strong>X_test</strong> (<em>xarray.DataArray</em>) – Testing predictor data with dimensions (T, M, Y, X).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>result_</strong> – Tercile probabilities with dimensions (probability, T, Y, X), where probability
includes [‘PB’, ‘PN’, ‘PA’] (below-normal, normal, above-normal).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_ELR.forecast">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor_for_year</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_ELR.forecast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_ELR.forecast" title="Link to this definition"></a></dt>
<dd><p>Generate probabilistic forecast for a target year using the ELR model.</p>
<p>Fits the ELR model on hindcast data and predicts tercile probabilities for the target year.
Applies regridding and drymasking to ensure data consistency.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Predictant</strong> (<em>xarray.DataArray</em>) – Observed predictand data with dimensions (T, Y, X) or (T, M, Y, X).</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em><em> or </em><em>str</em>) – Start year of the climatology period (not used in this method).</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em><em> or </em><em>str</em>) – End year of the climatology period (not used in this method).</p></li>
<li><p><strong>hindcast_det</strong> (<em>xarray.DataArray</em>) – Deterministic hindcast data with dimensions (T, M, Y, X).</p></li>
<li><p><strong>Predictor_for_year</strong> (<em>xarray.DataArray</em>) – Predictor data for the target year with dimensions (T, M, Y, X).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>hindcast_prob</strong> – Tercile probabilities with dimensions (probability, T, Y, X), where probability
includes [‘PB’, ‘PN’, ‘PA’] (below-normal, normal, above-normal).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_GA">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_mme.</span></span><span class="sig-name descname"><span class="pre">WAS_mme_GA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">population_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crossover_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mutation_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gamma'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_GA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_GA" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Genetic Algorithm-based Multi-Model Ensemble Weighting.</p>
<p>Uses a Genetic Algorithm to optimize weights for combining multiple climate models,
minimizing the mean squared error (MSE) against observations. Supports tercile probability
calculations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>population_size</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of individuals in the GA population. Default is 20.</p></li>
<li><p><strong>max_iter</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum number of generations for the GA. Default is 50.</p></li>
<li><p><strong>crossover_rate</strong> (<em>float</em><em>, </em><em>optional</em>) – Probability of performing crossover. Default is 0.7.</p></li>
<li><p><strong>mutation_rate</strong> (<em>float</em><em>, </em><em>optional</em>) – Probability of mutating a gene. Default is 0.01.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>optional</em>) – Seed for random number generation. Default is 42.</p></li>
<li><p><strong>dist_method</strong> (<em>str</em><em>, </em><em>optional</em>) – Distribution method for probability calculations (‘t’, ‘gamma’, ‘nonparam’,
‘normal’, ‘lognormal’, ‘weibull_min’). Default is ‘gamma’.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_GA.calculate_tercile_probabilities">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_GA.calculate_tercile_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_GA.calculate_tercile_probabilities" title="Link to this definition"></a></dt>
<dd><p>Student’s t-based method for tercile probabilities.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_GA.calculate_tercile_probabilities_gamma">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_GA.calculate_tercile_probabilities_gamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_GA.calculate_tercile_probabilities_gamma" title="Link to this definition"></a></dt>
<dd><p>Gamma-distribution based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_GA.calculate_tercile_probabilities_lognormal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_lognormal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_GA.calculate_tercile_probabilities_lognormal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_GA.calculate_tercile_probabilities_lognormal" title="Link to this definition"></a></dt>
<dd><p>Lognormal-distribution based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_GA.calculate_tercile_probabilities_nonparametric">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_nonparametric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_GA.calculate_tercile_probabilities_nonparametric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_GA.calculate_tercile_probabilities_nonparametric" title="Link to this definition"></a></dt>
<dd><p>Non-parametric method using historical error samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_GA.calculate_tercile_probabilities_normal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_normal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_GA.calculate_tercile_probabilities_normal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_GA.calculate_tercile_probabilities_normal" title="Link to this definition"></a></dt>
<dd><p>Normal-distribution based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_GA.calculate_tercile_probabilities_weibull_min">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_weibull_min</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_GA.calculate_tercile_probabilities_weibull_min"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_GA.calculate_tercile_probabilities_weibull_min" title="Link to this definition"></a></dt>
<dd><p>Weibull minimum-based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_GA.compute_model">
<span class="sig-name descname"><span class="pre">compute_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_GA.compute_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_GA.compute_model" title="Link to this definition"></a></dt>
<dd><p>Train the GA and predict on test data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X_train</strong> (<em>xarray.DataArray</em>) – Training predictor data with dimensions (T, Y, X, M).</p></li>
<li><p><strong>y_train</strong> (<em>xarray.DataArray</em>) – Training predictand data with dimensions (T, Y, X).</p></li>
<li><p><strong>X_test</strong> (<em>xarray.DataArray</em>) – Testing predictor data with dimensions (T, Y, X, M).</p></li>
<li><p><strong>y_test</strong> (<em>xarray.DataArray</em>) – Testing predictand data with dimensions (T, Y, X).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predicted_da</strong> – Predictions with dimensions (T, Y, X).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_GA.compute_prob">
<span class="sig-name descname"><span class="pre">compute_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_GA.compute_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_GA.compute_prob" title="Link to this definition"></a></dt>
<dd><p>Compute tercile probabilities for hindcast data using the GA-optimized weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Predictant</strong> (<em>xarray.DataArray</em>) – Observed predictand data with dimensions (T, Y, X).</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em><em> or </em><em>str</em>) – Start year of the climatology period.</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em><em> or </em><em>str</em>) – End year of the climatology period.</p></li>
<li><p><strong>hindcast_det</strong> (<em>xarray.DataArray</em>) – Deterministic hindcast data with dimensions (T, Y, X).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>hindcast_prob</strong> – Tercile probabilities with dimensions (probability, T, Y, X).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_GA.forecast">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det_cross</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor_for_year</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_GA.forecast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_GA.forecast" title="Link to this definition"></a></dt>
<dd><p>Forecast for a target year and compute tercile probabilities.</p>
<p>Standardizes data, fits the GA, predicts for the target year, and computes probabilities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Predictant</strong> (<em>xarray.DataArray</em>) – Historical predictand data with dimensions (T, Y, X).</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em><em> or </em><em>str</em>) – Start year of the climatology period.</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em><em> or </em><em>str</em>) – End year of the climatology period.</p></li>
<li><p><strong>hindcast_det</strong> (<em>xarray.DataArray</em>) – Deterministic hindcast data for training with dimensions (T, Y, X, M).</p></li>
<li><p><strong>hindcast_det_cross</strong> (<em>xarray.DataArray</em>) – Deterministic hindcast data for error estimation with dimensions (T, Y, X).</p></li>
<li><p><strong>Predictor_for_year</strong> (<em>xarray.DataArray</em>) – Predictor data for the target year with dimensions (T, Y, X, M).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>result_da</strong> (<em>xarray.DataArray</em>) – Deterministic forecast with dimensions (T, Y, X).</p></li>
<li><p><strong>hindcast_prob</strong> (<em>xarray.DataArray</em>) – Tercile probability forecast with dimensions (probability, T, Y, X).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_GradientBoosting">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_mme.</span></span><span class="sig-name descname"><span class="pre">WAS_mme_GradientBoosting</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_estimators</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gamma'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_GradientBoosting"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_GradientBoosting" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_GradientBoosting.calculate_tercile_probabilities">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_GradientBoosting.calculate_tercile_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_GradientBoosting.calculate_tercile_probabilities" title="Link to this definition"></a></dt>
<dd><p>Student’s t-based method</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_GradientBoosting.calculate_tercile_probabilities_gamma">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_GradientBoosting.calculate_tercile_probabilities_gamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_GradientBoosting.calculate_tercile_probabilities_gamma" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_GradientBoosting.calculate_tercile_probabilities_lognormal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_lognormal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_GradientBoosting.calculate_tercile_probabilities_lognormal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_GradientBoosting.calculate_tercile_probabilities_lognormal" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_GradientBoosting.calculate_tercile_probabilities_nonparametric">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_nonparametric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_GradientBoosting.calculate_tercile_probabilities_nonparametric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_GradientBoosting.calculate_tercile_probabilities_nonparametric" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_GradientBoosting.calculate_tercile_probabilities_normal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_normal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_GradientBoosting.calculate_tercile_probabilities_normal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_GradientBoosting.calculate_tercile_probabilities_normal" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_GradientBoosting.calculate_tercile_probabilities_weibull_min">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_weibull_min</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_GradientBoosting.calculate_tercile_probabilities_weibull_min"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_GradientBoosting.calculate_tercile_probabilities_weibull_min" title="Link to this definition"></a></dt>
<dd><p>Weibull minimum-based method.</p>
<dl class="simple">
<dt>Here, we assume:</dt><dd><ul class="simple">
<li><p>best_guess is used as the location,</p></li>
<li><p>error_std (sqrt(error_variance)) as the scale, and</p></li>
<li><p>dof (degrees of freedom) as the shape parameter.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>best_guess</strong> (<em>array-like</em>) – Forecast or best guess values.</p></li>
<li><p><strong>error_variance</strong> (<em>array-like</em>) – Variance associated with forecast errors.</p></li>
<li><p><strong>first_tercile</strong> (<em>array-like</em>) – First tercile threshold values.</p></li>
<li><p><strong>second_tercile</strong> (<em>array-like</em>) – Second tercile threshold values.</p></li>
<li><p><strong>dof</strong> (<em>float</em><em> or </em><em>array-like</em>) – Shape parameter for the Weibull minimum distribution.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>pred_prob</strong> – A 3 x n_time array with probabilities for being below the first tercile,
between the first and second tercile, and above the second tercile.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_GradientBoosting.compute_model">
<span class="sig-name descname"><span class="pre">compute_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_GradientBoosting.compute_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_GradientBoosting.compute_model" title="Link to this definition"></a></dt>
<dd><p>Fit the GradientBoostingRegressor on the training data and predict on X_test.
The input data (xarray DataArrays) are assumed to have dimensions including ‘T’, ‘Y’, ‘X’.
The predictions are then reshaped back to (T, Y, X).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_GradientBoosting.compute_prob">
<span class="sig-name descname"><span class="pre">compute_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_GradientBoosting.compute_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_GradientBoosting.compute_prob" title="Link to this definition"></a></dt>
<dd><p>Compute tercile probabilities using the chosen distribution method.
Predictant is expected to be an xarray DataArray with dims (T, Y, X).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_GradientBoosting.forecast">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det_cross</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor_for_year</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_GradientBoosting.forecast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_GradientBoosting.forecast" title="Link to this definition"></a></dt>
<dd><p>Forecast method using a single MLP model.
Steps:</p>
<blockquote>
<div><ul class="simple">
<li><p>Standardize the predictor for the target year using hindcast climatology.</p></li>
<li><p>Fit the MLP (if not already fitted) on standardized hindcast data.</p></li>
<li><p>Predict for the target year.</p></li>
<li><p>Reconstruct predictions into original (T, Y, X) shape.</p></li>
<li><p>Reverse the standardization.</p></li>
<li><p>Compute tercile probabilities using the chosen distribution.</p></li>
</ul>
</div></blockquote>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_LGBM_Boosting">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_mme.</span></span><span class="sig-name descname"><span class="pre">WAS_mme_LGBM_Boosting</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_estimators</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gamma'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_LGBM_Boosting"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_LGBM_Boosting" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>LightGBM-based Multi-Model Ensemble (MME) forecasting.</p>
<p>This class implements a single-model forecasting approach using LightGBM’s LGBMRegressor
for deterministic predictions, with optional tercile probability calculations using
various statistical distributions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_estimators</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of boosting iterations. Default is 100.</p></li>
<li><p><strong>learning_rate</strong> (<em>float</em><em>, </em><em>optional</em>) – Learning rate for boosting. Default is 0.1.</p></li>
<li><p><strong>max_depth</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum tree depth (-1 for no limit). Default is -1.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>optional</em>) – Seed for random number generation for reproducibility. Default is 42.</p></li>
<li><p><strong>dist_method</strong> (<em>str</em><em>, </em><em>optional</em>) – Distribution method for tercile probability calculations
(‘t’, ‘gamma’, ‘nonparam’, ‘normal’, ‘lognormal’, ‘weibull_min’).
Default is ‘gamma’.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_LGBM_Boosting.calculate_tercile_probabilities">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_LGBM_Boosting.calculate_tercile_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_LGBM_Boosting.calculate_tercile_probabilities" title="Link to this definition"></a></dt>
<dd><p>Student’s t-based method</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_LGBM_Boosting.calculate_tercile_probabilities_gamma">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_LGBM_Boosting.calculate_tercile_probabilities_gamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_LGBM_Boosting.calculate_tercile_probabilities_gamma" title="Link to this definition"></a></dt>
<dd><p>Gamma-distribution based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_LGBM_Boosting.calculate_tercile_probabilities_lognormal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_lognormal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_LGBM_Boosting.calculate_tercile_probabilities_lognormal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_LGBM_Boosting.calculate_tercile_probabilities_lognormal" title="Link to this definition"></a></dt>
<dd><p>Lognormal-distribution based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_LGBM_Boosting.calculate_tercile_probabilities_nonparametric">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_nonparametric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_LGBM_Boosting.calculate_tercile_probabilities_nonparametric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_LGBM_Boosting.calculate_tercile_probabilities_nonparametric" title="Link to this definition"></a></dt>
<dd><p>Non-parametric method using historical error samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_LGBM_Boosting.calculate_tercile_probabilities_normal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_normal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_LGBM_Boosting.calculate_tercile_probabilities_normal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_LGBM_Boosting.calculate_tercile_probabilities_normal" title="Link to this definition"></a></dt>
<dd><p>Normal-distribution based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_LGBM_Boosting.calculate_tercile_probabilities_weibull_min">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_weibull_min</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_LGBM_Boosting.calculate_tercile_probabilities_weibull_min"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_LGBM_Boosting.calculate_tercile_probabilities_weibull_min" title="Link to this definition"></a></dt>
<dd><p>Weibull minimum-based method.</p>
<dl class="simple">
<dt>Here, we assume:</dt><dd><ul class="simple">
<li><p>best_guess is used as the location,</p></li>
<li><p>error_std (sqrt(error_variance)) as the scale, and</p></li>
<li><p>dof (degrees of freedom) as the shape parameter.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>best_guess</strong> (<em>array-like</em>) – Forecast or best guess values.</p></li>
<li><p><strong>error_variance</strong> (<em>array-like</em>) – Variance associated with forecast errors.</p></li>
<li><p><strong>first_tercile</strong> (<em>array-like</em>) – First tercile threshold values.</p></li>
<li><p><strong>second_tercile</strong> (<em>array-like</em>) – Second tercile threshold values.</p></li>
<li><p><strong>dof</strong> (<em>float</em><em> or </em><em>array-like</em>) – Shape parameter for the Weibull minimum distribution.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>pred_prob</strong> – A 3 x n_time array with probabilities for being below the first tercile,
between the first and second tercile, and above the second tercile.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_LGBM_Boosting.compute_model">
<span class="sig-name descname"><span class="pre">compute_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_LGBM_Boosting.compute_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_LGBM_Boosting.compute_model" title="Link to this definition"></a></dt>
<dd><p>Compute deterministic hindcast using the LightGBM model.</p>
<p>Fits the LGBMRegressor on training data and predicts deterministic values for the test data.
Handles data stacking and NaN removal to ensure robust predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X_train</strong> (<em>xarray.DataArray</em>) – Training predictor data with dimensions (T, M, Y, X).</p></li>
<li><p><strong>y_train</strong> (<em>xarray.DataArray</em>) – Training predictand data with dimensions (T, Y, X).</p></li>
<li><p><strong>X_test</strong> (<em>xarray.DataArray</em>) – Testing predictor data with dimensions (T, M, Y, X).</p></li>
<li><p><strong>y_test</strong> (<em>xarray.DataArray</em>) – Testing predictand data with dimensions (T, Y, X).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predicted_da</strong> – Deterministic hindcast with dimensions (T, Y, X).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_LGBM_Boosting.compute_prob">
<span class="sig-name descname"><span class="pre">compute_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_LGBM_Boosting.compute_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_LGBM_Boosting.compute_prob" title="Link to this definition"></a></dt>
<dd><p>Compute tercile probabilities using the chosen distribution method.
Predictant is expected to be an xarray DataArray with dims (T, Y, X).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_LGBM_Boosting.forecast">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det_cross</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor_for_year</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_LGBM_Boosting.forecast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_LGBM_Boosting.forecast" title="Link to this definition"></a></dt>
<dd><p>Generate deterministic and probabilistic forecast for a target year using the LightGBM model.</p>
<p>Fits the LGBMRegressor on standardized hindcast data, predicts deterministic values for the target year,
reverses standardization, and computes tercile probabilities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Predictant</strong> (<em>xarray.DataArray</em>) – Observed predictand data with dimensions (T, Y, X) or (T, M, Y, X).</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em><em> or </em><em>str</em>) – Start year of the climatology period.</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em><em> or </em><em>str</em>) – End year of the climatology period.</p></li>
<li><p><strong>hindcast_det</strong> (<em>xarray.DataArray</em>) – Deterministic hindcast data for training with dimensions (T, M, Y, X).</p></li>
<li><p><strong>hindcast_det_cross</strong> (<em>xarray.DataArray</em>) – Deterministic hindcast data for error estimation with dimensions (T, Y, X).</p></li>
<li><p><strong>Predictor_for_year</strong> (<em>xarray.DataArray</em>) – Predictor data for the target year with dimensions (T, M, Y, X).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>result_da</strong> (<em>xarray.DataArray</em>) – Deterministic forecast with dimensions (T, Y, X).</p></li>
<li><p><strong>hindcast_prob</strong> (<em>xarray.DataArray</em>) – Tercile probabilities with dimensions (probability, T, Y, X), where probability
includes [‘PB’, ‘PN’, ‘PA’] (below-normal, normal, above-normal).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_MLP">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_mme.</span></span><span class="sig-name descname"><span class="pre">WAS_mme_MLP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hidden_layer_sizes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(10,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'adam'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gamma'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_MLP"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_MLP" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Multi-Layer Perceptron (MLP) for Multi-Model Ensemble (MME) forecasting.</p>
<p>This class implements a Multi-Layer Perceptron model using scikit-learn’s MLPRegressor
for deterministic forecasting, with optional tercile probability calculations using
various statistical distributions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hidden_layer_sizes</strong> (<em>tuple</em><em>, </em><em>optional</em>) – Sizes of the hidden layers in the MLP (e.g., (10, 5)). Default is (10, 5).</p></li>
<li><p><strong>activation</strong> (<em>str</em><em>, </em><em>optional</em>) – Activation function for the hidden layers (‘identity’, ‘logistic’, ‘tanh’, ‘relu’).
Default is ‘relu’.</p></li>
<li><p><strong>solver</strong> (<em>str</em><em>, </em><em>optional</em>) – Optimization algorithm (‘lbfgs’, ‘sgd’, ‘adam’). Default is ‘adam’.</p></li>
<li><p><strong>max_iter</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum number of iterations for the solver. Default is 200.</p></li>
<li><p><strong>alpha</strong> (<em>float</em><em>, </em><em>optional</em>) – L2 regularization parameter. Default is 0.01.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>optional</em>) – Seed for random number generation for reproducibility. Default is 42.</p></li>
<li><p><strong>dist_method</strong> (<em>str</em><em>, </em><em>optional</em>) – Distribution method for tercile probability calculations (‘t’, ‘gamma’, ‘nonparam’, ‘normal’, ‘lognormal’, ‘weibull_min’).
Default is ‘gamma’.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_MLP.calculate_tercile_probabilities">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_MLP.calculate_tercile_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_MLP.calculate_tercile_probabilities" title="Link to this definition"></a></dt>
<dd><p>Student’s t-based method</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_MLP.calculate_tercile_probabilities_gamma">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_MLP.calculate_tercile_probabilities_gamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_MLP.calculate_tercile_probabilities_gamma" title="Link to this definition"></a></dt>
<dd><p>Gamma-distribution based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_MLP.calculate_tercile_probabilities_lognormal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_lognormal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_MLP.calculate_tercile_probabilities_lognormal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_MLP.calculate_tercile_probabilities_lognormal" title="Link to this definition"></a></dt>
<dd><p>Lognormal-distribution based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_MLP.calculate_tercile_probabilities_nonparametric">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_nonparametric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_MLP.calculate_tercile_probabilities_nonparametric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_MLP.calculate_tercile_probabilities_nonparametric" title="Link to this definition"></a></dt>
<dd><p>Non-parametric method using historical error samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_MLP.calculate_tercile_probabilities_normal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_normal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_MLP.calculate_tercile_probabilities_normal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_MLP.calculate_tercile_probabilities_normal" title="Link to this definition"></a></dt>
<dd><p>Normal-distribution based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_MLP.calculate_tercile_probabilities_weibull_min">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_weibull_min</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_MLP.calculate_tercile_probabilities_weibull_min"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_MLP.calculate_tercile_probabilities_weibull_min" title="Link to this definition"></a></dt>
<dd><p>Weibull minimum-based method.</p>
<dl class="simple">
<dt>Here, we assume:</dt><dd><ul class="simple">
<li><p>best_guess is used as the location,</p></li>
<li><p>error_std (sqrt(error_variance)) as the scale, and</p></li>
<li><p>dof (degrees of freedom) as the shape parameter.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>best_guess</strong> (<em>array-like</em>) – Forecast or best guess values.</p></li>
<li><p><strong>error_variance</strong> (<em>array-like</em>) – Variance associated with forecast errors.</p></li>
<li><p><strong>first_tercile</strong> (<em>array-like</em>) – First tercile threshold values.</p></li>
<li><p><strong>second_tercile</strong> (<em>array-like</em>) – Second tercile threshold values.</p></li>
<li><p><strong>dof</strong> (<em>float</em><em> or </em><em>array-like</em>) – Shape parameter for the Weibull minimum distribution.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>pred_prob</strong> – A 3 x n_time array with probabilities for being below the first tercile,
between the first and second tercile, and above the second tercile.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_MLP.compute_model">
<span class="sig-name descname"><span class="pre">compute_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_MLP.compute_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_MLP.compute_model" title="Link to this definition"></a></dt>
<dd><p>Compute deterministic hindcast using the MLP model.</p>
<p>Fits the MLPRegressor on training data and predicts deterministic values for the test data.
Handles data stacking and NaN removal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X_train</strong> (<em>xarray.DataArray</em>) – Training predictor data with dimensions (T, M, Y, X).</p></li>
<li><p><strong>y_train</strong> (<em>xarray.DataArray</em>) – Training predictand data with dimensions (T, Y, X).</p></li>
<li><p><strong>X_test</strong> (<em>xarray.DataArray</em>) – Testing predictor data with dimensions (T, M, Y, X).</p></li>
<li><p><strong>y_test</strong> (<em>xarray.DataArray</em>) – Testing predictand data with dimensions (T, Y, X).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predicted_da</strong> – Deterministic hindcast with dimensions (T, Y, X).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_MLP.compute_prob">
<span class="sig-name descname"><span class="pre">compute_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_MLP.compute_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_MLP.compute_prob" title="Link to this definition"></a></dt>
<dd><p>Compute tercile probabilities for the hindcast using the chosen distribution method.
Predictant is an xarray DataArray with dims (T, Y, X).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_MLP.forecast">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det_cross</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor_for_year</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_MLP.forecast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_MLP.forecast" title="Link to this definition"></a></dt>
<dd><p>Generate deterministic and probabilistic forecast for a target year using the MLP model.</p>
<p>Fits the MLPRegressor on standardized hindcast data, predicts deterministic values for the target year,
reverses standardization, and computes tercile probabilities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Predictant</strong> (<em>xarray.DataArray</em>) – Observed predictand data with dimensions (T, Y, X) or (T, M, Y, X).</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em><em> or </em><em>str</em>) – Start year of the climatology period.</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em><em> or </em><em>str</em>) – End year of the climatology period.</p></li>
<li><p><strong>hindcast_det</strong> (<em>xarray.DataArray</em>) – Deterministic hindcast data for training with dimensions (T, M, Y, X).</p></li>
<li><p><strong>hindcast_det_cross</strong> (<em>xarray.DataArray</em>) – Deterministic hindcast data for error estimation with dimensions (T, Y, X).</p></li>
<li><p><strong>Predictor_for_year</strong> (<em>xarray.DataArray</em>) – Predictor data for the target year with dimensions (T, M, Y, X).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>result_da</strong> (<em>xarray.DataArray</em>) – Deterministic forecast with dimensions (T, Y, X).</p></li>
<li><p><strong>hindcast_prob</strong> (<em>xarray.DataArray</em>) – Tercile probabilities with dimensions (probability, T, Y, X), where probability
includes [‘PB’, ‘PN’, ‘PA’] (below-normal, normal, above-normal).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_StackXGboost_Ml">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_mme.</span></span><span class="sig-name descname"><span class="pre">WAS_mme_StackXGboost_Ml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_estimators</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gamma'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_StackXGboost_Ml"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_StackXGboost_Ml" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Stacking ensemble with XGBoost base model and Linear Regression meta-model for Multi-Model Ensemble (MME) forecasting.</p>
<p>This class implements a stacking ensemble using XGBRegressor as the base model,
with a LinearRegression meta-model, for deterministic forecasting and optional tercile probability calculations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_estimators</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of gradient boosted trees in XGBoost. Default is 100.</p></li>
<li><p><strong>max_depth</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum depth of each tree in XGBoost. Default is 3.</p></li>
<li><p><strong>learning_rate</strong> (<em>float</em><em>, </em><em>optional</em>) – Boosting learning rate for XGBoost. Default is 0.1.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>optional</em>) – Seed for random number generation for reproducibility. Default is 42.</p></li>
<li><p><strong>dist_method</strong> (<em>str</em><em>, </em><em>optional</em>) – Distribution method for tercile probability calculations
(‘t’, ‘gamma’, ‘nonparam’, ‘normal’, ‘lognormal’, ‘weibull_min’). Default is ‘gamma’.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_StackXGboost_Ml.calculate_tercile_probabilities">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_StackXGboost_Ml.calculate_tercile_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_StackXGboost_Ml.calculate_tercile_probabilities" title="Link to this definition"></a></dt>
<dd><p>Student’s t-based method</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_StackXGboost_Ml.calculate_tercile_probabilities_gamma">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_StackXGboost_Ml.calculate_tercile_probabilities_gamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_StackXGboost_Ml.calculate_tercile_probabilities_gamma" title="Link to this definition"></a></dt>
<dd><p>Gamma-distribution based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_StackXGboost_Ml.calculate_tercile_probabilities_lognormal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_lognormal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_StackXGboost_Ml.calculate_tercile_probabilities_lognormal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_StackXGboost_Ml.calculate_tercile_probabilities_lognormal" title="Link to this definition"></a></dt>
<dd><p>Lognormal-distribution based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_StackXGboost_Ml.calculate_tercile_probabilities_nonparametric">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_nonparametric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_StackXGboost_Ml.calculate_tercile_probabilities_nonparametric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_StackXGboost_Ml.calculate_tercile_probabilities_nonparametric" title="Link to this definition"></a></dt>
<dd><p>Non-parametric method using historical error samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_StackXGboost_Ml.calculate_tercile_probabilities_normal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_normal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_StackXGboost_Ml.calculate_tercile_probabilities_normal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_StackXGboost_Ml.calculate_tercile_probabilities_normal" title="Link to this definition"></a></dt>
<dd><p>Normal-distribution based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_StackXGboost_Ml.calculate_tercile_probabilities_weibull_min">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_weibull_min</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_StackXGboost_Ml.calculate_tercile_probabilities_weibull_min"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_StackXGboost_Ml.calculate_tercile_probabilities_weibull_min" title="Link to this definition"></a></dt>
<dd><p>Weibull minimum-based method.</p>
<dl class="simple">
<dt>Here, we assume:</dt><dd><ul class="simple">
<li><p>best_guess is used as the location,</p></li>
<li><p>error_std (sqrt(error_variance)) as the scale, and</p></li>
<li><p>dof (degrees of freedom) as the shape parameter.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_StackXGboost_Ml.compute_model">
<span class="sig-name descname"><span class="pre">compute_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_StackXGboost_Ml.compute_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_StackXGboost_Ml.compute_model" title="Link to this definition"></a></dt>
<dd><p>Train a stacking regressor with XGBoost as the base model and
Linear Regression as the meta-model, then generate deterministic
predictions on X_test.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X_train</strong> (<em>xarray.DataArray</em>) – Predictor training data with dimensions (T, Y, X, M) or (T, Y, X).</p></li>
<li><p><strong>y_train</strong> (<em>xarray.DataArray</em>) – Predictand training data with dimensions (T, Y, X, M) or (T, Y, X).</p></li>
<li><p><strong>X_test</strong> (<em>xarray.DataArray</em>) – Predictor testing data with dimensions (T, Y, X, M) or (T, Y, X).</p></li>
<li><p><strong>y_test</strong> (<em>xarray.DataArray</em>) – Predictand testing data with dimensions (T, Y, X, M) or (T, Y, X).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predicted_da</strong> – The predictions over X_test in the original grid shape.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_StackXGboost_Ml.compute_prob">
<span class="sig-name descname"><span class="pre">compute_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_StackXGboost_Ml.compute_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_StackXGboost_Ml.compute_prob" title="Link to this definition"></a></dt>
<dd><p>Compute tercile probabilities using the chosen distribution method.
This method extracts the climatology terciles from Predictant over the period
[clim_year_start, clim_year_end], computes an error variance (or uses error samples),
and then applies the chosen probability function.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_StackXGboost_Ml.forecast">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det_cross</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor_for_year</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_StackXGboost_Ml.forecast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_StackXGboost_Ml.forecast" title="Link to this definition"></a></dt>
<dd><p>Forecast method that uses the trained stacking ensemble to predict for a new year,
then computes tercile probabilities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Predictant</strong> (<em>xarray.DataArray</em>) – Historical predictand data.</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em><em> or </em><em>str</em>) – Start of the climatology period (e.g., 1981).</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em><em> or </em><em>str</em>) – End of the climatology period (e.g., 2010).</p></li>
<li><p><strong>hindcast_det</strong> (<em>xarray.DataArray</em>) – Deterministic hindcasts used for training (predictors).</p></li>
<li><p><strong>hindcast_det_cross</strong> (<em>xarray.DataArray</em>) – Deterministic hindcasts for cross-validation (for error estimation).</p></li>
<li><p><strong>Predictor_for_year</strong> (<em>xarray.DataArray</em>) – Predictor data for the target forecast year.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>result_da</strong> (<em>xarray.DataArray</em>) – The deterministic forecast for the target year.</p></li>
<li><p><strong>hindcast_prob</strong> (<em>xarray.DataArray</em>) – Tercile probability forecast for the target year.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_KNN_Tree_SVR">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_mme.</span></span><span class="sig-name descname"><span class="pre">WAS_mme_Stack_KNN_Tree_SVR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_neighbors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree_max_depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svr_C</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">svr_kernel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rbf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gamma'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_KNN_Tree_SVR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_KNN_Tree_SVR" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Stacking ensemble with K-Nearest Neighbors and Decision Tree base models, and SVR meta-model for Multi-Model Ensemble (MME) forecasting.</p>
<p>This class implements a stacking ensemble using KNeighborsRegressor and DecisionTreeRegressor as base models,
with an SVR meta-model, for deterministic forecasting and optional tercile probability calculations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_neighbors</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of neighbors for K-Nearest Neighbors. Default is 5.</p></li>
<li><p><strong>tree_max_depth</strong> (<em>int</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Maximum depth for the Decision Tree (None for no limit). Default is None.</p></li>
<li><p><strong>svr_C</strong> (<em>float</em><em>, </em><em>optional</em>) – Regularization parameter for SVR. Default is 1.0.</p></li>
<li><p><strong>svr_kernel</strong> (<em>str</em><em>, </em><em>optional</em>) – Kernel type for SVR (‘linear’, ‘poly’, ‘rbf’, ‘sigmoid’). Default is ‘rbf’.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>optional</em>) – Seed for random number generation for reproducibility. Default is 42.</p></li>
<li><p><strong>dist_method</strong> (<em>str</em><em>, </em><em>optional</em>) – Distribution method for tercile probability calculations
(‘t’, ‘gamma’, ‘nonparam’, ‘normal’, ‘lognormal’, ‘weibull_min’). Default is ‘gamma’.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_KNN_Tree_SVR.calculate_tercile_probabilities">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_KNN_Tree_SVR.calculate_tercile_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_KNN_Tree_SVR.calculate_tercile_probabilities" title="Link to this definition"></a></dt>
<dd><p>Student’s t-based method</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_KNN_Tree_SVR.calculate_tercile_probabilities_gamma">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_KNN_Tree_SVR.calculate_tercile_probabilities_gamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_KNN_Tree_SVR.calculate_tercile_probabilities_gamma" title="Link to this definition"></a></dt>
<dd><p>Gamma-distribution based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_KNN_Tree_SVR.calculate_tercile_probabilities_lognormal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_lognormal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_KNN_Tree_SVR.calculate_tercile_probabilities_lognormal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_KNN_Tree_SVR.calculate_tercile_probabilities_lognormal" title="Link to this definition"></a></dt>
<dd><p>Lognormal-distribution based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_KNN_Tree_SVR.calculate_tercile_probabilities_nonparametric">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_nonparametric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_KNN_Tree_SVR.calculate_tercile_probabilities_nonparametric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_KNN_Tree_SVR.calculate_tercile_probabilities_nonparametric" title="Link to this definition"></a></dt>
<dd><p>Non-parametric method using historical error samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_KNN_Tree_SVR.calculate_tercile_probabilities_normal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_normal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_KNN_Tree_SVR.calculate_tercile_probabilities_normal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_KNN_Tree_SVR.calculate_tercile_probabilities_normal" title="Link to this definition"></a></dt>
<dd><p>Normal-distribution based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_KNN_Tree_SVR.calculate_tercile_probabilities_weibull_min">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_weibull_min</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_KNN_Tree_SVR.calculate_tercile_probabilities_weibull_min"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_KNN_Tree_SVR.calculate_tercile_probabilities_weibull_min" title="Link to this definition"></a></dt>
<dd><p>Weibull minimum-based method.</p>
<dl class="simple">
<dt>Here, we assume:</dt><dd><ul class="simple">
<li><p>best_guess is used as the location,</p></li>
<li><p>error_std (sqrt(error_variance)) as the scale, and</p></li>
<li><p>dof (degrees of freedom) as the shape parameter.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>best_guess</strong> (<em>array-like</em>) – Forecast or best guess values.</p></li>
<li><p><strong>error_variance</strong> (<em>array-like</em>) – Variance associated with forecast errors.</p></li>
<li><p><strong>first_tercile</strong> (<em>array-like</em>) – First tercile threshold values.</p></li>
<li><p><strong>second_tercile</strong> (<em>array-like</em>) – Second tercile threshold values.</p></li>
<li><p><strong>dof</strong> (<em>float</em><em> or </em><em>array-like</em>) – Shape parameter for the Weibull minimum distribution.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>pred_prob</strong> – A 3 x n_time array with probabilities for being below the first tercile,
between the first and second tercile, and above the second tercile.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_KNN_Tree_SVR.compute_model">
<span class="sig-name descname"><span class="pre">compute_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_KNN_Tree_SVR.compute_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_KNN_Tree_SVR.compute_model" title="Link to this definition"></a></dt>
<dd><p>Compute deterministic hindcast using the stacking ensemble of KNN and Decision Tree with an SVR meta-model.</p>
<p>Fits the stacking ensemble (KNeighborsRegressor and DecisionTreeRegressor base models with an SVR meta-model)
on training data and predicts deterministic values for the test data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X_train</strong> (<em>xarray.DataArray</em>) – Training predictor data with dimensions (T, M, Y, X).</p></li>
<li><p><strong>y_train</strong> (<em>xarray.DataArray</em>) – Training predictand data with dimensions (T, Y, X).</p></li>
<li><p><strong>X_test</strong> (<em>xarray.DataArray</em>) – Testing predictor data with dimensions (T, M, Y, X).</p></li>
<li><p><strong>y_test</strong> (<em>xarray.DataArray</em>) – Testing predictand data with dimensions (T, Y, X).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predicted_da</strong> – Deterministic hindcast with dimensions (T, Y, X).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_KNN_Tree_SVR.compute_prob">
<span class="sig-name descname"><span class="pre">compute_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_KNN_Tree_SVR.compute_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_KNN_Tree_SVR.compute_prob" title="Link to this definition"></a></dt>
<dd><p>Compute tercile probabilities using the chosen distribution method.
Predictant is expected to be an xarray DataArray with dimensions (T, Y, X).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_KNN_Tree_SVR.forecast">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det_cross</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor_for_year</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_KNN_Tree_SVR.forecast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_KNN_Tree_SVR.forecast" title="Link to this definition"></a></dt>
<dd><p>Generate deterministic and probabilistic forecast for a target year using the stacking ensemble.</p>
<p>Fits the stacking ensemble (KNN and Decision Tree base models with an SVR meta-model)
on standardized hindcast data, predicts deterministic values for the target year,
reverses standardization, and computes tercile probabilities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Predictant</strong> (<em>xarray.DataArray</em>) – Observed predictand data with dimensions (T, Y, X) or (T, M, Y, X).</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em><em> or </em><em>str</em>) – Start year of the climatology period.</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em><em> or </em><em>str</em>) – End year of the climatology period.</p></li>
<li><p><strong>hindcast_det</strong> (<em>xarray.DataArray</em>) – Deterministic hindcast data for training with dimensions (T, M, Y, X).</p></li>
<li><p><strong>hindcast_det_cross</strong> (<em>xarray.DataArray</em>) – Deterministic hindcast data for error estimation with dimensions (T, Y, X).</p></li>
<li><p><strong>Predictor_for_year</strong> (<em>xarray.DataArray</em>) – Predictor data for the target year with dimensions (T, M, Y, X).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>result_da</strong> (<em>xarray.DataArray</em>) – Deterministic forecast with dimensions (T, Y, X).</p></li>
<li><p><strong>hindcast_prob</strong> (<em>xarray.DataArray</em>) – Tercile probabilities with dimensions (probability, T, Y, X), where probability
includes [‘PB’, ‘PN’, ‘PA’] (below-normal, normal, above-normal).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_Lasso_RF_MLP">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_mme.</span></span><span class="sig-name descname"><span class="pre">WAS_mme_Stack_Lasso_RF_MLP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lasso_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_estimators</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlp_hidden_layer_sizes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(10,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlp_activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlp_solver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'adam'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlp_max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlp_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gamma'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_Lasso_RF_MLP"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_Lasso_RF_MLP" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Stacking ensemble with Lasso and Random Forest base models, and MLP meta-model for Multi-Model Ensemble (MME) forecasting.</p>
<p>This class implements a stacking ensemble using Lasso and RandomForestRegressor as base models,
with an MLPRegressor meta-model, for deterministic forecasting and optional tercile probability calculations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lasso_alpha</strong> (<em>float</em><em>, </em><em>optional</em>) – Regularization strength for the Lasso base model. Default is 0.01.</p></li>
<li><p><strong>n_estimators</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of trees in the Random Forest base model. Default is 100.</p></li>
<li><p><strong>mlp_hidden_layer_sizes</strong> (<em>tuple</em><em>, </em><em>optional</em>) – Sizes of the hidden layers for the MLP meta-model (e.g., (10, 5)). Default is (10, 5).</p></li>
<li><p><strong>mlp_activation</strong> (<em>str</em><em>, </em><em>optional</em>) – Activation function for the MLP (‘identity’, ‘logistic’, ‘tanh’, ‘relu’). Default is ‘relu’.</p></li>
<li><p><strong>mlp_solver</strong> (<em>str</em><em>, </em><em>optional</em>) – Optimization algorithm for the MLP (‘lbfgs’, ‘sgd’, ‘adam’). Default is ‘adam’.</p></li>
<li><p><strong>mlp_max_iter</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum number of iterations for the MLP solver. Default is 200.</p></li>
<li><p><strong>mlp_alpha</strong> (<em>float</em><em>, </em><em>optional</em>) – L2 regularization parameter for the MLP. Default is 0.01.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>optional</em>) – Seed for random number generation for reproducibility. Default is 42.</p></li>
<li><p><strong>dist_method</strong> (<em>str</em><em>, </em><em>optional</em>) – Distribution method for tercile probability calculations
(‘t’, ‘gamma’, ‘nonparam’, ‘normal’, ‘lognormal’, ‘weibull_min’).
Default is ‘gamma’.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_Lasso_RF_MLP.calculate_tercile_probabilities">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_Lasso_RF_MLP.calculate_tercile_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_Lasso_RF_MLP.calculate_tercile_probabilities" title="Link to this definition"></a></dt>
<dd><p>Student’s t-based method</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_Lasso_RF_MLP.calculate_tercile_probabilities_gamma">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_Lasso_RF_MLP.calculate_tercile_probabilities_gamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_Lasso_RF_MLP.calculate_tercile_probabilities_gamma" title="Link to this definition"></a></dt>
<dd><p>Gamma-distribution based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_Lasso_RF_MLP.calculate_tercile_probabilities_lognormal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_lognormal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_Lasso_RF_MLP.calculate_tercile_probabilities_lognormal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_Lasso_RF_MLP.calculate_tercile_probabilities_lognormal" title="Link to this definition"></a></dt>
<dd><p>Lognormal-distribution based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_Lasso_RF_MLP.calculate_tercile_probabilities_nonparametric">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_nonparametric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_Lasso_RF_MLP.calculate_tercile_probabilities_nonparametric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_Lasso_RF_MLP.calculate_tercile_probabilities_nonparametric" title="Link to this definition"></a></dt>
<dd><p>Non-parametric method using historical error samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_Lasso_RF_MLP.calculate_tercile_probabilities_normal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_normal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_Lasso_RF_MLP.calculate_tercile_probabilities_normal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_Lasso_RF_MLP.calculate_tercile_probabilities_normal" title="Link to this definition"></a></dt>
<dd><p>Normal-distribution based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_Lasso_RF_MLP.calculate_tercile_probabilities_weibull_min">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_weibull_min</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_Lasso_RF_MLP.calculate_tercile_probabilities_weibull_min"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_Lasso_RF_MLP.calculate_tercile_probabilities_weibull_min" title="Link to this definition"></a></dt>
<dd><p>Weibull minimum-based method.</p>
<dl class="simple">
<dt>Here, we assume:</dt><dd><ul class="simple">
<li><p>best_guess is used as the location,</p></li>
<li><p>error_std (sqrt(error_variance)) as the scale, and</p></li>
<li><p>dof (degrees of freedom) as the shape parameter.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>best_guess</strong> (<em>array-like</em>) – Forecast or best guess values.</p></li>
<li><p><strong>error_variance</strong> (<em>array-like</em>) – Variance associated with forecast errors.</p></li>
<li><p><strong>first_tercile</strong> (<em>array-like</em>) – First tercile threshold values.</p></li>
<li><p><strong>second_tercile</strong> (<em>array-like</em>) – Second tercile threshold values.</p></li>
<li><p><strong>dof</strong> (<em>float</em><em> or </em><em>array-like</em>) – Shape parameter for the Weibull minimum distribution.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>pred_prob</strong> – A 3 x n_time array with probabilities for being below the first tercile,
between the first and second tercile, and above the second tercile.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_Lasso_RF_MLP.compute_model">
<span class="sig-name descname"><span class="pre">compute_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_Lasso_RF_MLP.compute_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_Lasso_RF_MLP.compute_model" title="Link to this definition"></a></dt>
<dd><p>Compute deterministic hindcast using the stacking ensemble of Lasso and Random Forest with an MLP meta-model.</p>
<p>Fits the stacking ensemble (Lasso and Random Forest base models with an MLPRegressor meta-model)
on training data and predicts deterministic values for the test data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X_train</strong> (<em>xarray.DataArray</em>) – Training predictor data with dimensions (T, M, Y, X).</p></li>
<li><p><strong>y_train</strong> (<em>xarray.DataArray</em>) – Training predictand data with dimensions (T, Y, X).</p></li>
<li><p><strong>X_test</strong> (<em>xarray.DataArray</em>) – Testing predictor data with dimensions (T, M, Y, X).</p></li>
<li><p><strong>y_test</strong> (<em>xarray.DataArray</em>) – Testing predictand data with dimensions (T, Y, X).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predicted_da</strong> – Deterministic hindcast with dimensions (T, Y, X).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_Lasso_RF_MLP.compute_prob">
<span class="sig-name descname"><span class="pre">compute_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_Lasso_RF_MLP.compute_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_Lasso_RF_MLP.compute_prob" title="Link to this definition"></a></dt>
<dd><p>Compute tercile probabilities using the chosen distribution method.
Predictant should be an xarray DataArray with dims (T, Y, X).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_Lasso_RF_MLP.forecast">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det_cross</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor_for_year</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_Lasso_RF_MLP.forecast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_Lasso_RF_MLP.forecast" title="Link to this definition"></a></dt>
<dd><p>Generate deterministic and probabilistic forecast for a target year using the stacking ensemble.</p>
<p>Fits the stacking ensemble (Lasso and Random Forest base models with an MLPRegressor meta-model)
on standardized hindcast data, predicts deterministic values for the target year,
reverses standardization, and computes tercile probabilities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Predictant</strong> (<em>xarray.DataArray</em>) – Observed predictand data with dimensions (T, Y, X) or (T, M, Y, X).</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em><em> or </em><em>str</em>) – Start year of the climatology period.</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em><em> or </em><em>str</em>) – End year of the climatology period.</p></li>
<li><p><strong>hindcast_det</strong> (<em>xarray.DataArray</em>) – Deterministic hindcast data for training with dimensions (T, M, Y, X).</p></li>
<li><p><strong>hindcast_det_cross</strong> (<em>xarray.DataArray</em>) – Deterministic hindcast data for error estimation with dimensions (T, Y, X).</p></li>
<li><p><strong>Predictor_for_year</strong> (<em>xarray.DataArray</em>) – Predictor data for the target year with dimensions (T, M, Y, X).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>result_da</strong> (<em>xarray.DataArray</em>) – Deterministic forecast with dimensions (T, Y, X).</p></li>
<li><p><strong>hindcast_prob</strong> (<em>xarray.DataArray</em>) – Tercile probabilities with dimensions (probability, T, Y, X), where probability
includes [‘PB’, ‘PN’, ‘PA’] (below-normal, normal, above-normal).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_MLP_Ada_Ridge">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_mme.</span></span><span class="sig-name descname"><span class="pre">WAS_mme_Stack_MLP_Ada_Ridge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hidden_layer_sizes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(10,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'adam'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlp_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_estimators_adaboost</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ridge_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gamma'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_MLP_Ada_Ridge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_MLP_Ada_Ridge" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Stacking ensemble with MLP and AdaBoost base models, and Ridge meta-model for Multi-Model Ensemble (MME) forecasting.</p>
<p>This class implements a stacking ensemble using MLPRegressor and AdaBoostRegressor as base models,
with a Ridge meta-model, for deterministic forecasting and optional tercile probability calculations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hidden_layer_sizes</strong> (<em>tuple</em><em>, </em><em>optional</em>) – Sizes of the hidden layers for the MLP base model (e.g., (10, 5)). Default is (10, 5).</p></li>
<li><p><strong>activation</strong> (<em>str</em><em>, </em><em>optional</em>) – Activation function for the MLP (‘identity’, ‘logistic’, ‘tanh’, ‘relu’). Default is ‘relu’.</p></li>
<li><p><strong>max_iter</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum number of iterations for the MLP solver. Default is 200.</p></li>
<li><p><strong>solver</strong> (<em>str</em><em>, </em><em>optional</em>) – Optimization algorithm for the MLP (‘lbfgs’, ‘sgd’, ‘adam’). Default is ‘adam’.</p></li>
<li><p><strong>mlp_alpha</strong> (<em>float</em><em>, </em><em>optional</em>) – L2 regularization parameter for the MLP. Default is 0.01.</p></li>
<li><p><strong>n_estimators_adaboost</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of boosting iterations for AdaBoost. Default is 50.</p></li>
<li><p><strong>ridge_alpha</strong> (<em>float</em><em>, </em><em>optional</em>) – Regularization strength for the Ridge meta-model. Default is 1.0.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>optional</em>) – Seed for random number generation for reproducibility. Default is 42.</p></li>
<li><p><strong>dist_method</strong> (<em>str</em><em>, </em><em>optional</em>) – Distribution method for tercile probability calculations
(‘t’, ‘gamma’, ‘nonparam’, ‘normal’, ‘lognormal’, ‘weibull_min’). Default is ‘gamma’.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_MLP_Ada_Ridge.calculate_tercile_probabilities">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_MLP_Ada_Ridge.calculate_tercile_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_MLP_Ada_Ridge.calculate_tercile_probabilities" title="Link to this definition"></a></dt>
<dd><p>Student’s t-based method</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_MLP_Ada_Ridge.calculate_tercile_probabilities_gamma">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_MLP_Ada_Ridge.calculate_tercile_probabilities_gamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_MLP_Ada_Ridge.calculate_tercile_probabilities_gamma" title="Link to this definition"></a></dt>
<dd><p>Gamma-distribution based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_MLP_Ada_Ridge.calculate_tercile_probabilities_lognormal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_lognormal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_MLP_Ada_Ridge.calculate_tercile_probabilities_lognormal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_MLP_Ada_Ridge.calculate_tercile_probabilities_lognormal" title="Link to this definition"></a></dt>
<dd><p>Lognormal-distribution based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_MLP_Ada_Ridge.calculate_tercile_probabilities_nonparametric">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_nonparametric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_MLP_Ada_Ridge.calculate_tercile_probabilities_nonparametric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_MLP_Ada_Ridge.calculate_tercile_probabilities_nonparametric" title="Link to this definition"></a></dt>
<dd><p>Non-parametric method using historical error samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_MLP_Ada_Ridge.calculate_tercile_probabilities_normal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_normal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_MLP_Ada_Ridge.calculate_tercile_probabilities_normal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_MLP_Ada_Ridge.calculate_tercile_probabilities_normal" title="Link to this definition"></a></dt>
<dd><p>Normal-distribution based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_MLP_Ada_Ridge.calculate_tercile_probabilities_weibull_min">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_weibull_min</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_MLP_Ada_Ridge.calculate_tercile_probabilities_weibull_min"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_MLP_Ada_Ridge.calculate_tercile_probabilities_weibull_min" title="Link to this definition"></a></dt>
<dd><p>Weibull minimum-based method.</p>
<dl class="simple">
<dt>Here, we assume:</dt><dd><ul class="simple">
<li><p>best_guess is used as the location,</p></li>
<li><p>error_std (sqrt(error_variance)) as the scale, and</p></li>
<li><p>dof (degrees of freedom) as the shape parameter.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>best_guess</strong> (<em>array-like</em>) – Forecast or best guess values.</p></li>
<li><p><strong>error_variance</strong> (<em>array-like</em>) – Variance associated with forecast errors.</p></li>
<li><p><strong>first_tercile</strong> (<em>array-like</em>) – First tercile threshold values.</p></li>
<li><p><strong>second_tercile</strong> (<em>array-like</em>) – Second tercile threshold values.</p></li>
<li><p><strong>dof</strong> (<em>float</em><em> or </em><em>array-like</em>) – Shape parameter for the Weibull minimum distribution.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>pred_prob</strong> – A 3 x n_time array with probabilities for being below the first tercile,
between the first and second tercile, and above the second tercile.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_MLP_Ada_Ridge.compute_model">
<span class="sig-name descname"><span class="pre">compute_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_MLP_Ada_Ridge.compute_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_MLP_Ada_Ridge.compute_model" title="Link to this definition"></a></dt>
<dd><p>Compute deterministic hindcast using the stacking ensemble of MLP and AdaBoost with a Ridge meta-model.</p>
<p>Fits the stacking ensemble (MLP and AdaBoost base models with a Ridge meta-model)
on training data and predicts deterministic values for the test data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X_train</strong> (<em>xarray.DataArray</em>) – Training predictor data with dimensions (T, M, Y, X).</p></li>
<li><p><strong>y_train</strong> (<em>xarray.DataArray</em>) – Training predictand data with dimensions (T, Y, X).</p></li>
<li><p><strong>X_test</strong> (<em>xarray.DataArray</em>) – Testing predictor data with dimensions (T, M, Y, X).</p></li>
<li><p><strong>y_test</strong> (<em>xarray.DataArray</em>) – Testing predictand data with dimensions (T, Y, X).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predicted_da</strong> – Deterministic hindcast with dimensions (T, Y, X).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_MLP_Ada_Ridge.compute_prob">
<span class="sig-name descname"><span class="pre">compute_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_MLP_Ada_Ridge.compute_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_MLP_Ada_Ridge.compute_prob" title="Link to this definition"></a></dt>
<dd><p>Compute tercile probabilities using the chosen distribution method.
Predictant is expected to be an xarray DataArray with dims (T, Y, X).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_MLP_Ada_Ridge.forecast">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det_cross</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor_for_year</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_MLP_Ada_Ridge.forecast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_MLP_Ada_Ridge.forecast" title="Link to this definition"></a></dt>
<dd><p>Generate deterministic and probabilistic forecast for a target year using the stacking ensemble.</p>
<p>Fits the stacking ensemble (MLP and AdaBoost base models with a Ridge meta-model)
on standardized hindcast data, predicts deterministic values for the target year,
reverses standardization, and computes tercile probabilities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Predictant</strong> (<em>xarray.DataArray</em>) – Observed predictand data with dimensions (T, Y, X) or (T, M, Y, X).</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em><em> or </em><em>str</em>) – Start year of the climatology period.</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em><em> or </em><em>str</em>) – End year of the climatology period.</p></li>
<li><p><strong>hindcast_det</strong> (<em>xarray.DataArray</em>) – Deterministic hindcast data for training with dimensions (T, M, Y, X).</p></li>
<li><p><strong>hindcast_det_cross</strong> (<em>xarray.DataArray</em>) – Deterministic hindcast data for error estimation with dimensions (T, Y, X).</p></li>
<li><p><strong>Predictor_for_year</strong> (<em>xarray.DataArray</em>) – Predictor data for the target year with dimensions (T, M, Y, X).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>result_da</strong> (<em>xarray.DataArray</em>) – Deterministic forecast with dimensions (T, Y, X).</p></li>
<li><p><strong>hindcast_prob</strong> (<em>xarray.DataArray</em>) – Tercile probabilities with dimensions (probability, T, Y, X), where probability
includes [‘PB’, ‘PN’, ‘PA’] (below-normal, normal, above-normal).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_MLP_RF">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_mme.</span></span><span class="sig-name descname"><span class="pre">WAS_mme_Stack_MLP_RF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hidden_layer_sizes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(10,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solver</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'adam'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_estimators</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gamma'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_MLP_RF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_MLP_RF" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Stacking ensemble with MLP and Random Forest for Multi-Model Ensemble (MME) forecasting.</p>
<p>This class implements a stacking ensemble using MLPRegressor and RandomForestRegressor as base models,
with a LinearRegression meta-model, for deterministic forecasting and optional tercile probability calculations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hidden_layer_sizes</strong> (<em>tuple</em><em>, </em><em>optional</em>) – Sizes of the hidden layers for the MLP base model (e.g., (10, 5)). Default is (10, 5).</p></li>
<li><p><strong>activation</strong> (<em>str</em><em>, </em><em>optional</em>) – Activation function for the MLP (‘identity’, ‘logistic’, ‘tanh’, ‘relu’). Default is ‘relu’.</p></li>
<li><p><strong>max_iter</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum number of iterations for the MLP solver. Default is 200.</p></li>
<li><p><strong>solver</strong> (<em>str</em><em>, </em><em>optional</em>) – Optimization algorithm for the MLP (‘lbfgs’, ‘sgd’, ‘adam’). Default is ‘adam’.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>optional</em>) – Seed for random number generation for reproducibility. Default is 42.</p></li>
<li><p><strong>alpha</strong> (<em>float</em><em>, </em><em>optional</em>) – L2 regularization parameter for the MLP. Default is 0.01.</p></li>
<li><p><strong>n_estimators</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of trees in the Random Forest base model. Default is 100.</p></li>
<li><p><strong>dist_method</strong> (<em>str</em><em>, </em><em>optional</em>) – Distribution method for tercile probability calculations
(‘t’, ‘gamma’, ‘nonparam’, ‘normal’, ‘lognormal’, ‘weibull_min’).
Default is ‘gamma’.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_MLP_RF.calculate_tercile_probabilities">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_MLP_RF.calculate_tercile_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_MLP_RF.calculate_tercile_probabilities" title="Link to this definition"></a></dt>
<dd><p>Student’s t-based method</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_MLP_RF.calculate_tercile_probabilities_gamma">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_MLP_RF.calculate_tercile_probabilities_gamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_MLP_RF.calculate_tercile_probabilities_gamma" title="Link to this definition"></a></dt>
<dd><p>Gamma-distribution based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_MLP_RF.calculate_tercile_probabilities_lognormal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_lognormal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_MLP_RF.calculate_tercile_probabilities_lognormal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_MLP_RF.calculate_tercile_probabilities_lognormal" title="Link to this definition"></a></dt>
<dd><p>Lognormal-distribution based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_MLP_RF.calculate_tercile_probabilities_nonparametric">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_nonparametric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_MLP_RF.calculate_tercile_probabilities_nonparametric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_MLP_RF.calculate_tercile_probabilities_nonparametric" title="Link to this definition"></a></dt>
<dd><p>Non-parametric method using historical error samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_MLP_RF.calculate_tercile_probabilities_normal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_normal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_MLP_RF.calculate_tercile_probabilities_normal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_MLP_RF.calculate_tercile_probabilities_normal" title="Link to this definition"></a></dt>
<dd><p>Normal-distribution based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_MLP_RF.calculate_tercile_probabilities_weibull_min">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_weibull_min</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_MLP_RF.calculate_tercile_probabilities_weibull_min"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_MLP_RF.calculate_tercile_probabilities_weibull_min" title="Link to this definition"></a></dt>
<dd><p>Weibull minimum-based method.</p>
<dl class="simple">
<dt>Here, we assume:</dt><dd><ul class="simple">
<li><p>best_guess is used as the location,</p></li>
<li><p>error_std (sqrt(error_variance)) as the scale, and</p></li>
<li><p>dof (degrees of freedom) as the shape parameter.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>best_guess</strong> (<em>array-like</em>) – Forecast or best guess values.</p></li>
<li><p><strong>error_variance</strong> (<em>array-like</em>) – Variance associated with forecast errors.</p></li>
<li><p><strong>first_tercile</strong> (<em>array-like</em>) – First tercile threshold values.</p></li>
<li><p><strong>second_tercile</strong> (<em>array-like</em>) – Second tercile threshold values.</p></li>
<li><p><strong>dof</strong> (<em>float</em><em> or </em><em>array-like</em>) – Shape parameter for the Weibull minimum distribution.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>pred_prob</strong> – A 3 x n_time array with probabilities for being below the first tercile,
between the first and second tercile, and above the second tercile.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_MLP_RF.compute_model">
<span class="sig-name descname"><span class="pre">compute_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_MLP_RF.compute_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_MLP_RF.compute_model" title="Link to this definition"></a></dt>
<dd><p>Compute deterministic hindcast using the stacking ensemble of MLP and Random Forest.</p>
<p>Fits the stacking ensemble (MLP and Random Forest base models with a LinearRegression meta-model)
on training data and predicts deterministic values for the test data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X_train</strong> (<em>xarray.DataArray</em>) – Training predictor data with dimensions (T, M, Y, X).</p></li>
<li><p><strong>y_train</strong> (<em>xarray.DataArray</em>) – Training predictand data with dimensions (T, Y, X).</p></li>
<li><p><strong>X_test</strong> (<em>xarray.DataArray</em>) – Testing predictor data with dimensions (T, M, Y, X).</p></li>
<li><p><strong>y_test</strong> (<em>xarray.DataArray</em>) – Testing predictand data with dimensions (T, Y, X).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predicted_da</strong> – Deterministic hindcast with dimensions (T, Y, X).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_MLP_RF.compute_prob">
<span class="sig-name descname"><span class="pre">compute_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_MLP_RF.compute_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_MLP_RF.compute_prob" title="Link to this definition"></a></dt>
<dd><p>Compute tercile probabilities using the chosen distribution method.
This method extracts the climatology terciles from Predictant over the period
[clim_year_start, clim_year_end], computes an error variance (or uses error samples),
and then applies the chosen probability function.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_MLP_RF.forecast">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det_cross</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor_for_year</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_MLP_RF.forecast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_MLP_RF.forecast" title="Link to this definition"></a></dt>
<dd><p>Forecast method that uses the trained stacking ensemble to predict for a new year,
then computes tercile probabilities.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_RF_GB_Ridge">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_mme.</span></span><span class="sig-name descname"><span class="pre">WAS_mme_Stack_RF_GB_Ridge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_estimators_rf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_depth_rf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_estimators_gb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate_gb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ridge_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gamma'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_RF_GB_Ridge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_RF_GB_Ridge" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Stacking ensemble with Random Forest and Gradient Boosting base models, and Ridge meta-model for Multi-Model Ensemble (MME) forecasting.</p>
<p>This class implements a stacking ensemble using RandomForestRegressor and GradientBoostingRegressor as base models,
with a Ridge meta-model, for deterministic forecasting and optional tercile probability calculations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_estimators_rf</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of trees in the Random Forest base model. Default is 100.</p></li>
<li><p><strong>max_depth_rf</strong> (<em>int</em><em> or </em><em>None</em><em>, </em><em>optional</em>) – Maximum depth for Random Forest trees (None for no limit). Default is None.</p></li>
<li><p><strong>n_estimators_gb</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of boosting iterations for Gradient Boosting. Default is 100.</p></li>
<li><p><strong>learning_rate_gb</strong> (<em>float</em><em>, </em><em>optional</em>) – Learning rate for Gradient Boosting. Default is 0.1.</p></li>
<li><p><strong>ridge_alpha</strong> (<em>float</em><em>, </em><em>optional</em>) – Regularization strength for the Ridge meta-model. Default is 1.0.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>optional</em>) – Seed for random number generation for reproducibility. Default is 42.</p></li>
<li><p><strong>dist_method</strong> (<em>str</em><em>, </em><em>optional</em>) – Distribution method for tercile probability calculations
(‘t’, ‘gamma’, ‘nonparam’, ‘normal’, ‘lognormal’, ‘weibull_min’). Default is ‘gamma’.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_RF_GB_Ridge.calculate_tercile_probabilities">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_RF_GB_Ridge.calculate_tercile_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_RF_GB_Ridge.calculate_tercile_probabilities" title="Link to this definition"></a></dt>
<dd><p>Student’s t-based method</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_RF_GB_Ridge.calculate_tercile_probabilities_gamma">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_RF_GB_Ridge.calculate_tercile_probabilities_gamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_RF_GB_Ridge.calculate_tercile_probabilities_gamma" title="Link to this definition"></a></dt>
<dd><p>Gamma-distribution based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_RF_GB_Ridge.calculate_tercile_probabilities_lognormal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_lognormal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_RF_GB_Ridge.calculate_tercile_probabilities_lognormal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_RF_GB_Ridge.calculate_tercile_probabilities_lognormal" title="Link to this definition"></a></dt>
<dd><p>Lognormal-distribution based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_RF_GB_Ridge.calculate_tercile_probabilities_nonparametric">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_nonparametric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_RF_GB_Ridge.calculate_tercile_probabilities_nonparametric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_RF_GB_Ridge.calculate_tercile_probabilities_nonparametric" title="Link to this definition"></a></dt>
<dd><p>Non-parametric method using historical error samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_RF_GB_Ridge.calculate_tercile_probabilities_normal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_normal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_RF_GB_Ridge.calculate_tercile_probabilities_normal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_RF_GB_Ridge.calculate_tercile_probabilities_normal" title="Link to this definition"></a></dt>
<dd><p>Normal-distribution based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_RF_GB_Ridge.calculate_tercile_probabilities_weibull_min">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_weibull_min</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_RF_GB_Ridge.calculate_tercile_probabilities_weibull_min"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_RF_GB_Ridge.calculate_tercile_probabilities_weibull_min" title="Link to this definition"></a></dt>
<dd><p>Weibull minimum-based method.</p>
<dl class="simple">
<dt>Here, we assume:</dt><dd><ul class="simple">
<li><p>best_guess is used as the location,</p></li>
<li><p>error_std (sqrt(error_variance)) as the scale, and</p></li>
<li><p>dof (degrees of freedom) as the shape parameter.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>best_guess</strong> (<em>array-like</em>) – Forecast or best guess values.</p></li>
<li><p><strong>error_variance</strong> (<em>array-like</em>) – Variance associated with forecast errors.</p></li>
<li><p><strong>first_tercile</strong> (<em>array-like</em>) – First tercile threshold values.</p></li>
<li><p><strong>second_tercile</strong> (<em>array-like</em>) – Second tercile threshold values.</p></li>
<li><p><strong>dof</strong> (<em>float</em><em> or </em><em>array-like</em>) – Shape parameter for the Weibull minimum distribution.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>pred_prob</strong> – A 3 x n_time array with probabilities for being below the first tercile,
between the first and second tercile, and above the second tercile.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_RF_GB_Ridge.compute_model">
<span class="sig-name descname"><span class="pre">compute_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_RF_GB_Ridge.compute_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_RF_GB_Ridge.compute_model" title="Link to this definition"></a></dt>
<dd><p>Compute deterministic hindcast using the stacking ensemble of Random Forest and Gradient Boosting with a Ridge meta-model.</p>
<p>Fits the stacking ensemble (Random Forest and Gradient Boosting base models with a Ridge meta-model)
on training data and predicts deterministic values for the test data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X_train</strong> (<em>xarray.DataArray</em>) – Training predictor data with dimensions (T, M, Y, X).</p></li>
<li><p><strong>y_train</strong> (<em>xarray.DataArray</em>) – Training predictand data with dimensions (T, Y, X).</p></li>
<li><p><strong>X_test</strong> (<em>xarray.DataArray</em>) – Testing predictor data with dimensions (T, M, Y, X).</p></li>
<li><p><strong>y_test</strong> (<em>xarray.DataArray</em>) – Testing predictand data with dimensions (T, Y, X).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predicted_da</strong> – Deterministic hindcast with dimensions (T, Y, X).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_RF_GB_Ridge.compute_prob">
<span class="sig-name descname"><span class="pre">compute_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_RF_GB_Ridge.compute_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_RF_GB_Ridge.compute_prob" title="Link to this definition"></a></dt>
<dd><p>Compute tercile probabilities for hindcasts based on the chosen distribution.
Predictant is an xarray DataArray with dims (T, Y, X).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Stack_RF_GB_Ridge.forecast">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det_cross</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor_for_year</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Stack_RF_GB_Ridge.forecast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Stack_RF_GB_Ridge.forecast" title="Link to this definition"></a></dt>
<dd><p>Generate deterministic and probabilistic forecast for a target year using the stacking ensemble.</p>
<p>Fits the stacking ensemble (Random Forest and Gradient Boosting base models with a Ridge meta-model)
on standardized hindcast data, predicts deterministic values for the target year,
reverses standardization, and computes tercile probabilities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Predictant</strong> (<em>xarray.DataArray</em>) – Observed predictand data with dimensions (T, Y, X) or (T, M, Y, X).</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em><em> or </em><em>str</em>) – Start year of the climatology period.</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em><em> or </em><em>str</em>) – End year of the climatology period.</p></li>
<li><p><strong>hindcast_det</strong> (<em>xarray.DataArray</em>) – Deterministic hindcast data for training with dimensions (T, M, Y, X).</p></li>
<li><p><strong>hindcast_det_cross</strong> (<em>xarray.DataArray</em>) – Deterministic hindcast data for error estimation with dimensions (T, Y, X).</p></li>
<li><p><strong>Predictor_for_year</strong> (<em>xarray.DataArray</em>) – Predictor data for the target year with dimensions (T, M, Y, X).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>result_da</strong> (<em>xarray.DataArray</em>) – Deterministic forecast with dimensions (T, Y, X).</p></li>
<li><p><strong>hindcast_prob</strong> (<em>xarray.DataArray</em>) – Tercile probabilities with dimensions (probability, T, Y, X), where probability
includes [‘PB’, ‘PN’, ‘PA’] (below-normal, normal, above-normal).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Weighted">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_mme.</span></span><span class="sig-name descname"><span class="pre">WAS_mme_Weighted</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">equal_weighted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gamma'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'GROC'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Weighted"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Weighted" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Weighted Multi-Model Ensemble (MME) for climate forecasting.</p>
<p>This class implements a weighted ensemble approach for combining multiple climate models,
supporting both equal weighting and score-based weighting. It also provides methods for
computing tercile probabilities using various statistical distributions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equal_weighted</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, use equal weights for all models; otherwise, use score-based weights. Default is False.</p></li>
<li><p><strong>dist_method</strong> (<em>str</em><em>, </em><em>optional</em>) – Statistical distribution for probability calculations (‘t’, ‘gamma’, ‘normal’, ‘lognormal’,
‘weibull_min’, ‘nonparam’). Default is ‘gamma’.</p></li>
<li><p><strong>metric</strong> (<em>str</em><em>, </em><em>optional</em>) – Performance metric for weighting (‘MAE’, ‘Pearson’, ‘GROC’). Default is ‘GROC’.</p></li>
<li><p><strong>threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – Threshold for score transformation. Default is 0.5.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Weighted.calculate_tercile_probabilities">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Weighted.calculate_tercile_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Weighted.calculate_tercile_probabilities" title="Link to this definition"></a></dt>
<dd><p>Student’s t-based method</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Weighted.calculate_tercile_probabilities_gamma">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Weighted.calculate_tercile_probabilities_gamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Weighted.calculate_tercile_probabilities_gamma" title="Link to this definition"></a></dt>
<dd><p>Gamma-distribution based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Weighted.calculate_tercile_probabilities_lognormal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_lognormal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Weighted.calculate_tercile_probabilities_lognormal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Weighted.calculate_tercile_probabilities_lognormal" title="Link to this definition"></a></dt>
<dd><p>Lognormal-distribution based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Weighted.calculate_tercile_probabilities_nonparametric">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_nonparametric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Weighted.calculate_tercile_probabilities_nonparametric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Weighted.calculate_tercile_probabilities_nonparametric" title="Link to this definition"></a></dt>
<dd><p>Non-parametric method using historical error samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Weighted.calculate_tercile_probabilities_normal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_normal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Weighted.calculate_tercile_probabilities_normal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Weighted.calculate_tercile_probabilities_normal" title="Link to this definition"></a></dt>
<dd><p>Normal-distribution based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Weighted.calculate_tercile_probabilities_weibull_min">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_weibull_min</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Weighted.calculate_tercile_probabilities_weibull_min"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Weighted.calculate_tercile_probabilities_weibull_min" title="Link to this definition"></a></dt>
<dd><p>Weibull minimum-based method.</p>
<dl class="simple">
<dt>Here, we assume:</dt><dd><ul class="simple">
<li><p>best_guess is used as the location,</p></li>
<li><p>error_std (sqrt(error_variance)) as the scale, and</p></li>
<li><p>dof (degrees of freedom) as the shape parameter.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>best_guess</strong> (<em>array-like</em>) – Forecast or best guess values.</p></li>
<li><p><strong>error_variance</strong> (<em>array-like</em>) – Variance associated with forecast errors.</p></li>
<li><p><strong>first_tercile</strong> (<em>array-like</em>) – First tercile threshold values.</p></li>
<li><p><strong>second_tercile</strong> (<em>array-like</em>) – Second tercile threshold values.</p></li>
<li><p><strong>dof</strong> (<em>float</em><em> or </em><em>array-like</em>) – Shape parameter for the Weibull minimum distribution.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>pred_prob</strong> – A 3 x n_time array with probabilities for being below the first tercile,
between the first and second tercile, and above the second tercile.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Weighted.compute">
<span class="sig-name descname"><span class="pre">compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rainfall</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hdcst</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcst</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scores</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">complete</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Weighted.compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Weighted.compute" title="Link to this definition"></a></dt>
<dd><p>Compute weighted hindcast and forecast using model scores.</p>
<p>This method calculates weighted averages of hindcast and forecast data based on model scores.
If <cite>complete</cite> is True, missing values are filled with unweighted averages.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rainfall</strong> (<em>xarray.DataArray</em>) – Observed rainfall data with dimensions (T, Y, X, M).</p></li>
<li><p><strong>hdcst</strong> (<em>xarray.DataArray</em>) – Hindcast data with dimensions (T, M, Y, X).</p></li>
<li><p><strong>fcst</strong> (<em>xarray.DataArray</em>) – Forecast data with dimensions (T, M, Y, X).</p></li>
<li><p><strong>scores</strong> (<em>dict</em>) – Dictionary mapping model names to score arrays.</p></li>
<li><p><strong>complete</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, fill missing values with unweighted averages. Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>hindcast_det</strong> (<em>xarray.DataArray</em>) – Weighted hindcast data with dimensions (T, Y, X).</p></li>
<li><p><strong>forecast_det</strong> (<em>xarray.DataArray</em>) – Weighted forecast data with dimensions (T, Y, X).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Weighted.compute_prob">
<span class="sig-name descname"><span class="pre">compute_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Weighted.compute_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Weighted.compute_prob" title="Link to this definition"></a></dt>
<dd><p>Compute tercile probabilities for hindcast data.</p>
<p>Calculates tercile probabilities based on the specified distribution method, using
climatological terciles derived from the predictand data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Predictant</strong> (<em>xarray.DataArray</em>) – Observed predictand data with dimensions (T, Y, X).</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em><em> or </em><em>str</em>) – Start year of the climatology period.</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em><em> or </em><em>str</em>) – End year of the climatology period.</p></li>
<li><p><strong>hindcast_det</strong> (<em>xarray.DataArray</em>) – Deterministic hindcast data with dimensions (T, Y, X).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>hindcast_prob</strong> – Tercile probabilities with dimensions (probability, T, Y, X).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Weighted.forecast">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forecast_det</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Weighted.forecast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Weighted.forecast" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_Weighted.transform_score">
<span class="sig-name descname"><span class="pre">transform_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">score_array</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_Weighted.transform_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_Weighted.transform_score" title="Link to this definition"></a></dt>
<dd><p>Transform score array based on the chosen metric and threshold.</p>
<p>For ‘MAE’, scores below the threshold are set to 1, others to 0. For ‘Pearson’ or ‘GROC’,
scores above the threshold are set to 1, others to 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>score_array</strong> (<em>xarray.DataArray</em>) – Score array to transform.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>transformed_score</strong> – Transformed score array with binary weights.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_XGBoosting">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_mme.</span></span><span class="sig-name descname"><span class="pre">WAS_mme_XGBoosting</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_estimators</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gamma'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_XGBoosting"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_XGBoosting" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>XGBoost-based Multi-Model Ensemble (MME) forecasting.</p>
<p>This class implements a single-model forecasting approach using XGBoost’s XGBRegressor
for deterministic predictions, with optional tercile probability calculations using
various statistical distributions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_estimators</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of boosting rounds. Default is 100.</p></li>
<li><p><strong>learning_rate</strong> (<em>float</em><em>, </em><em>optional</em>) – Learning rate for boosting. Default is 0.1.</p></li>
<li><p><strong>max_depth</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum tree depth for base learners. Default is 3.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>optional</em>) – Seed for random number generation for reproducibility. Default is 42.</p></li>
<li><p><strong>dist_method</strong> (<em>str</em><em>, </em><em>optional</em>) – Distribution method for tercile probability calculations
(‘t’, ‘gamma’, ‘nonparam’, ‘normal’, ‘lognormal’, ‘weibull_min’).
Default is ‘gamma’.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_XGBoosting.calculate_tercile_probabilities">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_XGBoosting.calculate_tercile_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_XGBoosting.calculate_tercile_probabilities" title="Link to this definition"></a></dt>
<dd><p>Student’s t-based method</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_XGBoosting.calculate_tercile_probabilities_gamma">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_XGBoosting.calculate_tercile_probabilities_gamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_XGBoosting.calculate_tercile_probabilities_gamma" title="Link to this definition"></a></dt>
<dd><p>Gamma-distribution based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_XGBoosting.calculate_tercile_probabilities_lognormal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_lognormal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_XGBoosting.calculate_tercile_probabilities_lognormal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_XGBoosting.calculate_tercile_probabilities_lognormal" title="Link to this definition"></a></dt>
<dd><p>Lognormal-distribution based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_XGBoosting.calculate_tercile_probabilities_nonparametric">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_nonparametric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_XGBoosting.calculate_tercile_probabilities_nonparametric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_XGBoosting.calculate_tercile_probabilities_nonparametric" title="Link to this definition"></a></dt>
<dd><p>Non-parametric method using historical error samples.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_XGBoosting.calculate_tercile_probabilities_normal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_normal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_XGBoosting.calculate_tercile_probabilities_normal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_XGBoosting.calculate_tercile_probabilities_normal" title="Link to this definition"></a></dt>
<dd><p>Normal-distribution based method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_XGBoosting.calculate_tercile_probabilities_weibull_min">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_weibull_min</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_XGBoosting.calculate_tercile_probabilities_weibull_min"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_XGBoosting.calculate_tercile_probabilities_weibull_min" title="Link to this definition"></a></dt>
<dd><p>Weibull minimum-based method.</p>
<dl class="simple">
<dt>Here, we assume:</dt><dd><ul class="simple">
<li><p>best_guess is used as the location,</p></li>
<li><p>error_std (sqrt(error_variance)) as the scale, and</p></li>
<li><p>dof (degrees of freedom) as the shape parameter.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>best_guess</strong> (<em>array-like</em>) – Forecast or best guess values.</p></li>
<li><p><strong>error_variance</strong> (<em>array-like</em>) – Variance associated with forecast errors.</p></li>
<li><p><strong>first_tercile</strong> (<em>array-like</em>) – First tercile threshold values.</p></li>
<li><p><strong>second_tercile</strong> (<em>array-like</em>) – Second tercile threshold values.</p></li>
<li><p><strong>dof</strong> (<em>float</em><em> or </em><em>array-like</em>) – Shape parameter for the Weibull minimum distribution.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>pred_prob</strong> – A 3 x n_time array with probabilities for being below the first tercile,
between the first and second tercile, and above the second tercile.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_XGBoosting.compute_model">
<span class="sig-name descname"><span class="pre">compute_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_XGBoosting.compute_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_XGBoosting.compute_model" title="Link to this definition"></a></dt>
<dd><p>Compute deterministic hindcast using the XGBoost model.</p>
<p>Fits the XGBRegressor on training data and predicts deterministic values for the test data.
Handles data stacking and NaN removal to ensure robust predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X_train</strong> (<em>xarray.DataArray</em>) – Training predictor data with dimensions (T, M, Y, X).</p></li>
<li><p><strong>y_train</strong> (<em>xarray.DataArray</em>) – Training predictand data with dimensions (T, Y, X).</p></li>
<li><p><strong>X_test</strong> (<em>xarray.DataArray</em>) – Testing predictor data with dimensions (T, M, Y, X).</p></li>
<li><p><strong>y_test</strong> (<em>xarray.DataArray</em>) – Testing predictand data with dimensions (T, Y, X).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>predicted_da</strong> – Deterministic hindcast with dimensions (T, Y, X).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_XGBoosting.compute_prob">
<span class="sig-name descname"><span class="pre">compute_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_XGBoosting.compute_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_XGBoosting.compute_prob" title="Link to this definition"></a></dt>
<dd><p>Compute tercile probabilities for hindcast data.</p>
<p>Calculates probabilities for below-normal, normal, and above-normal categories using
the specified distribution method, based on climatological terciles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Predictant</strong> (<em>xarray.DataArray</em>) – Observed predictand data with dimensions (T, Y, X).</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em><em> or </em><em>str</em>) – Start year of the climatology period.</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em><em> or </em><em>str</em>) – End year of the climatology period.</p></li>
<li><p><strong>hindcast_det</strong> (<em>xarray.DataArray</em>) – Deterministic hindcast data with dimensions (T, Y, X).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>hindcast_prob</strong> (<em>xarray.DataArray</em>) – Tercile probabilities with dimensions (probability, T, Y, X), where probability
includes [‘PB’, ‘PN’, ‘PA’] (below-normal, normal, above-normal).</p></li>
<li><p><em>Compute tercile probabilities using the chosen distribution method.</em></p></li>
<li><p><em>Predictant is expected to be an xarray DataArray with dims (T, Y, X).</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_mme.WAS_mme_XGBoosting.forecast">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det_cross</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Predictor_for_year</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#WAS_mme_XGBoosting.forecast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.WAS_mme_XGBoosting.forecast" title="Link to this definition"></a></dt>
<dd><p>Generate deterministic and probabilistic forecast for a target year using the XGBoost model.</p>
<p>Fits the XGBRegressor on standardized hindcast data, predicts deterministic values for the target year,
reverses standardization, and computes tercile probabilities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Predictant</strong> (<em>xarray.DataArray</em>) – Observed predictand data with dimensions (T, Y, X) or (T, M, Y, X).</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em><em> or </em><em>str</em>) – Start year of the climatology period.</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em><em> or </em><em>str</em>) – End year of the climatology period.</p></li>
<li><p><strong>hindcast_det</strong> (<em>xarray.DataArray</em>) – Deterministic hindcast data for training with dimensions (T, M, Y, X).</p></li>
<li><p><strong>hindcast_det_cross</strong> (<em>xarray.DataArray</em>) – Deterministic hindcast data for error estimation with dimensions (T, Y, X).</p></li>
<li><p><strong>Predictor_for_year</strong> (<em>xarray.DataArray</em>) – Predictor data for the target year with dimensions (T, M, Y, X).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>result_da</strong> (<em>xarray.DataArray</em>) – Deterministic forecast with dimensions (T, Y, X).</p></li>
<li><p><strong>hindcast_prob</strong> (<em>xarray.DataArray</em>) – Tercile probabilities with dimensions (probability, T, Y, X), where probability
includes [‘PB’, ‘PN’, ‘PA’] (below-normal, normal, above-normal).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wass2s.was_mme.myfill">
<span class="sig-prename descclassname"><span class="pre">wass2s.was_mme.</span></span><span class="sig-name descname"><span class="pre">myfill</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_model_fcst</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#myfill"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.myfill" title="Link to this definition"></a></dt>
<dd><p>Fill missing values in forecast data using random samples from observations.</p>
<p>This function fills NaN values in the forecast data by randomly sampling values from the observed
rainfall data along the time dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>all_model_fcst</strong> (<em>xarray.DataArray</em>) – Forecast data with dimensions (T, M, Y, X) containing possible NaN values.</p></li>
<li><p><strong>obs</strong> (<em>xarray.DataArray</em>) – Observed rainfall data with dimensions (T, Y, X) used for filling NaNs.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>da_filled_random</strong> – Forecast data with NaN values filled using random samples from observations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wass2s.was_mme.process_datasets_for_mme">
<span class="sig-prename descclassname"><span class="pre">wass2s.was_mme.</span></span><span class="sig-name descname"><span class="pre">process_datasets_for_mme</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rainfall</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hdcsted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcsted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gcm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agroparam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Prob</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ELM_ELR</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_to_save_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_models</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">month_of_initialization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lead_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_forecast</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score_metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'GROC'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#process_datasets_for_mme"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.process_datasets_for_mme" title="Link to this definition"></a></dt>
<dd><p>Process hindcast and forecast datasets for a multi-model ensemble.</p>
<p>This function loads, interpolates, and concatenates hindcast and forecast datasets from various sources
(GCMs, agroparameters, or others) to prepare them for a multi-model ensemble. It supports different score
metrics and configurations for probabilistic or deterministic outputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rainfall</strong> (<em>xarray.DataArray</em>) – Observed rainfall data used for interpolation and masking.</p></li>
<li><p><strong>hdcsted</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary of hindcast datasets for different models.</p></li>
<li><p><strong>fcsted</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary of forecast datasets for different models.</p></li>
<li><p><strong>gcm</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, process data as GCM data. Default is True.</p></li>
<li><p><strong>agroparam</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, process data as agroparameter data. Default is False.</p></li>
<li><p><strong>Prob</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, process data as probabilistic forecasts. Default is False.</p></li>
<li><p><strong>ELM_ELR</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, use ELM_ELR configuration for dimension renaming. Default is False.</p></li>
<li><p><strong>dir_to_save_model</strong> (<em>str</em><em>, </em><em>optional</em>) – Directory path to load model data.</p></li>
<li><p><strong>best_models</strong> (<em>list</em><em>, </em><em>optional</em>) – List of model names to include in the ensemble.</p></li>
<li><p><strong>scores</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dictionary containing model scores, with the key specified by <cite>score_metric</cite>.</p></li>
<li><p><strong>year_start</strong> (<em>int</em><em>, </em><em>optional</em>) – Starting year for the data range.</p></li>
<li><p><strong>year_end</strong> (<em>int</em><em>, </em><em>optional</em>) – Ending year for the data range.</p></li>
<li><p><strong>model</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, treat data as model-based. Default is True.</p></li>
<li><p><strong>month_of_initialization</strong> (<em>int</em><em>, </em><em>optional</em>) – Month when the forecast is initialized.</p></li>
<li><p><strong>lead_time</strong> (<em>int</em><em>, </em><em>optional</em>) – Forecast lead time in months.</p></li>
<li><p><strong>year_forecast</strong> (<em>int</em><em>, </em><em>optional</em>) – Year for which the forecast is generated.</p></li>
<li><p><strong>score_metric</strong> (<em>str</em><em>, </em><em>optional</em>) – Metric used to organize scores (e.g., ‘Pearson’, ‘MAE’, ‘GROC’). Default is ‘GROC’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>all_model_hdcst</strong> (<em>xarray.DataArray</em>) – Concatenated hindcast data across models.</p></li>
<li><p><strong>all_model_fcst</strong> (<em>xarray.DataArray</em>) – Concatenated forecast data across models.</p></li>
<li><p><strong>obs</strong> (<em>xarray.DataArray</em>) – Observed rainfall data expanded with a model dimension and masked.</p></li>
<li><p><strong>scores_organized</strong> (<em>dict</em>) – Dictionary of organized scores for selected models.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wass2s.was_mme.process_datasets_for_mme_">
<span class="sig-prename descclassname"><span class="pre">wass2s.was_mme.</span></span><span class="sig-name descname"><span class="pre">process_datasets_for_mme_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rainfall</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hdcsted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcsted</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gcm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agroparam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ELM_ELR</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_to_save_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_models</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">month_of_initialization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lead_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_forecast</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_mme.html#process_datasets_for_mme_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_mme.process_datasets_for_mme_" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-wass2s.was_verification">
<span id="wass2s-was-verification-module"></span><h2>wass2s.was_verification module<a class="headerlink" href="#module-wass2s.was_verification" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="wass2s.was_verification.WAS_Verification">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">wass2s.was_verification.</span></span><span class="sig-name descname"><span class="pre">WAS_Verification</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dist_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gamma'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_verification.html#WAS_Verification"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_verification.WAS_Verification" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Verification class for evaluating weather and climate forecasts.</p>
<p>Provides methods to compute deterministic, probabilistic, and ensemble-based metrics,
as well as visualization tools for model performance assessment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dist_method</strong> (<em>str</em><em>, </em><em>optional</em>) – Distribution method for tercile probability calculations
(‘t’, ‘gamma’, ‘nonparam’, ‘normal’, ‘lognormal’, ‘weibull_min’). Default is ‘gamma’.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_verification.WAS_Verification.calculate_groc">
<span class="sig-name descname"><span class="pre">calculate_groc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_probs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_verification.html#WAS_Verification.calculate_groc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_verification.WAS_Verification.calculate_groc" title="Link to this definition"></a></dt>
<dd><p>Compute Generalized Receiver Operating Characteristic (GROC) score.</p>
<p>Averages the Area Under the Curve (AUC) for each tercile category.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong> (<em>array-like</em>) – Observed values.</p></li>
<li><p><strong>y_probs</strong> (<em>array-like</em>) – Forecast probabilities with shape (n_classes, n_samples).</p></li>
<li><p><strong>index_start</strong> (<em>int</em>) – Start index of the climatology period.</p></li>
<li><p><strong>index_end</strong> (<em>int</em>) – End index of the climatology period.</p></li>
<li><p><strong>n_classes</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of classes (default is 3 for terciles).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>GROC score, ranging from 0 to 1. Returns np.nan if insufficient valid data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_verification.WAS_Verification.calculate_rpss">
<span class="sig-name descname"><span class="pre">calculate_rpss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_probs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_end</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_verification.html#WAS_Verification.calculate_rpss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_verification.WAS_Verification.calculate_rpss" title="Link to this definition"></a></dt>
<dd><p>Compute Ranked Probability Skill Score (RPSS).</p>
<p>Compares the Ranked Probability Score (RPS) of the forecast to a climatological reference.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong> (<em>array-like</em>) – Observed values.</p></li>
<li><p><strong>y_probs</strong> (<em>array-like</em>) – Forecast probabilities with shape (n_classes, n_samples).</p></li>
<li><p><strong>index_start</strong> (<em>int</em>) – Start index of the climatology period.</p></li>
<li><p><strong>index_end</strong> (<em>int</em>) – End index of the climatology period.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>RPSS score, ranging from -Inf to 1. Returns np.nan if insufficient valid data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_verification.WAS_Verification.calculate_rpss_">
<span class="sig-name descname"><span class="pre">calculate_rpss_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_probs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_verification.html#WAS_Verification.calculate_rpss_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_verification.WAS_Verification.calculate_rpss_" title="Link to this definition"></a></dt>
<dd><p>Compute Ranked Probability Skill Score (RPSS) for a single grid point or sample.</p>
<p>Compares the Ranked Probability Score (RPS) of the forecast to a climatological
reference with uniform probabilities (1/3 for each tercile).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em>) – True class labels, already classified into terciles (0: below-normal, 1: near-normal, 2: above-normal).</p></li>
<li><p><strong>y_probs</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>3</em><em>, </em><em>n_samples</em><em>)</em>) – Forecast probabilities for each tercile category.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>RPSS score, ranging from -Inf to 1 (1 indicates perfect forecast skill).
Returns np.nan if insufficient valid data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_verification.WAS_Verification.calculate_tercile_probabilities">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_verification.html#WAS_Verification.calculate_tercile_probabilities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_verification.WAS_Verification.calculate_tercile_probabilities" title="Link to this definition"></a></dt>
<dd><p>Calculate tercile probabilities using Student’s t-distribution.</p>
<p>Computes probabilities for below-normal, normal, and above-normal categories.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>best_guess</strong> (<em>array-like</em>) – Forecast or best-guess values.</p></li>
<li><p><strong>error_variance</strong> (<em>array-like</em>) – Variance of forecast errors.</p></li>
<li><p><strong>first_tercile</strong> (<em>array-like</em>) – First tercile threshold values.</p></li>
<li><p><strong>second_tercile</strong> (<em>array-like</em>) – Second tercile threshold values.</p></li>
<li><p><strong>dof</strong> (<em>int</em>) – Degrees of freedom for the t-distribution.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>pred_prob</strong> – Array of shape (3, n_time) with probabilities for below, normal, and above categories.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_verification.WAS_Verification.calculate_tercile_probabilities_gamma">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_verification.html#WAS_Verification.calculate_tercile_probabilities_gamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_verification.WAS_Verification.calculate_tercile_probabilities_gamma" title="Link to this definition"></a></dt>
<dd><p>Calculate tercile probabilities using Gamma distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>best_guess</strong> (<em>array-like</em>) – Forecast or best-guess values.</p></li>
<li><p><strong>error_variance</strong> (<em>array-like</em>) – Variance of forecast errors.</p></li>
<li><p><strong>T1</strong> (<em>array-like</em>) – First tercile threshold values.</p></li>
<li><p><strong>T2</strong> (<em>array-like</em>) – Second tercile threshold values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>pred_prob</strong> – Array of shape (3, n_time) with probabilities for below, normal, and above categories.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_verification.WAS_Verification.calculate_tercile_probabilities_lognormal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_lognormal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_verification.html#WAS_Verification.calculate_tercile_probabilities_lognormal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_verification.WAS_Verification.calculate_tercile_probabilities_lognormal" title="Link to this definition"></a></dt>
<dd><p>Calculate tercile probabilities using Lognormal distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>best_guess</strong> (<em>array-like</em>) – Forecast or best-guess values.</p></li>
<li><p><strong>error_variance</strong> (<em>array-like</em>) – Variance of forecast errors.</p></li>
<li><p><strong>first_tercile</strong> (<em>array-like</em>) – First tercile threshold values.</p></li>
<li><p><strong>second_tercile</strong> (<em>array-like</em>) – Second tercile threshold values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>pred_prob</strong> – Array of shape (3, n_time) with probabilities for below, normal, and above categories.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_verification.WAS_Verification.calculate_tercile_probabilities_nonparametric">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_nonparametric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_verification.html#WAS_Verification.calculate_tercile_probabilities_nonparametric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_verification.WAS_Verification.calculate_tercile_probabilities_nonparametric" title="Link to this definition"></a></dt>
<dd><p>Calculate tercile probabilities using a non-parametric method.</p>
<p>Uses historical error samples to estimate probabilities empirically.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>best_guess</strong> (<em>array-like</em>) – Forecast or best-guess values.</p></li>
<li><p><strong>error_samples</strong> (<em>array-like</em>) – Historical error samples.</p></li>
<li><p><strong>first_tercile</strong> (<em>array-like</em>) – First tercile threshold values.</p></li>
<li><p><strong>second_tercile</strong> (<em>array-like</em>) – Second tercile threshold values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>pred_prob</strong> – Array of shape (3, n_time) with probabilities for below, normal, and above categories.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_verification.WAS_Verification.calculate_tercile_probabilities_normal">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_normal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_verification.html#WAS_Verification.calculate_tercile_probabilities_normal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_verification.WAS_Verification.calculate_tercile_probabilities_normal" title="Link to this definition"></a></dt>
<dd><p>Calculate tercile probabilities using Normal distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>best_guess</strong> (<em>array-like</em>) – Forecast or best-guess values.</p></li>
<li><p><strong>error_variance</strong> (<em>array-like</em>) – Variance of forecast errors.</p></li>
<li><p><strong>first_tercile</strong> (<em>array-like</em>) – First tercile threshold values.</p></li>
<li><p><strong>second_tercile</strong> (<em>array-like</em>) – Second tercile threshold values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>pred_prob</strong> – Array of shape (3, n_time) with probabilities for below, normal, and above categories.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_verification.WAS_Verification.calculate_tercile_probabilities_weibull_min">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">calculate_tercile_probabilities_weibull_min</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_guess</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_variance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">second_tercile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dof</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_verification.html#WAS_Verification.calculate_tercile_probabilities_weibull_min"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_verification.WAS_Verification.calculate_tercile_probabilities_weibull_min" title="Link to this definition"></a></dt>
<dd><p>Calculate tercile probabilities using Weibull minimum distribution.</p>
<p>Assumes <cite>best_guess</cite> as the location, <cite>error_std</cite> as the scale, and <cite>dof</cite> as the shape parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>best_guess</strong> (<em>array-like</em>) – Forecast or best-guess values.</p></li>
<li><p><strong>error_variance</strong> (<em>array-like</em>) – Variance of forecast errors.</p></li>
<li><p><strong>first_tercile</strong> (<em>array-like</em>) – First tercile threshold values.</p></li>
<li><p><strong>second_tercile</strong> (<em>array-like</em>) – Second tercile threshold values.</p></li>
<li><p><strong>dof</strong> (<em>float</em><em> or </em><em>array-like</em>) – Shape parameter for the Weibull minimum distribution.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>pred_prob</strong> – Array of shape (3, n_time) with probabilities for below, normal, and above categories.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_verification.WAS_Verification.classify">
<span class="sig-name descname"><span class="pre">classify</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_end</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_verification.html#WAS_Verification.classify"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_verification.WAS_Verification.classify" title="Link to this definition"></a></dt>
<dd><p>Classify data into terciles based on climatological thresholds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>array-like</em>) – Input data to classify.</p></li>
<li><p><strong>index_start</strong> (<em>int</em>) – Start index of the climatology period.</p></li>
<li><p><strong>index_end</strong> (<em>int</em>) – End index of the climatology period.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><dl class="simple">
<dt>y_class<span class="classifier">array-like</span></dt><dd><p>Classified data (0: below-normal, 1: near-normal, 2: above-normal).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>tercile_33<span class="classifier">float</span></dt><dd><p>33rd percentile threshold.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>tercile_67<span class="classifier">float</span></dt><dd><p>67th percentile threshold.</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_verification.WAS_Verification.classify_data_into_terciles">
<span class="sig-name descname"><span class="pre">classify_data_into_terciles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_verification.html#WAS_Verification.classify_data_into_terciles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_verification.WAS_Verification.classify_data_into_terciles" title="Link to this definition"></a></dt>
<dd><p>Classify data into terciles based on given thresholds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y</strong> (<em>array-like</em>) – Input data to classify.</p></li>
<li><p><strong>T1</strong> (<em>float</em>) – First tercile threshold (33rd percentile).</p></li>
<li><p><strong>T2</strong> (<em>float</em>) – Second tercile threshold (67th percentile).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Classified data (0: below-normal, 1: near-normal, 2: above-normal).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array-like</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_verification.WAS_Verification.classify_percent">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">classify_percent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_verification.html#WAS_Verification.classify_percent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_verification.WAS_Verification.classify_percent" title="Link to this definition"></a></dt>
<dd><p>Classify a percentage value into predefined categories based on thresholds.</p>
<p>Maps a percentage ratio to one of five categories representing deviation from average.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>p</strong> (<em>float</em><em> or </em><em>array-like</em>) – Percentage value(s) to classify, typically representing a ratio to normal (%).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Category code:
- 1: Well Above Average (&gt;= 150%)
- 2: Above Average (&gt;= 110%)
- 3: Near Average (&gt;= 90%)
- 4: Below Average (&gt;= 50%)
- 5: Well Below Average (&lt; 50%)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int or array-like</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_verification.WAS_Verification.compute_class">
<span class="sig-name descname"><span class="pre">compute_class</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_verification.html#WAS_Verification.compute_class"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_verification.WAS_Verification.compute_class" title="Link to this definition"></a></dt>
<dd><p>Compute tercile class labels for observed data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Predictant</strong> (<em>xarray.DataArray</em>) – Observed data with dimensions (T, Y, X).</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em><em> or </em><em>str</em>) – Start year of the climatology period.</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em><em> or </em><em>str</em>) – End year of the climatology period.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Classified data with dimensions (T, Y, X), where values are
0 (below-normal), 1 (near-normal), or 2 (above-normal).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_verification.WAS_Verification.compute_crps">
<span class="sig-name descname"><span class="pre">compute_crps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">member_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'number'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'T'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_verification.html#WAS_Verification.compute_crps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_verification.WAS_Verification.compute_crps" title="Link to this definition"></a></dt>
<dd><p>Compute Continuous Ranked Probability Score (CRPS) for ensemble forecasts.</p>
<p>Measures the difference between the forecast ensemble distribution and observations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong> (<em>xarray.DataArray</em>) – Observed data with dimensions (T, Y, X).</p></li>
<li><p><strong>y_pred</strong> (<em>xarray.DataArray</em>) – Ensemble forecast data with dimensions (T, number, Y, X).</p></li>
<li><p><strong>member_dim</strong> (<em>str</em><em>, </em><em>optional</em>) – Dimension name for ensemble members. Default is ‘number’.</p></li>
<li><p><strong>dim</strong> (<em>str</em><em>, </em><em>optional</em>) – Dimension to compute CRPS over (typically time). Default is ‘T’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>CRPS values with dimensions (Y, X).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_verification.WAS_Verification.compute_deterministic_score">
<span class="sig-name descname"><span class="pre">compute_deterministic_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">score_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_verification.html#WAS_Verification.compute_deterministic_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_verification.WAS_Verification.compute_deterministic_score" title="Link to this definition"></a></dt>
<dd><p>Apply a deterministic scoring function over xarray DataArrays.</p>
<p>Computes the specified metric across the time dimension for each grid point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>score_func</strong> (<em>callable</em>) – Scoring function to apply (e.g., pearson_corr, kling_gupta_efficiency).</p></li>
<li><p><strong>obs</strong> (<em>xarray.DataArray</em>) – Observed data with dimensions (T, Y, X).</p></li>
<li><p><strong>pred</strong> (<em>xarray.DataArray</em>) – Predicted data with dimensions (T, Y, X).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Score values with dimensions (Y, X).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_verification.WAS_Verification.compute_one_year_rpss">
<span class="sig-name descname"><span class="pre">compute_one_year_rpss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prob_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_verification.html#WAS_Verification.compute_one_year_rpss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_verification.WAS_Verification.compute_one_year_rpss" title="Link to this definition"></a></dt>
<dd><p>Compute and visualize the Ranked Probability Skill Score (RPSS) for a specific year.</p>
<p>Applies the RPSS calculation across a gridded dataset for a single year, using
tercile classifications based on a climatology period, and plots the results on a map.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs</strong> (<em>xarray.DataArray</em>) – Observed data with dimensions (T, Y, X), where T is time, Y is latitude, and X is longitude.</p></li>
<li><p><strong>prob_pred</strong> (<em>xarray.DataArray</em>) – Forecast probabilities with dimensions (probability, T, Y, X), where probability includes
[‘PB’, ‘PN’, ‘PA’] (below-normal, near-normal, above-normal).</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em><em> or </em><em>str</em>) – Start year of the climatology period for tercile classification.</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em><em> or </em><em>str</em>) – End year of the climatology period for tercile classification.</p></li>
<li><p><strong>year</strong> (<em>int</em><em> or </em><em>str</em>) – Specific year to compute the RPSS for.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Displays a geographical plot of the RPSS values with a colorbar.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_verification.WAS_Verification.compute_probabilistic_score">
<span class="sig-name descname"><span class="pre">compute_probabilistic_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">score_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prob_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_verification.html#WAS_Verification.compute_probabilistic_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_verification.WAS_Verification.compute_probabilistic_score" title="Link to this definition"></a></dt>
<dd><p>Apply a probabilistic scoring function over xarray DataArrays.</p>
<p>Computes the specified probabilistic metric across the time dimension for each grid point.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>score_func</strong> (<em>callable</em>) – Probabilistic scoring function to apply (e.g., calculate_rpss, calculate_groc).</p></li>
<li><p><strong>obs</strong> (<em>xarray.DataArray</em>) – Observed data with dimensions (T, Y, X).</p></li>
<li><p><strong>prob_pred</strong> (<em>xarray.DataArray</em>) – Forecast probabilities with dimensions (probability, T, Y, X).</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em><em> or </em><em>str</em>) – Start year of the climatology period.</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em><em> or </em><em>str</em>) – End year of the climatology period.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Score values with dimensions (Y, X).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_verification.WAS_Verification.gcm_compute_prob">
<span class="sig-name descname"><span class="pre">gcm_compute_prob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hindcast_det</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_verification.html#WAS_Verification.gcm_compute_prob"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_verification.WAS_Verification.gcm_compute_prob" title="Link to this definition"></a></dt>
<dd><p>Compute tercile probabilities for GCM hindcasts.</p>
<p>Supports multiple distribution methods for calculating probabilities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Predictant</strong> (<em>xarray.DataArray</em>) – Observed data with dimensions (T, Y, X).</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em><em> or </em><em>str</em>) – Start year of the climatology period.</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em><em> or </em><em>str</em>) – End year of the climatology period.</p></li>
<li><p><strong>hindcast_det</strong> (<em>xarray.DataArray</em>) – Deterministic hindcast data with dimensions (T, Y, X).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tercile probabilities with dimensions (probability, T, Y, X), where
‘probability’ includes [‘PB’, ‘PN’, ‘PA’] (below-normal, normal, above-normal).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_verification.WAS_Verification.gcm_compute_prob_ensemble_method">
<span class="sig-name descname"><span class="pre">gcm_compute_prob_ensemble_method</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Obs_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ensemble</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_verification.html#WAS_Verification.gcm_compute_prob_ensemble_method"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_verification.WAS_Verification.gcm_compute_prob_ensemble_method" title="Link to this definition"></a></dt>
<dd><p>Compute probabilistic forecasts for GCM ensemble data.</p>
<p>Uses the specified ensemble statistic to derive best-guess forecasts and computes
tercile probabilities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Obs_data</strong> (<em>xarray.DataArray</em>) – Observed data with dimensions (T, Y, X).</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em><em> or </em><em>str</em>) – Start year of the climatology period.</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em><em> or </em><em>str</em>) – End year of the climatology period.</p></li>
<li><p><strong>model_data</strong> (<em>xarray.DataArray</em>) – Model ensemble data with dimensions (T, number, Y, X).</p></li>
<li><p><strong>ensemble</strong> (<em>str</em><em>, </em><em>optional</em>) – Ensemble statistic to use (‘mean’ or other supported methods). Default is ‘mean’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tercile probabilities with dimensions (probability, T, Y, X).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_verification.WAS_Verification.gcm_validation_compute">
<span class="sig-name descname"><span class="pre">gcm_validation_compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">models_files_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">month_of_initialization</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_to_save_roc_reliability</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lead_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ensemble_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gridded</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_verification.html#WAS_Verification.gcm_validation_compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_verification.WAS_Verification.gcm_validation_compute" title="Link to this definition"></a></dt>
<dd><p>Validate multiple General Circulation Model (GCM) forecasts using specified metrics.</p>
<p>Computes deterministic, probabilistic, or ensemble-based scores for GCM hindcasts
by processing model data from provided file paths and comparing against observations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>models_files_path</strong> (<em>dict</em>) – Dictionary mapping model identifiers (e.g., model names) to file paths of hindcast NetCDF files.</p></li>
<li><p><strong>Obs</strong> (<em>xarray.DataArray</em>) – Observed data with dimensions (T, Y, X), where T is time, Y is latitude, and X is longitude.</p></li>
<li><p><strong>score</strong> (<em>str</em>) – Score to compute, must be a key in self.scores (e.g., ‘Pearson’, ‘RPSS’, ‘ROC_CURVE’, ‘RELIABILITY_DIAGRAM’).</p></li>
<li><p><strong>month_of_initialization</strong> (<em>int</em>) – Month of forecast initialization (1-12).</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em><em> or </em><em>str</em>) – Start year of the climatology period for computing tercile thresholds.</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em><em> or </em><em>str</em>) – End year of the climatology period for computing tercile thresholds.</p></li>
<li><p><strong>dir_to_save_roc_reliability</strong> (<em>str</em><em> or </em><em>Path</em>) – Directory to save ROC curves and reliability diagram plots.</p></li>
<li><p><strong>lead_time</strong> (<em>list</em><em> of </em><em>int</em><em>, </em><em>optional</em>) – Lead times in months to define the forecast season (e.g., [1, 2, 3] for a 3-month season).
If None, no season is specified.</p></li>
<li><p><strong>ensemble_mean</strong> (<em>str</em><em>, </em><em>optional</em>) – Ensemble statistic to use for deterministic or probabilistic scores (e.g., ‘mean’).
If None, ensemble mean is computed automatically when required.</p></li>
<li><p><strong>gridded</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to perform gridded validation (True) or non-gridded (not implemented). Default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>If score_type is ‘det_score’, ‘prob_score’, or ‘ensemble_score’:</dt><dd><p>Dictionary with model identifiers as keys and xarray.DataArray of scores (dimensions Y, X) as values.</p>
</dd>
<dt>If score_type is ‘all_grid_prob_score’ (e.g., ROC_CURVE, RELIABILITY_DIAGRAM):</dt><dd><p>None, as results are saved as plots.</p>
</dd>
<dt>If score_type is ‘all_grid_det_score’:</dt><dd><p>None (not implemented).</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict or None</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the score is not recognized or if non-gridded validation is attempted (not implemented).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_verification.WAS_Verification.gcm_validation_compute_">
<span class="sig-name descname"><span class="pre">gcm_validation_compute_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">center_variable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">month_of_initialization</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lead_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">area</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_to_save_roc_reliability</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ensemble_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gridded</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_verification.html#WAS_Verification.gcm_validation_compute_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_verification.WAS_Verification.gcm_validation_compute_" title="Link to this definition"></a></dt>
<dd><p>Validate GCM forecasts using specified metrics.</p>
<p>Computes deterministic, probabilistic, or ensemble scores for GCM hindcasts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>center_variable</strong> (<em>list</em><em> of </em><em>str</em>) – List of model identifiers (e.g., ‘center.variable’).</p></li>
<li><p><strong>month_of_initialization</strong> (<em>int</em>) – Month of forecast initialization (1-12).</p></li>
<li><p><strong>lead_time</strong> (<em>list</em><em> of </em><em>int</em>) – Lead times in months for the forecast season.</p></li>
<li><p><strong>dir_model</strong> (<em>str</em><em> or </em><em>Path</em>) – Directory containing model hindcast files.</p></li>
<li><p><strong>Obs</strong> (<em>xarray.DataArray</em>) – Observed data with dimensions (T, Y, X).</p></li>
<li><p><strong>year_start</strong> (<em>int</em>) – Start year of the validation period.</p></li>
<li><p><strong>year_end</strong> (<em>int</em>) – End year of the validation period.</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em>) – Start year of the climatology period.</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em>) – End year of the climatology period.</p></li>
<li><p><strong>area</strong> (<em>str</em>) – Geographical area for validation (not used in current implementation).</p></li>
<li><p><strong>score</strong> (<em>str</em>) – Score to compute (e.g., ‘Pearson’, ‘RPSS’, ‘ROC_CURVE’).</p></li>
<li><p><strong>dir_to_save_roc_reliability</strong> (<em>str</em><em> or </em><em>Path</em>) – Directory to save ROC and reliability plots.</p></li>
<li><p><strong>ensemble_mean</strong> (<em>str</em><em>, </em><em>optional</em>) – Ensemble statistic to use if needed (e.g., ‘mean’). Default is None.</p></li>
<li><p><strong>gridded</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to perform gridded validation. Default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary of model scores with keys as model identifiers and values as xarray.DataArray,
or None for plotting scores (e.g., ROC_CURVE, RELIABILITY_DIAGRAM).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_verification.WAS_Verification.get_scores_metadata">
<span class="sig-name descname"><span class="pre">get_scores_metadata</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_verification.html#WAS_Verification.get_scores_metadata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_verification.WAS_Verification.get_scores_metadata" title="Link to this definition"></a></dt>
<dd><p>Retrieve metadata for all available scoring metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary containing score names as keys and tuples of metadata
(description, min_value, max_value, score_type, colormap, function) as values.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_verification.WAS_Verification.ignorance_score">
<span class="sig-name descname"><span class="pre">ignorance_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_probs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_end</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_verification.html#WAS_Verification.ignorance_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_verification.WAS_Verification.ignorance_score" title="Link to this definition"></a></dt>
<dd><p>Compute Ignorance Score based on Weijs (2010).</p>
<p>Measures the logarithmic loss of forecast probabilities for the true category.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong> (<em>array-like</em>) – Observed values.</p></li>
<li><p><strong>y_probs</strong> (<em>array-like</em>) – Forecast probabilities with shape (n_classes, n_samples).</p></li>
<li><p><strong>index_start</strong> (<em>int</em>) – Start index of the climatology period.</p></li>
<li><p><strong>index_end</strong> (<em>int</em>) – End index of the climatology period.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Ignorance score, non-negative. Returns np.nan if insufficient valid data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_verification.WAS_Verification.index_of_agreement">
<span class="sig-name descname"><span class="pre">index_of_agreement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_verification.html#WAS_Verification.index_of_agreement"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_verification.WAS_Verification.index_of_agreement" title="Link to this definition"></a></dt>
<dd><p>Compute Index of Agreement (IOA).</p>
<p>Measures the degree of model prediction accuracy relative to observed variability.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong> (<em>array-like</em>) – Observed values.</p></li>
<li><p><strong>y_pred</strong> (<em>array-like</em>) – Predicted values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>IOA score, ranging from 0 to 1 (1 is perfect). Returns np.nan if insufficient valid data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_verification.WAS_Verification.kling_gupta_efficiency">
<span class="sig-name descname"><span class="pre">kling_gupta_efficiency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_verification.html#WAS_Verification.kling_gupta_efficiency"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_verification.WAS_Verification.kling_gupta_efficiency" title="Link to this definition"></a></dt>
<dd><p>Compute Kling-Gupta Efficiency (KGE) metric.</p>
<p>KGE combines correlation, bias, and variability ratios to assess model performance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong> (<em>array-like</em>) – Observed values.</p></li>
<li><p><strong>y_pred</strong> (<em>array-like</em>) – Predicted values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>KGE score, ranging from -Inf to 1 (1 is perfect). Returns np.nan if insufficient valid data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_verification.WAS_Verification.mean_absolute_error">
<span class="sig-name descname"><span class="pre">mean_absolute_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_verification.html#WAS_Verification.mean_absolute_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_verification.WAS_Verification.mean_absolute_error" title="Link to this definition"></a></dt>
<dd><p>Compute Mean Absolute Error (MAE).</p>
<p>Measures the average magnitude of errors in predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong> (<em>array-like</em>) – Observed values.</p></li>
<li><p><strong>y_pred</strong> (<em>array-like</em>) – Predicted values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>MAE value, non-negative. Returns np.nan if insufficient valid data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_verification.WAS_Verification.nash_sutcliffe_efficiency">
<span class="sig-name descname"><span class="pre">nash_sutcliffe_efficiency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_verification.html#WAS_Verification.nash_sutcliffe_efficiency"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_verification.WAS_Verification.nash_sutcliffe_efficiency" title="Link to this definition"></a></dt>
<dd><p>Compute Nash-Sutcliffe Efficiency (NSE).</p>
<p>Measures the predictive skill of the model compared to the mean of observations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong> (<em>array-like</em>) – Observed values.</p></li>
<li><p><strong>y_pred</strong> (<em>array-like</em>) – Predicted values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>NSE score, ranging from -Inf to 1 (1 is perfect). Returns np.nan if insufficient valid data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_verification.WAS_Verification.pearson_corr">
<span class="sig-name descname"><span class="pre">pearson_corr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_verification.html#WAS_Verification.pearson_corr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_verification.WAS_Verification.pearson_corr" title="Link to this definition"></a></dt>
<dd><p>Compute Pearson Correlation Coefficient.</p>
<p>Measures the linear correlation between observed and predicted values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong> (<em>array-like</em>) – Observed values.</p></li>
<li><p><strong>y_pred</strong> (<em>array-like</em>) – Predicted values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Pearson correlation coefficient, ranging from -1 to 1. Returns np.nan if insufficient valid data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_verification.WAS_Verification.plot_model_score">
<span class="sig-name descname"><span class="pre">plot_model_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_metric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_save_score</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figure_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'WAS_MLR'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_verification.html#WAS_Verification.plot_model_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_verification.WAS_Verification.plot_model_score" title="Link to this definition"></a></dt>
<dd><p>Plot a deterministic score on a map.</p>
<p>Creates a geographical plot of the specified metric for a single model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_metric</strong> (<em>xarray.DataArray</em>) – Score values with dimensions (Y, X).</p></li>
<li><p><strong>score</strong> (<em>str</em>) – Name of the score to plot (e.g., ‘Pearson’, ‘MAE’).</p></li>
<li><p><strong>dir_save_score</strong> (<em>str</em><em> or </em><em>Path</em>) – Directory to save the plot.</p></li>
<li><p><strong>figure_name</strong> (<em>str</em><em>, </em><em>optional</em>) – Prefix for the figure filename. Default is ‘WAS_MLR’.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_verification.WAS_Verification.plot_models_score">
<span class="sig-name descname"><span class="pre">plot_models_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_save_score</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_verification.html#WAS_Verification.plot_models_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_verification.WAS_Verification.plot_models_score" title="Link to this definition"></a></dt>
<dd><p>Plot multiple model scores on a grid of maps.</p>
<p>Creates a subplot grid with geographical plots for each model’s score.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_metrics</strong> (<em>dict</em>) – Dictionary of model names and their corresponding score DataArrays (Y, X).</p></li>
<li><p><strong>score</strong> (<em>str</em>) – Name of the score to plot (e.g., ‘Pearson’, ‘MAE’).</p></li>
<li><p><strong>dir_save_score</strong> (<em>str</em><em> or </em><em>Path</em>) – Directory to save the plot.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_verification.WAS_Verification.plot_roc_curves">
<span class="sig-name descname"><span class="pre">plot_roc_curves</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">modelname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_to_save_score</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_probs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bootstraps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_verification.html#WAS_Verification.plot_roc_curves"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_verification.WAS_Verification.plot_roc_curves" title="Link to this definition"></a></dt>
<dd><p>Plot ROC Curves with Confidence Intervals for probabilistic forecasts.</p>
<p>Visualizes the Receiver Operating Characteristic for each tercile category.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>modelname</strong> (<em>str</em>) – Name of the model for labeling the plot.</p></li>
<li><p><strong>dir_to_save_score</strong> (<em>str</em><em> or </em><em>Path</em>) – Directory to save the plot.</p></li>
<li><p><strong>y_true</strong> (<em>xarray.DataArray</em>) – Observed data with dimensions (T, Y, X).</p></li>
<li><p><strong>y_probs</strong> (<em>xarray.DataArray</em>) – Forecast probabilities with dimensions (probability, T, Y, X).</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em><em> or </em><em>str</em>) – Start year of the climatology period.</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em><em> or </em><em>str</em>) – End year of the climatology period.</p></li>
<li><p><strong>n_bootstraps</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of bootstrap samples for confidence intervals. Default is 200.</p></li>
<li><p><strong>ci</strong> (<em>float</em><em>, </em><em>optional</em>) – Confidence interval level (e.g., 0.95 for 95%). Default is 0.95.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_verification.WAS_Verification.ratio_to_average">
<span class="sig-name descname"><span class="pre">ratio_to_average</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_verification.html#WAS_Verification.ratio_to_average"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_verification.WAS_Verification.ratio_to_average" title="Link to this definition"></a></dt>
<dd><p>Compute and visualize the ratio of a specific year’s data to the climatological mean.</p>
<p>Calculates the percentage ratio of the predictand for a given year relative to
the mean over a climatology period, classifies it into categories, and plots the
result on a geographical map.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>predictant</strong> (<em>xarray.DataArray</em>) – Observed data with dimensions (T, Y, X), where T is time, Y is latitude, and X is longitude.</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em><em> or </em><em>str</em>) – Start year of the climatology period.</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em><em> or </em><em>str</em>) – End year of the climatology period.</p></li>
<li><p><strong>year</strong> (<em>int</em><em> or </em><em>str</em>) – Specific year to compute the ratio for.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Displays a geographical plot of the classified ratios with a custom colormap and legend.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_verification.WAS_Verification.reliability_diagram">
<span class="sig-name descname"><span class="pre">reliability_diagram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">modelname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_to_save_score</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_probs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0.1,</span> <span class="pre">0.15,</span> <span class="pre">0.2,</span> <span class="pre">0.25,</span> <span class="pre">0.3,</span> <span class="pre">0.35,</span> <span class="pre">0.4,</span> <span class="pre">0.45,</span> <span class="pre">0.5,</span> <span class="pre">0.55,</span> <span class="pre">0.6,</span> <span class="pre">0.65,</span> <span class="pre">0.7])</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_verification.html#WAS_Verification.reliability_diagram"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_verification.WAS_Verification.reliability_diagram" title="Link to this definition"></a></dt>
<dd><p>Plot Reliability Diagrams for probabilistic forecasts.</p>
<p>Visualizes the calibration of forecast probabilities against observed frequencies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>modelname</strong> (<em>str</em>) – Name of the model for labeling the plot.</p></li>
<li><p><strong>dir_to_save_score</strong> (<em>str</em><em> or </em><em>Path</em>) – Directory to save the plot.</p></li>
<li><p><strong>y_true</strong> (<em>xarray.DataArray</em>) – Observed data with dimensions (T, Y, X).</p></li>
<li><p><strong>y_probs</strong> (<em>xarray.DataArray</em>) – Forecast probabilities with dimensions (probability, T, Y, X).</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em><em> or </em><em>str</em>) – Start year of the climatology period.</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em><em> or </em><em>str</em>) – End year of the climatology period.</p></li>
<li><p><strong>bins</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Probability bins for discretizing forecast probabilities.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_verification.WAS_Verification.reliability_score_grid">
<span class="sig-name descname"><span class="pre">reliability_score_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_probs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0.,</span> <span class="pre">0.025,</span> <span class="pre">0.05,</span> <span class="pre">0.1,</span> <span class="pre">0.15,</span> <span class="pre">0.2,</span> <span class="pre">0.25,</span> <span class="pre">0.3,</span> <span class="pre">0.35,</span> <span class="pre">0.4,</span> <span class="pre">0.45,</span> <span class="pre">0.5,</span> <span class="pre">0.55,</span> <span class="pre">0.6,</span> <span class="pre">0.65,</span> <span class="pre">0.7,</span> <span class="pre">0.75,</span> <span class="pre">0.8,</span> <span class="pre">0.85,</span> <span class="pre">0.9,</span> <span class="pre">0.95,</span> <span class="pre">0.975,</span> <span class="pre">1.])</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_verification.html#WAS_Verification.reliability_score_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_verification.WAS_Verification.reliability_score_grid" title="Link to this definition"></a></dt>
<dd><p>Compute Reliability Score on a grid based on Weijs (2010).</p>
<p>Measures the calibration of forecast probabilities against observed frequencies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong> (<em>array-like</em>) – Observed values.</p></li>
<li><p><strong>y_probs</strong> (<em>array-like</em>) – Forecast probabilities with shape (n_classes, n_samples).</p></li>
<li><p><strong>index_start</strong> (<em>int</em>) – Start index of the climatology period.</p></li>
<li><p><strong>index_end</strong> (<em>int</em>) – End index of the climatology period.</p></li>
<li><p><strong>bins</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Probability bins for discretizing forecast probabilities.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Reliability score. Returns np.nan if insufficient valid data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_verification.WAS_Verification.resolution_and_reliability_over_all_grid">
<span class="sig-name descname"><span class="pre">resolution_and_reliability_over_all_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_to_save_score</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_probs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0.,</span> <span class="pre">0.025,</span> <span class="pre">0.05,</span> <span class="pre">0.1,</span> <span class="pre">0.15,</span> <span class="pre">0.2,</span> <span class="pre">0.25,</span> <span class="pre">0.3,</span> <span class="pre">0.35,</span> <span class="pre">0.4,</span> <span class="pre">0.45,</span> <span class="pre">0.5,</span> <span class="pre">0.55,</span> <span class="pre">0.6,</span> <span class="pre">0.65,</span> <span class="pre">0.7,</span> <span class="pre">0.75,</span> <span class="pre">0.8,</span> <span class="pre">0.85,</span> <span class="pre">0.9,</span> <span class="pre">0.95,</span> <span class="pre">0.975,</span> <span class="pre">1.])</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_verification.html#WAS_Verification.resolution_and_reliability_over_all_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_verification.WAS_Verification.resolution_and_reliability_over_all_grid" title="Link to this definition"></a></dt>
<dd><p>Compute Resolution and Reliability scores over all grid points.</p>
<p>Based on Weijs (2010), computes scores by aggregating across all grid points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dir_to_save_score</strong> (<em>str</em><em> or </em><em>Path</em>) – Directory to save score outputs.</p></li>
<li><p><strong>y_true</strong> (<em>xarray.DataArray</em>) – Observed data with dimensions (T, Y, X).</p></li>
<li><p><strong>y_probs</strong> (<em>xarray.DataArray</em>) – Forecast probabilities with dimensions (probability, T, Y, X).</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em><em> or </em><em>str</em>) – Start year of the climatology period.</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em><em> or </em><em>str</em>) – End year of the climatology period.</p></li>
<li><p><strong>bins</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Probability bins for discretizing forecast probabilities.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><dl class="simple">
<dt>resolution_sum<span class="classifier">float</span></dt><dd><p>Aggregated resolution score.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>reliability_sum<span class="classifier">float</span></dt><dd><p>Aggregated reliability score.</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_verification.WAS_Verification.resolution_score_grid">
<span class="sig-name descname"><span class="pre">resolution_score_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_probs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([0.,</span> <span class="pre">0.025,</span> <span class="pre">0.05,</span> <span class="pre">0.1,</span> <span class="pre">0.15,</span> <span class="pre">0.2,</span> <span class="pre">0.25,</span> <span class="pre">0.3,</span> <span class="pre">0.35,</span> <span class="pre">0.4,</span> <span class="pre">0.45,</span> <span class="pre">0.5,</span> <span class="pre">0.55,</span> <span class="pre">0.6,</span> <span class="pre">0.65,</span> <span class="pre">0.7,</span> <span class="pre">0.75,</span> <span class="pre">0.8,</span> <span class="pre">0.85,</span> <span class="pre">0.9,</span> <span class="pre">0.95,</span> <span class="pre">0.975,</span> <span class="pre">1.])</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_verification.html#WAS_Verification.resolution_score_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_verification.WAS_Verification.resolution_score_grid" title="Link to this definition"></a></dt>
<dd><p>Compute Resolution Score on a grid based on Weijs (2010).</p>
<p>Measures the ability of the forecast to distinguish between different outcomes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong> (<em>array-like</em>) – Observed values.</p></li>
<li><p><strong>y_probs</strong> (<em>array-like</em>) – Forecast probabilities with shape (n_classes, n_samples).</p></li>
<li><p><strong>index_start</strong> (<em>int</em>) – Start index of the climatology period.</p></li>
<li><p><strong>index_end</strong> (<em>int</em>) – End index of the climatology period.</p></li>
<li><p><strong>bins</strong> (<em>array-like</em><em>, </em><em>optional</em>) – Probability bins for discretizing forecast probabilities.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Resolution score, non-negative. Returns np.nan if insufficient valid data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_verification.WAS_Verification.root_mean_square_error">
<span class="sig-name descname"><span class="pre">root_mean_square_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_verification.html#WAS_Verification.root_mean_square_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_verification.WAS_Verification.root_mean_square_error" title="Link to this definition"></a></dt>
<dd><p>Compute Root Mean Square Error (RMSE).</p>
<p>Measures the square root of the average squared errors in predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong> (<em>array-like</em>) – Observed values.</p></li>
<li><p><strong>y_pred</strong> (<em>array-like</em>) – Predicted values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>RMSE value, non-negative. Returns np.nan if insufficient valid data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_verification.WAS_Verification.taylor_diagram">
<span class="sig-name descname"><span class="pre">taylor_diagram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_verification.html#WAS_Verification.taylor_diagram"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_verification.WAS_Verification.taylor_diagram" title="Link to this definition"></a></dt>
<dd><p>Placeholder for Taylor Diagram visualization.</p>
<p>Visualizes model performance in terms of correlation, standard deviation, and RMSE.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong> (<em>array-like</em>) – Observed values.</p></li>
<li><p><strong>y_pred</strong> (<em>array-like</em>) – Predicted values.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Implementation pending.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="wass2s.was_verification.WAS_Verification.weighted_gcm_forecasts">
<span class="sig-name descname"><span class="pre">weighted_gcm_forecasts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_models</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scores</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lead_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'PRCP'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/was_verification.html#WAS_Verification.weighted_gcm_forecasts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.was_verification.WAS_Verification.weighted_gcm_forecasts" title="Link to this definition"></a></dt>
<dd><p>Generate weighted ensemble forecasts from selected GCMs based on their performance scores.</p>
<p>Combines hindcasts and forecasts from multiple models using weights derived from
the GROC score, scales the results to match observed climatology, and computes
tercile probabilities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Obs</strong> (<em>xarray.DataArray</em>) – Observed data with dimensions (T, Y, X), used for scaling and probability calculations.</p></li>
<li><p><strong>best_models</strong> (<em>dict</em>) – Dictionary of model identifiers (keys) to be included in the ensemble.</p></li>
<li><p><strong>scores</strong> (<em>dict</em>) – Dictionary containing scores (e.g., GROC) for each model, with model identifiers as keys.</p></li>
<li><p><strong>lead_time</strong> (<em>list</em><em> of </em><em>int</em>) – Lead times in months for the forecast season (e.g., [1, 2, 3] for a 3-month season).</p></li>
<li><p><strong>model_dir</strong> (<em>str</em><em> or </em><em>Path</em>) – Directory containing hindcast and forecast NetCDF files.</p></li>
<li><p><strong>clim_year_start</strong> (<em>int</em><em> or </em><em>str</em>) – Start year of the climatology period for computing tercile thresholds.</p></li>
<li><p><strong>clim_year_end</strong> (<em>int</em><em> or </em><em>str</em>) – End year of the climatology period for computing tercile thresholds.</p></li>
<li><p><strong>variable</strong> (<em>str</em><em>, </em><em>optional</em>) – Variable name in the NetCDF files (e.g., ‘PRCP’ for precipitation). Default is ‘PRCP’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><dl class="simple">
<dt>hindcast_det<span class="classifier">xarray.DataArray</span></dt><dd><p>Weighted deterministic hindcast with dimensions (T, Y, X).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>hindcast_prob<span class="classifier">xarray.DataArray</span></dt><dd><p>Tercile probabilities for hindcasts with dimensions (probability, T, Y, X).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>forecast_prob<span class="classifier">xarray.DataArray</span></dt><dd><p>Tercile probabilities for forecasts with dimensions (probability, Y, X).</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Model files are expected to follow a naming convention like
‘hindcast_{center}_{variable}_{init_month}_{season}_{lead}.nc’.</p></li>
<li><p>The GROC score is used as the weighting metric.</p></li>
<li><p>A scaling factor is applied based on the ratio of observed to hindcast mean.</p></li>
</ul>
</dd></dl>

</dd></dl>

</section>
<section id="module-wass2s.utils">
<span id="wass2s-utils-module"></span><h2>wass2s.utils module<a class="headerlink" href="#module-wass2s.utils" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="wass2s.utils.anomalize_timeseries">
<span class="sig-prename descclassname"><span class="pre">wass2s.utils.</span></span><span class="sig-name descname"><span class="pre">anomalize_timeseries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/utils.html#anomalize_timeseries"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.utils.anomalize_timeseries" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wass2s.utils.build_iridl_url_ersst">
<span class="sig-prename descclassname"><span class="pre">wass2s.utils.</span></span><span class="sig-name descname"><span class="pre">build_iridl_url_ersst</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">year_start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_end</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bbox</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_avg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">month_start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Jan'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">month_end</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Dec'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/utils.html#build_iridl_url_ersst"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.utils.build_iridl_url_ersst" title="Link to this definition"></a></dt>
<dd><p>Build a parameterized IRIDL URL for NOAA/ERSST, using a numeric bounding box
of the form [North, West, South, East].</p>
<blockquote>
<div><p>e.g. area = [10, -15, -5, 15].</p>
</div></blockquote>
<dl class="simple">
<dt>IRIDL wants Y/(south)/(north)/…, X/(west)/(east)/…, so we reorder:</dt><dd><ul class="simple">
<li><p>south = area[2]</p></li>
<li><p>north = area[0]</p></li>
<li><p>west  = area[1]</p></li>
<li><p>east  = area[3]</p></li>
</ul>
</dd>
</dl>
<p>If run_avg is provided, we’ll append T/&lt;run_avg&gt;/runningAverage/.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wass2s.utils.compute_other_indices">
<span class="sig-prename descclassname"><span class="pre">wass2s.utils.</span></span><span class="sig-name descname"><span class="pre">compute_other_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_to_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variables_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">season</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">month_of_initialization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lead_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_forecast</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/utils.html#compute_other_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.utils.compute_other_indices" title="Link to this definition"></a></dt>
<dd><p>Compute indices for other variables.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wass2s.utils.compute_sst_indices">
<span class="sig-prename descclassname"><span class="pre">wass2s.utils.</span></span><span class="sig-name descname"><span class="pre">compute_sst_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_to_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variables_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">season</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">others_zone</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">month_of_initialization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lead_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_forecast</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/utils.html#compute_sst_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.utils.compute_sst_indices" title="Link to this definition"></a></dt>
<dd><p>Compute SST indices for reanalysis or model data.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wass2s.utils.decode_cf">
<span class="sig-prename descclassname"><span class="pre">wass2s.utils.</span></span><span class="sig-name descname"><span class="pre">decode_cf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_var</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/utils.html#decode_cf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.utils.decode_cf" title="Link to this definition"></a></dt>
<dd><p>Decodes time dimension to CFTime standards.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wass2s.utils.download_file">
<span class="sig-prename descclassname"><span class="pre">wass2s.utils.</span></span><span class="sig-name descname"><span class="pre">download_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">url</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_download</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunk_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8192</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">120</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/utils.html#download_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.utils.download_file" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wass2s.utils.find_best_distribution_grid">
<span class="sig-prename descclassname"><span class="pre">wass2s.utils.</span></span><span class="sig-name descname"><span class="pre">find_best_distribution_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rainfall</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distribution_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/utils.html#find_best_distribution_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.utils.find_best_distribution_grid" title="Link to this definition"></a></dt>
<dd><p>Apply a function across the rainfall DataArray (assumed to have a ‘T’ dimension)
to determine the best-fitting distribution, returning a grid of numeric codes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rainfall</strong> (<em>xarray.DataArray</em>) – Precipitation data with a time dimension ‘T’ and additional spatial dimensions.</p></li>
<li><p><strong>distribution_map</strong> (<em>dict</em><em>, </em><em>optional</em>) – <dl>
<dt>A mapping of distribution names to numeric codes. Defaults to:</dt><dd><dl class="simple">
<dt>{</dt><dd><p>‘norm’: 1,
‘lognorm’: 2,
‘expon’: 3,
‘gamma’: 4,
‘weibull_min’: 5</p>
</dd>
</dl>
<p>}</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>best_fit_da</strong> – An array of the same spatial dimensions as rainfall with the best-fitting
distribution’s numeric code at each grid cell.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>xarray.DataArray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wass2s.utils.fix_time_coord">
<span class="sig-prename descclassname"><span class="pre">wass2s.utils.</span></span><span class="sig-name descname"><span class="pre">fix_time_coord</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seas</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/utils.html#fix_time_coord"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.utils.fix_time_coord" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wass2s.utils.get_best_models">
<span class="sig-prename descclassname"><span class="pre">wass2s.utils.</span></span><span class="sig-name descname"><span class="pre">get_best_models</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">center_variable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scores</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'MAE'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gcm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agroparam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/utils.html#get_best_models"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.utils.get_best_models" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wass2s.utils.load_gridded_predictor">
<span class="sig-prename descclassname"><span class="pre">wass2s.utils.</span></span><span class="sig-name descname"><span class="pre">load_gridded_predictor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_to_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variables_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">season</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">month_of_initialization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lead_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_forecast</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/utils.html#load_gridded_predictor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.utils.load_gridded_predictor" title="Link to this definition"></a></dt>
<dd><p>Load gridded predictor data for reanalysis or model.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wass2s.utils.parse_variable">
<span class="sig-prename descclassname"><span class="pre">wass2s.utils.</span></span><span class="sig-name descname"><span class="pre">parse_variable</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variables_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/utils.html#parse_variable"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.utils.parse_variable" title="Link to this definition"></a></dt>
<dd><p>Extract center and variable names from the variables list.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wass2s.utils.plot_date">
<span class="sig-prename descclassname"><span class="pre">wass2s.utils.</span></span><span class="sig-name descname"><span class="pre">plot_date</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/utils.html#plot_date"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.utils.plot_date" title="Link to this definition"></a></dt>
<dd><p>Plots ‘A’ on a map, interpreting the data values as
offsets from 2024-01-01. The colorbar ticks are then
converted to calendar dates.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wass2s.utils.plot_map">
<span class="sig-prename descclassname"><span class="pre">wass2s.utils.</span></span><span class="sig-name descname"><span class="pre">plot_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">extent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Map'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sst_indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fig_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(10,</span> <span class="pre">8)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/utils.html#plot_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.utils.plot_map" title="Link to this definition"></a></dt>
<dd><p>Plots a map with specified geographic extent and optionally adds SST index boxes.</p>
<p>Parameters:
- extent: list of float, specifying [west, east, south, north]
- title: str, title of the map
- sst_indices: dict, optional dictionary containing SST index information</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wass2s.utils.plot_prob_forecasts">
<span class="sig-prename descclassname"><span class="pre">wass2s.utils.</span></span><span class="sig-name descname"><span class="pre">plot_prob_forecasts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_to_save</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forecast_prob</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['Below-Normal',</span> <span class="pre">'Near-Normal',</span> <span class="pre">'Above-Normal']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reverse_cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/utils.html#plot_prob_forecasts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.utils.plot_prob_forecasts" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wass2s.utils.plot_prob_forecasts_">
<span class="sig-prename descclassname"><span class="pre">wass2s.utils.</span></span><span class="sig-name descname"><span class="pre">plot_prob_forecasts_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_to_save</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forecast_prob</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/utils.html#plot_prob_forecasts_"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.utils.plot_prob_forecasts_" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wass2s.utils.plot_tercile">
<span class="sig-prename descclassname"><span class="pre">wass2s.utils.</span></span><span class="sig-name descname"><span class="pre">plot_tercile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">A</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/utils.html#plot_tercile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.utils.plot_tercile" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wass2s.utils.predictant_mask">
<span class="sig-prename descclassname"><span class="pre">wass2s.utils.</span></span><span class="sig-name descname"><span class="pre">predictant_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/utils.html#predictant_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.utils.predictant_mask" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wass2s.utils.prepare_predictand">
<span class="sig-prename descclassname"><span class="pre">wass2s.utils.</span></span><span class="sig-name descname"><span class="pre">prepare_predictand</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_to_save_Obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variables_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">season</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">daily</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/utils.html#prepare_predictand"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.utils.prepare_predictand" title="Link to this definition"></a></dt>
<dd><p>Prepare the predictand dataset.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wass2s.utils.process_model_for_other_params">
<span class="sig-prename descclassname"><span class="pre">wass2s.utils.</span></span><span class="sig-name descname"><span class="pre">process_model_for_other_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">agmParamModel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dir_to_save</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hdcst_file_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcst_file_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_hdcst</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">obs_fcst_year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">month_of_initialization</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_forecast</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb_cores</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agrometparam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Onset'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/utils.html#process_model_for_other_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.utils.process_model_for_other_params" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wass2s.utils.retrieve_several_zones_for_PCR">
<span class="sig-prename descclassname"><span class="pre">wass2s.utils.</span></span><span class="sig-name descname"><span class="pre">retrieve_several_zones_for_PCR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_to_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variables_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">season</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">month_of_initialization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lead_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_forecast</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/utils.html#retrieve_several_zones_for_PCR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.utils.retrieve_several_zones_for_PCR" title="Link to this definition"></a></dt>
<dd><p>Compute indices for other variables.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wass2s.utils.retrieve_single_zone_for_PCR">
<span class="sig-prename descclassname"><span class="pre">wass2s.utils.</span></span><span class="sig-name descname"><span class="pre">retrieve_single_zone_for_PCR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_to_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variables_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_end</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">season</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">month_of_initialization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lead_time</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year_forecast</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/utils.html#retrieve_single_zone_for_PCR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.utils.retrieve_single_zone_for_PCR" title="Link to this definition"></a></dt>
<dd><p>Compute indices for other variables.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wass2s.utils.reverse_standardize">
<span class="sig-prename descclassname"><span class="pre">wass2s.utils.</span></span><span class="sig-name descname"><span class="pre">reverse_standardize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ds_st</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/utils.html#reverse_standardize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.utils.reverse_standardize" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wass2s.utils.save_hindcast_and_forecasts">
<span class="sig-prename descclassname"><span class="pre">wass2s.utils.</span></span><span class="sig-name descname"><span class="pre">save_hindcast_and_forecasts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_to_save</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forecast</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deterministic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/utils.html#save_hindcast_and_forecasts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.utils.save_hindcast_and_forecasts" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wass2s.utils.save_validation_score">
<span class="sig-prename descclassname"><span class="pre">wass2s.utils.</span></span><span class="sig-name descname"><span class="pre">save_validation_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir_to_save</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/utils.html#save_validation_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.utils.save_validation_score" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wass2s.utils.standardize_timeseries">
<span class="sig-prename descclassname"><span class="pre">wass2s.utils.</span></span><span class="sig-name descname"><span class="pre">standardize_timeseries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">clim_year_end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/utils.html#standardize_timeseries"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.utils.standardize_timeseries" title="Link to this definition"></a></dt>
<dd><p>Standardize the dataset over a specified climatology period.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wass2s.utils.to_iridl_lat">
<span class="sig-prename descclassname"><span class="pre">wass2s.utils.</span></span><span class="sig-name descname"><span class="pre">to_iridl_lat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/wass2s/utils.html#to_iridl_lat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.utils.to_iridl_lat" title="Link to this definition"></a></dt>
<dd><p>Convert numeric latitude to IRIDL lat string: +10 -&gt; ‘10N’, -5 -&gt; ‘5S’.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wass2s.utils.to_iridl_lon">
<span class="sig-prename descclassname"><span class="pre">wass2s.utils.</span></span><span class="sig-name descname"><span class="pre">to_iridl_lon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/wass2s/utils.html#to_iridl_lon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.utils.to_iridl_lon" title="Link to this definition"></a></dt>
<dd><p>Convert numeric longitude to IRIDL lon string: +15 -&gt; ‘15E’, -15 -&gt; ‘15W’.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wass2s.utils.trend_data">
<span class="sig-prename descclassname"><span class="pre">wass2s.utils.</span></span><span class="sig-name descname"><span class="pre">trend_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/utils.html#trend_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.utils.trend_data" title="Link to this definition"></a></dt>
<dd><p>trend the data using ExtendedEOF if detrending is enabled.</p>
<p>Parameters:
- data: xarray DataArray we want to know trend.</p>
<p>Returns:
- data_trended: trended xarray DataArray.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="wass2s.utils.verify_station_network">
<span class="sig-prename descclassname"><span class="pre">wass2s.utils.</span></span><span class="sig-name descname"><span class="pre">verify_station_network</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_filtered</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Rain-gauge</span> <span class="pre">network'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/wass2s/utils.html#verify_station_network"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#wass2s.utils.verify_station_network" title="Link to this definition"></a></dt>
<dd><p>Verify the station network by plotting the locations of the stations
on a map.</p>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="mme.html" class="btn btn-neutral float-left" title="Multi-Model Ensemble (MME) Techniques" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Mandela C. M. HOUNGNIBO.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>